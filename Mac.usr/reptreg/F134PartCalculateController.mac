/* ──────────────────────────────────────────────────────────────────────────┐
   RS-Bank V6                                                 R-Style Softlab
   Файл подсистемы "Регламентированная отчетность"

   Форма 134. Контроллер расчет раздела.

   CREATED : 17.07.12 Ser.
└────────────────────────────────────────────────────────────────────────── */
class (RcbPartCalculateController) F134PartCalculateController(reportCalculateController : Object /*TReportCalculateController*/, partId : String)
    initRcbPartCalculateController(reportCalculateController, partId);
    private var m_protocolView = m_dataSources.getProtocolView();

    private const PROFIT_WITHIOUT_PFI_NOTE_ID = 49;

    private const PFI_IMPL_NOTE_ID = 47;

    private const PROFIT_NOT_IMPL_NOTE_ID = 48;

    private const NOTEKIND_BOUGHT_OUT_COST = 23;

    private var m_costTransferDate : Date = null;

    private macro getYear(day : date)
        var y;
        dateSplit(day, null, null, y);

        return y;
    end;

    private macro getSpodEndDate()
        return f134Parameters.spodEndDate;
    end;

    macro printAttributeHead(attributeId : String)
        // m_protocolView.printLine("\n***********************************");
        // m_protocolView.printLine("Расчет атрибута: " + attributeId);
        // m_protocolView.printLine("***********************************");
    end;

    private macro getCostTransferDate()
        if (m_costTransferDate == null)

            if (getSpodEndDate() != Date(0, 0, 0))
                var dataSet = TRsbDataSet("SELECT t_date"
                    +"\n"+                "  FROM drepdocument_vw"
                    +"\n"+                " WHERE t_date BETWEEN " + getSqlDate(getSpodEndDate()) + " AND " + getSqlDate(date(31,01,getYear(m_report.getPeriod().endDate)))
                    +"\n"+                "   AND (   (t_debetAccount like '70801%' AND (t_creditAccount like '10801%' OR  t_creditAccount like '10901%'))"
                    +"\n"+                "        OR (t_debetAccount like '10901%' AND t_creditAccount like '70802%'))"
                    +"\n"+                "   AND rowNum < 2");

                dataSet.setFieldType("t_date", V_DATE);

                if (dataSet.moveNext())
                    m_costTransferDate = dataSet.date;
                else
                    m_costTransferDate = Date(0, 0, 0);
                end;
            else
                m_costTransferDate = Date(0, 0, 0);
            end;
        end;

        return m_costTransferDate;
    end;


    private macro isLastDayInMonth(day : Date)
        var m;
        var y;
        dateSplit(day, NULL, m, y);

        if (m == 12)
            m = 1;
            y = y + 1;
        else
            m = m + 1;
        end;

        return day == Date(1, m, y) - 1;
    end;

    macro processUserAttribute(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        m_protocolView.printLine("Атрибут пользователького ввода: " + attribute.getId());

        if (attribute.getValue() == null)
            m_protocolView.printLine("\nЗначение не заданно, полагаем равным нулю");

            attribute.setValue($0.0);
        end;

        m_protocolView.printLine("\n" + attribute.getId + " = " + attribute.getValue());
    end;


    private macro setValueCbDocument(attribute : RcbAttributeBase, creditSum : Money, debetSum : Money)
        var sum = creditSum - debetSum;

        m_protocolView.printLine("\n" + attribute.getId + " = Сумма по кредиту(" + creditSum + ") - Сумма по дебету(" + debetSum + ")");

        attribute.setValue(sum);

        m_protocolView.printLine("\n" + attribute.getId + " = " + attribute.getValue());
    end;

    private macro setValue(attribute : RcbAttributeBase, sum : Money)
        m_protocolView.printLine("\n" + attribute.getId + " = " + sum);

        attribute.setValue(sum);
    end;

    private macro plusValue(attribute : RcbAttributeBase, sum : Money)
        m_protocolView.printLine("\n" + attribute.getId + " = " + attribute.getId + "(" + attribute.getValue() + ") + " + sum);

        attribute.plus(sum);

        m_protocolView.printLine("\n" + attribute.getId + " = " + attribute.getValue());
    end;

    private macro minusValue(attribute : RcbAttributeBase, sum : Money)
        m_protocolView.printLine("\n" + attribute.getId + " = " + attribute.getId + "(" + attribute.getValue() + ") - " + sum);

        attribute.minus(sum);

        m_protocolView.printLine("\n" + attribute.getId + " = " + attribute.getValue());
    end;

    private macro setValueAttributes(attribute : RcbAttributeBase, plusPool : RcbArray, minusPool : RcbArray, isControlNegativeAmmount : Bool)
        m_protocolView.printLine("Собственное значение атрибута: " + attribute.getId() + "(" + attribute.getValue() + ")");

        var tmpAttribute = null;
        var value        = $0.0;

        plusPool.moveFirst();

        while (plusPool.moveNext())
             tmpAttribute = m_part.getAttribute(plusPool.getCurrentItem());

             value = tmpAttribute.getValue();

             if (isControlNegativeAmmount and (value <= $0.0))

                m_protocolView.printLine("Значение переменной  "  + tmpAttribute.getId() + "(" + value + ") <= 0, в расчете принимаем = 0");
                value = $0.0;
             end;

             attribute.plus(value);

             m_protocolView.printLine("+" + tmpAttribute.getId() + "(" + value + ")");
        end;

        minusPool.moveFirst();

        while (minusPool.moveNext())
             tmpAttribute = m_part.getAttribute(minusPool.getCurrentItem());

             value = tmpAttribute.getValue();


             if (isControlNegativeAmmount and (value <= $0.0))

                m_protocolView.printLine("Значение переменной  "  + tmpAttribute.getId() + "(" + value + ") <= 0, в расчете принимаем = 0");
                value = $0.0;
             end;

             attribute.minus(value);

             m_protocolView.printLine("-" + tmpAttribute.getId() + "(" + value + ")");
        end;

        m_protocolView.printLine("\n" + attribute.getId + " = " + attribute.getValue());
    end;

    private macro getCalculateAttributeData(attributeId : String, functionName : String, dependencesAttributeIdPool : RcbArray)
        if (dependencesAttributeIdPool == null)
            dependencesAttributeIdPool = RcbArray();
        end;

        var dependencesAttributePool = RcbArray();

        dependencesAttributeIdPool.moveFirst();
        while (dependencesAttributeIdPool.moveNext())
            dependencesAttributePool.push_back(m_part.getAttribute(dependencesAttributeIdPool.getCurrentItem()));
        end;

        return RcbCalculationAttributeData(m_part.getAttribute(attributeId),
                                           RcbArray().initialize(RcbCalculationData(r2m(this, functionName),
                                                                                    RcbArray().initialize(attributeId))),
                                           RcbDependencesData(dependencesAttributePool));
    end;

    private macro replaceDependencesAttributePool(attributeId : String, functionName : String, dependencesAttributeIdPool: RcbArray)
        m_reportCalculateController.deleteCalculationAttributeData(m_part.getAttribute(attributeId));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData(attributeId, functionName, dependencesAttributeIdPool));
        m_reportCalculateController.setReplacedDependencies(true);
    end;
end;
/**
 * Класс предварительного расчета отчета
 */
class (F134PartCalculateController) F134Part1CalculateController(reportCalculateController : Object /*TReportCalculateController*/)
    initF134PartCalculateController(reportCalculateController, "1");

    macro calculateLine_101(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = null;
        var filter     = null;

        if (f134Parameters.isCalculateACForPosting)

            dataSource = m_dataSources.getDataSource("CbDocument");
            filter     = m_dataSouceFilters.getFilter("CbDocument");

            filter.paymentCapitalChangeDateLessOrEqual(m_report.getPeriod().endDate).op("AND").isSatisfiesToBalanceMasks("10207*, 10208*", false);

            var sumCredit = dataSource.getData(filter, attribute, "Сумма по кредиту");

            filter     = m_dataSouceFilters.getFilter("CbDocument");

            filter.paymentCapitalChangeDateLessOrEqual(m_report.getPeriod().endDate).op("AND").isSatisfiesToBalanceMasks("10207*, 10208*", true);

            var sumDebet = dataSource.getData(filter, attribute, "Сумма по дебету");

            setValueCbDocument(attribute, sumCredit, sumDebet)
        else

            dataSource = m_dataSources.getDataSource("CbAccount");
            filter     = m_dataSouceFilters.getFilter("CbAccount");

            filter.isOpened().op("AND").isExistRest();

            filter.op("AND").isSatisfiesToBalanceMasks("10207, 10208").op("AND").op("(").op("(").isSatisfiesToBalanceMasks("10207").op("AND").op("NOT").isReportingCategoryExists("2.1.1 искл").op("AND").op("NOT").isReportingCategoryExists("3.7").op(")");

            filter.op("OR").op("(").isSatisfiesToBalanceMasks("10208").op("AND").op("NOT").isReportingCategoryExists("2.1.2 искл").op(")").op(")");

            setValue(attribute, dataSource.getData(filter, attribute));
        end;
    end;

    macro calculateLine_102(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = null;
        var filter     = null;

        if (f134Parameters.isCalculateACForPosting)

            dataSource = m_dataSources.getDataSource("CbDocument");
            filter     = m_dataSouceFilters.getFilter("CbDocument");

            filter.paymentCapitalChangeDateLessOrEqual(m_report.getPeriod().endDate).op("AND").isSatisfiesToBalanceMasks("10602*", false);

            var sumCredit = dataSource.getData(filter, attribute, "Сумма по кредиту");

            filter     = m_dataSouceFilters.getFilter("CbDocument");

            filter.paymentCapitalChangeDateLessOrEqual(m_report.getPeriod().endDate).op("AND").isSatisfiesToBalanceMasks("10602*", true);

            var sumDebet = dataSource.getData(filter, attribute, "Сумма по дебету");

            setValueCbDocument(attribute, sumCredit, sumDebet)
        else

            dataSource = m_dataSources.getDataSource("CbAccount");
            filter     = m_dataSouceFilters.getFilter("CbAccount");

            filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("10602");

            setValue(attribute, dataSource.getData(filter, attribute));
        end;
    end;

    macro calculateLine_103(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = null;
        var filter     = null;

        dataSource = m_dataSources.getDataSource("CbAccount");
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("107*").op("AND").isReportingCategoryExists("2.1.5");

        setValue(attribute, dataSource.getData(filter, attribute));

        setValueAttributes(attribute,
                           RcbArray(),
                           RcbArray().initialize("Строка_105", "Строка_202"));
    end;

    macro calculateLine_104_data(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.ПрибыльТекущегоГодаПодтверждена)
            m_protocolView.PrintLine("Прибыль текущего года подтверждена.");

            var dataSource = m_dataSources.getDataSource("CbAccount");
            var filter     = m_dataSouceFilters.getFilter("CbAccount");
            var rest       = $0.0;
            //Сумма 1
            filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70601, 70603, 70604, 70605, 61301, 61304");

            rest = dataSource.getData(filter, attribute, null, f134Parameters.ДатаАудПодтв_ТекГ -1);

            //Сумма 2
            m_protocolView.PrintLine("Плюс");

            filter = m_dataSouceFilters.getFilter("CbAccount");

            filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10603, 70602").op("AND").isReportingCategoryExists("ТСС");

            rest = rest + dataSource.getData(filter, attribute, null, f134Parameters.ДатаАудПодтв_ТекГ -1);

            //Сумма 3
            m_protocolView.PrintLine("Минус");

            filter = m_dataSouceFilters.getFilter("CbAccount");

            filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70606, 70608, 70609, 70610, 70611, 70612, 50905, 61401, 61403");

            rest = rest - dataSource.getData(filter, attribute, null, f134Parameters.ДатаАудПодтв_ТекГ -1);

            //Сумма 4
            m_protocolView.PrintLine("Минус");

            filter = m_dataSouceFilters.getFilter("CbAccount");

            filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10605, 70607").op("AND").isReportingCategoryExists("ТСС");

            rest = rest - dataSource.getData(filter, attribute, null, f134Parameters.ДатаАудПодтв_ТекГ -1);

            setValue(attribute, rest);

            var minusPool = RcbArray();

            if (not isLastDayInMonth(m_report.getPeriod().endDate))
                minusPool.push_back("Строка_104_52303_ввод");
            end;

            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_104.2_данные"),
                               minusPool);
        else
            m_protocolView.PrintLine("Прибыль текущего года не подтверждена.");
            m_protocolView.PrintLine("Значение переменной равно нулю.");
            setValue(attribute, $0.0);
        end;
    end;

    macro calculateLine_104(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var sum = m_part.getAttribute("Строка_104_данные").getValue();

        if (sum >= 0)
            m_protocolView.PrintLine("Строка_104_данные (" + sum + ") >= 0");
            setValue(attribute, sum);
        else
            m_protocolView.PrintLine("Строка_104_данные (" + sum + ") < 0");
            setValue(attribute, $0.0);
        end;
    end;

    macro calculateLine_104RevaluationData(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.ПрибыльТекущегоГодаПодтверждена)
            m_protocolView.PrintLine("Прибыль текущего года подтверждена.");

            var dataSource = m_dataSources.getDataSource("CbAccount");
            var filter     = m_dataSouceFilters.getFilter("CbAccount");
            var rest       = $0.0;
            //Сумма 1
            filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10603, 70602").op("AND").isReportingCategoryExists("ТСС");

            rest = dataSource.getData(filter, attribute, null, f134Parameters.ДатаАудПодтв_ТекГ -1);

            //Сумма 2
            m_protocolView.PrintLine("Минус");

            filter = m_dataSouceFilters.getFilter("CbAccount");

            filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10605, 70607").op("AND").isReportingCategoryExists("ТСС");

            rest = rest - dataSource.getData(filter, attribute, null, f134Parameters.ДатаАудПодтв_ТекГ -1);

            setValue(attribute, rest);
        else
            m_protocolView.PrintLine("Прибыль текущего года не подтверждена.");
            m_protocolView.PrintLine("Значение переменной равно нулю.");
            setValue(attribute, $0.0);
        end;
    end;

    macro calculateLine_104Revaluation(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var sum = m_part.getAttribute("Строка_104").getValue();

        if (sum >= 0)
            m_protocolView.PrintLine("Строка_104 (" + sum + ") >= 0");

            sum = m_part.getAttribute("Строка_104.1_переоценка_данные").getValue();

            m_protocolView.PrintLine("Значение переменной равно значению переменной Строка_104.1_переоценка_данные (" + sum + ")");
            setValue(attribute, sum);
        else
            m_protocolView.PrintLine("Строка_104 (" + sum + ") < 0");
            setValue(attribute, $0.0);
        end;
    end;

    macro calculateLine_104_2_data(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("Строка_104.2.1_данные", "Строка_104.2.2_нереал_полож_данные"),
                           RcbArray().initialize("Строка_104.2.2_нереал_отриц_данные"),
                           true);
    end;

    macro calculateLine_104_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_104.2.1_ввод", "Строка_104.2.2_полож_ввод"),
                               RcbArray().initialize("Строка_104.2.2_отриц_ввод"),
                               true);
        else
            var sum = m_part.getAttribute("Строка_104").getValue();

            if (sum > 0)
                m_protocolView.PrintLine("Строка_104 (" + sum + ") > 0");

                sum = m_part.getAttribute("Строка_104.2_данные").getValue();

                m_protocolView.PrintLine("Значение переменной равно значению переменной Строка_104.2_данные (" + sum + ")");
                setValue(attribute, sum);
            else
                m_protocolView.PrintLine("Строка_104 (" + sum + ") <= 0");
                setValue(attribute, $0.0);
            end;
        end;

    end;

    macro calculateLine_104_2_1_dataSum1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        //Сумма 1
        var dataSource = m_dataSources.getDataSource("CbDocument");
        var filter     = m_dataSouceFilters.getFilter("CbDocument");

        var year;
        dateSplit(f134Parameters.ДатаАудПодтв_ТекГ, NULL, NULL, year);

        filter.setDateCary(date(0, 0, 0), f134Parameters.ДатаАудПодтв_ТекГ - 1).op("AND").isSatisfiesToBalanceMasks("61601*", true).op("AND").isSatisfiesToBalanceMasks("70613*", false).op("AND").isOpuSymbolEqualTo("16101", false);

        setValue(attribute, dataSource.getData(filter, attribute));

        //Сумма 2

        setValueAttributes(attribute,
                           RcbArray().initialize("Док_подтв_суммы_70613_ввод"),
                           RcbArray(),
                           true);

        //Сумма 3
        filter     = m_dataSouceFilters.getFilter("CbDocument");

        filter.setDateCary(date(0, 0, 0), f134Parameters.ДатаАудПодтв_ТекГ - 1).op("AND").isSatisfiesToBalanceMasks("70613*", true).op("AND").isSatisfiesToBalanceMasks("61601*", false).op("AND").isOpuSymbolEqualTo("16101", true);

        minusValue(attribute, dataSource.getData(filter, attribute));
    end;

    macro calculateLine_104_2_1_dataSum2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = m_dataSources.getDataSource("CbDocument");
        var filter     = m_dataSouceFilters.getFilter("CbDocument");

        var year;
        dateSplit(f134Parameters.ДатаАудПодтв_ТекГ, NULL, NULL, year);

        //Сумма 1

        filter.setDateCary(date(0, 0, 0), f134Parameters.ДатаАудПодтв_ТекГ - 1).op("AND").isSatisfiesToBalanceMasks("70614*", true).op("AND").isSatisfiesToBalanceMasks("61601*", false).op("AND").isOpuSymbolEqualTo("25101", true);

        setValue(attribute, dataSource.getData(filter, attribute));

        //Сумма 2

        setValueAttributes(attribute,
                           RcbArray("Док_подтв_суммы_70614_ввод"),
                           RcbArray(),
                           true);

        //Сумма 3
        filter     = m_dataSouceFilters.getFilter("CbDocument");

        filter.setDateCary(date(0, 0, 0), f134Parameters.ДатаАудПодтв_ТекГ - 1).op("AND").isSatisfiesToBalanceMasks("61601*", true).op("AND").isSatisfiesToBalanceMasks("70614*", false).op("AND").isOpuSymbolEqualTo("25101", false);

        minusValue(attribute, dataSource.getData(filter, attribute));
    end;

    macro calculateLine_104_2_1_data(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);


        setValueAttributes(attribute,
                           RcbArray().initialize("Строка_104.2.1_данныеСумма1"),
                           RcbArray().initialize("Строка_104.2.1_данныеСумма2"),
                           true);

    end;

    macro calculateLine_104_2_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_104.2.1_ввод"),
                               RcbArray(),
                               true);
        else
            var sum = m_part.getAttribute("Строка_104").getValue();

            if (sum > 0)
                m_protocolView.PrintLine("Строка_104 (" + sum + ") > 0");

                sum = m_part.getAttribute("Строка_104.2.1_данные").getValue();

                m_protocolView.PrintLine("Значение переменной равно значению переменной Строка_104.2.1_данные (" + sum + ")");
                setValue(attribute, sum);
            else
                m_protocolView.PrintLine("Строка_104 (" + sum + ") <= 0");
                setValue(attribute, $0.0);
            end;
        end;

    end;

    macro calculateLine_104_2_2data(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (m_part.getAttribute("Строка_104.2.2_нереал_полож_данные").getValue() > 0)
            setValue(attribute, m_part.getAttribute("Строка_104.2.2_нереал_полож_данные").getValue());
        else
            setValue(attribute, m_part.getAttribute("Строка_104.2.2_нереал_отриц_данные").getValue());
        end;
    end;

    macro calculateLine_104_2_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            if (m_part.getAttribute("Строка_104.2.2_полож_ввод").getValue() > 0)
                setValue(attribute, m_part.getAttribute("Строка_104.2.2_полож_ввод").getValue());
            else
                if (m_part.getAttribute("Строка_104.2.2_отриц_ввод").getValue() > 0)
                    setValue(attribute, m_part.getAttribute("Строка_104.2.2_отриц_ввод").getValue());
                else
                    setValue(attribute, $0.0);
                end;
            end;
        else
            var sum = m_part.getAttribute("Строка_104").getValue();

            if (sum > 0)
                m_protocolView.PrintLine("Строка_104 (" + sum + ") > 0");

                sum = m_part.getAttribute("Строка_104.2.2_данные").getValue();

                m_protocolView.PrintLine("Значение переменной равно значению переменной Строка_104.2.2_данные (" + sum + ")");
                setValue(attribute, sum);
            else
                m_protocolView.PrintLine("Строка_104 (" + sum + ") <= 0");
                setValue(attribute, $0.0);
            end;
        end;
    end;

    macro calculateLine_104_2_2NotImplPositiveDataSum1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        printAttributeHead(attributeId);

        var dataSource = null;
        var filter     = null;

        dataSource = m_dataSources.getDataSource("CbAccount");
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70613");

        setValue(attribute, dataSource.getData(filter, attribute, null, f134Parameters.ДатаАудПодтв_ТекГ -1));

        //2
        setValueAttributes(attribute,
                           RcbArray().initialize("70613_нер_корр_ввод"),
                           RcbArray().initialize("Строка_104.2.1_данныеСумма1"),
                           true);

        //3
        dataSource = m_dataSources.getDataSource("CbAccount");
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70613").op("AND").isReportingCategoryExists("ПФИ: искл. из  10.2");

        minusValue(attribute, dataSource.getData(filter, attribute, null, f134Parameters.ДатаАудПодтв_ТекГ -1));
    end;

    macro calculateLine_104_2_2NotImplPositiveDataSum2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        printAttributeHead(attributeId);

        var dataSource = null;
        var filter     = null;

        //1

        dataSource = m_dataSources.getDataSource("CbAccount");
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70614");

        setValue(attribute, dataSource.getData(filter, attribute, null, f134Parameters.ДатаАудПодтв_ТекГ -1));

        //2
        setValueAttributes(attribute,
                           RcbArray().initialize("70614_нер_корр_ввод"),
                           RcbArray().initialize("Строка_104.2.1_данныеСумма2"),
                           true);
    end;

    macro calculateLine_104_2_2NotImplPositiveData(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("Строка_104.2.2_нереал_полож_данныеСумма1"),
                           RcbArray().initialize("Строка_104.2.2_нереал_полож_данныеСумма2"),
                           true);

        //Обработка полученного значения

        if (attribute.getValue() > 0)
            m_protocolView.PrintLine("Значение переменной равно " + attribute.getValue() + "/100*60");
            attribute.setValue(attribute.getValue()/100*60);
        else
            m_protocolView.PrintLine("Полученное значение переменной " + attribute.getValue() + " <= 0, полагаем равным 0");
            attribute.setValue($0.0);
        end;
    end;

    macro calculateLine_104_2_2NotImplPositive(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_104.2.2_полож_ввод"),
                               RcbArray(),
                               true);
        else
            var sum = m_part.getAttribute("Строка_104").getValue();

            if (sum > 0)
                m_protocolView.PrintLine("Строка_104 (" + sum + ") > 0");

                sum = m_part.getAttribute("Строка_104.2.2_нереал_полож_данные").getValue();

                m_protocolView.PrintLine("Значение переменной равно значению переменной Строка_104.2.2_нереал_полож_данные (" + sum + ")");
                setValue(attribute, sum);
            else
                m_protocolView.PrintLine("Строка_104 (" + sum + ") <= 0");
                setValue(attribute, $0.0);
            end;
        end;
    end;

    macro calculateLine_104_2_2NotImplNegativeData(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("Строка_104.2.2_нереал_полож_данныеСумма2"),
                           RcbArray().initialize("Строка_104.2.2_нереал_полож_данныеСумма1"),
                           true);

        //Обработка полученного значения

        if (attribute.getValue() > 0)
            attribute.setValue(attribute.getValue());
        else
            m_protocolView.PrintLine("Полученное значение переменной " + attribute.getValue() + " <= 0, полагаем равным 0");
            attribute.setValue($0.0);
        end;
    end;


    macro calculateLine_104_2_2NotImplNegative(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_104.2.2_отриц_ввод"),
                               RcbArray(),
                               true);
        else
            var sum = m_part.getAttribute("Строка_104").getValue();

            if (sum > 0)
                m_protocolView.PrintLine("Строка_104 (" + sum + ") > 0");

                sum = m_part.getAttribute("Строка_104.2.2_нереал_отриц_данные").getValue();

                m_protocolView.PrintLine("Значение переменной равно значению переменной Строка_104.2.2_нереал_отриц_данные (" + sum + ")");
                setValue(attribute, sum);
            else
                m_protocolView.PrintLine("Строка_104 (" + sum + ") <= 0");
                setValue(attribute, $0.0);
            end;
        end;
    end;

    macro calculateLinePriviousProfit(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = null;
        var filter     = null;

        dataSource = m_dataSources.getDataSource("CbAccount");
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        //1
        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("70701, 70703, 70704, 70705");

        setValue(attribute, dataSource.getData(filter, attribute));

        //2

        setValueAttributes(attribute,
                           RcbArray().initialize("10801_без_ПФИ", "70801_без_ПФИ", "Строка_106.1_пред_лет"),
                           RcbArray().initialize("10901_без_ПФИ", "70802_без_ПФИ"));

        //3
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70702").op("AND").isReportingCategoryExists("ТСС");

        plusValue(attribute, dataSource.getData(filter, attribute));

        //4
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70706, 70708, 70709, 70710, 70711, 70712");

        minusValue(attribute, dataSource.getData(filter, attribute));

        //5
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70707").op("AND").isReportingCategoryExists("ТСС");

        minusValue(attribute, dataSource.getData(filter, attribute));
    end;

    macro calculateLine10801withoutPFI_Sum1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = m_dataSources.getDataSource("CbAccountNote");
        var filter     = m_dataSouceFilters.getFilter("CbAccount");

        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10801").op("AND (").isExistAccountNote(PROFIT_WITHIOUT_PFI_NOTE_ID).op("OR").isReportingCategoryExists("Счет 10801: искл. из капитала").op(")");

        setValue(attribute, dataSource.getData(filter, attribute, PROFIT_WITHIOUT_PFI_NOTE_ID));
    end;

    macro calculateLine10801withoutPFI_Sum2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = m_dataSources.getDataSource("CbAccount");
        var filter     = m_dataSouceFilters.getFilter("CbAccount");

        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10801").op("AND").op("NOT").isExistAccountNote(PROFIT_WITHIOUT_PFI_NOTE_ID).op("AND").op("NOT").isReportingCategoryExists("Счет 10801: искл. из капитала");

        setValue(attribute, dataSource.getData(filter, attribute));
    end;

    macro calculateLine10801withoutPFI(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("10801_без_ПФИ_Сумма1", "10801_без_ПФИ_Сумма2"),
                           RcbArray());
    end;

    macro calculateLine10901withoutPFI_Sum1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = m_dataSources.getDataSource("CbAccountNote");
        var filter     = m_dataSouceFilters.getFilter("CbAccount");

        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10901");

        setValue(attribute, dataSource.getData(filter, attribute, PROFIT_WITHIOUT_PFI_NOTE_ID));
    end;

    macro calculateLine10901withoutPFI_Sum2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = m_dataSources.getDataSource("CbAccount");
        var filter     = m_dataSouceFilters.getFilter("CbAccount");

        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10901").op("AND").op("NOT").isExistAccountNote(PROFIT_WITHIOUT_PFI_NOTE_ID);

        setValue(attribute, dataSource.getData(filter, attribute));
    end;

    macro calculateLine10901withoutPFI(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("10901_без_ПФИ_Сумма1", "10901_без_ПФИ_Сумма2"),
                           RcbArray());
    end;

    macro calculateLine70801withoutPFI_Sum1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = m_dataSources.getDataSource("CbAccountNote");
        var filter     = m_dataSouceFilters.getFilter("CbAccount");

        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70801").op("AND").isExistAccountNote(PROFIT_WITHIOUT_PFI_NOTE_ID);

        setValue(attribute, dataSource.getData(filter, attribute, PROFIT_WITHIOUT_PFI_NOTE_ID));
    end;

    macro calculateLine70801withoutPFI_Sum2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = m_dataSources.getDataSource("CbAccount");
        var filter     = m_dataSouceFilters.getFilter("CbAccount");

        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70801").op("AND").op("NOT").isExistAccountNote(PROFIT_WITHIOUT_PFI_NOTE_ID);

        setValue(attribute, dataSource.getData(filter, attribute, NULL, NULL, PROFIT_WITHIOUT_PFI_NOTE_ID));
    end;

    macro calculateLine70801withoutPFI(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("70801_без_ПФИ_Сумма1", "70801_без_ПФИ_Сумма2"),
                           RcbArray());
    end;

    macro calculateLine70802withoutPFI_Sum1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = m_dataSources.getDataSource("CbAccountNote");
        var filter     = m_dataSouceFilters.getFilter("CbAccount");

        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70802");

        setValue(attribute, dataSource.getData(filter, attribute, PROFIT_WITHIOUT_PFI_NOTE_ID));
    end;

    macro calculateLine70802withoutPFI_Sum2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = m_dataSources.getDataSource("CbAccount");
        var filter     = m_dataSouceFilters.getFilter("CbAccount");

        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70802").op("AND").op("NOT").isExistAccountNote(PROFIT_WITHIOUT_PFI_NOTE_ID);

        setValue(attribute, dataSource.getData(filter, attribute));
    end;

    macro calculateLine70802withoutPFI(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("70802_без_ПФИ_Сумма1", "70802_без_ПФИ_Сумма2"),
                           RcbArray().initialize());
    end;

    macro calculateLinePriviousYearProfit(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = m_dataSources.getDataSource("CbAccount");
        var filter     = m_dataSouceFilters.getFilter("CbAccount");

        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70701, 70703, 70704, 70705");

        setValue(attribute, dataSource.getData(filter, attribute));

        //2
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70702").op("AND").isReportingCategoryExists("ТСС");

        plusValue(attribute, dataSource.getData(filter, attribute));

        //3
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70706, 70708, 70709, 70710, 70711, 70712");

        minusValue(attribute, dataSource.getData(filter, attribute));

        //4
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70707").op("AND").isReportingCategoryExists("ТСС");

        minusValue(attribute, dataSource.getData(filter, attribute));

        //5
        setValueAttributes(attribute,
                           RcbArray().initialize("70801_без_ПФИ", "Строка_106.1_прошл_года"),
                           RcbArray().initialize("70802_без_ПФИ"));
    end;

    macro calculateLine_106(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var sumEqprevYears = m_part.getAttribute("Прибыль_пред_лет").getValue();

        if (f134Parameters.ПрибыльПрошлогоГодаПодтверждена)
             m_protocolView.printLine("Прибыль прошлого года подтверждена.");

             if (sumEqprevYears > 0)
                setValueAttributes(attribute,
                                   RcbArray().initialize("Прибыль_пред_лет"),
                                   RcbArray());
             else
                setValueAttributes(attribute,
                                   RcbArray().initialize("Прибыль_прошл_года"),
                                   RcbArray(),
                                   true);
             end;
        else
            m_protocolView.printLine("Прибыль прошлого года не подтверждена.");
            if (f134Parameters.unconfirmedProfitPreviousYear == "2.1.11")
                var sumEq2_1_6prev = m_report.getPreviousReport().getPart("1").getAttribute("Строка_104").getValue();
                m_protocolView.printLine("Значение переменной равно min(Прибыль_пред_лет(" + sumEqprevYears + "), Строка_104 за предыдущий период(" + sumEq2_1_6prev + "))");
                setValue(attribute, min(sumEqprevYears, nvl(sumEq2_1_6prev, $0.0)));
                if (attribute.getValue() < 0)
                    m_protocolView.PrintLine(attribute.getId() + "(" + attribute.getValue() + ") < 0");
                    setValue(attribute, $0.0);
                end;
            else
                m_protocolView.printLine("Настройка реестра 'НЕПОДТВ. ПРИБЫЛЬ ПРЕДШЕСТВ. ЛЕТ' имеет значение '3.9'");
                m_protocolView.printLine("Значение переменной равно нулю.");
            end;
        end;
    end;

    macro calculateLine106_1PrevYears(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("Строка_106.1.1_пред_лет", "Строка_106.1.2_нереал_полож_пред_лет"),
                           RcbArray().initialize("Строка_106.1.2_нереал_отриц_пред_лет"),
                           true);
    end;

    macro calculateLine106_1PrevYear(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("Строка_106.1.1_прошл_года", "Строка_106.1.2_нереал_полож_прошл_года"),
                           RcbArray().initialize("Строка_106.1.2_нереал_отриц_прошл_года"),
                           true);
    end;

    macro calculateLine106_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_106.1.1_ввод", "Строка_106.1.2_полож_ввод"),
                               RcbArray().initialize("Строка_106.1.2_отриц_ввод"),
                               true);
        else

            if (f134Parameters.ПрибыльПрошлогоГодаПодтверждена)
                m_protocolView.printLine("Прибыль прошлого года подтверждена.");

                if (m_part.getAttribute("Прибыль_пред_лет").getValue() > 0)
                   setValueAttributes(attribute,
                                      RcbArray().initialize("Строка_106.1_пред_лет"),
                                      RcbArray());
                else
                   setValueAttributes(attribute,
                                      RcbArray().initialize("Строка_106.1_прошл_года"),
                                      RcbArray(),
                                      true);
                end;
            else
                m_protocolView.printLine("Прибыль прошлого года не подтверждена.");
                if (f134Parameters.unconfirmedProfitPreviousYear == "2.1.11")
                    var sumEq104_2prev = m_report.getPreviousReport().getPart("1").getAttribute("Строка_104.2").getValue();
                    var sumEq_106_1prevYars = m_part.getAttribute("Строка_106.1_пред_лет").getValue();

                    m_protocolView.printLine("Значение переменной равно min(Строка_106.1_пред_лет(" + sumEq_106_1prevYars + "), Строка_104.2 за предыдущий период(" + sumEq104_2prev + "))");
                    setValue(attribute, min(sumEq_106_1prevYars, nvl(sumEq104_2prev, $0.0)));

                    if (attribute.getValue() < 0)
                        m_protocolView.PrintLine(attribute.getId() + "(" + attribute.getValue() + ") < 0");
                        setValue(attribute, $0.0);
                    end;
                else
                    m_protocolView.printLine("Настройка реестра 'НЕПОДТВ. ПРИБЫЛЬ ПРЕДШЕСТВ. ЛЕТ' имеет значение '3.9'");
                    m_protocolView.printLine("Значение переменной равно нулю.");
                end;
            end;
        end;
    end;

    macro calculateLine_106_1_1PrevYears_Sum1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = m_dataSources.getDataSource("CbAccountNote");
        var filter     = m_dataSouceFilters.getFilter("CbAccount");

        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10801");

        setValue(attribute, dataSource.getData(filter, attribute, PFI_IMPL_NOTE_ID));
    end;

    macro calculateLine_106_1_1PrevYears_Sum2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = m_dataSources.getDataSource("CbAccountNote");
        var filter     = m_dataSouceFilters.getFilter("CbAccount");

        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10901");

        setValue(attribute, dataSource.getData(filter, attribute, PFI_IMPL_NOTE_ID));
    end;

    macro calculateLine_106_1_1PrevYears(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (global.getRcbReport().context.period.endDate < getCostTransferDate())
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_106.1.1_прошл_года", "Строка_106.1.1_пред_лет_Сумма1"),
                               RcbArray().initialize("Строка_106.1.1_пред_лет_Сумма2"));
        else
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_106.1.1_пред_лет_Сумма1"),
                               RcbArray().initialize("Строка_106.1.1_пред_лет_Сумма2"));
        end;

    end;

    macro calculateLine_106_1_1PrevYear_Sum1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        //Сумма 1
        var dataSource = m_dataSources.getDataSource("CbDocument");
        var filter     = m_dataSouceFilters.getFilter("CbDocument");

        filter.setDateCary(date(1, 1, getYear(global.getRcbReport().context.period.endDate)-1), date(31, 1, getYear(global.getRcbReport().context.period.endDate)-1));
        filter.op("AND").isSatisfiesToBalanceMasks("61601*", true).op("AND").isSatisfiesToBalanceMasks("70613*", false).op("AND").isOpuSymbolEqualTo("16101", false);

        setValue(attribute, dataSource.getData(filter, attribute));

        //Сумма 2
        filter     = m_dataSouceFilters.getFilter("CbDocument");

        filter.setDateCary(date(1, 1, getYear(global.getRcbReport().context.period.endDate)-1), date(31, 1, getYear(global.getRcbReport().context.period.endDate)-1));
        filter.op("AND").isSatisfiesToBalanceMasks("70613*", true).op("AND").isSatisfiesToBalanceMasks("61601*", false).op("AND").isOpuSymbolEqualTo("16101", true);

        minusValue(attribute, dataSource.getData(filter, attribute));

        //Сумма 3
        filter     = m_dataSouceFilters.getFilter("CbDocument");

        filter.setDateCary(date(1, 1, getYear(global.getRcbReport().context.period.endDate)), getSpodEndDate());
        filter.op("AND").isSatisfiesToBalanceMasks("61601*", true).op("AND").isSatisfiesToBalanceMasks("70713*", false).op("AND").isOpuSymbolEqualTo("16101", false).op("AND").isSpod();

        plusValue(attribute, dataSource.getData(filter, attribute));

        //Сумма 4
        filter     = m_dataSouceFilters.getFilter("CbDocument");

        filter.setDateCary(date(1, 1, getYear(global.getRcbReport().context.period.endDate)), getSpodEndDate());
        filter.op("AND").isSatisfiesToBalanceMasks("61601*", true).op("AND").isSatisfiesToBalanceMasks("70613*", false).op("AND").isOpuSymbolEqualTo("16101", false);

        minusValue(attribute, dataSource.getData(filter, attribute));

        //Сумма 5
        setValueAttributes(attribute,
                           RcbArray().initialize("Док_подтв_суммы_доход_ПрошлГ_ввод"),
                           RcbArray());
    end;

    macro calculateLine_106_1_1PrevYear_Sum2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        //Сумма 1
        var dataSource = m_dataSources.getDataSource("CbDocument");
        var filter     = m_dataSouceFilters.getFilter("CbDocument");

        filter.setDateCary(date(1, 1, getYear(global.getRcbReport().context.period.endDate)-1), date(31, 1, getYear(global.getRcbReport().context.period.endDate)-1));
        filter.op("AND").isSatisfiesToBalanceMasks("70614*", true).op("AND").isSatisfiesToBalanceMasks("61601*", false).op("AND").isOpuSymbolEqualTo("25101", true);

        setValue(attribute, dataSource.getData(filter, attribute));

        //Сумма 2
        filter     = m_dataSouceFilters.getFilter("CbDocument");

        filter.setDateCary(date(1, 1, getYear(global.getRcbReport().context.period.endDate)-1), date(31, 1, getYear(global.getRcbReport().context.period.endDate)-1));
        filter.op("AND").isSatisfiesToBalanceMasks("61601*", true).op("AND").isSatisfiesToBalanceMasks("70614*", false).op("AND").isOpuSymbolEqualTo("25101", false);

        minusValue(attribute, dataSource.getData(filter, attribute));

        //Сумма 3
        filter     = m_dataSouceFilters.getFilter("CbDocument");

        filter.setDateCary(date(1, 1, getYear(global.getRcbReport().context.period.endDate)), getSpodEndDate());
        filter.op("AND").isSatisfiesToBalanceMasks("70714*", true).op("AND").isSatisfiesToBalanceMasks("61601*", false).op("AND").isOpuSymbolEqualTo("25101", true).op("AND").isSpod();

        plusValue(attribute, dataSource.getData(filter, attribute));

        //Сумма 4
        filter     = m_dataSouceFilters.getFilter("CbDocument");

        filter.setDateCary(date(1, 1, getYear(global.getRcbReport().context.period.endDate)), getSpodEndDate());
        filter.op("AND").isSatisfiesToBalanceMasks("61601*", true).op("AND").isSatisfiesToBalanceMasks("70714*", false).op("AND").isOpuSymbolEqualTo("25101", false);

        minusValue(attribute, dataSource.getData(filter, attribute));

        //Сумма 5
        setValueAttributes(attribute,
                           RcbArray().initialize("Док_подтв_суммы_расход_ПрошлГ_ввод"),
                           RcbArray());
    end;

    macro calculateLine_106_1_1PrevYear(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("Строка_106.1.1_прошл_года_Сумма1"),
                           RcbArray().initialize("Строка_106.1.1_прошл_года_Сумма2"));

    end;


    macro calculateLine_106_1_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_106.1.1_ввод"),
                               RcbArray(),
                               true);
        else

            if (f134Parameters.ПрибыльПрошлогоГодаПодтверждена)
                m_protocolView.printLine("Прибыль прошлого года подтверждена.");

                if (m_part.getAttribute("Прибыль_пред_лет").getValue() > 0)
                   setValueAttributes(attribute,
                                      RcbArray().initialize("Строка_106.1.1_пред_лет"),
                                      RcbArray());
                else
                   setValueAttributes(attribute,
                                      RcbArray().initialize("Строка_106.1.1_прошл_года"),
                                      RcbArray(),
                                      true);
                end;
            else
                m_protocolView.printLine("Прибыль прошлого года не подтверждена.");
                if (f134Parameters.unconfirmedProfitPreviousYear == "2.1.11")
                    var sumEq104_2_1prev = m_report.getPreviousReport().getPart("1").getAttribute("Строка_104.2.1").getValue();
                    var sumEq_106_1_1prevYars = m_part.getAttribute("Строка_106.1.1_пред_лет").getValue();

                    m_protocolView.printLine("Значение переменной равно min(Строка_106.1.1_пред_лет(" + sumEq_106_1_1prevYars + "), Строка_104.2.1 за предыдущий период(" + sumEq104_2_1prev + "))");
                    setValue(attribute, min(sumEq_106_1_1prevYars, nvl(sumEq104_2_1prev, $0.0)));

                    if (attribute.getValue() < 0)
                        m_protocolView.PrintLine(attribute.getId() + "(" + attribute.getValue() + ") < 0");
                        setValue(attribute, $0.0);
                    end;
                else
                    m_protocolView.printLine("Настройка реестра 'НЕПОДТВ. ПРИБЫЛЬ ПРЕДШЕСТВ. ЛЕТ' имеет значение '3.9'");
                    m_protocolView.printLine("Значение переменной равно нулю.");
                end;
            end;
        end;
    end;

    macro calculateLine_106_1_2prevYears(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (m_part.getAttribute("Строка_106.1.2_нереал_полож_пред_лет").getValue() > 0)
           setValueAttributes(attribute,
                              RcbArray().initialize("Строка_106.1.2_нереал_полож_пред_лет"),
                              RcbArray());
        else
           setValueAttributes(attribute,
                              RcbArray().initialize("Строка_106.1.2_нереал_отриц_пред_лет"),
                              RcbArray());
        end;
    end;

    macro calculateLine_106_1_2prevYear(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (m_part.getAttribute("Строка_106.1.2_нереал_полож_прошл_года").getValue() > 0)
           setValueAttributes(attribute,
                              RcbArray().initialize("Строка_106.1.2_нереал_полож_прошл_года"),
                              RcbArray());
        else
           setValueAttributes(attribute,
                              RcbArray().initialize("Строка_106.1.2_нереал_отриц_прошл_года"),
                              RcbArray());
        end;
    end;

    macro calculateLine_106_1_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            if (m_part.getAttribute("Строка_106.1.2_полож_ввод").getValue() > 0)
               setValueAttributes(attribute,
                                  RcbArray().initialize("Строка_106.1.2_полож_ввод"),
                                  RcbArray());
            else
               setValueAttributes(attribute,
                                  RcbArray().initialize("Строка_106.1.2_отриц_ввод"),
                                  RcbArray());
            end;
        else

            if (f134Parameters.ПрибыльПрошлогоГодаПодтверждена)
                m_protocolView.printLine("Прибыль прошлого года подтверждена.");

                if (m_part.getAttribute("Прибыль_пред_лет").getValue() >= 0)
                   setValueAttributes(attribute,
                                      RcbArray().initialize("Строка_106.1.2_пред_лет"),
                                      RcbArray());
                else
                   setValueAttributes(attribute,
                                      RcbArray().initialize("Строка_106.1.2_прошл_года"),
                                      RcbArray(),
                                      true);
                end;
            else
                m_protocolView.printLine("Прибыль прошлого года не подтверждена.");
                if (f134Parameters.unconfirmedProfitPreviousYear == "2.1.11")
                    var sumEq104_2_2prev = m_report.getPreviousReport().getPart("1").getAttribute("Строка_104.2.2").getValue();
                    var sumEq_106_1_2prevYars = m_part.getAttribute("Строка_106.1.2_пред_лет").getValue();

                    m_protocolView.printLine("Значение переменной равно min(Строка_106.1.2_пред_лет(" + sumEq_106_1_2prevYars + "), Строка_104.2.2 за предыдущий период(" + sumEq104_2_2prev + "))");
                    setValue(attribute, min(sumEq_106_1_2prevYars, nvl(sumEq104_2_2prev, $0.0)));

                    if (attribute.getValue() < 0)
                        m_protocolView.PrintLine(attribute.getId() + "(" + attribute.getValue() + ") < 0");
                        setValue(attribute, $0.0);
                    end;
                else
                    m_protocolView.printLine("Настройка реестра 'НЕПОДТВ. ПРИБЫЛЬ ПРЕДШЕСТВ. ЛЕТ' имеет значение '3.9'");
                    m_protocolView.printLine("Значение переменной равно нулю.");
                end;
            end;
        end;
    end;

    macro calculateLine_106_1_2NotImplPrevYears_Sum1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = m_dataSources.getDataSource("CbAccountNote");
        var filter     = m_dataSouceFilters.getFilter("CbAccount");

        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10801");

        setValue(attribute, dataSource.getData(filter, attribute, PROFIT_NOT_IMPL_NOTE_ID));
    end;

    macro calculateLine_106_1_2NotImplPrevYears_Sum2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = m_dataSources.getDataSource("CbAccountNote");
        var filter     = m_dataSouceFilters.getFilter("CbAccount");

        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10901");

        setValue(attribute, dataSource.getData(filter, attribute, PROFIT_NOT_IMPL_NOTE_ID));
    end;

    macro calculateLine_106_1_2NotImplPrevYears(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_106.1.2_полож_ввод"),
                               RcbArray());
        else

            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_106.1.2_нереал_полож_пред_лет_Сумма1", "Строка_106.1.2_нереал_полож_прошл_года"),
                               RcbArray().initialize("Строка_106.1.2_нереал_полож_пред_лет_Сумма2"));


            if (attribute.getValue() > 0)
                m_protocolView.PrintLine("Значение переменной равно " + attribute.getValue() + "/100*60");
                attribute.setValue(attribute.getValue()/100*60);
            else
                m_protocolView.PrintLine("Полученное значение переменной " + attribute.getValue() + " <= 0, полагаем равным 0");
                attribute.setValue($0.0);
            end;
        end;
    end;

    macro calculateLine_106_1_2NotImplPrevYear_Sum1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        //1
        var dataSource = m_dataSources.getDataSource("CbDocument");
        var filter     = m_dataSouceFilters.getFilter("CbDocument");

        filter.setDateCary(date(1, 1, getYear(global.getRcbReport().context.period.endDate)), getSpodEndDate());
        filter.op("AND").isSatisfiesToBalanceMasks("70713*", true).op("AND").isSatisfiesToBalanceMasks("70801*", false);

        setValue(attribute, dataSource.getData(filter, attribute));

        //2
        filter     = m_dataSouceFilters.getFilter("CbDocument");

        filter.setDateCary(date(1, 1, getYear(global.getRcbReport().context.period.endDate)), getSpodEndDate());
        filter.op("AND").isSatisfiesToBalanceMasks("70801*", true).op("AND").isSatisfiesToBalanceMasks("70713*", false);

        minusValue(attribute, dataSource.getData(filter, attribute));

        //3
        dataSource = m_dataSources.getDataSource("CbAccount");
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70713").op("AND").isReportingCategoryExists("ПФИ: искл. из  10.2");

        minusValue(attribute, dataSource.getData(filter, attribute));

        //4
        setValueAttributes(attribute,
                           RcbArray().initialize("70713_нер_корр_ввод"),
                           RcbArray().initialize("Строка_106.1.1_прошл_года_Сумма1"));

    end;

    macro calculateLine_106_1_2NotImplPrevYear_Sum2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        //1
        var dataSource = m_dataSources.getDataSource("CbDocument");
        var filter     = m_dataSouceFilters.getFilter("CbDocument");

        filter.setDateCary(date(1, 1, getYear(global.getRcbReport().context.period.endDate)), getSpodEndDate());
        filter.op("AND").isSatisfiesToBalanceMasks("70802*", true).op("AND").isSatisfiesToBalanceMasks("70714*", false);

        setValue(attribute, dataSource.getData(filter, attribute));

        //2
        filter     = m_dataSouceFilters.getFilter("CbDocument");

        filter.setDateCary(date(1, 1, getYear(global.getRcbReport().context.period.endDate)), getSpodEndDate());
        filter.op("AND").isSatisfiesToBalanceMasks("70714*", true).op("AND").isSatisfiesToBalanceMasks("70802*", false);

        minusValue(attribute, dataSource.getData(filter, attribute));

        //3
        setValueAttributes(attribute,
                           RcbArray().initialize("70614_нер_корр_ввод"),
                           RcbArray().initialize("Строка_106.1.1_прошл_года_Сумма2"));

    end;

    macro calculateLine_106_1_2NotImplPrevYear(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_106.1.2_полож_ввод"),
                               RcbArray());
        else

            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_106.1.2_нереал_полож_прошл_года_Сумма1"),
                               RcbArray().initialize("Строка_106.1.2_нереал_полож_прошл_года_Сумма2"));


            if (attribute.getValue() > 0)
                m_protocolView.PrintLine("Значение переменной равно " + attribute.getValue() + "/100*60");
                attribute.setValue(attribute.getValue()/100*60);
            else
                m_protocolView.PrintLine("Полученное значение переменной " + attribute.getValue() + " <= 0, полагаем равным 0");
                attribute.setValue($0.0);
            end;
        end;
    end;

    macro calculateLine_106_1_2NotImplPositive(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.ПрибыльПрошлогоГодаПодтверждена)
             m_protocolView.printLine("Прибыль прошлого года подтверждена.");

             if (m_part.getAttribute("Прибыль_пред_лет").getValue() > 0)
                setValueAttributes(attribute,
                                   RcbArray().initialize("Строка_106.1.2_нереал_полож_пред_лет"),
                                   RcbArray());
             else
                setValueAttributes(attribute,
                                   RcbArray().initialize("Строка_106.1.2_нереал_полож_прошл_года"),
                                   RcbArray(),
                                   true);
             end;
        else
            m_protocolView.printLine("Прибыль прошлого года не подтверждена.");
            if (f134Parameters.unconfirmedProfitPreviousYear == "2.1.11")
                var sumA = m_part.getAttribute("Строка_106.1.2_нереал_полож_пред_лет").getValue();
                var sumB = m_report.getPreviousReport().getPart("1").getAttribute("Строка_104.2.2_нереал_полож").getValue();
                m_protocolView.printLine("Значение переменной равно min(Строка_106.1.2_нереал_полож_пред_лет(" + sumA + "), Строка_104.2.2_нереал_полож за предыдущий период(" + sumB + "))");
                setValue(attribute, min(sumA, nvl(sumB, $0.0)));
                if (attribute.getValue() < 0)
                    m_protocolView.PrintLine(attribute.getId() + "(" + attribute.getValue() + ") < 0");
                    setValue(attribute, $0.0);
                end;
            else
                m_protocolView.printLine("Настройка реестра 'НЕПОДТВ. ПРИБЫЛЬ ПРЕДШЕСТВ. ЛЕТ' имеет значение '3.9'");
                m_protocolView.printLine("Значение переменной равно нулю.");
            end;
        end;
    end;


    macro calculateLine_106_1_2NotImplNegativePrevYears(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_106.1.2_отриц_ввод"),
                               RcbArray());
        else

            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_106.1.2_нереал_полож_пред_лет_Сумма2", "Строка_106.1.2_нереал_отриц_прошл_года"),
                               RcbArray().initialize("Строка_106.1.2_нереал_полож_пред_лет_Сумма1"));

            var atributeSum1 = m_part.getAttribute("Строка_106.1.2_нереал_полож_пред_лет_Сумма1");
            var atributeSum2 = m_part.getAttribute("Строка_106.1.2_нереал_полож_пред_лет_Сумма2");

            if (attribute.getValue() > 0)
                m_protocolView.PrintLine("Полученное значение " + attribute.getValue() + " > 0");
                m_protocolView.PrintLine(attribute.getId() + " = " + atributeSum2.getId() + "(" + atributeSum2.getValue() + ") - " + atributeSum1.getId() + "(" + atributeSum1.getValue() + ")");
                attribute.setValue(atributeSum2.getValue() - atributeSum1.getValue());
            else
                m_protocolView.PrintLine("Полученное значение переменной " + attribute.getValue() + " <= 0, полагаем равным 0");
                attribute.setValue($0.0);
            end;
        end;
    end;

    macro calculateLine_106_1_2NotImplNegativePrevYear(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_106.1.2_отриц_ввод"),
                               RcbArray());
        else

            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_106.1.2_нереал_полож_прошл_года_Сумма2"),
                               RcbArray().initialize("Строка_106.1.2_нереал_полож_прошл_года_Сумма1"));

            if (attribute.getValue() <= 0)
                m_protocolView.PrintLine("Полученное значение переменной " + attribute.getValue() + " <= 0, полагаем равным 0");
                attribute.setValue($0.0);
            end;
        end;
    end;


    macro calculateLine_106_1_2NotImplNegative(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.ПрибыльПрошлогоГодаПодтверждена)
             m_protocolView.printLine("Прибыль прошлого года подтверждена.");

             if (m_part.getAttribute("Прибыль_пред_лет").getValue() > 0)
                setValueAttributes(attribute,
                                   RcbArray().initialize("Строка_106.1.2_нереал_отриц_пред_лет"),
                                   RcbArray());
             else
                setValueAttributes(attribute,
                                   RcbArray().initialize("Строка_106.1.2_нереал_отриц_прошл_года"),
                                   RcbArray(),
                                   true);
             end;
        else
            m_protocolView.printLine("Прибыль прошлого года не подтверждена.");
            if (f134Parameters.unconfirmedProfitPreviousYear == "2.1.11")
                var sumA = m_part.getAttribute("Строка_106.1.2_нереал_отриц_пред_лет").getValue();
                var sumB = m_report.getPreviousReport().getPart("1").getAttribute("Строка_104.2.2_нереал_отриц").getValue();
                m_protocolView.printLine("Значение переменной равно min(Строка_106.1.2_нереал_отриц_пред_лет(" + sumA + "), Строка_104.2.2_нереал_отриц за предыдущий период(" + sumB + "))");
                setValue(attribute, min(sumA, nvl(sumB, $0.0)));
                if (attribute.getValue() < 0)
                    m_protocolView.PrintLine(attribute.getId() + "(" + attribute.getValue() + ") < 0");
                    setValue(attribute, $0.0);
                end;
            else
                m_protocolView.printLine("Настройка реестра 'НЕПОДТВ. ПРИБЫЛЬ ПРЕДШЕСТВ. ЛЕТ' имеет значение '3.9'");
                m_protocolView.printLine("Значение переменной равно нулю.");
            end;
        end;
    end;

    macro calculateLine_107data(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = null;
        var filter     = null;

        dataSource = m_dataSources.getDataSource("CbAccountSubCredit");
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("31309, 31409, 31509, 31609, 41107, 41207, 41307, 41407, 41507, 41607, 41707, 41807, 41907, 42007, 42107, 42207, 42507, 42807, 42907, 43007, 43107, 43207, 43307, 43407, 43507, 43607, 43707, 43807, 43907, 44007, 52006");
        filter.op("AND").isReportingCategoryExists("Субкредит 2.1.12");

        setValue(attribute, dataSource.getData(filter, attribute));
    end;


    macro calculateLine_107(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);


        setValueAttributes(attribute,
                           RcbArray().initialize("Строка_101","Строка_102","Строка_103","Строка_104","Строка_105","Строка_106"),
                           RcbArray().initialize("Строка_109","Строка_110","Строка_111","Строка_112","Строка_113","Строка_114","Строка_115"));

        var attributeEq2_1_12data = m_part.getAttribute("Строка_107_данные");

        m_protocolView.PrintLine("Значение переменной равно min(0.15*" + attribute.getValue() + ", " + attributeEq2_1_12data.getId() + "(" + attributeEq2_1_12data.getValue() + "))");

        if ((attribute.getValue() * 0.15) > 0)
            attribute.setValue(min(0.15 * attribute.getValue(), attributeEq2_1_12data.getValue()));
        else
            attribute.setValue(0.0);
        end;

        m_protocolView.PrintLine(attribute.getId() + " = " + attribute.getValue());
    end;

    macro calculateLineMainReal(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);


        setValueAttributes(attribute,
                           RcbArray().initialize("Строка_101","Строка_102","Строка_103","Строка_104","Строка_105","Строка_106", "Строка_107"),
                           RcbArray());
    end;


    macro calculateLine_109(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = null;
        var filter     = null;

        //1
        dataSource = m_dataSources.getDataSource("CbAccount");
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("60901, 60905");

        setValue(attribute, dataSource.getData(filter, attribute));

        //2
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("60701").op("AND").isReportingCategoryExists("НМА");

        plusValue(attribute, dataSource.getData(filter, attribute));

        //3
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("60903");

        minusValue(attribute, dataSource.getData(filter, attribute));
    end;

    macro calculateLine_110(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = null;
        var filter     = null;

        dataSource = m_dataSources.getDataSource("CbAccount");
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("10501");

        setValue(attribute, dataSource.getData(filter, attribute));

        if (nvl(attribute.getValue(), $0.0) != $0.0)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_110_ввод"),
                               RcbArray());
        else
            m_protocolView.PrintLine("Остаток на счете 10501 равен нулю, проверяем счет 10502");

            dataSource = m_dataSources.getDataSource("CbAccountNote");
            filter     = m_dataSouceFilters.getFilter("CbAccount");

            filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10502");

            setValue(attribute, dataSource.getData(filter, attribute, NOTEKIND_BOUGHT_OUT_COST));

            if (nvl(attribute.getValue(), $0.0) == $0.0)
                m_protocolView.PrintLine("Значение примечания \"Стоимость выкупленных долей\" на счете 10501 равно нулю, проверяем остатки.");
                dataSource = m_dataSources.getDataSource("CbAccount");

                setValue(attribute, dataSource.getData(filter, attribute));
            end;
        end;
    end;

    macro calculateLine_111(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (m_part.getAttribute("Прибыль_пред_лет").getValue() <= 0)
            m_protocolView.PrintLine("Прибыль_пред_лет <= 0");
            if (m_part.getAttribute("Прибыль_прошл_года").getValue() >= 0)
                m_protocolView.PrintLine("Прибыль_прошл_года >= 0");
                setValueAttributes(attribute,
                                   RcbArray().initialize("Прибыль_прошл_года"),
                                   RcbArray().initialize("Прибыль_пред_лет"));
            else
                m_protocolView.PrintLine("Прибыль_прошл_года < 0");
                setValueAttributes(attribute,
                                   RcbArray(),
                                   RcbArray().initialize("Прибыль_пред_лет"));
            end;

        else
            m_protocolView.PrintLine("Прибыль_пред_лет > 0");
            setValue(attribute, $0.0);
        end;
    end;

    macro calculateLine_111_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_111.1.1_ввод", "Строка_111.1.2_отриц_ввод"),
                               RcbArray().initialize("Строка_111.1.2_полож_ввод"),
                               true);
        else
            if (m_part.getAttribute("Прибыль_пред_лет").getValue() <= 0)
                m_protocolView.PrintLine("Прибыль_пред_лет <= 0");
                if (m_part.getAttribute("Прибыль_прошл_года").getValue() >= 0)
                    m_protocolView.PrintLine("Прибыль_прошл_года >= 0");
                    setValueAttributes(attribute,
                                       RcbArray().initialize("Строка_106.1_прошл_года"),
                                       RcbArray().initialize("Строка_106.1_пред_лет"));
                else
                    m_protocolView.PrintLine("Прибыль_прошл_года < 0");
                    setValueAttributes(attribute,
                                       RcbArray(),
                                       RcbArray().initialize("Строка_106.1_пред_лет"));
                end;

            else
                m_protocolView.PrintLine("Прибыль_пред_лет > 0");
                setValue(attribute, $0.0);
            end;
        end;
    end;

    macro calculateLine_111_1_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_111.1.1_ввод"),
                               RcbArray(),
                               true);
        else
            if (m_part.getAttribute("Прибыль_пред_лет").getValue() <= 0)
                m_protocolView.PrintLine("Прибыль_пред_лет <= 0");
                if (m_part.getAttribute("Прибыль_прошл_года").getValue() >= 0)
                    m_protocolView.PrintLine("Прибыль_прошл_года >= 0");
                    setValueAttributes(attribute,
                                       RcbArray().initialize("Строка_106.1.1_прошл_года"),
                                       RcbArray().initialize("Строка_106.1.1_пред_лет"));
                else
                    m_protocolView.PrintLine("Прибыль_прошл_года < 0");
                    setValueAttributes(attribute,
                                       RcbArray(),
                                       RcbArray().initialize("Строка_106.1.1_пред_лет"));
                end;

            else
                m_protocolView.PrintLine("Прибыль_пред_лет > 0");
                setValue(attribute, $0.0);
            end;
        end;
    end;

    macro calculateLine_111_1_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            if (m_part.getAttribute("Строка_111.1.2_полож_ввод").getValue() > 0)
                m_protocolView.PrintLine("Строка_111.1.2_полож_ввод > 0");
                setValueAttributes(attribute,
                                   RcbArray().initialize("Строка_111.1.2_полож_ввод"),
                                   RcbArray());
            else
                m_protocolView.PrintLine("Строка_111.1.2_полож_ввод <= 0");
                setValueAttributes(attribute,
                                   RcbArray().initialize("Строка_111.1.2_отриц_ввод"),
                                   RcbArray());

            end;
        else

            if (m_part.getAttribute("Прибыль_пред_лет").getValue() <= 0)
                m_protocolView.PrintLine("Прибыль_пред_лет <= 0");
                if (m_part.getAttribute("Прибыль_прошл_года").getValue() >= 0)
                    m_protocolView.PrintLine("Прибыль_прошл_года >= 0");
                    setValueAttributes(attribute,
                                       RcbArray().initialize("Строка_106.1.2_прошл_года"),
                                       RcbArray().initialize("Строка_106.1.2_пред_лет"));
                else
                    m_protocolView.PrintLine("Прибыль_прошл_года < 0");
                    setValueAttributes(attribute,
                                       RcbArray(),
                                       RcbArray().initialize("Строка_106.1.2_пред_лет"));
                end;

            else
                m_protocolView.PrintLine("Прибыль_пред_лет > 0");
                setValue(attribute, $0.0);
            end;
        end;

    end;

    macro calculateLine_111_1_2NotImplPositive(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_111.1.2_полож_ввод"),
                               RcbArray(),
                               true);
        else
            if (m_part.getAttribute("Прибыль_пред_лет").getValue() <= 0)
                m_protocolView.PrintLine("Прибыль_пред_лет <= 0");
                if (m_part.getAttribute("Прибыль_прошл_года").getValue() >= 0)
                    m_protocolView.PrintLine("Прибыль_прошл_года >= 0");
                    setValueAttributes(attribute,
                                       RcbArray().initialize("Строка_106.1.2_нереал_полож_прошл_года"),
                                       RcbArray().initialize("Строка_106.1.2_нереал_полож_пред_лет"));
                else
                    m_protocolView.PrintLine("Прибыль_прошл_года < 0");
                    setValueAttributes(attribute,
                                       RcbArray(),
                                       RcbArray().initialize("Строка_106.1.2_нереал_полож_пред_лет"));
                end;

            else
                m_protocolView.PrintLine("Прибыль_пред_лет > 0");
                setValue(attribute, $0.0);
            end;
        end;
    end;

    macro calculateLine_111_1_2NotImplNegative(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_111.1.2_отриц_ввод"),
                               RcbArray(),
                               true);
        else
            if (m_part.getAttribute("Прибыль_пред_лет").getValue() <= 0)
                m_protocolView.PrintLine("Прибыль_пред_лет <= 0");
                if (m_part.getAttribute("Прибыль_прошл_года").getValue() >= 0)
                    m_protocolView.PrintLine("Прибыль_прошл_года >= 0");
                    setValueAttributes(attribute,
                                       RcbArray().initialize("Строка_106.1.2_нереал_отриц_прошл_года"),
                                       RcbArray().initialize("Строка_106.1.2_нереал_отриц_пред_лет"));
                else
                    m_protocolView.PrintLine("Прибыль_прошл_года < 0");
                    setValueAttributes(attribute,
                                       RcbArray(),
                                       RcbArray().initialize("Строка_106.1.2_нереал_отриц_пред_лет"));
                end;

            else
                m_protocolView.PrintLine("Прибыль_пред_лет > 0");
                setValue(attribute, $0.0);
            end;
        end;
    end;


    macro calculateLine_112_data(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = m_dataSources.getDataSource("CbAccount");
        var filter     = m_dataSouceFilters.getFilter("CbAccount");
        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70606, 70608, 70609, 70610, 70611, 70612, 50905, 61401, 61403");

        setValue(attribute, dataSource.getData(filter, attribute));

        //2
        filter     = m_dataSouceFilters.getFilter("CbAccount");
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10605, 70607").op("AND").isReportingCategoryExists("ТСС");

        plusValue(attribute, dataSource.getData(filter, attribute));

        //3
        filter     = m_dataSouceFilters.getFilter("CbAccount");
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70601, 70603, 70604, 70605, 61301, 61304");

        minusValue(attribute, dataSource.getData(filter, attribute));

        //4
        filter     = m_dataSouceFilters.getFilter("CbAccount");
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10603, 70602").op("AND").isReportingCategoryExists("ТСС");

        minusValue(attribute, dataSource.getData(filter, attribute));

        //5
        setValueAttributes(attribute,
                           RcbArray().initialize("Строка_112.2_данные"),
                           RcbArray());

        //6
        if (not isLastDayInMonth(m_report.getPeriod().endDate))
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_112_52303_ввод"),
                               RcbArray());
        end;
    end;

    macro calculateLine_112(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("Строка_112_данные", "Строка_104"),
                           RcbArray());

        if (attribute.getValue() < 0)
            m_protocolView.PrintLine("Полученное значение переменной " + attribute.getValue() + " < 0, полагаем равным 0");
            attribute.setValue($0.0);
        end;
    end;

    macro calculateLine_112_2data(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("Строка_112.2.1_данные", "Строка_112.2.2_нереал_отриц_данные"),
                           RcbArray().initialize("Строка_112.2.2_нереал_полож_данные"),
                           true);
    end;

    macro calculateLine_112_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_112.2.1_ввод", "Строка_112.2.2_отриц_ввод"),
                               RcbArray().initialize("Строка_112.2.2_полож_ввод"),
                               true);
        else
            if (m_part.getAttribute("Строка_112").getValue() > 0)
                m_protocolView.PrintLine("Строка_112 > 0");
                setValueAttributes(attribute,
                                   RcbArray().initialize("Строка_112.2_данные"),
                                   RcbArray());
            else
                m_protocolView.PrintLine("Строка_112 <= 0");
                setValue(attribute, $0.0);
            end;
        end;
    end;

    macro calculateLine_112_2_1dataSum1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        //1
        var dataSource = m_dataSources.getDataSource("CbDocument");
        var filter     = m_dataSouceFilters.getFilter("CbDocument");

        filter.setDateCary(date(1, 1, getYear(global.getRcbReport().context.period.endDate)), global.getRcbReport().context.period.endDate);
        filter.op("AND").isSatisfiesToBalanceMasks("70614*", true).op("AND").isSatisfiesToBalanceMasks("61601*", false).op("AND").isOpuSymbolEqualTo("25101", true);

        setValue(attribute, dataSource.getData(filter, attribute));

        //2
        filter     = m_dataSouceFilters.getFilter("CbDocument");

        filter.setDateCary(date(1, 1, getYear(global.getRcbReport().context.period.endDate)), global.getRcbReport().context.period.endDate);
        filter.op("AND").isSatisfiesToBalanceMasks("61601*", true).op("AND").isSatisfiesToBalanceMasks("70614*", false).op("AND").isOpuSymbolEqualTo("25101", false);

        minusValue(attribute, dataSource.getData(filter, attribute));

        //3

        setValueAttributes(attribute,
                           RcbArray().initialize("Док_подтв_суммы_70614_ввод"),
                           RcbArray());
    end;

    macro calculateLine_112_2_1dataSum2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        //1
        var dataSource = m_dataSources.getDataSource("CbDocument");
        var filter     = m_dataSouceFilters.getFilter("CbDocument");

        filter.setDateCary(date(1, 1, getYear(global.getRcbReport().context.period.endDate)), global.getRcbReport().context.period.endDate);
        filter.op("AND").isSatisfiesToBalanceMasks("61601*", true).op("AND").isSatisfiesToBalanceMasks("70613*", false).op("AND").isOpuSymbolEqualTo("16101", false);

        setValue(attribute, dataSource.getData(filter, attribute));

        //2
        filter     = m_dataSouceFilters.getFilter("CbDocument");

        filter.setDateCary(date(1, 1, getYear(global.getRcbReport().context.period.endDate)), global.getRcbReport().context.period.endDate);
        filter.op("AND").isSatisfiesToBalanceMasks("70613*", true).op("AND").isSatisfiesToBalanceMasks("61601*", false).op("AND").isOpuSymbolEqualTo("16101", true);

        minusValue(attribute, dataSource.getData(filter, attribute));

        //3

        setValueAttributes(attribute,
                           RcbArray().initialize("Док_подтв_суммы_70613_ввод"),
                           RcbArray());
    end;

    macro calculateLine_112_2_1data(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);


        setValueAttributes(attribute,
                           RcbArray().initialize("Строка_112.2.1_данные_Сумма1"),
                           RcbArray().initialize("Строка_112.2.1_данные_Сумма2"));
    end;

    macro calculateLine_112_2_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_112.2.1_ввод"),
                               RcbArray(),
                               true);
        else
            if (m_part.getAttribute("Строка_112").getValue() > 0)
                m_protocolView.PrintLine("Строка_112 > 0");
                setValueAttributes(attribute,
                                   RcbArray().initialize("Строка_112.2.1_данные"),
                                   RcbArray());
            else
                m_protocolView.PrintLine("Строка_112 <= 0");
                setValue(attribute, $0.0);
            end;
        end;
    end;

    macro calculateLine_112_2_2data(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (m_part.getAttribute("Строка_112.2.2_нереал_полож_данные").getValue() > 0)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_112.2.2_нереал_полож_данные"),
                               RcbArray());
        else
            m_protocolView.PrintLine("Строка_112.2.2_нереал_полож_данные <= 0");
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_112.2.2_нереал_отриц_данные"),
                               RcbArray());
        end;
    end;

    macro calculateLine_112_2_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            if (m_part.getAttribute("Строка_112.2.2_полож_ввод").getValue() > 0)
                setValueAttributes(attribute,
                                   RcbArray().initialize("Строка_112.2.2_полож_ввод"),
                                   RcbArray());
            else
                m_protocolView.PrintLine("Строка_112.2.2_полож_ввод <= 0");
                setValueAttributes(attribute,
                                   RcbArray().initialize("Строка_112.2.2_отриц_ввод"),
                                   RcbArray(),
                                   true);
            end;
        else
            if (m_part.getAttribute("Строка_112").getValue() > 0)
                m_protocolView.PrintLine("Строка_112 > 0");
                setValueAttributes(attribute,
                                   RcbArray().initialize("Строка_112.2.2_данные"),
                                   RcbArray());
            else
                m_protocolView.PrintLine("Строка_112 <= 0");
                setValue(attribute, $0.0);
            end;
        end;
    end;

    macro calculateLine_112_2NotImplPositiveDataSum1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = m_dataSources.getDataSource("CbAccount");
        var filter     = m_dataSouceFilters.getFilter("CbAccount");

        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70613");

        setValue(attribute, dataSource.getData(filter, attribute));

        //2
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70613*").op("AND").isReportingCategoryExists("ПФИ: искл. из  10.2");

        minusValue(attribute, dataSource.getData(filter, attribute));

        //3
        setValueAttributes(attribute,
                           RcbArray().initialize("70613_нер_корр_ввод"),
                           RcbArray().initialize("Строка_112.2.1_данные_Сумма1"));
    end;

    macro calculateLine_112_2NotImplPositiveDataSum2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = m_dataSources.getDataSource("CbAccount");
        var filter     = m_dataSouceFilters.getFilter("CbAccount");

        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70614");

        setValue(attribute, dataSource.getData(filter, attribute));

        //2
        setValueAttributes(attribute,
                           RcbArray().initialize("70614_нер_корр_ввод"),
                           RcbArray().initialize("Строка_112.2.1_данные_Сумма2"));
    end;

    macro calculateLine_112_2NotImplPositiveData(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("Строка_112.2.1_данные_Сумма1"),
                           RcbArray().initialize("Строка_112.2.1_данные_Сумма2"));

        if (attribute.getValue() > 0)
            m_protocolView.PrintLine("Значение переменной равно " + attribute.getValue() + "/100*60");
            attribute.setValue(attribute.getValue()/100*60);
        else
            m_protocolView.PrintLine("Полученное значение переменной " + attribute.getValue() + " <= 0, полагаем равным 0");
            attribute.setValue($0.0);
        end;
    end;

    macro calculateLine_112_2NotImplPositive(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_112.2.2_полож_ввод"),
                               RcbArray());
        else
            if (m_part.getAttribute("Строка_112").getValue() > 0)
                m_protocolView.PrintLine("Строка_112 > 0");
                setValueAttributes(attribute,
                                   RcbArray().initialize("Строка_112.2.2_нереал_полож_данные"),
                                   RcbArray());
            else
                m_protocolView.PrintLine("Строка_112 <= 0");
                setValue(attribute, $0.0);
            end;
        end;
    end;

    macro calculateLine_112_2NotImplNegativeData(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("Строка_112.2.1_данные_Сумма2"),
                           RcbArray().initialize("Строка_112.2.1_данные_Сумма1"));

        if (attribute.getValue() < 0)
            m_protocolView.PrintLine("Полученное значение переменной " + attribute.getValue() + " <= 0, полагаем равным 0");
            attribute.setValue($0.0);
        end;
    end;

    macro calculateLine_112_2NotImplNegative(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_112.2.2_отриц_ввод"),
                               RcbArray());
        else
            if (m_part.getAttribute("Строка_112").getValue() > 0)
                m_protocolView.PrintLine("Строка_112 > 0");
                setValueAttributes(attribute,
                                   RcbArray().initialize("Строка_112.2.2_нереал_отриц_данные"),
                                   RcbArray());
            else
                m_protocolView.PrintLine("Строка_112 <= 0");
                setValue(attribute, $0.0);
            end;
        end;
    end;

    macro calculateLine_112RevaluationData(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = null;
        var filter     = null;

        dataSource = m_dataSources.getDataSource("CbAccount");
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10605, 70607").op("AND").isReportingCategoryExists("ТСС");

        setValue(attribute, dataSource.getData(filter, attribute));

        //2
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10603, 70602").op("AND").isReportingCategoryExists("ТСС");

        minusValue(attribute, dataSource.getData(filter, attribute));
    end;

    macro calculateLine_112Revaluation(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (m_part.getAttribute("Строка_112").getValue() > 0)
            m_protocolView.PrintLine("Строка_112 > 0");
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_112_1_данные", "Строка_104.1_переоценка"),
                               RcbArray());
        else
            m_protocolView.PrintLine("Строка_112 <= 0");
            setValue(attribute, $0.0);
        end;
    end;

    macro calculateLine_113(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = null;
        var filter     = null;

        dataSource = m_dataSources.getDataSource("CbAccount");
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        //1
        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("60101").op("AND").op("((").isReportingCategoryExists("ИП").op("AND").isShareInCapital(">20").op(")");
        filter.op("OR").isCodeOkopfEqual(67).op("OR").op("(").op("NOT").isReportingCategoryExists("2.2.6 искл").op("AND").isCodeOkopfEqual(47).op("))");

        setValue(attribute, dataSource.getData(filter, attribute));

        //2
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("60102, 60103, 60104").op("AND").isReportingCategoryExists("ИП").op("AND").isShareInCapital(">20");

        plusValue(attribute, dataSource.getData(filter, attribute));

        //3
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("60201");

        plusValue(attribute, dataSource.getData(filter, attribute));

        //4
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("60202, 60203, 60204");
        filter.op("AND").isReportingCategoryExists("ИП").op("AND").isContractorSubsidiary().op("AND").isShareInCapital(">20");

        plusValue(attribute, dataSource.getData(filter, attribute));

        //5
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("50605, 50618, 50705, 50718,  50621, 50721");
        filter.op("AND").op("((").isReportingCategoryExists("ИП").op("AND").isContractorSubsidiary().op("AND").isShareInCapital(">20").op(")");
        filter.op("OR").isCodeOkopfEqual(67);
        filter.op("OR").op("(").op("NOT").isReportingCategoryExists("2.2.6 искл").op("AND").isCodeOkopfEqual(47).op("))");

        plusValue(attribute, dataSource.getData(filter, attribute));

        //6
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("50620, 50720");
        filter.op("AND").op("((").isReportingCategoryExists("ИП").op("AND").isContractorSubsidiary().op("AND").isShareInCapital(">20").op(")");
        filter.op("OR").isCodeOkopfEqual(67);
        filter.op("OR").op("(").op("NOT").isReportingCategoryExists("2.2.6 искл").op("AND").isCodeOkopfEqual(47).op("))");

        minusValue(attribute, dataSource.getData(filter, attribute));

        m_protocolView.PrintLine("Вычитаем значения фактического резерва:");

        //7
        dataSource = m_dataSources.getDataSource("CbAccountReserve");
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("60101").op("AND").op("((").isReportingCategoryExists("ИП").op("AND").isShareInCapital(">20").op(")");
        filter.op("OR").isCodeOkopfEqual(67).op("OR").op("(").op("NOT").isReportingCategoryExists("2.2.6 искл").op("AND").isCodeOkopfEqual(47).op("))");

        minusValue(attribute, dataSource.getData(filter, attribute));

        //8
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("60102, 60103, 60104").op("AND").isReportingCategoryExists("ИП").op("AND").isShareInCapital(">20");

        minusValue(attribute, dataSource.getData(filter, attribute));

        //9
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("60201");

        minusValue(attribute, dataSource.getData(filter, attribute));

        //10
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("60202, 60203, 60204");
        filter.op("AND").isReportingCategoryExists("ИП").op("AND").isContractorSubsidiary().op("AND").isShareInCapital(">20");

        minusValue(attribute, dataSource.getData(filter, attribute));

        //11
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("50705, 50718");
        filter.op("AND").op("((").isReportingCategoryExists("ИП").op("AND").isContractorSubsidiary().op("AND").isShareInCapital(">20").op(")");
        filter.op("OR").isCodeOkopfEqual(67);
        filter.op("OR").op("(").op("NOT").isReportingCategoryExists("2.2.6 искл").op("AND").isCodeOkopfEqual(47).op("))");

        minusValue(attribute, dataSource.getData(filter, attribute));

        //12

        setValueAttributes(attribute,
                           RcbArray().initialize("Строка_113_ввод"),
                           RcbArray());
    end;

    macro calculateLine_114(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = null;
        var filter     = null;

        dataSource = m_dataSources.getDataSource("CbAccount");
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("102*, 10602, 107*, 108*").op("AND").isReportingCategoryExists("2.2.8");

        setValue(attribute, dataSource.getData(filter, attribute));
        //2

        setValueAttributes(attribute,
                           RcbArray().initialize("Строка_104_ввод"),
                           RcbArray());
    end;

    macro calculateLine_115(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (m_part.getAttribute("Строка_209_минус_208").getValue() <= 0)
            setValueAttributes(attribute,
                               RcbArray(),
                               RcbArray().initialize("Строка_209_минус_208"));
        else
            m_protocolView.PrintLine("Значение Строка_209_минус_208 > 0");
            setValue(attribute, $0.0);
        end;
    end;

    macro calculateLineMain(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("Строка_108"),
                           RcbArray().initialize("Строка_109", "Строка_110", "Строка_111", "Строка_112", "Строка_113", "Строка_114", "Строка_115"));
    end;

    macro calculateLine_203_data(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = null;
        var filter     = null;

        dataSource = m_dataSources.getDataSource("CbAccount");
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70601, 70603, 70604, 70605, 61301, 61304");

        setValue(attribute, dataSource.getData(filter, attribute));

        //2
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10603, 70602").op("AND").isReportingCategoryExists("ТСС");

        plusValue(attribute, dataSource.getData(filter, attribute));

        //3
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70606, 70608, 70609, 70610, 70611, 70612, 50905, 61401, 61403");

        minusValue(attribute, dataSource.getData(filter, attribute));

        //4
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10605, 70607").op("AND").isReportingCategoryExists("ТСС");

        minusValue(attribute, dataSource.getData(filter, attribute));

        //5
        setValueAttributes(attribute,
                           RcbArray().initialize("Строка_203.2_данные"),
                           RcbArray());


        //6
        if (not isLastDayInMonth(m_report.getPeriod().endDate))
            setValueAttributes(attribute,
                               RcbArray(),
                               RcbArray().initialize("Строка_112_52303_ввод"));
        end;
    end;

    macro calculateLine_203(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("Строка_203_данные"),
                           RcbArray().initialize("Строка_104"));

        if (attribute.getValue() < 0)
            m_protocolView.PrintLine("Полученное значение переменной " + attribute.getValue() + " <= 0, полагаем равным 0");
            attribute.setValue($0.0);
        end;
    end;

    macro calculateLine_203RevaluationData(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = null;
        var filter     = null;

        dataSource = m_dataSources.getDataSource("CbAccount");
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10603, 70602").op("AND").isReportingCategoryExists("ТСС");

        setValue(attribute, dataSource.getData(filter, attribute));

        //2
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10605, 70607").op("AND").isReportingCategoryExists("ТСС");

        minusValue(attribute, dataSource.getData(filter, attribute));
    end;

    macro calculateLine_203_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_203.2.1_ввод", "Строка_203.2.2_полож_ввод"),
                               RcbArray().initialize("Строка_203.2.2_отриц_ввод"),
                               true);
        else
            var sum = m_part.getAttribute("Строка_203").getValue();

            if (sum > 0)
                m_protocolView.PrintLine("Строка_203 (" + sum + ") > 0");

                sum = m_part.getAttribute("Строка_203.2_данные").getValue();

                m_protocolView.PrintLine("Значение переменной равно значению переменной Строка_203.2_данные (" + sum + ")");
                setValue(attribute, sum);
            else
                m_protocolView.PrintLine("Строка_203 (" + sum + ") <= 0");
                setValue(attribute, $0.0);
            end;
        end;

    end;

    macro calculateLine_203Revaluation(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (m_part.getAttribute("Строка_203").getValue() > 0)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_203_переоценка_данные"),
                               RcbArray().initialize("Строка_104.1_переоценка"));
        else
            m_protocolView.PrintLine("Значение Строка_203 <= 0");
            setValue(attribute, $0.0);
        end;
    end;

    macro calculateLine_203_2data(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("Строка_203.2.1_данные", "Строка_203.2.2_нереал_полож_данные"),
                           RcbArray().initialize("Строка_203.2.2_нереал_отриц_данные"),
                           true);
    end;

    macro calculateLine_203_2_1DataSum1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        //1
        var dataSource = m_dataSources.getDataSource("CbDocument");
        var filter     = m_dataSouceFilters.getFilter("CbDocument");

        filter.setDateCary(date(1, 1, getYear(global.getRcbReport().context.period.endDate)), global.getRcbReport().context.period.endDate);
        filter.op("AND").isSatisfiesToBalanceMasks("61601*", true).op("AND").isSatisfiesToBalanceMasks("70613*", false).op("AND").isOpuSymbolEqualTo("16101", false);

        setValue(attribute, dataSource.getData(filter, attribute));

        //2
        filter     = m_dataSouceFilters.getFilter("CbDocument");

        filter.setDateCary(date(1, 1, getYear(global.getRcbReport().context.period.endDate)), global.getRcbReport().context.period.endDate);
        filter.op("AND").isSatisfiesToBalanceMasks("70613*", true).op("AND").isSatisfiesToBalanceMasks("61601*", false).op("AND").isOpuSymbolEqualTo("16101", true);

        minusValue(attribute, dataSource.getData(filter, attribute));

        //3
        setValueAttributes(attribute,
                           RcbArray().initialize("Строка_203.2.1_док_суммы_70613_ввод"),
                           RcbArray());
    end;

    macro calculateLine_203_2_1DataSum2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        //1
        var dataSource = m_dataSources.getDataSource("CbDocument");
        var filter     = m_dataSouceFilters.getFilter("CbDocument");

        filter.setDateCary(date(1, 1, getYear(global.getRcbReport().context.period.endDate)), global.getRcbReport().context.period.endDate);
        filter.op("AND").isSatisfiesToBalanceMasks("70614*", true).op("AND").isSatisfiesToBalanceMasks("61601*", false).op("AND").isOpuSymbolEqualTo("25101", true);

        setValue(attribute, dataSource.getData(filter, attribute));

        //2
        filter     = m_dataSouceFilters.getFilter("CbDocument");

        filter.setDateCary(date(1, 1, getYear(global.getRcbReport().context.period.endDate)), global.getRcbReport().context.period.endDate);
        filter.op("AND").isSatisfiesToBalanceMasks("61601*", true).op("AND").isSatisfiesToBalanceMasks("70614*", false).op("AND").isOpuSymbolEqualTo("25101", false);

        minusValue(attribute, dataSource.getData(filter, attribute));

        //3
        setValueAttributes(attribute,
                           RcbArray().initialize("Строка_203.2.1_док_суммы_70614_ввод"),
                           RcbArray());
    end;

    macro calculateLine_203_2_1Data(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("Строка_203.2.1_данные_Сумма1"),
                           RcbArray().initialize("Строка_203.2.1_данные_Сумма2"));
    end;

    macro calculateLine_203_2_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_203.2.1_ввод"),
                               RcbArray(),
                               true);
        else
            if (m_part.getAttribute("Строка_203").getValue() > 0)
                m_protocolView.PrintLine("Строка_203 > 0");
                setValueAttributes(attribute,
                                   RcbArray().initialize("Строка_203.2.1_данные"),
                                   RcbArray());
            else
                m_protocolView.PrintLine("Строка_203 <= 0");
                setValue(attribute, $0.0);
            end;
        end;
    end;

    macro calculateLine_203_2_2data(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (m_part.getAttribute("Строка_203.2.2_нереал_полож_данные").getValue() > 0)
            m_protocolView.PrintLine("Строка_203.2.2_нереал_полож_данные > 0");
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_203.2.2_нереал_полож_данные"),
                               RcbArray());
        elif(m_part.getAttribute("Строка_203.2.2_нереал_полож_данные").getValue() == 0)
            m_protocolView.PrintLine("Строка_203.2.2_нереал_полож_данные == 0");
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_203.2.2_нереал_отриц_данные"),
                               RcbArray());
        end;
    end;

    macro calculateLine_203_2_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            if (m_part.getAttribute("Строка_203.2.2_полож_ввод").getValue() > 0)
                m_protocolView.PrintLine("Строка_203.2.2_полож_ввод > 0");
                setValueAttributes(attribute,
                                   RcbArray().initialize("Строка_203.2.2_полож_ввод"),
                                   RcbArray());
            else
                m_protocolView.PrintLine("Строка_203.2.2_полож_ввод <= 0");
                setValueAttributes(attribute,
                                   RcbArray().initialize("Строка_203.2.2_отриц_ввод"),
                                   RcbArray(),
                                   true);
            end;
        else
            if (m_part.getAttribute("Строка_203").getValue() > 0)
                m_protocolView.PrintLine("Строка_203 > 0");
                setValueAttributes(attribute,
                                   RcbArray().initialize("Строка_203.2.2_данные"),
                                   RcbArray());
            else
                m_protocolView.PrintLine("Строка_203 <= 0");
                setValue(attribute, $0.0);
            end;
        end;
    end;

    macro calculateLine_203_2_2NotImplPositiveDataSum1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = null;
        var filter     = null;

        dataSource = m_dataSources.getDataSource("CbAccount");
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70613");

        setValue(attribute, dataSource.getData(filter, attribute));

        //2
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70613").op("AND").isReportingCategoryExists("ПФИ: искл. из  10.2");

        minusValue(attribute, dataSource.getData(filter, attribute));

        //3
        setValueAttributes(attribute,
                           RcbArray().initialize("Строка_203.2.2_70613_нер_корр_ввод"),
                           RcbArray().initialize("Строка_203.2.1_данные_Сумма1"));
    end;

    macro calculateLine_203_2_2NotImplPositiveDataSum2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = null;
        var filter     = null;

        dataSource = m_dataSources.getDataSource("CbAccount");
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70614");

        setValue(attribute, dataSource.getData(filter, attribute));

        //2
        setValueAttributes(attribute,
                           RcbArray().initialize("Строка_203.2.2_70614_нер_корр_ввод"),
                           RcbArray().initialize("Строка_203.2.1_данные_Сумма2"));
    end;

    macro calculateLine_203_2_2NotImplPositiveData(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("Строка_203.2.2_нереал_полож_данные_Сумма1"),
                           RcbArray().initialize("Строка_203.2.2_нереал_полож_данные_Сумма2"));

        if (attribute.getValue() > 0)
            m_protocolView.PrintLine("Значение переменной равно " + attribute.getValue() + "/100*60");
            attribute.setValue(attribute.getValue()/100*60);
        else
            m_protocolView.PrintLine("Полученное значение переменной " + attribute.getValue() + " <= 0, полагаем равным 0");
            attribute.setValue($0.0);
        end;
    end;

    macro calculateLine_203_2_2NotImplPositive(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_203.2.2_полож_ввод"),
                               RcbArray());
        else
            if (m_part.getAttribute("Строка_203").getValue() > 0)
                m_protocolView.PrintLine("Строка_203 > 0");
                setValueAttributes(attribute,
                                   RcbArray().initialize("Строка_203.2.2_нереал_полож_данные"),
                                   RcbArray());
            else
                m_protocolView.PrintLine("Строка_203 <= 0");
                setValue(attribute, $0.0);
            end;
        end;
    end;

    macro calculateLine_203_2_2NotImplNegativeData(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("Строка_203.2.2_нереал_полож_данные_Сумма2"),
                           RcbArray().initialize("Строка_203.2.2_нереал_полож_данные_Сумма1"));

        if (attribute.getValue() <= 0)
            m_protocolView.PrintLine("Полученное значение переменной " + attribute.getValue() + " <= 0, полагаем равным 0");
            attribute.setValue($0.0);
        end;
    end;

    macro calculateLine_203_2_2NotImplNegative(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_203.2.2_отриц_ввод"),
                               RcbArray());
        else
            if (m_part.getAttribute("Строка_203").getValue() > 0)
                m_protocolView.PrintLine("Строка_203 > 0");
                setValueAttributes(attribute,
                                   RcbArray().initialize("Строка_203.2.2_нереал_отриц_данные"),
                                   RcbArray());
            else
                m_protocolView.PrintLine("Строка_203 <= 0");
                setValue(attribute, $0.0);
            end;
        end;
    end;

    macro calculateLine_204_data(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = null;
        var filter     = null;

        dataSource = m_dataSources.getDataSource("CbAccountSubCredit");
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("с 20313, 20314, 31309, 31409, 31509, 31609, 41107, 41207, 41307, 41407, 41507, 41607, 41707, 41807, 41907, 42007, 42107, 42207, 42507, 42807, 42907, 43007, 43107, 43207, 43307, 43407, 43507, 43607, 43707, 43807, 43907, 44007, 52006");
        filter.op("AND").isReportingCategoryExists("СубКредит").op("AND").op("NOT").isReportingCategoryExists("СубКредит на 10 лет");

        setValue(attribute, dataSource.getData(filter, attribute));
    end;

    macro calculateLine_204_data10Years(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = null;
        var filter     = null;

        dataSource = m_dataSources.getDataSource("CbAccountSubCredit");
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("с 20313, 20314, 31309, 31409, 31509, 31609, 41107, 41207, 41307, 41407, 41507, 41607, 41707, 41807, 41907, 42007, 42107, 42207, 42507, 42807, 42907, 43007, 43107, 43207, 43307, 43407, 43507, 43607, 43707, 43807, 43907, 44007, 52006");
        filter.op("AND").isReportingCategoryExists("СубКредит на 10 лет");

        setValue(attribute, dataSource.getData(filter, attribute));
    end;

    macro calculateLine_204(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("Строка_204_данные", "Строка_204_данные10лет"),
                           RcbArray());
    end;

    macro calculateLine_204_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var sumEq3_5data = m_part.getAttribute("Строка_204_данные").getValue();
        var sumEqMain = m_part.getAttribute("Строка_116").getValue();

        m_protocolView.printLine("Значение переменной равно min(Строка_204_данные(" + sumEq3_5data + "), 0.5*Строка_116(" + sumEqMain + "))");
        setValue(attribute, min(sumEq3_5data,0.5*sumEqMain));
    end;

    macro calculateLine_204_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var sumEq3_5data10years = m_part.getAttribute("Строка_204_данные10лет").getValue();
        var sumEqMain = m_part.getAttribute("Строка_116").getValue();
        var sumEq204_1 = m_part.getAttribute("Строка_204.1").getValue();

        m_protocolView.printLine("Значение переменной равно Строка_204.1(" + sumEq204_1 + ") +  min(Строка_204_данные10лет(" + sumEq3_5data10years + "), Строка_116(" + sumEqMain + "))");
        setValue(attribute, sumEq204_1 + min(sumEq3_5data10years,sumEqMain));
    end;

    macro calculateLine_206(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = null;
        var filter     = null;

        dataSource = m_dataSources.getDataSource("CbAccount");
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("10207").op("AND").isReportingCategoryExists("3.7");

        setValue(attribute, dataSource.getData(filter, attribute));
    end;

    macro calculateLine_207(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.ПрибыльПредшествующихЛетНеПодтверждена)
            if (f134Parameters.isEndDateLess0107)
                if (m_part.getAttribute("Прибыль_пред_лет").getValue() >= 0)
                    setValueAttributes(attribute,
                                       RcbArray().initialize("Прибыль_пред_лет"),
                                       RcbArray().initialize("Строка_106"));

                    if (attribute.getValue() < 0)
                        m_protocolView.PrintLine("Полученное значение переменной " + attribute.getValue() + " <= 0, полагаем равным 0");
                        attribute.setValue($0.0);
                    end;
                elif (m_part.getAttribute("Прибыль_прошл_года").getValue() >= 0)
                    setValueAttributes(attribute,
                                       RcbArray().initialize("Прибыль_прошл_года"),
                                       RcbArray());
                else
                    m_protocolView.PrintLine("Значение переменной равно нулю.");
                    setValue(attribute, $0.0);
                end;
            else
                m_protocolView.PrintLine("Дата окончания о.п. >= 01.07 отчетного года.");
                m_protocolView.PrintLine("Значение переменной равно нулю.");
                setValue(attribute, $0.0);
            end;

        else
            m_protocolView.PrintLine("Прибыль предшествующих лет подтверждена.");
            m_protocolView.PrintLine("Значение переменной равно нулю.");
            setValue(attribute, $0.0);
        end;
    end;

    macro calculateLine_207_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.ПрибыльПредшествующихЛетНеПодтверждена)
            if (f134Parameters.isEndDateLess0107)
                if (m_part.getAttribute("Прибыль_пред_лет").getValue() >= 0)
                    setValueAttributes(attribute,
                                       RcbArray().initialize("Строка_106.1_пред_лет"),
                                       RcbArray().initialize("Строка_106.1"));

                    if (attribute.getValue() < 0)
                        m_protocolView.PrintLine("Полученное значение переменной " + attribute.getValue() + " <= 0, полагаем равным 0");
                        attribute.setValue($0.0);
                    end;
                elif (m_part.getAttribute("Прибыль_прошл_года").getValue() >= 0)
                    setValueAttributes(attribute,
                                       RcbArray().initialize("Строка_106.1_прошл_года"),
                                       RcbArray());
                else
                    m_protocolView.PrintLine("Значение переменной равно нулю.");
                    setValue(attribute, $0.0);
                end;
            else
                m_protocolView.PrintLine("Дата окончания о.п. >= 01.07 отчетного года.");
                m_protocolView.PrintLine("Значение переменной равно нулю.");
                setValue(attribute, $0.0);
            end;

        else
            m_protocolView.PrintLine("Прибыль предшествующих лет подтверждена.");
            m_protocolView.PrintLine("Значение переменной равно нулю.");
            setValue(attribute, $0.0);
        end;
    end;

    macro calculateLine_207_1_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.ПрибыльПредшествующихЛетНеПодтверждена)
            if (f134Parameters.isEndDateLess0107)
                if (m_part.getAttribute("Прибыль_пред_лет").getValue() >= 0)
                    setValueAttributes(attribute,
                                       RcbArray().initialize("Строка_106.1.1_пред_лет"),
                                       RcbArray().initialize("Строка_106.1.1"));

                    if (attribute.getValue() < 0)
                        m_protocolView.PrintLine("Полученное значение переменной " + attribute.getValue() + " <= 0, полагаем равным 0");
                        attribute.setValue($0.0);
                    end;
                elif (m_part.getAttribute("Прибыль_прошл_года").getValue() >= 0)
                    setValueAttributes(attribute,
                                       RcbArray().initialize("Строка_106.1.1_прошл_года"),
                                       RcbArray());
                else
                    m_protocolView.PrintLine("Значение переменной равно нулю.");
                    setValue(attribute, $0.0);
                end;
            else
                m_protocolView.PrintLine("Дата окончания о.п. >= 01.07 отчетного года.");
                m_protocolView.PrintLine("Значение переменной равно нулю.");
                setValue(attribute, $0.0);
            end;

        else
            m_protocolView.PrintLine("Прибыль предшествующих лет подтверждена.");
            m_protocolView.PrintLine("Значение переменной равно нулю.");
            setValue(attribute, $0.0);
        end;
    end;

    macro calculateLine_207_1_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.ПрибыльПредшествующихЛетНеПодтверждена)
            if (f134Parameters.isEndDateLess0107)
                if (m_part.getAttribute("Прибыль_пред_лет").getValue() >= 0)
                    setValueAttributes(attribute,
                                       RcbArray().initialize("Строка_106.1.2_пред_лет"),
                                       RcbArray().initialize("Строка_106.1.2"));

                    if (attribute.getValue() < 0)
                        m_protocolView.PrintLine("Полученное значение переменной " + attribute.getValue() + " <= 0, полагаем равным 0");
                        attribute.setValue($0.0);
                    end;
                elif (m_part.getAttribute("Прибыль_прошл_года").getValue() >= 0)
                    setValueAttributes(attribute,
                                       RcbArray().initialize("Строка_106.1.2_прошл_года"),
                                       RcbArray());
                else
                    m_protocolView.PrintLine("Значение переменной равно нулю.");
                    setValue(attribute, $0.0);
                end;
            else
                m_protocolView.PrintLine("Дата окончания о.п. >= 01.07 отчетного года.");
                m_protocolView.PrintLine("Значение переменной равно нулю.");
                setValue(attribute, $0.0);
            end;

        else
            m_protocolView.PrintLine("Прибыль предшествующих лет подтверждена.");
            m_protocolView.PrintLine("Значение переменной равно нулю.");
            setValue(attribute, $0.0);
        end;
    end;


    macro calculateLine_207_1_2NotImplPositive(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.ПрибыльПредшествующихЛетНеПодтверждена)
            if (f134Parameters.isEndDateLess0107)
                if (m_part.getAttribute("Прибыль_пред_лет").getValue() >= 0)
                    setValueAttributes(attribute,
                                       RcbArray().initialize("Строка_106.1.2_нереал_полож_пред_лет"),
                                       RcbArray().initialize("Строка_106.1.2_нереал_полож"));

                    if (attribute.getValue() < 0)
                        m_protocolView.PrintLine("Полученное значение переменной " + attribute.getValue() + " <= 0, полагаем равным 0");
                        attribute.setValue($0.0);
                    end;
                elif (m_part.getAttribute("Прибыль_прошл_года").getValue() >= 0)
                    setValueAttributes(attribute,
                                       RcbArray().initialize("Строка_106.1.2_нереал_полож_прошл_года"),
                                       RcbArray());
                else
                    m_protocolView.PrintLine("Значение переменной равно нулю.");
                    setValue(attribute, $0.0);
                end;
            else
                m_protocolView.PrintLine("Дата окончания о.п. >= 01.07 отчетного года.");
                m_protocolView.PrintLine("Значение переменной равно нулю.");
                setValue(attribute, $0.0);
            end;

        else
            m_protocolView.PrintLine("Прибыль предшествующих лет подтверждена.");
            m_protocolView.PrintLine("Значение переменной равно нулю.");
            setValue(attribute, $0.0);
        end;
    end;

    macro calculateLine_207_1_2NotImplNegative(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.ПрибыльПредшествующихЛетНеПодтверждена)
            if (f134Parameters.isEndDateLess0107)
                if (m_part.getAttribute("Прибыль_пред_лет").getValue() >= 0)
                    setValueAttributes(attribute,
                                       RcbArray().initialize("Строка_106.1.2_нереал_отриц_пред_лет"),
                                       RcbArray().initialize("Строка_106.1.2_нереал_отриц"));

                    if (attribute.getValue() < 0)
                        m_protocolView.PrintLine("Полученное значение переменной " + attribute.getValue() + " <= 0, полагаем равным 0");
                        attribute.setValue($0.0);
                    end;
                elif (m_part.getAttribute("Прибыль_прошл_года").getValue() >= 0)
                    setValueAttributes(attribute,
                                       RcbArray().initialize("Строка_106.1.2_нереал_отриц_прошл_года"),
                                       RcbArray());
                else
                    m_protocolView.PrintLine("Значение переменной равно нулю.");
                    setValue(attribute, $0.0);
                end;
            else
                m_protocolView.PrintLine("Дата окончания о.п. >= 01.07 отчетного года.");
                m_protocolView.PrintLine("Значение переменной равно нулю.");
                setValue(attribute, $0.0);
            end;

        else
            m_protocolView.PrintLine("Прибыль предшествующих лет подтверждена.");
            m_protocolView.PrintLine("Значение переменной равно нулю.");
            setValue(attribute, $0.0);
        end;
    end;

    macro calculateLine_208(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = null;
        var filter     = null;

        dataSource = m_dataSources.getDataSource("CbAccount");
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10207, 10603, 10801, 61301, 61304, 20313, 20314, 31309, 31409, 31509, 31609, 41107, 41207, 41307, 41407, 41507, 41607, 41707, 41807, 41907, 42007, 42107, 42207, 42507, 42807, 42907, 43007, 43107, 43207, 43307, 43407, 43507, 43607, 43807, 43907, 44007, 52006, 70601, 70602, 70603, 70604, 70605, 70701, 70702, 70703, 70704, 70705, 70801");
        filter.op("AND").isReportingCategoryExists("3.10_");

        setValue(attribute, dataSource.getData(filter, attribute));

        //2
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("20321, 30126, 30226, 30410, 30607, 32015, 32115, 32211, 32311, 32403, 32505, 44115, 44215, 44315, 44415, 44515, 44615, 44715, 44815, 44915, 45015, 45115, 45215, 45315, 45415, 45515, 45615, 45715, 45818, 45918, 46008, 46108, 46208, 46308, 46408, 46508, 46608, 46708, 46808, 46908, 47008, 47108, 47208, 47308, 47425, 47425, 47702, 47804, 47902, 50219, 50319, 50507, 50719, 50908, 51210, 51310, 51410, 51510, 51610, 51710, 51810, 51910, 60105, 60206, 60324, 60405");
        filter.op("AND").isReportingCategoryExists("3.10_");

        minusValue(attribute, dataSource.getData(filter, attribute));
        //3
        setValueAttributes(attribute,
                           RcbArray().initialize("Строка_208_ввод"),
                           RcbArray());
        if(attribute.getValue() > 0)
            replaceDependencesAttributePool("Строка_107", "calculateLine_107", RcbArray().initialize("Строка_101","Строка_102","Строка_103","Строка_104","Строка_105","Строка_106","Строка_109","Строка_110","Строка_111","Строка_112","Строка_113","Строка_114","Строка_115","Строка_107_данные"));
            replaceDependencesAttributePool("Строка_116", "calculateLineMain", RcbArray().initialize("Строка_108","Строка_109", "Строка_110", "Строка_111", "Строка_112", "Строка_113", "Строка_114", "Строка_115"));
            replaceDependencesAttributePool("Строка_204", "calculateLine_204", RcbArray().initialize("Строка_204_данные", "Строка_204_данные10лет"));
        else
            replaceDependencesAttributePool("Строка_107", "calculateLine_107", RcbArray().initialize("Строка_101","Строка_102","Строка_103","Строка_104","Строка_105","Строка_106","Строка_109","Строка_110","Строка_111","Строка_112","Строка_113","Строка_114","Строка_107_данные"));
            replaceDependencesAttributePool("Строка_116", "calculateLineMain", RcbArray().initialize("Строка_108","Строка_109", "Строка_110", "Строка_111", "Строка_112", "Строка_113", "Строка_114"));
            replaceDependencesAttributePool("Строка_204", "calculateLine_204", RcbArray().initialize("Строка_204.1", "Строка_204.2"));
        end;
    end;


    macro calculateLineRealAdditional(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("Строка_201", "Строка_202", "Строка_203", "Строка_204", "Строка_205", "Строка_206", "Строка_207"),
                           RcbArray().initialize("Строка_208"));
    end;

    macro calculateLineReal(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (m_part.getAttribute("Строка_116").getValue() <= $0.0)
            m_protocolView.PrintLine("Строка_116 <= 0");

            setValue(attribute, $0.0);
            return;
        end;

        if (m_part.getAttribute("Строка_209_минус_208").getValue() <= $0.0)
            m_protocolView.PrintLine("Строка_209_минус_208 <= 0");

            setValue(attribute, $0.0);
            return;
        end;
        if (m_part.getAttribute("Строка_116").getValue() <= m_part.getAttribute("Строка_209_минус_208").getValue())
            m_protocolView.PrintLine("Строка_116 <= Строка_209_минус_208");
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_116"),
                               RcbArray());
        else

            m_protocolView.PrintLine("Строка_116 > Строка_209_минус_208");

            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_201", "Строка_202", "Строка_203", "Строка_205", "Строка_206", "Строка_207"),
                               RcbArray().initialize("Строка_208"));

            var sumEq3_5Data = m_part.getAttribute("Строка_204_данные").getValue();
            var sumEqMain = m_part.getAttribute("Строка_116").getValue();
            var sumEq3_5Data10Years = m_part.getAttribute("Строка_204_данные10лет").getValue();

            m_protocolView.PrintLine("+ минимум {минимум {Строка_204_данные(" + sumEq3_5Data + "); 0.5 * Строка_116(" + sumEqMain + ")}+ Строка_204_данные10лет(" + sumEq3_5Data10Years + "); Строка_116(" + sumEqMain + ")}");

            plusValue(attribute, min(min(sumEq3_5Data, 0.5 * sumEqMain) + sumEq3_5Data10Years, sumEqMain));
        end;
    end;

    macro calculateLine_301(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = null;
        var filter     = null;

        dataSource = m_dataSources.getDataSource("CbAccount");
        filter     = m_dataSouceFilters.getFilter("CbAccount");
        //1
        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("474*, 603*").op("AND").isActive().op("AND").isTermDelay(">30");
        filter.op("AND").op("NOT").isSatisfiesToBalanceMasks("47402, 47408, 47423, 47427, 60312, 60314, 60315, 60323, 60337, 60339, 60341, 60343");

        setValue(attribute, dataSource.getData(filter, attribute));

        //2
        dataSource = m_dataSources.getDataSource("CbAccountReserve");

        minusValue(attribute, dataSource.getData(filter, attribute));
    end;

    macro calculateLine_302(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = null;
        var filter     = null;

        dataSource = m_dataSources.getDataSource("CbAccount");
        filter     = m_dataSouceFilters.getFilter("CbAccount");
        //1
        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("32009, 32209, 47802, 50106, 50107, 50110, 50207, 50208, 50211, 50307, 50308, 50311");
        filter.op("AND").isReportingCategoryExists("СубКредит");

        setValue(attribute, dataSource.getData(filter, attribute));

        //2
        dataSource = m_dataSources.getDataSource("CbAccountReserve");

        minusValue(attribute, dataSource.getData(filter, attribute));
    end;

    macro calculateLineSubTotal(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("Строка_116", "Строка_210"),
                           RcbArray().initialize("Строка_301", "Строка_302"));
    end;

    macro calculateLine_502_assets(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = null;
        var filter     = null;

        dataSource = m_dataSources.getDataSource("CbAccount");
        filter     = m_dataSouceFilters.getFilter("CbAccount");
        //1
        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("60401, 60404, 60406, 60407, 60408, 60409, 60410, 60411");
        filter.op("AND").op("NOT").isReportingCategoryExists("5.2 искл");

        setValue(attribute, dataSource.getData(filter, attribute));
        //2
        filter     = m_dataSouceFilters.getFilter("CbAccount");
        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("61002, 61008, 61009, 610011");

        plusValue(attribute, dataSource.getData(filter, attribute));

        //3
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("60701, 60702, 60705");
        filter.op("AND").op("NOT").isReportingCategoryExists("НМА");

        plusValue(attribute, dataSource.getData(filter, attribute));

        //4
        filter     = m_dataSouceFilters.getFilter("CbAccount");
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("60601, 60602, 60603");

        minusValue(attribute, dataSource.getData(filter, attribute));

        //5
        setValueAttributes(attribute,
                           RcbArray(),
                           RcbArray().initialize("Строка_502_Имущество_ввод"));

    end;

    macro calculateLine_502_MainAdditional(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = m_dataSources.getDataSource("CbAccount");
        var filter     = m_dataSouceFilters.getFilter("CbAccount");

        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10601");

        setValue(attribute, dataSource.getData(filter, attribute));

        //2
        setValueAttributes(attribute,
                           RcbArray().initialize("Строка_116", "Строка_202", "Строка_203", "Строка_205", "Строка_206", "Строка_207"),
                           RcbArray().initialize("Строка_208"));
    end;

    macro calculateLine_502(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var sumEqMainAditional = m_part.getAttribute("Строка_502_ОснДоп").getValue();
        var sumEq5_2assets = m_part.getAttribute("Строка_502_Имущество").getValue();

        if (sumEqMainAditional <= 0)
            m_protocolView.PrintLine("Строка_502_ОснДоп <= 0");
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_502_Имущество"),
                               RcbArray());
        elif ((sumEqMainAditional > 0) and (sumEqMainAditional < sumEq5_2assets))
            m_protocolView.PrintLine("(Строка_502_ОснДоп > 0) И (Строка_502_ОснДоп < Строка_502_Имущество)");
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_502_Имущество"),
                               RcbArray().initialize("Строка_502_ОснДоп"));
        else
            m_protocolView.PrintLine("Не выполняются условия:");
            m_protocolView.PrintLine("Строка_502_ОснДоп <= 0");
            m_protocolView.PrintLine("(Строка_502_ОснДоп > 0) И (Строка_502_ОснДоп < Строка_502_Имущество)");
            m_protocolView.PrintLine("Значение переменной равно 0");

            setValue(attribute, $0.0);
        end;
    end;

    macro calculateReserveShortfall(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("Недосозд_резерв_254П_ввод","Недосозд_резерв_283П_ввод","Недосозд_резерв_1584У_ввод","Недосозд_резерв_2732У_ввод"),
                           RcbArray());
    end;

    macro calculateLine_000(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("Строка_400"),
                           RcbArray().initialize("Строка_501", "Строка_502", "Строка_503"));
    end;

    macro execute()

        println("Значения настроек, используемых при расчете:");
        println("REPTREG/REP_GROUPS/COMMON/ОПФ_КО_АО                                " + string(f134Parameters.ОПФ_КО_АО));
        println("REPTREG/REP_GROUPS/COMMON/ДАТААУДПОДТВ_ПРОШЛЫЙГ                    " + string(f134Parameters.ДатаАудПодтв_ПрошлыйГ));
        println("REPTREG/REP_GROUPS/COMMON/ДАТААУД_ПРОШЛЫЙГ                         " + string(f134Parameters.ДатаАуд_ПрошлыйГ));
        println("REPTREG/REP_GROUPS/COMMON/ДАТААУДПОДТВ_ТЕКГ                        " + string(f134Parameters.ДатаАудПодтв_ТекГ));
        println("REPTREG/REP_GROUPS/COMMON/ДАТААУД_ТЕКГ                             " + string(f134Parameters.ДатаАуд_ТекГ));
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/РАСЧЕТ_УК_ПО_ПРОВОДКАМ          " + string(f134Parameters.isCalculateACForPosting));
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/НЕПОДТВ_ПРИБЫЛЬ_ПРЕДШЕСТВ_ЛЕТ   " + string(f134Parameters.unconfirmedProfitPreviousYear));
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/ПОЛЬЗОВАТЕЛЬСКИЙ ВВОД           " + string(f134Parameters.isUserInput));


        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_101",                         "calculateLine_101", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_102",                         "calculateLine_102", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_103",                         "calculateLine_103", RcbArray().initialize("Строка_105", "Строка_202")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_104_данные",                  "calculateLine_104_data", RcbArray().initialize("Строка_104.2_данные", "Строка_104_52303_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_104",                         "calculateLine_104", RcbArray().initialize("Строка_104_данные")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_104_52303_ввод",              "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_104.1_переоценка_данные",     "calculateLine_104RevaluationData", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_104.1_переоценка",            "calculateLine_104Revaluation", RcbArray().initialize("Строка_104", "Строка_104.1_переоценка_данные")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_104.2_данные",                "calculateLine_104_2_data", RcbArray().initialize("Строка_104.2.1_данные", "Строка_104.2.2_нереал_полож_данные", "Строка_104.2.2_нереал_отриц_данные")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_104.2",                       "calculateLine_104_2", RcbArray().initialize("Строка_104", "Строка_104.2.1_ввод", "Строка_104.2.2_полож_ввод", "Строка_104.2.2_отриц_ввод")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_104.2.1_данныеСумма1",        "calculateLine_104_2_1_dataSum1", RcbArray().initialize("Док_подтв_суммы_70613_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_104.2.1_данныеСумма2",        "calculateLine_104_2_1_dataSum2", RcbArray().initialize("Док_подтв_суммы_70614_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_104.2.1_данные",              "calculateLine_104_2_1_data", RcbArray().initialize("Строка_104.2.1_данныеСумма1", "Строка_104.2.1_данныеСумма2")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Док_подтв_суммы_70613_ввод",         "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Док_подтв_суммы_70614_ввод",         "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_104.2.1",                     "calculateLine_104_2_1", RcbArray().initialize("Строка_104", "Строка_104.2.1_данные", "Строка_104.2.1_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_104.2.2_данные",              "calculateLine_104_2_2data", RcbArray().initialize("Строка_104.2.2_нереал_полож_данные", "Строка_104.2.2_нереал_отриц_данные")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_104.2.2",                     "calculateLine_104_2_2", RcbArray().initialize("Строка_104.2.2_полож_ввод", "Строка_104.2.2_отриц_ввод", "Строка_104", "Строка_104.2.2_данные")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_104.2.2_нереал_полож_данныеСумма1", "calculateLine_104_2_2NotImplPositiveDataSum1", RcbArray().initialize("70613_нер_корр_ввод","Строка_104.2.1_данныеСумма1")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_104.2.2_нереал_полож_данныеСумма2", "calculateLine_104_2_2NotImplPositiveDataSum2", RcbArray().initialize("70614_нер_корр_ввод", "Строка_104.2.1_данныеСумма2")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_104.2.2_нереал_полож_данные",       "calculateLine_104_2_2NotImplPositiveData", RcbArray().initialize("Строка_104.2.2_нереал_полож_данныеСумма1", "Строка_104.2.2_нереал_полож_данныеСумма2")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("70613_нер_корр_ввод",                "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("70614_нер_корр_ввод",                "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_104.2.2_нереал_полож",        "calculateLine_104_2_2NotImplPositive", RcbArray().initialize("Строка_104.2.2_полож_ввод","Строка_104.2.2_нереал_полож_данные","Строка_104")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_104.2.2_нереал_отриц_данные", "calculateLine_104_2_2NotImplNegativeData", RcbArray().initialize("Док_подтв_суммы_70613_ввод", "70613_нер_корр_ввод", "Док_подтв_суммы_70614_ввод", "70614_нер_корр_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_104.2.2_нереал_отриц",        "calculateLine_104_2_2NotImplNegative", RcbArray().initialize("Строка_104.2.2_отриц_ввод", "Строка_104", "Строка_104.2.2_нереал_отриц_данные")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_105",                         "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Прибыль_пред_лет",                   "calculateLinePriviousProfit", RcbArray().initialize("10801_без_ПФИ", "70801_без_ПФИ", "Строка_106.1_пред_лет", "10901_без_ПФИ", "70802_без_ПФИ")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("10801_без_ПФИ_Сумма1",        "calculateLine10801withoutPFI_Sum1", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("10801_без_ПФИ_Сумма2",        "calculateLine10801withoutPFI_Sum2", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("10801_без_ПФИ",               "calculateLine10801withoutPFI", RcbArray().initialize("10801_без_ПФИ_Сумма1", "10801_без_ПФИ_Сумма2")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("10901_без_ПФИ_Сумма1",        "calculateLine10901withoutPFI_Sum1", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("10901_без_ПФИ_Сумма2",        "calculateLine10901withoutPFI_Sum2", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("10901_без_ПФИ",               "calculateLine10901withoutPFI", RcbArray().initialize("10901_без_ПФИ_Сумма1", "10901_без_ПФИ_Сумма2")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("70801_без_ПФИ_Сумма1",        "calculateLine70801withoutPFI_Sum1", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("70801_без_ПФИ_Сумма2",        "calculateLine70801withoutPFI_Sum2", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("70801_без_ПФИ",               "calculateLine70801withoutPFI", RcbArray().initialize("70801_без_ПФИ_Сумма1", "70801_без_ПФИ_Сумма2")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("70802_без_ПФИ_Сумма1",        "calculateLine70802withoutPFI_Sum1", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("70802_без_ПФИ_Сумма2",        "calculateLine70802withoutPFI_Sum2", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("70802_без_ПФИ",               "calculateLine70802withoutPFI", RcbArray().initialize("70802_без_ПФИ_Сумма1", "70802_без_ПФИ_Сумма2")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Прибыль_прошл_года",                 "calculateLinePriviousYearProfit", RcbArray().initialize("70801_без_ПФИ", "70802_без_ПФИ", "Строка_106.1_прошл_года")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106",                         "calculateLine_106", RcbArray().initialize("Прибыль_пред_лет", "Прибыль_прошл_года")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1_пред_лет",              "calculateLine106_1PrevYears", RcbArray().initialize("Строка_106.1.1_пред_лет", "Строка_106.1.2_нереал_полож_пред_лет", "Строка_106.1.2_нереал_отриц_пред_лет")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1_прошл_года",            "calculateLine106_1PrevYear", RcbArray().initialize("Строка_106.1.1_прошл_года", "Строка_106.1.2_нереал_полож_прошл_года","Строка_106.1.2_нереал_отриц_прошл_года")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1",                       "calculateLine106_1", RcbArray().initialize("Строка_106.1.1_ввод", "Строка_106.1.2_полож_ввод", "Строка_106.1.2_отриц_ввод", "Прибыль_пред_лет", "Строка_106.1_пред_лет", "Строка_106.1_прошл_года")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1.1_пред_лет_Сумма1",     "calculateLine_106_1_1PrevYears_Sum1", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1.1_пред_лет_Сумма2",     "calculateLine_106_1_1PrevYears_Sum2", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1.1_пред_лет",            "calculateLine_106_1_1PrevYears", RcbArray().initialize("Строка_106.1.1_пред_лет_Сумма1", "Строка_106.1.1_пред_лет_Сумма2", "Строка_106.1.1_прошл_года")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1.1_прошл_года_Сумма1",   "calculateLine_106_1_1PrevYear_Sum1", RcbArray().initialize("Док_подтв_суммы_доход_ПрошлГ_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1.1_прошл_года_Сумма2",   "calculateLine_106_1_1PrevYear_Sum2", RcbArray().initialize("Док_подтв_суммы_расход_ПрошлГ_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1.1_прошл_года",          "calculateLine_106_1_1PrevYear", RcbArray().initialize("Строка_106.1.1_прошл_года_Сумма1", "Строка_106.1.1_прошл_года_Сумма2")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Док_подтв_суммы_доход_ПрошлГ_ввод",  "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Док_подтв_суммы_расход_ПрошлГ_ввод", "processUserAttribute", RcbArray()));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1.1",                     "calculateLine_106_1_1", RcbArray().initialize("Строка_106.1.1_ввод","Прибыль_пред_лет","Строка_106.1.1_пред_лет","Строка_106.1.1_прошл_года")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1.2_пред_лет",            "calculateLine_106_1_2prevYears", RcbArray().initialize("Строка_106.1.2_нереал_полож_пред_лет", "Строка_106.1.2_нереал_отриц_пред_лет")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1.2_прошл_года",          "calculateLine_106_1_2prevYear", RcbArray().initialize("Строка_106.1.2_нереал_полож_прошл_года", "Строка_106.1.2_нереал_отриц_прошл_года")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1.2",                     "calculateLine_106_1_2", RcbArray().initialize("Строка_106.1.2_полож_ввод","Строка_106.1.2_отриц_ввод","Прибыль_пред_лет","Строка_106.1.2_прошл_года","Строка_106.1.2_пред_лет")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1.2_нереал_полож_пред_лет_Сумма1",   "calculateLine_106_1_2NotImplPrevYears_Sum1", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1.2_нереал_полож_пред_лет_Сумма2",   "calculateLine_106_1_2NotImplPrevYears_Sum2", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1.2_нереал_полож_пред_лет",          "calculateLine_106_1_2NotImplPrevYears", RcbArray().initialize("Строка_106.1.2_нереал_полож_пред_лет_Сумма1", "Строка_106.1.2_нереал_полож_пред_лет_Сумма2", "Строка_106.1.2_нереал_полож_прошл_года","Строка_106.1.2_полож_ввод")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1.2_нереал_полож_прошл_года_Сумма1", "calculateLine_106_1_2NotImplPrevYear_Sum1", RcbArray().initialize("70713_нер_корр_ввод","Строка_106.1.1_прошл_года_Сумма1")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1.2_нереал_полож_прошл_года_Сумма2", "calculateLine_106_1_2NotImplPrevYear_Sum2", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1.2_нереал_полож_прошл_года",        "calculateLine_106_1_2NotImplPrevYear", RcbArray().initialize("Строка_106.1.2_нереал_полож_прошл_года_Сумма1", "Строка_106.1.2_нереал_полож_прошл_года_Сумма2")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("70713_нер_корр_ввод",                           "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("70714_нер_корр_ввод",                           "processUserAttribute", RcbArray()));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1.2_нереал_полож",                   "calculateLine_106_1_2NotImplPositive", RcbArray().initialize("Прибыль_пред_лет","Строка_106.1.2_нереал_полож_пред_лет","Строка_106.1.2_нереал_полож_прошл_года")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1.2_нереал_отриц_пред_лет",          "calculateLine_106_1_2NotImplNegativePrevYears", RcbArray().initialize("Строка_106.1.2_нереал_полож_пред_лет_Сумма1", "Строка_106.1.2_нереал_полож_пред_лет_Сумма2", "Строка_106.1.2_нереал_отриц_прошл_года", "Строка_106.1.2_отриц_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1.2_нереал_отриц_прошл_года",        "calculateLine_106_1_2NotImplNegativePrevYear", RcbArray().initialize("Строка_106.1.2_нереал_полож_прошл_года_Сумма2","Строка_106.1.2_нереал_полож_прошл_года_Сумма1", "Строка_106.1.2_отриц_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1.2_нереал_отриц",                   "calculateLine_106_1_2NotImplNegative", RcbArray().initialize("Прибыль_пред_лет","Строка_106.1.2_нереал_отриц_пред_лет","Строка_106.1.2_нереал_отриц_прошл_года")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_107_данные",                             "calculateLine_107data", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_107",                   "calculateLine_107", RcbArray().initialize("Строка_208")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_108",                   "calculateLineMainReal", RcbArray().initialize("Строка_101","Строка_102","Строка_103","Строка_104","Строка_105","Строка_106", "Строка_107")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_109",                   "calculateLine_109", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_110",                   "calculateLine_110", RcbArray().initialize("Строка_110_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_110_ввод",               "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_111",                   "calculateLine_111", RcbArray().initialize("Прибыль_пред_лет","Прибыль_прошл_года")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_111.1",                 "calculateLine_111_1", RcbArray().initialize("Прибыль_пред_лет","Прибыль_прошл_года","Строка_106.1_прошл_года","Строка_106.1_пред_лет","Строка_111.1.1_ввод", "Строка_111.1.2_отриц_ввод","Строка_111.1.2_полож_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_111.1.1",               "calculateLine_111_1_1", RcbArray().initialize("Прибыль_пред_лет","Прибыль_прошл_года","Строка_106.1.1_прошл_года","Строка_106.1.1_пред_лет","Строка_111.1.1_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_111.1.2",               "calculateLine_111_1_2", RcbArray().initialize("Строка_111.1.2_полож_ввод","Строка_111.1.2_отриц_ввод","Прибыль_пред_лет","Прибыль_прошл_года","Строка_106.1.2_прошл_года","Строка_106.1.2_пред_лет")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_111.1.2_нереал_полож",  "calculateLine_111_1_2NotImplPositive", RcbArray().initialize("Строка_111.1.2_полож_ввод","Прибыль_пред_лет","Прибыль_прошл_года","Строка_106.1.2_нереал_полож_прошл_года","Строка_106.1.2_нереал_полож_пред_лет")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_111.1.2_нереал_отриц",  "calculateLine_111_1_2NotImplNegative", RcbArray().initialize("Строка_111.1.2_отриц_ввод","Прибыль_пред_лет","Прибыль_прошл_года","Строка_106.1.2_нереал_отриц_прошл_года","Строка_106.1.2_нереал_отриц_пред_лет")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112_данные",            "calculateLine_112_data", RcbArray().initialize("Строка_112.2_данные","Строка_112_52303_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112",                   "calculateLine_112", RcbArray().initialize("Строка_112_данные", "Строка_104")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112_52303_ввод",        "processUserAttribute", RcbArray()));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112.2_данные",          "calculateLine_112_2data", RcbArray().initialize("Строка_112.2.1_данные", "Строка_112.2.2_нереал_отриц_данные","Строка_112.2.2_нереал_полож_данные")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112.2",                 "calculateLine_112_2", RcbArray().initialize("Строка_112.2.1_ввод","Строка_112.2.2_отриц_ввод", "Строка_112.2.2_полож_ввод","Строка_112","Строка_112.2_данные")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112.2.1_данные_Сумма1", "calculateLine_112_2_1dataSum1", RcbArray().initialize("Док_подтв_суммы_70614_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112.2.1_данные_Сумма2", "calculateLine_112_2_1dataSum2", RcbArray().initialize("Док_подтв_суммы_70613_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112.2.1_данные",        "calculateLine_112_2_1data", RcbArray().initialize("Строка_112.2.1_данные_Сумма1","Строка_112.2.1_данные_Сумма2")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112.2.1",               "calculateLine_112_2_1", RcbArray().initialize("Строка_112.2.1_ввод", "Строка_112", "Строка_112.2.1_данные")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112.2.2_данные",        "calculateLine_112_2_2data", RcbArray().initialize("Строка_112.2.2_нереал_полож_данные", "Строка_112.2.2_нереал_отриц_данные")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112.2.2",               "calculateLine_112_2_2", RcbArray().initialize("Строка_112.2.2_полож_ввод","Строка_112.2.2_отриц_ввод","Строка_112","Строка_112.2.2_данные")));


        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112.2.2_нереал_полож_данные_Сумма1", "calculateLine_112_2NotImplPositiveDataSum1", RcbArray().initialize("70613_нер_корр_ввод","Строка_112.2.1_данные_Сумма1")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112.2.2_нереал_полож_данные_Сумма2", "calculateLine_112_2NotImplPositiveDataSum2", RcbArray().initialize("70614_нер_корр_ввод","Строка_112.2.1_данные_Сумма2")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112.2.2_нереал_полож_данные",        "calculateLine_112_2NotImplPositiveData", RcbArray().initialize("Строка_112.2.2_нереал_полож_данные_Сумма1","Строка_112.2.2_нереал_полож_данные_Сумма2")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112.2.2_нереал_полож",               "calculateLine_112_2NotImplPositive", RcbArray().initialize("Строка_112.2.2_полож_ввод","Строка_112","Строка_112.2.2_нереал_полож_данные")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112.2.2_нереал_отриц_данные",        "calculateLine_112_2NotImplNegativeData", RcbArray().initialize("Строка_112.2.1_данные_Сумма2","Строка_112.2.1_данные_Сумма1")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112.2.2_нереал_отриц",               "calculateLine_112_2NotImplNegative", RcbArray().initialize("Строка_112.2.2_отриц_ввод","Строка_112.2.2_нереал_отриц_данные","Строка_112")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112_1_данные",          "calculateLine_112RevaluationData", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112.1",                 "calculateLine_112Revaluation", RcbArray().initialize("Строка_112_1_данные", "Строка_104.1_переоценка")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_113",                   "calculateLine_113", RcbArray().initialize("Строка_113_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_113_ввод",              "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_114",                   "calculateLine_114", RcbArray().initialize("Строка_104_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_104_ввод",              "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_115",                   "calculateLine_115", RcbArray().initialize("Строка_209_минус_208")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_116",                   "calculateLineMain", RcbArray().initialize("Строка_208")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_201",                   "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_202",                   "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203_данные",            "calculateLine_203_data", RcbArray().initialize("Строка_203.2_данные","Строка_112_52303_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203",                   "calculateLine_203", RcbArray().initialize("Строка_203_данные","Строка_104")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203_переоценка_данные", "calculateLine_203RevaluationData", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203.1",                 "calculateLine_203Revaluation", RcbArray().initialize("Строка_203_переоценка_данные","Строка_104.1_переоценка")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203.2_данные",          "calculateLine_203_2data", RcbArray().initialize("Строка_203.2.1_данные", "Строка_203.2.2_нереал_полож_данные","Строка_203.2.2_нереал_отриц_данные")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203.2",                 "calculateLine_203_2", RcbArray().initialize("Строка_203.2.1_ввод", "Строка_203.2.2_полож_ввод","Строка_203.2.2_отриц_ввод","Строка_203","Строка_203.2_данные")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203.2.1_данные_Сумма1",        "calculateLine_203_2_1DataSum1", RcbArray().initialize("Строка_203.2.1_док_суммы_70613_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203.2.1_данные_Сумма2",        "calculateLine_203_2_1DataSum2", RcbArray().initialize("Строка_203.2.1_док_суммы_70614_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203.2.1_данные",               "calculateLine_203_2_1Data", RcbArray().initialize("Строка_203.2.1_данные_Сумма1","Строка_203.2.1_данные_Сумма2")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203.2.1_док_суммы_70613_ввод", "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203.2.1_док_суммы_70614_ввод", "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203.2.1",                      "calculateLine_203_2_1", RcbArray().initialize("Строка_203.2.1_ввод","Строка_203","Строка_203.2.1_данные")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203.2.2_данные",               "calculateLine_203_2_2data", RcbArray().initialize("Строка_203.2.2_нереал_полож_данные","Строка_203.2.2_нереал_отриц_данные")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203.2.2",                      "calculateLine_203_2_2", RcbArray().initialize("Строка_203.2.2_полож_ввод","Строка_203.2.2_отриц_ввод","Строка_203","Строка_203.2.2_данные")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203.2.2_нереал_полож_данные_Сумма1", "calculateLine_203_2_2NotImplPositiveDataSum1", RcbArray().initialize("Строка_203.2.2_70613_нер_корр_ввод","Строка_203.2.1_данные_Сумма1")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203.2.2_нереал_полож_данные_Сумма2", "calculateLine_203_2_2NotImplPositiveDataSum2", RcbArray().initialize("Строка_203.2.2_70614_нер_корр_ввод","Строка_203.2.1_данные_Сумма2")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203.2.2_нереал_полож_данные",        "calculateLine_203_2_2NotImplPositiveData", RcbArray().initialize("Строка_203.2.2_нереал_полож_данные_Сумма1","Строка_203.2.2_нереал_полож_данные_Сумма2")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203.2.2_70613_нер_корр_ввод",  "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203.2.2_70614_нер_корр_ввод",  "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203.2.2_нереал_полож",         "calculateLine_203_2_2NotImplPositive", RcbArray().initialize("Строка_203.2.2_полож_ввод","Строка_203","Строка_203.2.2_нереал_полож_данные")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203.2.2_нереал_отриц_данные",  "calculateLine_203_2_2NotImplNegativeData", RcbArray().initialize("Строка_203.2.2_нереал_полож_данные_Сумма2","Строка_203.2.2_нереал_полож_данные_Сумма1")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203.2.2_нереал_отриц",         "calculateLine_203_2_2NotImplNegative", RcbArray().initialize("Строка_203.2.2_отриц_ввод","Строка_203.2.2_нереал_отриц_данные","Строка_203")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_204_данные",           "calculateLine_204_data", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_204_данные10лет",      "calculateLine_204_data10Years", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_204",                  "calculateLine_204", RcbArray().initialize("Строка_208")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_204.1",                "calculateLine_204_1", RcbArray().initialize("Строка_204_данные","Строка_116")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_204.2",                "calculateLine_204_2", RcbArray().initialize("Строка_204_данные10лет","Строка_116","Строка_204.1")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_205",                  "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_206",                  "calculateLine_206", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_207",                  "calculateLine_207", RcbArray().initialize("Прибыль_пред_лет","Строка_106","Прибыль_прошл_года")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_207.1",                "calculateLine_207_1", RcbArray().initialize("Прибыль_пред_лет","Прибыль_прошл_года","Строка_106.1_пред_лет","Строка_106.1","Строка_106.1_прошл_года")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_207.1.1",              "calculateLine_207_1_1", RcbArray().initialize("Прибыль_пред_лет","Прибыль_прошл_года","Строка_106.1.1_пред_лет","Строка_106.1.1","Строка_106.1.1_прошл_года")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_207.1.2",              "calculateLine_207_1_2", RcbArray().initialize("Прибыль_пред_лет","Прибыль_прошл_года","Строка_106.1.2_пред_лет","Строка_106.1.2","Строка_106.1.2_прошл_года")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_207.1.2_нереал_полож", "calculateLine_207_1_2NotImplPositive", RcbArray().initialize("Прибыль_пред_лет","Строка_106.1.2_нереал_полож_пред_лет","Строка_106.1.2_нереал_полож","Прибыль_прошл_года","Строка_106.1.2_нереал_полож_прошл_года")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_207.1.2_нереал_отриц", "calculateLine_207_1_2NotImplNegative", RcbArray().initialize("Прибыль_пред_лет","Прибыль_прошл_года","Строка_106.1.2_нереал_отриц_пред_лет","Строка_106.1.2_нереал_отриц","Строка_106.1.2_нереал_отриц_прошл_года")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_208",                  "calculateLine_208", RcbArray().initialize("Строка_208_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_208_ввод",             "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_209_минус_208",        "calculateLineRealAdditional", RcbArray().initialize("Строка_201", "Строка_202", "Строка_203", "Строка_204", "Строка_205", "Строка_206", "Строка_207","Строка_208")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_210",                  "calculateLineReal", RcbArray().initialize("Строка_116","Строка_209_минус_208","Строка_201", "Строка_202", "Строка_203", "Строка_205", "Строка_206", "Строка_207","Строка_208","Строка_204_данные","Строка_204_данные10лет")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_301",                  "calculateLine_301", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_302",                  "calculateLine_302", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_400",                  "calculateLineSubTotal", RcbArray().initialize("Строка_116","Строка_210","Строка_301","Строка_302")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_501",                  "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_502_Имущество",        "calculateLine_502_assets", RcbArray().initialize("Строка_502_Имущество_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_502_ОснДоп",           "calculateLine_502_MainAdditional", RcbArray().initialize("Строка_116", "Строка_202", "Строка_203", "Строка_205", "Строка_206", "Строка_207", "Строка_208")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_502",                  "calculateLine_502", RcbArray().initialize("Строка_502_ОснДоп","Строка_502_Имущество")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_502_Имущество_ввод",   "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_503",                  "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_104.2.1_ввод",         "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_104.2.2_полож_ввод",   "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_104.2.2_отриц_ввод",   "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1.1_ввод",         "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1.2_полож_ввод",   "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1.2_отриц_ввод",   "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_111.1.1_ввод",         "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_111.1.2_полож_ввод",   "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_111.1.2_отриц_ввод",   "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112.2.1_ввод",         "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112.2.2_полож_ввод",   "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112.2.2_отриц_ввод",   "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203.2.1_ввод",         "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203.2.2_полож_ввод",   "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203.2.2_отриц_ввод",   "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_207.1.1_ввод",         "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_207.1.2_полож_ввод",   "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_207.1.2_отриц_ввод",   "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Недосозд_резерв_всего",       "calculateReserveShortfall", RcbArray().initialize("Недосозд_резерв_254П_ввод","Недосозд_резерв_283П_ввод","Недосозд_резерв_1584У_ввод","Недосозд_резерв_2732У_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Недосозд_резерв_254П_ввод",   "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Недосозд_резерв_283П_ввод",   "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Недосозд_резерв_1584У_ввод",  "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Недосозд_резерв_2732У_ввод",  "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_недосозд_рез_ввод",    "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_000",                  "calculateLine_000", RcbArray().initialize("Строка_400","Строка_501", "Строка_502", "Строка_503")));
    end;
end;

class (F134Part1CalculateController) F134Part1CalculateControllerF134_14_Pak(reportCalculateController : Object /*TReportCalculateController*/)
    initF134Part1CalculateController(reportCalculateController);

    macro calculateLine_115(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if ((m_part.getAttribute("Строка_208").getValue() > 0) and
            (m_part.getAttribute("Строка_209_минус_208").getValue() < 0))
            setValueAttributes(attribute,
                               RcbArray(),
                               RcbArray().initialize("Строка_209_минус_208"));
        else
            m_protocolView.PrintLine("Значение Строка_209_минус_208 > 0");
            setValue(attribute, $0.0);
        end;
    end;

    macro calculateLine_204_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var sumLine204data = m_part.getAttribute("Строка_204_данные").getValue();
        var sumLine116 = m_part.getAttribute("Строка_116").getValue();

        m_protocolView.printLine("Значение переменной равно min(Строка_204_данные(" + sumLine204data + "), 0.5*Строка_116(" + sumLine116 + "))");
        if (sumLine116 > 0)
            setValue(attribute, min(sumLine204data,0.5 * sumLine116));
        else
            setValue(attribute, $0.0);
        end;
    end;

    macro calculateLine_204_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var sumLine204data10years = m_part.getAttribute("Строка_204_данные10лет").getValue();
        var sumLine116 = m_part.getAttribute("Строка_116").getValue();
        var sumLine204_1 = m_part.getAttribute("Строка_204.1").getValue();

        if (sumLine116 > 0)
            if ((sumLine116 - sumLine204_1) > sumLine204data10years)
                m_protocolView.printLine("Строка_116(" + sumLine116 + ") - Строка_204.1(" + sumLine204_1 + ") > Строка_204_данные10лет(" + sumLine204data10years + ")");
                setValue(attribute, sumLine204data10years);
            elif ((sumLine116 - sumLine204_1) < sumLine204data10years)
                m_protocolView.printLine("Строка_116(" + sumLine116 + ") - Строка_204.1(" + sumLine204_1 + ") < Строка_204_данные10лет(" + sumLine204data10years + ")");
                m_protocolView.printLine("Строка_116(" + sumLine116 + ") - Строка_204.1(" + sumLine204_1 + ") = " + String(sumLine116 - sumLine204_1));
                setValue(attribute, sumLine116 - sumLine204_1);
            else
                m_protocolView.printLine("Строка_116(" + sumLine116 + ") - Строка_204.1(" + sumLine204_1 + ") = Строка_204_данные10лет(" + sumLine204data10years + ")");
                setValue(attribute, $0.0);
            end;
        else
            m_protocolView.printLine("Строка_116(" + sumLine116 + ") - Строка_204.1(" + sumLine204_1 + ") = Строка_204_данные10лет(" + sumLine204data10years + ")");
            setValue(attribute, $0.0);
        end;
    end;

    macro calculateLine_204(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (m_part.getAttribute("Строка_208").getValue() > 0)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_204_данные", "Строка_204_данные10лет"),
                               RcbArray());

        else
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_204.1", "Строка_204.2"),
                               RcbArray());
        end;
    end;

    macro calculateLineRealAdditional_201_207(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("Строка_201", "Строка_202", "Строка_203", "Строка_204", "Строка_205", "Строка_206", "Строка_207"),
                           RcbArray());
    end;

    macro calculateLineRealAdditional(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("Строка_209"),
                           RcbArray().initialize("Строка_208"));
    end;

    macro execute()
        execute();
        m_reportCalculateController.deleteCalculationAttributeData(m_part.getAttribute("Строка_209_минус_208"));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_209_минус_208",          "calculateLineRealAdditional", RcbArray().initialize("Строка_209", "Строка_208")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_209",  "calculateLineRealAdditional_201_207", RcbArray().initialize("Строка_201", "Строка_202", "Строка_203", "Строка_204", "Строка_205", "Строка_206", "Строка_207")));
    end;
end;

/**
 * Класс окончательного расчета отчета
 */
class (F134PartCalculateController) F134Part1FinalCalculateController(reportCalculateController : Object /*TReportCalculateController*/, part1CalculateController : F134Part1CalculateController)
    initF134PartCalculateController(reportCalculateController, "1");

    private var m_part1CalculateController = part1CalculateController;

    macro processCalculatedAttribute(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        m_protocolView.printLine("Атрибут рассчитанный на этапе предварительного расчета: " + attribute.getId());

        if (attribute.getValue() == null)
            m_protocolView.printLine("\nЗначение не заданно, полагаем равным нулю");

            attribute.setValue($0.0);
        end;

        m_protocolView.printLine("\n" + attribute.getId + " = " + attribute.getValue());
    end;

    macro calculateLine_104_data(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "104")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray(),
                               RcbArray().initialize("Строка_104.3"));
        end;
    end;

    macro calculateLine_104(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "104")
            printAttributeHead(attributeId);

            var sum = m_part.getAttribute("Строка_104_данные").getValue();

            if (sum >= 0)
                m_protocolView.PrintLine("Строка_104_данные (" + sum + ") >= 0");
                setValue(attribute, sum);
            else
                m_protocolView.PrintLine("Строка_104_данные (" + sum + ") < 0");
                setValue(attribute, $0.0);
            end;
//            setValueAttributes(attribute,
//                               RcbArray().initialize("Строка_104_данные"),
//                               RcbArray(),
//                               true);
        end;
    end;

    macro calculateLine_104_3(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "104")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_всего"),
                               RcbArray());
        end;
    end;

    macro calculateLine_104_3_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "104")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_254П_ввод"),
                               RcbArray());
        end;
    end;

    macro calculateLine_104_3_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "104")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_283П_ввод"),
                               RcbArray());
        end;
    end;

    macro calculateLine_104_3_3(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "104")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_1584У_ввод"),
                               RcbArray());
        end;
    end;

    macro calculateLine_104_3_4(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "104")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_2732У_ввод"),
                               RcbArray());
        end;
    end;

    macro calculateLinePriviousProfit(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(),"106","111","207"))
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_всего"),
                               RcbArray()
                               );
        end;
    end;

    macro calculateLinePriviousYearProfit(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(),"106","111","207"))
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_всего"),
                               RcbArray());
        end;
    end;

    macro calculateLine_106(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(),"106","111"))
            attribute.setValue($0.0);

            m_part1CalculateController.calculateLine_106(attributeId);
        end;
    end;

    macro calculateLine_106_1_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(),"106","111","207"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateLine_106_1_1(attributeId);
        end;
    end;

    macro calculateLine_106_1_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(),"106","111","207"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateLine_106_1_2(attributeId);
        end;
    end;

    macro calculateLine_106_1_2NotImplPositive(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(),"106","111","207"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateLine_106_1_2NotImplPositive(attributeId);
        end;
    end;

    macro calculateLine_106_1_2NotImplNegative(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(),"106","111","207"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateLine_106_1_2NotImplNegative(attributeId);
        end;
    end;

    macro calculateLine_106_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "106")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_всего"),
                               RcbArray(),
                               true);
        end;
    end;

    macro calculateLine_106_2_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "106")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_254П_ввод"),
                               RcbArray(),
                               true);
        end;
    end;

    macro calculateLine_106_2_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "106")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_283П_ввод"),
                               RcbArray(),
                               true);
        end;
    end;

    macro calculateLine_106_2_3(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "106")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_1584У_ввод"),
                               RcbArray(),
                               true);
        end;
    end;

    macro calculateLine_106_2_4(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "106")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_2732У_ввод"),
                               RcbArray(),
                               true);
        end;
    end;

    macro calculateLine_107(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(),"104", "106", "111", "112", "203", "207"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateLine_107(attributeId);
        end;
    end;

    macro calculateLineMainReal(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(),"104", "106", "111", "112", "203", "207"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateLineMainReal(attributeId);
        end;
    end;

    macro calculateLine_111(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(),"106", "111"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateLine_111(attributeId);
        end;
    end;

    macro calculateLine_111_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(),"106", "111"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateLine_111_1(attributeId);
        end;
    end;

    macro calculateLine_111_1_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(),"106", "111"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateLine_111_1_1(attributeId);
        end;
    end;

    macro calculateLine_111_1_2NotImplPositive(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(),"106", "111"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateLine_111_1_2NotImplPositive(attributeId);
        end;
    end;

    macro calculateLine_111_1_2NotImplNegative(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(),"106", "111"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateLine_111_1_2NotImplNegative(attributeId);
        end;
    end;

    macro calculateLine_111_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "111")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_всего"),
                               RcbArray(),
                               true);
        end;
    end;

    macro calculateLine_111_2_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "111")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_254П_ввод"),
                               RcbArray(),
                               true);
        end;
    end;

    macro calculateLine_111_2_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "111")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_283П_ввод"),
                               RcbArray(),
                               true);
        end;
    end;

    macro calculateLine_111_2_3(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "111")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_1584У_ввод"),
                               RcbArray(),
                               true);
        end;
    end;

    macro calculateLine_111_2_4(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "111")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_2732У_ввод"),
                               RcbArray(),
                               true);
        end;
    end;

    macro calculateLine_112_data(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(),"104","112"))
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_112.3"),
                               RcbArray());
        end;
    end;

    macro calculateLine_112(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(),"104","112"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateLine_112(attributeId);
        end;
    end;

    macro calculateLine_112_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(),"104","112"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateLine_112_2(attributeId);
        end;
    end;

    macro calculateLine_112_2_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(),"104","112"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateLine_112_2_1(attributeId);
        end;
    end;

    macro calculateLine_112_2_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(),"104","112"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateLine_112_2_2(attributeId);
        end;
    end;

    macro calculateLine_112_2NotImplPositive(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(),"104","112"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateLine_112_2NotImplPositive(attributeId);
        end;
    end;

    macro calculateLine_112_2NotImplNegative(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(),"104","112"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateLine_112_2NotImplNegative(attributeId);
        end;
    end;

    macro calculateLine_112_3(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "112")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_всего"),
                               RcbArray(),
                               true);
        end;
    end;

    macro calculateLine_112_3_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "112")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_254П_ввод"),
                               RcbArray(),
                               true);
        end;
    end;

    macro calculateLine_112_3_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "112")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_283П_ввод"),
                               RcbArray(),
                               true);
        end;
    end;

    macro calculateLine_112_3_3(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "112")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_1584У_ввод"),
                               RcbArray(),
                               true);
        end;
    end;

    macro calculateLine_112_3_4(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "112")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_2732У_ввод"),
                               RcbArray(),
                               true);
        end;
    end;

    macro calculateLine_112Revaluation(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(), "112"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateLine_112Revaluation(attributeId);
        end;
    end;

    macro calculateLine_115(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(), "203", "207"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateLine_115(attributeId);
        end;
    end;

    macro calculateLineMain(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(), "104", "106", "111", "112", "203", "207"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateLineMain(attributeId);
        end;
    end;

    macro calculateLine_203_data(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "203")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_всего"),
                               RcbArray());
        end;
    end;

    macro calculateLine_203(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(), "104", "203"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateLine_203(attributeId);
        end;
    end;

    macro calculateLine_203Revaluation(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(), "104", "203"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateLine_203Revaluation(attributeId);
        end;
    end;

    macro calculateLine_203_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(), "104", "203"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateLine_203_2(attributeId);
        end;
    end;

    macro calculateLine_203_2_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(), "104", "203"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateLine_203_2_1(attributeId);
        end;
    end;

    macro calculateLine_203_2_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(), "104", "203"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateLine_203_2_2(attributeId);
        end;
    end;

    macro calculateLine_203_2_2NotImplPositive(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(), "104", "203"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateLine_203_2_2NotImplPositive(attributeId);
        end;
    end;

    macro calculateLine_203_2_2NotImplNegative(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(), "104", "203"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateLine_203_2_2NotImplNegative(attributeId);
        end;
    end;

    macro calculateLine_203_3(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "203")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_всего"),
                               RcbArray(),
                               true);
        end;
    end;

    macro calculateLine_203_3_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "203")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_254П_ввод"),
                               RcbArray(),
                               true);
        end;
    end;

    macro calculateLine_203_3_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "203")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_283П_ввод"),
                               RcbArray(),
                               true);
        end;
    end;

    macro calculateLine_203_3_3(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "203")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_1584У_ввод"),
                               RcbArray(),
                               true);
        end;
    end;

    macro calculateLine_203_3_4(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "203")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_2732У_ввод"),
                               RcbArray(),
                               true);
        end;
    end;

    macro calculateLine_204_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(), "104", "106", "111", "112", "203", "207"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateLine_204_1(attributeId);
        end;
    end;

    macro calculateLine_204_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(), "104", "106", "111", "112", "203", "207"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateLine_204_2(attributeId);
        end;
    end;

    macro calculateLine_207(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(), "106", "207"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateLine_207(attributeId);
        end;
    end;

    macro calculateLine_207_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(), "106", "207"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateLine_207_1(attributeId);
        end;
    end;


    macro calculateLine_207_1_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(), "106", "207"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateLine_207_1_1(attributeId);
        end;
    end;


    macro calculateLine_207_1_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(), "106", "207"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateLine_207_1_2(attributeId);
        end;
    end;


    macro calculateLine_207_1_2NotImplPositive(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(), "106", "207"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateLine_207_1_2NotImplPositive(attributeId);
        end;
    end;


    macro calculateLine_207_1_2NotImplNegative(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(), "106", "207"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateLine_207_1_2NotImplNegative(attributeId);
        end;
    end;

    macro calculateLine_207_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "207")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_всего"),
                               RcbArray(),
                               true);
        end;
    end;

    macro calculateLine_207_2_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "207")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_254П_ввод"),
                               RcbArray(),
                               true);
        end;
    end;

    macro calculateLine_207_2_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "207")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_283П_ввод"),
                               RcbArray(),
                               true);
        end;
    end;

    macro calculateLine_207_2_3(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "207")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_1584У_ввод"),
                               RcbArray(),
                               true);
        end;
    end;

    macro calculateLine_207_2_4(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "207")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_2732У_ввод"),
                               RcbArray(),
                               true);
        end;
    end;

    macro calculateLineRealAdditional(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(), "203", "207"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateLineRealAdditional(attributeId);
        end;
    end;

    macro calculateLineReal(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(), "104", "106", "111", "112", "203", "207"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateLineReal(attributeId);
        end;
    end;

    macro calculateReserveShortfall(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        attribute.setValue($0.0);

        m_part1CalculateController.calculateReserveShortfall(attributeId);

        if (m_part.getAttribute(attributeId).getValue() == $0.0)
            msgBox("Общая сумма недосозданного резерва равна нулю." + "|" + " Окончательный расчет завершен");
            установитьФлагВозврата(STOP_PROC_FLG);
            exit(1);
        end;
    end;

    macro calculateLineSubTotal(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(), "104", "106", "111", "112", "203", "207"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateLineSubTotal(attributeId);
        end;
    end;

    macro calculateLine_502_MainAdditional(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(), "104", "106", "111", "112", "203", "207"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateLine_502_MainAdditional(attributeId);
        end;
    end;

    macro calculateReserveShortfallStringInput(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        m_protocolView.printLine("Атрибут пользователького ввода: " + attribute.getId());

        m_protocolView.printLine("\n" + attribute.getId + " = " + attribute.getValue());

        if (not in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(), "104", "106", "111", "112", "203", "207"))
            msgBox("Номер строки, в которой должен отражаться ", "|",
                    "недосозданный резерв, введен неверно.", "|",
                    "Введите одно из значений:", "|",
                    "104, 106, 111, 112, 203, 207, ", "|",
                    "и повторите операцию 'Окончательный расчет'.");
            установитьФлагВозврата(STOP_PROC_FLG);
            exit(1);
        end;
    end;

    macro execute()

        println("Недосозд_резерв_всего          " + m_part.getAttribute("Недосозд_резерв_всего").getValue());
        println("Недосозд_резерв_283П_ввод      " + m_part.getAttribute("Недосозд_резерв_283П_ввод").getValue());
        println("Недосозд_резерв_1584У_ввод     " + m_part.getAttribute("Недосозд_резерв_1584У_ввод").getValue());
        println("Недосозд_резерв_2732У_ввод     " + m_part.getAttribute("Недосозд_резерв_2732У_ввод").getValue());
        println("Строка_недосозд_рез_ввод       " + m_part.getAttribute("Строка_недосозд_рез_ввод").getValue());
        println();
        println();

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_недосозд_рез_ввод", "calculateReserveShortfallStringInput", RcbArray().initialize("Недосозд_резерв_всего")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_104_данные", "calculateLine_104_data", RcbArray().initialize("Строка_недосозд_рез_ввод","Строка_104.3")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_104",       "calculateLine_104", RcbArray().initialize("Строка_недосозд_рез_ввод","Строка_104_данные")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_104.3",         "calculateLine_104_3", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_всего")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_104.3.1",       "calculateLine_104_3_1", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_254П_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_104.3.2",       "calculateLine_104_3_2", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_283П_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_104.3.3",       "calculateLine_104_3_3", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_1584У_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_104.3.4",       "calculateLine_104_3_4", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_2732У_ввод")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Прибыль_пред_лет",   "calculateLinePriviousProfit", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_всего")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Прибыль_прошл_года", "calculateLinePriviousYearProfit", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_всего")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106",              "calculateLine_106", RcbArray().initialize("Прибыль_пред_лет", "Прибыль_прошл_года")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1.1",            "calculateLine_106_1_1", RcbArray().initialize("Строка_106.1.1_ввод","Прибыль_пред_лет","Строка_106.1.1_пред_лет","Строка_106.1.1_прошл_года")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1.2",            "calculateLine_106_1_2", RcbArray().initialize("Строка_106.1.2_полож_ввод","Строка_106.1.2_отриц_ввод","Прибыль_пред_лет","Строка_106.1.2_прошл_года","Строка_106.1.2_пред_лет")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1.2_нереал_полож",  "calculateLine_106_1_2NotImplPositive", RcbArray().initialize("Прибыль_пред_лет","Строка_106.1.2_нереал_полож_пред_лет","Строка_106.1.2_нереал_полож_прошл_года")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1.2_нереал_отриц",  "calculateLine_106_1_2NotImplNegative", RcbArray().initialize("Прибыль_пред_лет","Строка_106.1.2_нереал_отриц_пред_лет","Строка_106.1.2_нереал_отриц_прошл_года")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.2",   "calculateLine_106_2", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_всего")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.2.1", "calculateLine_106_2_1", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_254П_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.2.2", "calculateLine_106_2_2", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_283П_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.2.3", "calculateLine_106_2_3", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_1584У_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.2.4", "calculateLine_106_2_4", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_2732У_ввод")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_107", "calculateLine_107", RcbArray().initialize("Строка_101","Строка_102","Строка_103","Строка_104","Строка_105","Строка_106","Строка_109","Строка_110","Строка_111","Строка_112","Строка_113","Строка_114","Строка_115","Строка_107_данные")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_108", "calculateLineMainReal", RcbArray().initialize("Строка_101","Строка_102","Строка_103","Строка_104","Строка_105","Строка_106", "Строка_107")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_111",  "calculateLine_111", RcbArray().initialize("Прибыль_пред_лет","Прибыль_прошл_года")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_111.1", "calculateLine_111_1", RcbArray().initialize("Прибыль_пред_лет","Прибыль_прошл_года","Строка_106.1_прошл_года","Строка_106.1_пред_лет","Строка_111.1.1_ввод", "Строка_111.1.2_отриц_ввод","Строка_111.1.2_полож_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_111.1.1", "calculateLine_111_1_1", RcbArray().initialize("Прибыль_пред_лет","Прибыль_прошл_года","Строка_106.1.1_прошл_года","Строка_106.1.1_пред_лет","Строка_111.1.1_ввод")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_111.1.2_нереал_полож", "calculateLine_111_1_2NotImplPositive", RcbArray().initialize("Строка_111.1.2_полож_ввод","Прибыль_пред_лет","Прибыль_прошл_года","Строка_106.1.2_нереал_полож_прошл_года","Строка_106.1.2_нереал_полож_пред_лет")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_111.1.2_нереал_отриц", "calculateLine_111_1_2NotImplNegative", RcbArray().initialize("Строка_111.1.2_отриц_ввод","Прибыль_пред_лет","Прибыль_прошл_года","Строка_106.1.2_нереал_отриц_прошл_года","Строка_106.1.2_нереал_отриц_пред_лет")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_111.2",   "calculateLine_111_2", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_всего")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_111.2.1", "calculateLine_111_2_1", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_254П_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_111.2.2", "calculateLine_111_2_2", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_283П_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_111.2.3", "calculateLine_111_2_3", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_1584У_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_111.2.4", "calculateLine_111_2_4", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_2732У_ввод")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112_данные", "calculateLine_112_data", RcbArray().initialize("Строка_недосозд_рез_ввод", "Строка_112.3")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112",       "calculateLine_112", RcbArray().initialize("Строка_112_данные", "Строка_104")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112.2",      "calculateLine_112_2", RcbArray().initialize("Строка_112.2.1_ввод","Строка_112.2.2_отриц_ввод", "Строка_112.2.2_полож_ввод","Строка_112","Строка_112.2_данные")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112.2.1",    "calculateLine_112_2_1", RcbArray().initialize("Строка_112.2.1_ввод", "Строка_112", "Строка_112.2.1_данные")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112.2.2",    "calculateLine_112_2_2", RcbArray().initialize("Строка_112.2.2_полож_ввод","Строка_112.2.2_отриц_ввод","Строка_112","Строка_112.2.2_данные")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112.2.2_нереал_полож", "calculateLine_112_2NotImplPositive", RcbArray().initialize("Строка_112.2.2_полож_ввод","Строка_112","Строка_112.2.2_нереал_полож_данные")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112.2.2_нереал_отриц", "calculateLine_112_2NotImplNegative", RcbArray().initialize("Строка_112.2.2_отриц_ввод","Строка_112.2.2_нереал_отриц_данные","Строка_112")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112.3",   "calculateLine_112_3", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_всего")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112.3.1", "calculateLine_112_3_1", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_254П_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112.3.2", "calculateLine_112_3_2", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_283П_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112.3.3", "calculateLine_112_3_3", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_1584У_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112.3.4", "calculateLine_112_3_4", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_2732У_ввод")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112.1", "calculateLine_112Revaluation", RcbArray().initialize("Строка_112_1_данные", "Строка_104.1_переоценка")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_115",           "calculateLine_115", RcbArray().initialize("Строка_209_минус_208")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_116",             "calculateLineMain", RcbArray().initialize("Строка_108","Строка_109", "Строка_110", "Строка_111", "Строка_112", "Строка_113", "Строка_114", "Строка_115")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203_данные",       "calculateLine_203_data", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_всего")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203",             "calculateLine_203", RcbArray().initialize("Строка_203_данные","Строка_104")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203.1",   "calculateLine_203Revaluation", RcbArray().initialize("Строка_203_переоценка_данные","Строка_104.1_переоценка")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203.2",          "calculateLine_203_2", RcbArray().initialize("Строка_203.2.1_ввод", "Строка_203.2.2_полож_ввод","Строка_203.2.2_отриц_ввод","Строка_203","Строка_203.2_данные")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203.2.1",        "calculateLine_203_2_1", RcbArray().initialize("Строка_203.2.1_ввод","Строка_203","Строка_203.2.1_данные")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203.2.2",        "calculateLine_203_2_2", RcbArray().initialize("Строка_203.2.2_полож_ввод","Строка_203.2.2_отриц_ввод","Строка_203","Строка_203.2.2_данные")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203.2.2_нереал_полож", "calculateLine_203_2_2NotImplPositive", RcbArray().initialize("Строка_203.2.2_полож_ввод","Строка_203","Строка_203.2.2_нереал_полож_данные")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203.2.2_нереал_отриц", "calculateLine_203_2_2NotImplNegative", RcbArray().initialize("Строка_203.2.2_отриц_ввод","Строка_203.2.2_нереал_отриц_данные","Строка_203")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203.3",   "calculateLine_203_3", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_всего")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203.3.1", "calculateLine_203_3_1", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_254П_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203.3.2", "calculateLine_203_3_2", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_283П_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203.3.3", "calculateLine_203_3_3", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_1584У_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203.3.4", "calculateLine_203_3_4", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_2732У_ввод")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_204.1",   "calculateLine_204_1", RcbArray().initialize("Строка_204_данные","Строка_116")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_204.2",   "calculateLine_204_2", RcbArray().initialize("Строка_204_данные10лет","Строка_116","Строка_204.1")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_207",      "calculateLine_207", RcbArray().initialize("Прибыль_пред_лет","Строка_106","Прибыль_прошл_года")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_207.1",                         "calculateLine_207_1", RcbArray().initialize("Прибыль_пред_лет","Прибыль_прошл_года","Строка_106.1_пред_лет","Строка_106.1","Строка_106.1_прошл_года")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_207.1.1",                       "calculateLine_207_1_1", RcbArray().initialize("Прибыль_пред_лет","Прибыль_прошл_года","Строка_106.1.1_пред_лет","Строка_106.1.1","Строка_106.1.1_прошл_года")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_207.1.2",                       "calculateLine_207_1_2", RcbArray().initialize("Прибыль_пред_лет","Прибыль_прошл_года","Строка_106.1.2_пред_лет","Строка_106.1.2","Строка_106.1.2_прошл_года")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_207.1.2_нереал_полож",          "calculateLine_207_1_2NotImplPositive", RcbArray().initialize("Прибыль_пред_лет","Строка_106.1.2_нереал_полож_пред_лет","Строка_106.1.2_нереал_полож","Прибыль_прошл_года","Строка_106.1.2_нереал_полож_прошл_года")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_207.1.2_нереал_отриц",          "calculateLine_207_1_2NotImplNegative", RcbArray().initialize("Прибыль_пред_лет","Прибыль_прошл_года","Строка_106.1.2_нереал_отриц_пред_лет","Строка_106.1.2_нереал_отриц","Строка_106.1.2_нереал_отриц_прошл_года")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_207.2",   "calculateLine_207_2", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_всего")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_207.2.1", "calculateLine_207_2_1", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_254П_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_207.2.2", "calculateLine_207_2_2", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_283П_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_207.2.3", "calculateLine_207_2_3", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_1584У_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_207.2.4", "calculateLine_207_2_4", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_2732У_ввод")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_209_минус_208",     "calculateLineRealAdditional", RcbArray().initialize("Строка_201", "Строка_202", "Строка_203", "Строка_204", "Строка_205", "Строка_206", "Строка_207","Строка_208")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_210",        "calculateLineReal", RcbArray().initialize("Строка_116","Строка_209_минус_208","Строка_201", "Строка_202", "Строка_203", "Строка_205", "Строка_206", "Строка_207","Строка_208","Строка_204_данные","Строка_204_данные10лет")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_400",       "calculateLineSubTotal", RcbArray().initialize("Строка_116","Строка_210","Строка_301","Строка_302")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_502_ОснДоп", "calculateLine_502_MainAdditional", RcbArray().initialize("Строка_116", "Строка_202", "Строка_203", "Строка_205", "Строка_206", "Строка_207", "Строка_208")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Недосозд_резерв_всего",             "calculateReserveShortfall", RcbArray().initialize("Недосозд_резерв_254П_ввод","Недосозд_резерв_283П_ввод","Недосозд_резерв_1584У_ввод","Недосозд_резерв_2732У_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Недосозд_резерв_254П_ввод", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Недосозд_резерв_283П_ввод", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Недосозд_резерв_1584У_ввод", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Недосозд_резерв_2732У_ввод", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1.1_ввод", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1.1_пред_лет", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1.1_прошл_года", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1.2_полож_ввод", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1.2_отриц_ввод", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1.2_прошл_года", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1.2_пред_лет", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1.2_нереал_полож_пред_лет", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1.2_нереал_полож_прошл_года", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1.2_нереал_отриц_пред_лет", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1.2_нереал_отриц_прошл_года", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_101", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_102", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_103", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_105", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_109", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_110", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_113", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_114", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_201", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_202", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_204", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_205", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_206", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_208", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_107_данные", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1_прошл_года", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1_пред_лет", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_111.1.1_ввод", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_111.1.2_отриц_ввод", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_111.1.2_полож_ввод", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112.2.1_ввод", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112.2.2_отриц_ввод", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112.2.2_полож_ввод", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112.2_данные", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112.2.1_данные", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112.2.2_данные", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112.2.2_нереал_полож_данные", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112.2.2_нереал_отриц_данные", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112_1_данные", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_104.1_переоценка", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203_переоценка_данные", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203.2.1_ввод", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203.2.2_полож_ввод", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203.2.2_отриц_ввод", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203.2_данные", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203.2.1_данные", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203.2.2_данные", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203.2.2_нереал_полож_данные", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203.2.2_нереал_отриц_данные", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_204_данные", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_204_данные10лет", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_301", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_302", "processCalculatedAttribute", RcbArray()));
    end;
end;

class (F134Part1FinalCalculateController) F134Part1FinalCalculateControllerF134_14_Pak(reportCalculateController : Object /*TReportCalculateController*/, part1CalculateController : F134Part1CalculateController)
    initF134Part1FinalCalculateController(reportCalculateController, part1CalculateController);

    macro calculateLineRealAdditional_201_207(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(), "203", "207"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateLineRealAdditional_201_207(attributeId);
        end;
    end;

    macro execute()
        execute();
        m_reportCalculateController.deleteCalculationAttributeData(m_part.getAttribute("Строка_209_минус_208"));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_209_минус_208",          "calculateLineRealAdditional", RcbArray().initialize("Строка_209", "Строка_208")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_209",  "calculateLineRealAdditional_201_207", RcbArray().initialize("Строка_201", "Строка_202", "Строка_203", "Строка_204", "Строка_205", "Строка_206", "Строка_207")));


    end;
end;
