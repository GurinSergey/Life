/*
$Name:          calc_ffor.mac
$Module:        Регламентируемая отчетность
$Description:   ФОР. Интерфейс операций расчета
*/
// @desc: макрос расчёта ФОР с предварительным кэшированием java-нормализатора
import "import.mac";
import rsexts; // 2012-11-01 zip_z.

private macro calculate()
    var m_java_cache = CreateObject ("rsjvm", "TJavaHost", "GlobalJavaHost"); // 2012-11-01 zip_z.
    if (ValType(global.form) != V_UNDEF)
        global.form.calculate();
    end;
    установитьФлагВозврата( OK_MACRO_FLAG);
    m_java_cache.DisposeAllJavaObjects (true); // 2012-11-01 zip_z.
    exit(1);
end;

private macro recalculateItogValues()
    global.form.recalculateItogValues();
    установитьФлагВозврата( OK_MACRO_FLAG);
    exit(1);
end;

private macro controlBeforeSummation()
    global.form.controlBeforeSummation();
    установитьФлагВозврата( OK_MACRO_FLAG);
    exit(1);
end;