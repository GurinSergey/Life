/*****************************************************************************/
/*  Форма 251                                                                */
/*  Коркин Иван                                                              */
/*  25.10.2010                                                               */
/*  Реализовано по заявке А53261.                                            */
/*  по форме 0409251.                                                        */
/*      Вихров                                                               */
/* 23.06.2011 vihrov много разных ТЗ, последнее ТЗ_Ф251_V6_0611.xls          */
/*                                                                           */
/* общая                                                                     */
/*                                                                           */
/*   19.04.2012                                                              */
/* версия с уточнениями от Бриткиной Т.В.                                    */
/* 20.01.2014 Гуцу Е. Адаптация под 2031: миллион упоминаний darhdoc_dbt 
              заменён на dacctrn_dbt, а также daccount$_dbt, darhdoc$_dbt и  
              многое другое.                                                 */
/* 08.10.2014 GSP C-33991 удалены строки 2.1.6.2, 2.1.6.2.1, 2.2.6.2,        */
/*                                       2.2.6.2.1, 2.3.6.2, 2.3.6.2.1       */
/* 26.11.2014 GSP C-34616 доп. условие в отборе данных по стр. 2.1.6 и 2.2.6 */
/*****************************************************************************/

import rsbdataset, bankinter, globals, календарь, TAssocArray, "fg_Life_parm.mac";
import cb_sql; //исключительно для ternary

var beginDate, endDate;

var ReportData = TAssocArray;

var disa_temp:string;
var ttruncate:string="";
var fgBank = fg_life_subject({OurBank});
macro printValue(p_name : String) : String
  return ReportData.GetValue(p_name);
end;


//import p_f251n;

const  KEY_F1      =315;
const  KEY_F2      =316;
const  KEY_F3      =317;
const KEY_ESC      = 27;
const KEY_SPACE    = 32;
const KEY_ENTER    = 13;

var Fulloutputl, outl, outputl="addsymbfor202.lbr";                    
GetRegistryValue("BANK_INI\\ОБЩИЕ ПАРАМЕТРЫ\\ДИРЕКТОРИИ\\LBRDIR",2,outl);
Fulloutputl = FindPath(outputl, outl);
var dlg = TRecHandler("251forms", fulloutputl, TRUE); 
//msgbox("редакция от 15.04.2011");


var s1_2_c4eta_m1:string, s1_2_c4eta_rub_:string, s1_2_c4eta_val_:string, s1_2_c4eta_m2:string,  s1_2_c4eta_not_rest:string;
var s1_2_c4eta_m3:string, s1_2_c4eta_rub_rest:string,s1_2_c4eta_val_rest:string;
//var s1_2_m_rub_rest:string="",s1_2_m_val_rest:string="";
var s2_4_1_rub:string="";
var s2_4_1_val:string="";
var s2_4_1_1_rub:string="";
var s2_4_1_1_val:string="";
var s2_4_1_2_rub_z:string="";
var s2_4_1_2_val_z:string="";
var s2_4_1_2_rub_:string="";
var s2_4_1_2_val_:string="";
var s2_4_1_2_1_rub:string="";
var s2_4_1_2_1_val:string="";

var s2_4_2_rub:string="";
var s2_4_2_val:string="";
var s2_4_2_1_rub:string="";
var s2_4_2_1_val:string="";

var s2_4_2_2_rub_:string="";
var s2_4_2_2_val_:string="";
var s2_4_2_2_rub_z:string="";
var s2_4_2_2_val_z:string="";
var s2_4_2_2_1_rub:string="";
var s2_4_2_2_1_val:string="";

var s1_1_c4eta_rub:string="";
var s1_1_c4eta_val:string="";
var s1_1_dataopen:string="";
var s1_1_m_rub:string="";
var s1_1_m_val:string="";
var s1_1_1_rub:string="";
var s1_1_1_val:string="";
var s1_1_1_1_rub:string="";
var s1_1_1_1_val:string="";
var s1_1_1_1_1_rub:string="";
var s1_1_1_1_1_val:string="";
/*------------------------------- 2926-У begin ----------------------------------GSP*/
/*---------------------------- пременные для новых строк ---------------------------*/
var s11_112_113_s4eta_rub:string="";
var s11_112_113_s4eta_val:string="";
var s1_1_2_c4eta_rub:string="";
var s1_1_2_c4eta_val:string="";
var s1_1_3_c4eta_rub:string="";
var s1_1_3_c4eta_val:string="";
var s1_1_2_m_rub:string="";
var s1_1_2_m_val:string="";
var s1_1_3_m_rub:string="";
var s1_1_3_m_val:string="";
var s2_1_2_1_rub:string="";
var s2_1_2_1_val:string="";
var s2_1_3_1_rub:string="";
var s2_1_3_1_val:string="";
var s2_1_3_1_1_rub:string="";
var s2_1_3_1_1_val:string="";
var s2_1_4_1_rub:string="";
var s2_1_4_1_val:string="";
var s2_1_6_2_rub:string="";
var s2_1_6_2_val:string="";
var s2_1_6_2_1_rub:string="";
var s2_1_6_2_1_val:string="";
var s2_2_2_1_rub:string="";
var s2_2_2_1_val:string="";
var s2_2_3_1_rub:string="";
var s2_2_3_1_val:string="";
var s2_2_3_1_1_rub:string="";
var s2_2_3_1_1_val:string="";
var s2_2_4_1_rub:string="";
var s2_2_4_1_val:string="";
var s2_2_6_2_rub:string="";
var s2_2_6_2_val:string="";
var s2_2_6_2_1_rub:string="";
var s2_2_6_2_1_val:string="";
var s2_3_1_1_rub:string="";
var s2_3_1_1_val:string="";
var s2_3_1_1_1_rub:string="";
var s2_3_1_1_1_val:string="";
var s2_3_3_1_rub:string="";
var s2_3_3_1_val:string="";
var s2_3_3_1_1_rub:string="";
var s2_3_3_1_1_val:string="";
var s2_3_4_1_rub:string="";
var s2_3_4_1_val:string="";
var s2_3_6_1_rub:string="";
var s2_3_6_1_val:string="";
var s2_3_6_2_rub:string="";
var s2_3_6_2_val:string="";
var s2_3_6_2_1_rub:string="";
var s2_3_6_2_1_val:string="";
var s2_4_all_rub:string="";
var s2_4_all_val:string="";
var s2_4_1_1_1_rub:string="";
var s2_4_1_1_1_val:string="";
var s2_4_1_1_2_1_rub:string="";
var s2_4_1_1_2_1_val:string="";
var s2_4_1_2_rub:string="";
var s2_4_1_2_val:string="";
var s2_4_2_1_1_rub:string="";
var s2_4_2_1_1_val:string="";
var s2_4_2_1_2_rub:string="";
var s2_4_2_1_2_val:string="";
var s2_4_2_1_2_1_rub:string="";
var s2_4_2_1_2_1_val:string="";
var s2_4_2_2_rub:string="";
var s2_4_2_2_val:string="";
var s3_4_rub:string="";
var s3_4_val:string="";
var s3_1_1_rub:string="";
var s3_1_1_val:string="";
var s3_4_1_rub:string="";
var s3_4_1_val:string="";
var s2_4_1_rub_otr:string="";
var s2_4_1_val_otr:string="";
var s3_2_rub:string="";
var s3_2_val:string="";
var originExists;
/*------------------------------- 2926-У end ------------------------------------*/
var s1_2_m1:string;
var s1_2_m_rub:string;
var s1_2_m_val:string;
var s1_2_m_rub_rest:string;
var s1_2_m_val_rest:string;
var s1_2_dataopen:string;
var s1_2_c4eta_rub:string;
var s1_2_c4eta_val:string;
//var s1_2_m_rub:string;
//var s1_2_m_val:string;
var s1_2_1_rub:string;
var s1_2_1_val:string;
var s1_2_2_rub:string;
var s1_2_2_val:string;
var s1_2_2_1_rub:string;
var s1_2_2_1_val:string;
var s1_2_2_1_2_rub:string;
var s1_2_2_1_2_val:string;
var s1_3_m_rub:string="";
var s1_3_m_val:string="";
var s1_3_c4eta_rub:string="";
var s1_3_c4eta_val:string="";

var s2_1_1_uni:string="";
var s2_1_1_rub:string="";
var s2_1_1_val:string="";
var s2_1_1_1_rub:string="";
var s2_1_1_1_val:string="";
var s2_1_1_1_1_rub:string="";
var s2_1_1_1_1_val:string="";

var s2_1_2_rub:string="";
var s2_1_2_val:string="";
var s2_1_3_uni:string="";
var s2_1_3_rub:string="";
var s2_1_3_val:string="";
var s2_1_4_uni:string="";
var s2_1_4_rub:string="";
var s2_1_4_val:string="";
var s2_1_5_rub:string="";
var s2_1_5_val:string="";
var s2_1_6_rub:string="";
var s2_1_6_val:string="";
var s2_1_6_1_rub:string="";
var s2_1_6_1_val:string="";

var s2_2_1_rub:string="";
var s2_2_1_val:string="";

var s2_2_1_1_rub:string="";
var s2_2_1_1_val:string="";

var s2_2_1_1_1_rub:string="";
var s2_2_1_1_1_val:string="";

var s2_2_2_rub:string="";
var s2_2_2_val:string="";
var s2_2_3_rub:string="";
var s2_2_3_val:string="";
var s2_2_4_rub:string="";
var s2_2_4_val:string="";
var s2_2_5_rub:string="";
var s2_2_5_val:string="";

var s2_2_6_rub:string="";
var s2_2_6_val:string="";
var s2_2_6_1_rub:string="";
var s2_2_6_1_val:string="";

//var s2_3_1_c4eta_rub:string="";
//var s2_3_1_c4eta_val:string="";

var s2_3_1_rub:string="";
var s2_3_1_val:string="";

var s2_3_3_rub:string="";
var s2_3_3_val:string="";
var s2_3_4_rub:string="";
var s2_3_4_val:string="";
var s2_3_5_rub:string="";
var s2_3_5_val:string="";

var s2_3_6_rub:string="";
var s2_3_6_val:string="";
var s2_spr_rub:string="";

var s3_1_rub:string="";
var s3_1_val:string="";

var s4_1_rub:string="";
var s4_1_val:string="";

var s4_1_1_rub:string="";
var s4_1_1_val:string="";
var s4_1_3_rub:string="";
var s4_1_3_val:string="";

SetDefPrec(0);

macro day_c4eta231(rubli:bool);
        var s:string=" from daccount_dbt acc   "+
                " where  acc.t_chapter=1 and subStr( acc.t_account, 1, 5 ) in "+
                "('30232','30233','47411','47422','47426','52501','60301','60302','60309','60310','60311','60312','60313', "+
                "'60314','60320','60322','60323','70601','70602','70603','70605','70606','70607','70608','70609','70610','70611')  and acc.t_client='"+{ourbank}+"' ";
        if (rubli == true)
                        s=s+" AND (acc.t_type_account NOT LIKE '%П%' AND acc.t_type_account NOT LIKE '%U%' AND acc.t_type_account NOT LIKE '%Н%') ";
                else
                        s=s+" AND (acc.t_type_account  LIKE '%П%' or acc.t_type_account  LIKE '%U%' or acc.t_type_account LIKE '%Н%')   ";
        end;
        return s;
end;

macro day_c4eta41(rubli:bool);
        var s:string=" from daccount_dbt acc   "+
                " where  acc.t_chapter=1 and subStr( acc.t_account, 1, 5 ) in "+
                "('30109','30112','30113','30122','30123','30230','30231','30214') ";
        if (rubli == true)
                        s=s+" AND (acc.t_type_account NOT LIKE '%П%' AND acc.t_type_account NOT LIKE '%U%' AND acc.t_type_account NOT LIKE '%Н%') ";
                else
                        s=s+" AND (acc.t_type_account  LIKE '%П%' or acc.t_type_account  LIKE '%U%' or acc.t_type_account LIKE '%Н%')   ";
        end;
        return s;
end;

macro day_c4eta241(rubli:bool);
        var s:string=" from daccount_dbt acc, dobjcode_dbt do1  "+
                " where  acc.t_chapter=1 and subStr( acc.t_account, 1, 5 ) in "+
                "('40911','40912','40913') "+
"            AND do1.t_objecttype = 3   "+
"            AND do1.t_codekind = 1     and do1.t_state=0"+
"            AND acc.t_client = do1.t_objectid  "+
"            AND do1.t_code in ('010000060231', '010000060430', '010000002005', '010000060431', '010000060433', '010000060434') "+
"                AND not (do1.t_code = '010000070780' and subStr( acc.t_account, 1, 5 ) = '40911')";

        if (rubli == true)
                        s=s+" AND (acc.t_type_account NOT LIKE '%П%' AND acc.t_type_account NOT LIKE '%U%' AND acc.t_type_account NOT LIKE '%Н%') ";
                else
                        s=s+" AND (acc.t_type_account  LIKE '%П%' or acc.t_type_account  LIKE '%U%' or acc.t_type_account LIKE '%Н%')   ";
        end;
        return s;
end;

macro day_c4eta242(rubli:bool);
        var s:string=" from daccount_dbt acc, dobjcode_dbt do1  "+
                " where  acc.t_chapter=1 and subStr( acc.t_account, 1, 5 ) in "+
                "('40911','40912','40913') "+
"            AND do1.t_objecttype = 3   "+
"            AND do1.t_codekind = 1     and do1.t_state=0"+
"            AND acc.t_client = do1.t_objectid  "+
"            AND do1.t_code not in ('010000060231', '010000060430', '010000002005', '010000060431', '010000060433', '010000060434')     "+
"                AND not (do1.t_code = '010000070780' and subStr( acc.t_account, 1, 5 ) = '40911')";

        if (rubli == true)
                        s=s+" AND (acc.t_type_account NOT LIKE '%П%' AND acc.t_type_account NOT LIKE '%U%' AND acc.t_type_account NOT LIKE '%Н%') ";
                else
                        s=s+" AND (acc.t_type_account  LIKE '%П%' or acc.t_type_account  LIKE '%U%' or acc.t_type_account LIKE '%Н%')   ";
        end;
        return s;
end;

macro IfThenElse (a, b, c)
        if (a)
                return b;
        else
                return c;
        end;
        
end;

macro vstavit_c4eta(stroka_vstavki)
        var iinsert;
        iinsert=rsdcommand(stroka_vstavki);
//      println( stroka_vstavki );
//      debugbreak;
//      debugbreak;
        iinsert.execute;
//      iinsert=rsdcommand("commit");  //димон сказал так только лохи пишут
//      iinsert.execute;
end;

/* Расчет строк 
macro createQuery_1_1(currency): string
        var AccountTable, query;
   if (currency == "Rub")
     query=
   else
     query=
   end;
   return query;
end;
*/

private macro line_1_1 ()       
        var data;
//debugbreak;
        macro createQuery_1_1(currency)
                var query;
            if (currency == "Rub")
              query=s1_1_m_rub;
            else
              query=s1_1_m_val;
            end;
        return query;
        end;

   data = TRsbDataset(createQuery_1_1("Rub"));
   if (data.movenext)
        ReportData.set("Ф251__1_1__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__1_1__5", data.value(1, null, V_DOUBLE));
   end;         

   data = TRsbDataset(createQuery_1_1("Cur"));
   if (data.movenext)

        ReportData.set("Ф251__1_1__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__1_1__6", data.value(1, null, V_DOUBLE));
   end;         
end;


private macro line_1_1_1 ()     
//debugbreak;
        var data;
        macro createQuery_1_1_1(currency): string
          var query;
      if (currency == "Rub")
      query=s1_1_1_rub;

      else
      query=s1_1_1_val;
      end;
                return query;
  end;                                 
  //getstring(createQuery_1_1_1("Rub"));
  data = TRsbDataset(createQuery_1_1_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__1_1_1__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__1_1_1__5", data.value(1, null, V_DOUBLE));
  end;          
        //getstring(createQuery_1_1_1("Cur"));
  data = TRsbDataset(createQuery_1_1_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__1_1_1__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__1_1_1__6", data.value(1, null, V_DOUBLE));
  end;          
end;


private macro line_1_1_1_1 ()   
        var data;
        macro createQuery_1_1_1_1(currency): string
                var query;
      if (currency == "Rub")
      query=s1_1_1_1_rub;

      else
      query=s1_1_1_1_val;
      end;      
  return query
        end;



  data = TRsbDataset(createQuery_1_1_1_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__1_1_1_1__3", data.value(0, null, V_DOUBLE));
        //ReportData.set("Ф251__1_1_1_1_1__3", data.value(0, null, V_DOUBLE));
  end;          

  data = TRsbDataset(createQuery_1_1_1_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__1_1_1_1__4", data.value(0, null, V_DOUBLE));
        //ReportData.set("Ф251__1_1_1_1_1__4", data.value(0, null, V_DOUBLE));
  end;          
end;

private macro line_1_1_1_1_1 () 
        var data;
        macro createQuery_1_1_1_1_1(currency): string
                var query;
      if (currency == "Rub")
      query=s1_1_1_1_1_rub;

      else
      query=s1_1_1_1_1_val;
      end;      
  return query
        end;



  data = TRsbDataset(createQuery_1_1_1_1_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__1_1_1_1_1__3", data.value(0, null, V_DOUBLE));
  end;          

  data = TRsbDataset(createQuery_1_1_1_1_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__1_1_1_1_1__4", data.value(0, null, V_DOUBLE));
  end;          
end;

/*------------------------------- 2926-У begin ----------------------------------GSP*/
private macro line_1_1_2 ()     
        var data;
//debugbreak;
        macro createQuery_1_1_2(currency)
                var query;
            if (currency == "Rub")
              query=s1_1_2_m_rub;
            else
              query=s1_1_2_m_val;
            end;
        return query;
        end;

   data = TRsbDataset(createQuery_1_1_2("Rub"));
   if (data.movenext)
        ReportData.set("Ф251__1_1_2__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__1_1_2__5", data.value(1, null, V_DOUBLE));
   end;         

   data = TRsbDataset(createQuery_1_1_2("Cur"));
   if (data.movenext)
        ReportData.set("Ф251__1_1_2__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__1_1_2__6", data.value(1, null, V_DOUBLE));
   end;         
end;

private macro line_1_1_3()      
        var data;
//debugbreak;
        macro createQuery_1_1_3(currency)
                var query;
            if (currency == "Rub")
              query=s1_1_3_m_rub;
            else
              query=s1_1_3_m_val;
            end;
        return query;
        end;

   data = TRsbDataset(createQuery_1_1_3("Rub"));
   if (data.movenext)
        ReportData.set("Ф251__1_1_3__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__1_1_3__5", data.value(1, null, V_DOUBLE));
   end;         

   data = TRsbDataset(createQuery_1_1_3("Cur"));
   if (data.movenext)
        ReportData.set("Ф251__1_1_3__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__1_1_3__6", data.value(1, null, V_DOUBLE));
   end;         
end;
/*------------------------------- 2926-У end ------------------------------------*/

private macro line_1_2 ()
////debugbreak;
        var data;
        macro createQuery_1_2 (currency): string
              var AccountTable, query, currencyQuery;
              if (currency == "Rub")
                query=s1_2_m_rub;
/*            elif (currency == "Rub_rest")
                query=s1_2_m_rub_rest;*/
              elif (currency == "Val")
                query=s1_2_m_val;
/*            elif (currency == "Val_rest")
                query=s1_2_m_val_rest;*/
              end;      
        return query;
        end;
/*   getstring(createQuery_1_2("Rub"));*/
   data = TRsbDataset(createQuery_1_2("Rub"));
   if (data.movenext)
        ReportData.set("Ф251__1_2__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__1_2__5", data.value(1, null, V_DOUBLE));
   end;         
/*   data = TRsbDataset(createQuery_1_2("Rub_rest"));
   if (data.movenext)
        ReportData.set("Ф251__1_2__5", data.value(0));
   end;         */
   data = TRsbDataset(createQuery_1_2("Val"));
   if (data.movenext)
        ReportData.set("Ф251__1_2__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__1_2__6", data.value(1, null, V_DOUBLE));
   end;         
/*   data = TRsbDataset(createQuery_1_2("Val_rest"));
   if (data.movenext)
        ReportData.set("Ф251__1_2__6", data.value(0));
   end;         */
end;

macro line_1_2_1 ()
//debugbreak;
        var data;
   macro createQuery_1_2_1(currency): string
        var AccountTable, query, currencyQuery;
      if (currency == "Rub")
        query=s1_2_1_rub;
      else
        query=s1_2_1_val;

      end;
      return query;
   end;
   data = TRsbDataset(createQuery_1_2_1("Rub"));
   if (data.movenext)
        ReportData.set("Ф251__1_2_1__3", data.value(0, null, V_DOUBLE));
   end;         
   data = TRsbDataset(createQuery_1_2_1("Cur"));
   if (data.movenext)
        ReportData.set("Ф251__1_2_1__4", data.value(0, null, V_DOUBLE));
   end;         
end;










macro line_1_2_2 ()
        var data;
   macro createQuery_1_2_2(currency): string
        var AccountTable, query, currencyQuery, Account;
      if (currency == "Rub")
        query=s1_2_2_rub;
      else
        query=s1_2_2_val;
        
      end;
      return query;
   end;
   data = TRsbDataset(createQuery_1_2_2("Rub"));
   if (data.movenext)
        ReportData.set("Ф251__1_2_2__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__1_2_2__5", data.value(1, null, V_DOUBLE));
   end;         
   data = TRsbDataset(createQuery_1_2_2("Cur"));
   if (data.movenext)
        ReportData.set("Ф251__1_2_2__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__1_2_2__6", data.value(1, null, V_DOUBLE));
   end;         
end;

macro line_1_2_2_1 ()
        var data;
        macro createQuery_1_2_2_1 (currency): string
        var  query;
      if (currency == "Rub")
        query=s1_2_2_1_rub;
 
      else
        query=s1_2_2_1_val;

      end;
      return query;
        end;
   data = TRsbDataset(createQuery_1_2_2_1("Rub"));
   if (data.movenext)
        ReportData.set("Ф251__1_2_2_1__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__1_2_2_1_1__3", data.value(0, null, V_DOUBLE));
   end;         
   data = TRsbDataset(createQuery_1_2_2_1("Cur"));
   if (data.movenext)
        ReportData.set("Ф251__1_2_2_1__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__1_2_2_1_1__4", data.value(0, null, V_DOUBLE));
   end;         
end;


macro line_1_2_2_1_2 ()
        ReportData.set("Ф251__1_2_2_1_2__3", 0);
        ReportData.set("Ф251__1_2_2_1_2__4", 0);        
end; 


macro line_1_3 ()
        var data;
        macro createQuery_1_3 (currency): string
      var AccountTable, query, currencyQuery, Account;
      if (currency == "Rub")
        query = s1_3_m_rub;
      else
        query = s1_3_m_val;
      end;
      
      return query;
   end;
   data = TRsbDataset(createQuery_1_3("Rub"));
   if (data.movenext)
        ReportData.set("Ф251__1_3__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__1_3__5", data.value(1, null, V_DOUBLE));
   end;         
   data = TRsbDataset(createQuery_1_3("Cur"));
   if (data.movenext)
        ReportData.set("Ф251__1_3__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__1_3__6", data.value(1, null, V_DOUBLE));
   end;         
end;


/* Раздел 2 */

macro line_2_1_1 ()
        var data;
        macro createQuery_2_1_1 (currency): string
      var query;
      if (currency == "Rub")
        query=s2_1_1_rub;
      else
        query=s2_1_1_val;
      end;
      return query;
   end;

   data = TRsbDataset(createQuery_2_1_1("Rub"));
   if (data.movenext)
        ReportData.set("Ф251__2_1_1__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_1_1__5", data.value(1, null, V_DOUBLE));
   end;         
   data = TRsbDataset(createQuery_2_1_1("Cur"));
   if (data.movenext)
        ReportData.set("Ф251__2_1_1__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_1_1__6", data.value(1, null, V_DOUBLE));
   end;         
end;



macro line_2_1_1_1 ()
////debugbreak;
        var data;
        macro createQuery_2_1_1_1 (currency): string
                        var query;
      if (currency == "Rub")
        query=s2_1_1_1_rub;
      else
        query=s2_1_1_1_val;
      end;
                return query;
  end;
//               getstring(createQuery_2_1_1_1("Cur"));
  data = TRsbDataset(createQuery_2_1_1_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_1_1_1__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_1_1_1__6", data.value(1, null, V_DOUBLE));
  end;          
               
  data = TRsbDataset(createQuery_2_1_1_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_1_1_1__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_1_1_1__5", data.value(1, null, V_DOUBLE));
  end;          

end; //line_2_1_1_1 ()



macro line_2_1_1_1_1 ()
        var data;
        macro createQuery_2_1_1_1_1 (currency): string
                        var query;
      if (currency == "Rub")
        query=s2_1_1_1_1_rub;
      else
        query=s2_1_1_1_1_val;
      end;

                return query;
  end;
//               getstring(createQuery_2_1_1_1("Cur"));
  data = TRsbDataset(createQuery_2_1_1_1_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_1_1_1_1__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_1_1_1_1__6", data.value(1, null, V_DOUBLE));
  end;          
               
  data = TRsbDataset(createQuery_2_1_1_1_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_1_1_1_1__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_1_1_1_1__5", data.value(1, null, V_DOUBLE));
  end;          

end; //line_2_1_1_1_1 ()



macro line_2_1_2 ()
        var data;
        macro createQuery_2_1_2 (currency): string
      var query;
      if (currency == "Rub")
         query = s2_1_2_rub;
      else
         query = s2_1_2_val;
      end;
      return query;
   end;
   //disa_temp=createQuery_2_1_2("Rub");
   //getstring(disa_temp);

   data = TRsbDataset(createQuery_2_1_2("Rub"));
   if (data.movenext)
        ReportData.set("Ф251__2_1_2__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_1_2__5", data.value(1, null, V_DOUBLE));
   end;         
   data = TRsbDataset(createQuery_2_1_2("Cur"));
   if (data.movenext)
        ReportData.set("Ф251__2_1_2__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_1_2__6", data.value(1, null, V_DOUBLE));
   end;         
end;

macro line_2_1_2_1()
        var data;
        macro createQuery_2_1_2_1(currency): string
      var query;
      if (currency == "Rub")
         query = s2_1_2_1_rub;
      else
         query = s2_1_2_1_val;
      end;
      return query;
   end;

   data = TRsbDataset(createQuery_2_1_2_1("Rub"));
   if (data.movenext)
        ReportData.set("Ф251__2_1_2_1__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_1_2_1__5", data.value(1, null, V_DOUBLE));
   end;         
   data = TRsbDataset(createQuery_2_1_2_1("Cur"));
   if (data.movenext)
        ReportData.set("Ф251__2_1_2_1__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_1_2_1__6", data.value(1, null, V_DOUBLE));
   end;         
end;


macro line_2_1_3 ()
        var data;
        macro createQuery_2_1_3 (currency): string
      var query;
      if (currency == "Rub")
        query=s2_1_3_rub;
      else
        query=s2_1_3_val;
      end;
      return query;
   end;

   data = TRsbDataset(createQuery_2_1_3("Rub"));
   if (data.movenext)
        ReportData.set("Ф251__2_1_3__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_1_3__5", data.value(1, null, V_DOUBLE));
   end;         
   data = TRsbDataset(createQuery_2_1_3("Cur"));
   if (data.movenext)
        ReportData.set("Ф251__2_1_3__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_1_3__6", data.value(1, null, V_DOUBLE));
   end;         
end;


macro line_2_1_3_1()
        var data;
        macro createQuery_2_1_3_1(currency): string
      var query;
      if (currency == "Rub")
        query=s2_1_3_1_rub;
      else
        query=s2_1_3_1_val;
      end;
      return query;
   end;

   data = TRsbDataset(createQuery_2_1_3_1("Rub"));
   if (data.movenext)
        ReportData.set("Ф251__2_1_3_1__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_1_3_1__5", data.value(1, null, V_DOUBLE));
   end;         
   data = TRsbDataset(createQuery_2_1_3_1("Cur"));
   if (data.movenext)
        ReportData.set("Ф251__2_1_3_1__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_1_3_1__6", data.value(1, null, V_DOUBLE));
   end;         
end;

macro line_2_1_3_1_1()
        var data;
        macro createQuery_2_1_3_1_1(currency): string
      var query;
      if (currency == "Rub")
        query=s2_1_3_1_1_rub;
      else
        query=s2_1_3_1_1_val;
      end;
      return query;
   end;

   data = TRsbDataset(createQuery_2_1_3_1_1("Rub"));
   if (data.movenext)
        ReportData.set("Ф251__2_1_3_1_1__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_1_3_1_1__5", data.value(1, null, V_DOUBLE));
   end;         
   data = TRsbDataset(createQuery_2_1_3_1_1("Cur"));
   if (data.movenext)
        ReportData.set("Ф251__2_1_3_1_1__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_1_3_1_1__6", data.value(1, null, V_DOUBLE));
   end;         
end;



macro line_2_1_4 ()
//debugbreak;
        var data;
        macro createQuery_2_1_4 (currency): string
//                        debugbreak;
      var AccountTable, query, currencyQuery, Account, resultQuery;
      if (currency == "Rub")
        query=s2_1_4_rub;
      else
        query=s2_1_4_val;
      end;

                return query;
  end;
                 
  data = TRsbDataset(createQuery_2_1_4("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_1_4__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_1_4__6", data.value(1, null, V_DOUBLE));
  end;          
               
  data = TRsbDataset(createQuery_2_1_4("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_1_4__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_1_4__5", data.value(1, null, V_DOUBLE));
  end;          

end; //line_2_1_4 ()



macro line_2_1_4_1()
//debugbreak;
        var data;
        macro createQuery_2_1_4_1(currency): string
                        //debugbreak;
      var AccountTable, query, currencyQuery, Account, resultQuery;
      if (currency == "Rub")
        query=s2_1_4_1_rub;
      else
        query=s2_1_4_1_val;
      end;
        return query;
  end;
  data = TRsbDataset(createQuery_2_1_4_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_1_4_1__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_1_4_1__6", data.value(1, null, V_DOUBLE));
  end;          
               
  data = TRsbDataset(createQuery_2_1_4_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_1_4_1__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_1_4_1__5", data.value(1, null, V_DOUBLE));
  end;          

end; //line_2_1_4_1()



macro line_2_1_5 ()
//debugbreak;
        var data;
        macro createQuery_2_1_5 (currency): string
                        //debugbreak;
      var AccountTable, query, currencyQuery, Account, resultQuery;
      if (currency == "Rub")
        query=s2_1_5_rub;
      else
        query=s2_1_5_val;
      end;
                return query;
  end;
  data = TRsbDataset(createQuery_2_1_5("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_1_5__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_1_5__6", data.value(1, null, V_DOUBLE));
  end;          
               
  data = TRsbDataset(createQuery_2_1_5("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_1_5__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_1_5__5", data.value(1, null, V_DOUBLE));
  end;          

end; //line_2_1_5 ()



macro line_2_1_6 ()
//debugbreak;
        var data;
        macro createQuery_2_1_6 (currency): string
                        //debugbreak;
              var AccountTable, query, currencyQuery, Account, resultQuery;
              if (currency == "Rub")
                query=s2_1_6_rub;
              else
                query=s2_1_6_val;
              end;

        return query;
        end;
  data = TRsbDataset(createQuery_2_1_6("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_1_6__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_1_6__6", data.value(1, null, V_DOUBLE));
  end;          
               
  data = TRsbDataset(createQuery_2_1_6("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_1_6__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_1_6__5", data.value(1, null, V_DOUBLE));
  end;          
end; //line_2_1_6 ()



macro line_2_1_6_1 ()
//debugbreak;
        var data;
        macro createQuery_2_1_6_1 (currency): string
                        //debugbreak;
              var AccountTable, query, currencyQuery, Account, resultQuery;
              if (currency == "Rub")
                query=s2_1_6_1_rub;
              else
                query=s2_1_6_1_val;
              end;

        return query;
        end;
                 
  data = TRsbDataset(createQuery_2_1_6_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_1_6_1__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_1_6_1__6", data.value(1, null, V_DOUBLE));
  end;          
               
  data = TRsbDataset(createQuery_2_1_6_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_1_6_1__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_1_6_1__5", data.value(1, null, V_DOUBLE));
  end;          

end; //line_2_1_6_1 ()


/* C-33991
macro line_2_1_6_2()
//debugbreak;
        var data;
        macro createQuery_2_1_6_2(currency): string
                        //debugbreak;
              var AccountTable, query, currencyQuery, Account, resultQuery;
              if (currency == "Rub")
                query=s2_1_6_2_rub;
              else
                query=s2_1_6_2_val;
              end;

        return query;
        end;
                 
  data = TRsbDataset(createQuery_2_1_6_2("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_1_6_2__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_1_6_2__6", data.value(1, null, V_DOUBLE));
  end;          
               
  data = TRsbDataset(createQuery_2_1_6_2("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_1_6_2__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_1_6_2__5", data.value(1, null, V_DOUBLE));
  end;          

end; //line_2_1_6_2()



macro line_2_1_6_2_1()
//debugbreak;
        var data;
        macro createQuery_2_1_6_2_1(currency): string
                        //debugbreak;
              var AccountTable, query, currencyQuery, Account, resultQuery;
              if (currency == "Rub")
                query=s2_1_6_2_1_rub;
              else
                query=s2_1_6_2_1_val;
              end;

        return query;
        end;
                 
  data = TRsbDataset(createQuery_2_1_6_2_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_1_6_2_1__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_1_6_2_1__6", data.value(1, null, V_DOUBLE));
  end;          
               
  data = TRsbDataset(createQuery_2_1_6_2_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_1_6_2_1__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_1_6_2_1__5", data.value(1, null, V_DOUBLE));
  end;          

end; //line_2_1_6_2_1()

*/



macro line_2_2_1 ()
//debugbreak;
        var data;
        macro createQuery_2_2_1 (currency): string
                        var query;
      if (currency == "Rub")
        query=s2_2_1_rub;
      else
        query=s2_2_1_val;
      end;
        return query;
  end;
  data = TRsbDataset(createQuery_2_2_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_2_1__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_2_1__6", data.value(1, null, V_DOUBLE));
  end;          
  data = TRsbDataset(createQuery_2_2_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_2_1__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_2_1__5", data.value(1, null, V_DOUBLE));
  end;          
end; //line_2_2_1 ()



macro line_2_2_1_1 ()
//debugbreak;
        var data;
        macro createQuery_2_2_1_1 (currency): string
                        var query;
      if (currency == "Rub")
        query=s2_2_1_1_rub;
      else
        query=s2_2_1_1_val;
      end;
        return query;
  end;
                 
  data = TRsbDataset(createQuery_2_2_1_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_2_1_1__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_2_1_1__6", data.value(1, null, V_DOUBLE));
  end;          
               
  data = TRsbDataset(createQuery_2_2_1_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_2_1_1__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_2_1_1__5", data.value(1, null, V_DOUBLE));
  end;          

end; //line_2_2_1_1 ()


macro line_2_2_1_1_1 ()
//debugbreak;
        var data;
        macro createQuery_2_2_1_1_1 (currency): string
                        var query;
      if (currency == "Rub")
        query=s2_2_1_1_1_rub;
      else
        query=s2_2_1_1_1_val;
      end;
        return query;
  end;
  data = TRsbDataset(createQuery_2_2_1_1_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_2_1_1_1__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_2_1_1_1__6", data.value(1, null, V_DOUBLE));
  end;          
  data = TRsbDataset(createQuery_2_2_1_1_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_2_1_1_1__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_2_1_1_1__5", data.value(1, null, V_DOUBLE));
  end;          
end; //line_2_2_1_1_1 ()



macro line_2_2_2 ()
//debugbreak;
        var data;
        macro createQuery_2_2_2 (currency): string
                        var query;
      if (currency == "Rub")
        query=s2_2_2_rub;
      else
        query=s2_2_2_val;

      end;
        return query;
  end;
  data = TRsbDataset(createQuery_2_2_2("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_2_2__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_2_2__6", data.value(1, null, V_DOUBLE));
  end;          
  data = TRsbDataset(createQuery_2_2_2("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_2_2__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_2_2__5", data.value(1, null, V_DOUBLE));
  end;          
end; //line_2_2_2 ()


macro line_2_2_2_1()
//debugbreak;
        var data;
        macro createQuery_2_2_2_1(currency): string
        var query;
      if (currency == "Rub")
        query=s2_2_2_1_rub;
      else
        query=s2_2_2_1_val;

      end;
        return query;
  end;
                 
  data = TRsbDataset(createQuery_2_2_2_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_2_2_1__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_2_2_1__6", data.value(1, null, V_DOUBLE));
  end;          
               
  data = TRsbDataset(createQuery_2_2_2_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_2_2_1__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_2_2_1__5", data.value(1, null, V_DOUBLE));
  end;          

end; //line_2_2_2_1()




macro line_2_2_3 ()
//debugbreak;
        var data;
        macro createQuery_2_2_3 (currency): string
        var query;
          return ternary (currency == "Rub", s2_2_3_rub, s2_2_3_val);
//              return query;
  end;
                 
  data = TRsbDataset(createQuery_2_2_3("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_2_3__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_2_3__6", data.value(1, null, V_DOUBLE));
  end;          
               
  data = TRsbDataset(createQuery_2_2_3("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_2_3__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_2_3__5", data.value(1, null, V_DOUBLE));
  end;          

end; //line_2_2_3 ()

/*------------------------------- 2926-У begin ----------------------------------GSP*/
macro line_2_2_3_1()
//debugbreak;
        var data;
      macro createQuery_2_2_3_1(currency): string
        var query;
        return ternary(currency == "Rub", s2_2_3_1_rub, s2_2_3_1_val);
      end;
  data = TRsbDataset(createQuery_2_2_3_1("Cur"));
   if (data.movenext)
        ReportData.set("Ф251__2_2_3_1__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_2_3_1__6", data.value(1, null, V_DOUBLE));
   end;         
  data = TRsbDataset(createQuery_2_2_3_1("Rub"));
   if (data.movenext)
        ReportData.set("Ф251__2_2_3_1__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_2_3_1__5", data.value(1, null, V_DOUBLE));
   end;         
end; //line_2_2_3_1()



macro line_2_2_3_1_1()
//debugbreak;
        var data;
      macro createQuery_2_2_3_1_1(currency): string
        var query;
        return ternary(currency == "Rub", s2_2_3_1_1_rub, s2_2_3_1_1_val);
      end;
  data = TRsbDataset(createQuery_2_2_3_1_1("Cur"));
   if (data.movenext)
        ReportData.set("Ф251__2_2_3_1_1__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_2_3_1_1__6", data.value(1, null, V_DOUBLE));
   end;         
  data = TRsbDataset(createQuery_2_2_3_1_1("Rub"));
   if (data.movenext)
        ReportData.set("Ф251__2_2_3_1_1__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_2_3_1_1__5", data.value(1, null, V_DOUBLE));
   end;         
end; //line_2_2_3_1_1()
/*------------------------------- 2926-У end ------------------------------------*/


macro line_2_2_4 ()
        var data;
        macro createQuery_2_2_4 (currency): string
          return ternary (currency == "Rub", s2_2_4_rub, s2_2_4_val);
  end;
  data = TRsbDataset(createQuery_2_2_4("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_2_4__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_2_4__6", data.value(1, null, V_DOUBLE));
  end;          
  data = TRsbDataset(createQuery_2_2_4("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_2_4__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_2_4__5", data.value(1, null, V_DOUBLE));
  end;          
end; //line_2_2_4 ()


/*------------------------------- 2926-У begin ----------------------------------GSP*/
macro line_2_2_4_1()
        var data;
        macro createQuery_2_2_4_1(currency): string
//        return ternary (currency == "Rub", s2_2_4_1_rub, s2_2_4_1_val);
        var query;
      if (currency == "Rub")
        query=s2_2_4_1_rub;
      else
        query=s2_2_4_1_val;
      end;
        return query;
  end;
  data = TRsbDataset(createQuery_2_2_4_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_2_4_1__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_2_4_1__6", data.value(1, null, V_DOUBLE));
  end;          
  data = TRsbDataset(createQuery_2_2_4_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_2_4_1__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_2_4_1__5", data.value(1, null, V_DOUBLE));
  end;          
end; //line_2_2_4_1()
/*------------------------------- 2926-У end ------------------------------------*/




macro line_2_2_5 ()
//debugbreak;
        var data;

        macro createQuery_2_2_5 (currency): string
          return ternary (currency == "Rub", s2_2_5_rub, s2_2_5_val);
  end;
                 
  data = TRsbDataset(createQuery_2_2_5("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_2_5__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_2_5__6", data.value(1, null, V_DOUBLE));
  end;          
               
  data = TRsbDataset(createQuery_2_2_5("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_2_5__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_2_5__5", data.value(1, null, V_DOUBLE));
  end;          

end; //line_2_2_5 ()


macro line_2_2_6 ()
//debugbreak;
        var data;
        macro createQuery_2_2_6 (currency): string
        var query;
      if (currency == "Rub")
        query=s2_2_6_rub;
      else
        query=s2_2_6_val;
      end;
        return query;
  end;
                 
  data = TRsbDataset(createQuery_2_2_6("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_2_6__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_2_6__6", data.value(1, null, V_DOUBLE));
  end;          
               
  data = TRsbDataset(createQuery_2_2_6("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_2_6__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_2_6__5", data.value(1, null, V_DOUBLE));
  end;          

end; //line_2_2_6 ()

macro line_2_2_6_1 ()
        var data;
        macro createQuery_2_2_6_1 (currency): string
           var query;
      if (currency == "Rub")
        query=s2_2_6_1_rub;
      else
        query=s2_2_6_1_val;
      end;
        return query;
  end;
  data = TRsbDataset(createQuery_2_2_6_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_2_6_1__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_2_6_1__6", data.value(1, null, V_DOUBLE));
  end;          
  data = TRsbDataset(createQuery_2_2_6_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_2_6_1__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_2_6_1__5", data.value(1, null, V_DOUBLE));
  end;          
end; //line_2_2_6_1 ()


/*macro line_2_2_6_2()
        var data;
        macro createQuery_2_2_6_2(currency): string
           var query;
      if (currency == "Rub")
        query=s2_2_6_2_rub;
      else
        query=s2_2_6_2_val;
      end;
        return query;
  end;
  data = TRsbDataset(createQuery_2_2_6_2("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_2_6_2__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_2_6_2__6", data.value(1, null, V_DOUBLE));
  end;          
  data = TRsbDataset(createQuery_2_2_6_2("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_2_6_2__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_2_6_2__5", data.value(1, null, V_DOUBLE));
  end;          
end; //line_2_2_6_2()
  

macro line_2_2_6_2_1()
        var data;
        macro createQuery_2_2_6_2_1(currency): string
           var query;
      if (currency == "Rub")
        query=s2_2_6_2_1_rub;
      else
        query=s2_2_6_2_1_val;
      end;
        return query;
  end;
  data = TRsbDataset(createQuery_2_2_6_2_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_2_6_2_1__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_2_6_2_1__6", data.value(1, null, V_DOUBLE));
  end;          
  data = TRsbDataset(createQuery_2_2_6_2_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_2_6_2_1__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_2_6_2_1__5", data.value(1, null, V_DOUBLE));
  end;          
end; //line_2_2_6_2_1()
*/

macro line_2_3_1 ()
//debugbreak;
        var data;
        macro createQuery_2_3_1 (currency): string
        var query;
      if (currency == "Rub")
        query=s2_3_1_rub;
      else
        query=s2_3_1_val;
      end;
        return query;
  end;
  data = TRsbDataset(createQuery_2_3_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_3_1__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_3_1__6", data.value(1, null, V_DOUBLE));
  end;          
  data = TRsbDataset(createQuery_2_3_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_3_1__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_3_1__5", data.value(1, null, V_DOUBLE));
  end;          
end; //line_2_3_1 ()


macro line_2_3_1_1()
//debugbreak;
/*      var data;
        macro createQuery_2_3_1_1(currency): string
        var query;
      if (currency == "Rub")
        query=s2_3_1_1_rub;
      else
        query=s2_3_1_1_val;
      end;
        return query;
  end;
  data = TRsbDataset(createQuery_2_3_1_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_3_1_1__4",0/* data.value(0, null, V_DOUBLE)*/);
        ReportData.set("Ф251__2_3_1_1__6",0/* data.value(1, null, V_DOUBLE)*/);
  end;          
  data = TRsbDataset(createQuery_2_3_1_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_3_1_1__3",0/* data.value(0, null, V_DOUBLE)*/);
        ReportData.set("Ф251__2_3_1_1__5",0/* data.value(1, null, V_DOUBLE)*/);
  end;          */
        ReportData.set("Ф251__2_3_1_1__4",0/* data.value(0, null, V_DOUBLE)*/);
        ReportData.set("Ф251__2_3_1_1__6",0/* data.value(1, null, V_DOUBLE)*/);
        ReportData.set("Ф251__2_3_1_1__3",0/* data.value(0, null, V_DOUBLE)*/);
        ReportData.set("Ф251__2_3_1_1__5",0/* data.value(1, null, V_DOUBLE)*/);
end; //line_2_3_1_1()

macro line_2_3_1_1_1()
//debugbreak;
/*      var data;
        macro createQuery_2_3_1_1_1(currency): string
        var query;
      if (currency == "Rub")
        query=s2_3_1_1_1_rub;
      else
        query=s2_3_1_1_1_val;
      end;
        return query;
  end;
  data = TRsbDataset(createQuery_2_3_1_1_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_3_1_1_1__4",0/* data.value(0, null, V_DOUBLE)*/);
        ReportData.set("Ф251__2_3_1_1_1__6",0/* data.value(1, null, V_DOUBLE)*/);
  end;          
  data = TRsbDataset(createQuery_2_3_1_1_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_3_1_1_1__3",0/* data.value(0, null, V_DOUBLE)*/);
        ReportData.set("Ф251__2_3_1_1_1__5",0/* data.value(1, null, V_DOUBLE)*/);
  end;          */
        ReportData.set("Ф251__2_3_1_1_1__4",0/* data.value(0, null, V_DOUBLE)*/);
        ReportData.set("Ф251__2_3_1_1_1__6",0/* data.value(1, null, V_DOUBLE)*/);
        ReportData.set("Ф251__2_3_1_1_1__3",0/* data.value(0, null, V_DOUBLE)*/);
        ReportData.set("Ф251__2_3_1_1_1__5",0/* data.value(1, null, V_DOUBLE)*/);
end; //line_2_3_1_1_1()


macro line_2_3_3 ()
//debugbreak;
        var data;
        macro createQuery_2_3_3 (currency): string
        var query;
      if (currency == "Rub")
        query=s2_3_3_rub;
      else
        query=s2_3_3_val;
      end;
        return query;
  end;
  data = TRsbDataset(createQuery_2_3_3("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_3_3__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_3_3__6", data.value(1, null, V_DOUBLE));
  end;          
  data = TRsbDataset(createQuery_2_3_3("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_3_3__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_3_3__5", data.value(1, null, V_DOUBLE));
  end;          
end; //line_2_3_3 ()


macro line_2_3_3_1()
//debugbreak;
/*      var data;
        macro createQuery_2_3_3_1(currency): string
        var query;
      if (currency == "Rub")
        query=s2_3_3_1_rub;
      else
        query=s2_3_3_1_val;
      end;
        return query;
  end;
  data = TRsbDataset(createQuery_2_3_3_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_3_3_1__4",0/* data.value(0, null, V_DOUBLE)*/);
        ReportData.set("Ф251__2_3_3_1__6",0/* data.value(1, null, V_DOUBLE)*/);
  end;          
  data = TRsbDataset(createQuery_2_3_3_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_3_3_1__3",0/* data.value(0, null, V_DOUBLE)*/);
        ReportData.set("Ф251__2_3_3_1__5",0/* data.value(1, null, V_DOUBLE)*/);
  end;          */
        ReportData.set("Ф251__2_3_3_1__4",0/* data.value(0, null, V_DOUBLE)*/);
        ReportData.set("Ф251__2_3_3_1__6",0/* data.value(1, null, V_DOUBLE)*/);
        ReportData.set("Ф251__2_3_3_1__3",0/* data.value(0, null, V_DOUBLE)*/);
        ReportData.set("Ф251__2_3_3_1__5",0/* data.value(1, null, V_DOUBLE)*/);
end; //line_2_3_3_1()


macro line_2_3_3_1_1()
//debugbreak;
/*      var data;
        macro createQuery_2_3_3_1_1(currency): string
        var query;
      if (currency == "Rub")
        query=s2_3_3_1_1_rub;
      else
        query=s2_3_3_1_1_val;
      end;
        return query;
  end;
  data = TRsbDataset(createQuery_2_3_3_1_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_3_3_1_1__4",0/* data.value(0, null, V_DOUBLE)*/);
        ReportData.set("Ф251__2_3_3_1_1__6",0/* data.value(1, null, V_DOUBLE)*/);
  end;          
  data = TRsbDataset(createQuery_2_3_3_1_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_3_3_1_1__3",0/* data.value(0, null, V_DOUBLE)*/);
        ReportData.set("Ф251__2_3_3_1_1__5",0/* data.value(1, null, V_DOUBLE)*/);
  end;          */
        ReportData.set("Ф251__2_3_3_1_1__4",0/* data.value(0, null, V_DOUBLE)*/);
        ReportData.set("Ф251__2_3_3_1_1__6",0/* data.value(1, null, V_DOUBLE)*/);
        ReportData.set("Ф251__2_3_3_1_1__3",0/* data.value(0, null, V_DOUBLE)*/);
        ReportData.set("Ф251__2_3_3_1_1__5",0/* data.value(1, null, V_DOUBLE)*/);
end; //line_2_3_3_1_1()


macro line_2_3_4 ()
//debugbreak;
        var data;
        macro createQuery_2_3_4 (currency): string
        var query;
      if (currency == "Rub")
        query=s2_3_4_rub;
      else
        query=s2_3_4_val;
      end;
        return query;
  end;
  data = TRsbDataset(createQuery_2_3_4("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_3_4__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_3_4__6", data.value(1, null, V_DOUBLE));
  end;          

  data = TRsbDataset(createQuery_2_3_4("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_3_4__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_3_4__5", data.value(1, null, V_DOUBLE));
  end;          
end; //line_2_3_4 ()


macro line_2_3_4_1()
//debugbreak;
/*      var data;
        macro createQuery_2_3_4_1(currency): string
        var query;
      if (currency == "Rub")
        query=s2_3_4_1_rub;
      else
        query=s2_3_4_1_val;
      end;
        return query;
  end;
  data = TRsbDataset(createQuery_2_3_4_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_3_4_1__4",0/* data.value(0, null, V_DOUBLE)*/);
        ReportData.set("Ф251__2_3_4_1__6",0/* data.value(1, null, V_DOUBLE)*/);
  end;          

  data = TRsbDataset(createQuery_2_3_4_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_3_4_1__3",0/* data.value(0, null, V_DOUBLE)*/);
        ReportData.set("Ф251__2_3_4_1__5",0/* data.value(1, null, V_DOUBLE)*/);
  end;          */
        ReportData.set("Ф251__2_3_4_1__4",0/* data.value(0, null, V_DOUBLE)*/);
        ReportData.set("Ф251__2_3_4_1__6",0/* data.value(1, null, V_DOUBLE)*/);
        ReportData.set("Ф251__2_3_4_1__3",0/* data.value(0, null, V_DOUBLE)*/);
        ReportData.set("Ф251__2_3_4_1__5",0/* data.value(1, null, V_DOUBLE)*/);
end; //line_2_3_4_1()


macro line_2_3_5 ()
//debugbreak;
        var data;
        macro createQuery_2_3_5 (currency): string
                        var query;
      if (currency == "Rub")
        query=s2_3_5_rub;
              else
        query=s2_3_5_val;
      end;
                return query;
  end;
                 
  data = TRsbDataset(createQuery_2_3_5("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_3_5__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_3_5__6", data.value(1, null, V_DOUBLE));
  end;          
               
  data = TRsbDataset(createQuery_2_3_5("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_3_5__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_3_5__5", data.value(1, null, V_DOUBLE));
  end;          

end; //line_2_3_5 ()



macro line_2_3_6 ()
//debugbreak;
        var data;
        macro createQuery_2_3_6 (currency): string
        var query;
      if (currency == "Rub")
        query=s2_3_6_rub;
      else
        query=s2_3_6_val;
      end;
        return query;
  end;
  data = TRsbDataset(createQuery_2_3_6("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_3_6__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_3_6__6", data.value(1, null, V_DOUBLE));
  end;          
  data = TRsbDataset(createQuery_2_3_6("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_3_6__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_3_6__5", data.value(1, null, V_DOUBLE));
  end;          
end; //line_2_3_6 ()


macro line_2_3_6_1()/*уточнение в ТЗ, стр2.3.6.1 = стр 2.3.6*/
//debugbreak;
/*      var data;
        macro createQuery_2_3_6_1(currency): string
        var query;
      if (currency == "Rub")
        query=s2_3_6_1_rub;
      else
        query=s2_3_6_1_val;
      end;
        return query;
  end;
  data = TRsbDataset(createQuery_2_3_6_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_3_6_1__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_3_6_1__6", data.value(1, null, V_DOUBLE));
  end;          
  data = TRsbDataset(createQuery_2_3_6_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_3_6_1__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_3_6_1__5", data.value(1, null, V_DOUBLE));
  end;          */
        ReportData.set("Ф251__2_3_6_1__3",ReportData.GetValue("Ф251__2_3_6__3"));
        ReportData.set("Ф251__2_3_6_1__4",ReportData.GetValue("Ф251__2_3_6__4"));
        ReportData.set("Ф251__2_3_6_1__5",ReportData.GetValue("Ф251__2_3_6__5"));
        ReportData.set("Ф251__2_3_6_1__6",ReportData.GetValue("Ф251__2_3_6__6"));
end; //line_2_3_6_1()


macro line_2_3_6_2()
//debugbreak;
        var data;
        macro createQuery_2_3_6_2(currency): string                       
        var query;
      if (currency == "Rub")
        query=s2_3_6_2_rub;
      else
        query=s2_3_6_2_val;
      end;
        return query;
  end;
  data = TRsbDataset(createQuery_2_3_6_2("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_3_6_2__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_3_6_2__6", data.value(1, null, V_DOUBLE));
  end;          
  data = TRsbDataset(createQuery_2_3_6_2("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_3_6_2__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_3_6_2__5", data.value(1, null, V_DOUBLE));
  end;          
end; //line_2_3_6_2()


macro line_2_3_6_2_1()
//debugbreak;
/*      var data;
        macro createQuery_2_3_6_2_1(currency): string
        var query;
      if (currency == "Rub")
        query=s2_3_6_2_1_rub;
      else
        query=s2_3_6_2_1_val;
      end;
        return query;
  end;
  data = TRsbDataset(createQuery_2_3_6_2_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_3_6_2_1__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_3_6_2_1__6", data.value(1, null, V_DOUBLE));
  end;          
  data = TRsbDataset(createQuery_2_3_6_2_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_3_6_2_1__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_3_6_2_1__5", data.value(1, null, V_DOUBLE));
  end;          */
        ReportData.set("Ф251__2_3_6_2_1__3",int(ReportData.GetValue("Ф251__2_3_6_2__3")));
        ReportData.set("Ф251__2_3_6_2_1__4",int(ReportData.GetValue("Ф251__2_3_6_2__4")));
        ReportData.set("Ф251__2_3_6_2_1__5",int(ReportData.GetValue("Ф251__2_3_6_2__5")));
        ReportData.set("Ф251__2_3_6_2_1__6",int(ReportData.GetValue("Ф251__2_3_6_2__6")));
end; //line_2_3_6_2_1()


macro line_2_4 ()
        var val_2_4__3, val_2_4__4, val_2_4__5, val_2_4__6;
 val_2_4__3 =    int(ReportData.GetValue("Ф251__2_4_1__3")) + int(ReportData.GetValue("Ф251__2_4_2__3"));
 val_2_4__4 =    int(ReportData.GetValue("Ф251__2_4_1__4")) + int(ReportData.GetValue("Ф251__2_4_2__4"));
 val_2_4__5 =    int(ReportData.GetValue("Ф251__2_4_1__5")) + int(ReportData.GetValue("Ф251__2_4_2__5"));
 val_2_4__6 =    int(ReportData.GetValue("Ф251__2_4_1__6")) + int(ReportData.GetValue("Ф251__2_4_2__6"));       

        ReportData.set("Ф251__2_4__3", val_2_4__3);
        ReportData.set("Ф251__2_4__4", val_2_4__4);
        ReportData.set("Ф251__2_4__5", val_2_4__5);
        ReportData.set("Ф251__2_4__6", val_2_4__6);
end;



macro line_2_4_1 () /*из строки вычитается сумма по 32 символу кассы*/
//debugbreak;
        var data, data_otr;
        macro createQuery_2_4_1 (currency): string
                        var query;
      if (currency == "Rub")
        query=s2_4_1_rub;
      else
        query=s2_4_1_val;

      end;
                return query;
  end;
                 
  data = TRsbDataset(createQuery_2_4_1("Cur"));
/*  data_otr = TRsbDataset(s2_4_1_val_otr);
    if (data_otr.movenext)
        ReportData.set("Ф251__2_4_1_otr__6", data_otr.value(0, null, V_INTEGER));
    end;
  */
  if (data.movenext)
        ReportData.set("Ф251__2_4_1__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_4_1__6", data.value(1, null, V_DOUBLE));
  end;          
               
  data = TRsbDataset(createQuery_2_4_1("Rub"));
  data_otr = TRsbDataset(s2_4_1_rub_otr);
     if (data_otr.movenext)
        ReportData.set("Ф251__2_4_1_otr__5", data_otr.value(0, null, V_DOUBLE));
     end;

  if (data.movenext)
        ReportData.set("Ф251__2_4_1__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_4_1__5", data.value(1, null, V_DOUBLE));
  end;          

//ReportData.set("Ф251__2_4_1__5",int(ReportData.GetValue("Ф251__2_4_1__5")) - int(ReportData.GetValue("Ф251__2_4_1_otr__5")));
//ReportData.set("Ф251__2_4_1__6",int(ReportData.GetValue("Ф251__2_4_1__6")) - int(ReportData.GetValue("Ф251__2_4_1_otr__6"))); 


end; //line_2_4_1 ()



macro line_2_4_1_1 ()
//debugbreak;
        var data;
        macro createQuery_2_4_1_1 (currency): string
                        var query;
      if (currency == "Rub")
        query=s2_4_1_1_rub;
      else          
        query=s2_4_1_1_val;
      end;
                return query;
  end;
  data = TRsbDataset(createQuery_2_4_1_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_4_1_1__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_4_1_1__6", data.value(1, null, V_DOUBLE));
  end;          
  data = TRsbDataset(createQuery_2_4_1_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_4_1_1__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_4_1_1__5", data.value(1, null, V_DOUBLE));
  end;          
end; //line_2_4_1_1 ()


macro line_2_4_1_1_1 ()
//debugbreak;
        var data;
        macro createQuery_2_4_1_1_1 (currency): string
                        var query;
      if (currency == "Rub")
        query=s2_4_1_1_1_rub;
      else          
        query=s2_4_1_1_1_val;
      end;
                return query;
  end;
  data = TRsbDataset(createQuery_2_4_1_1_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_4_1_1_1__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_4_1_1_1__6", data.value(1, null, V_DOUBLE));
  end;          
  data = TRsbDataset(createQuery_2_4_1_1_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_4_1_1_1__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_4_1_1_1__5", data.value(1, null, V_DOUBLE));
  end;          
end; //line_2_4_1_1_1 ()

macro line_2_4_1_1_2()

        ReportData.set("Ф251__2_4_1_1_2__3", (int(ReportData.GetValue("Ф251__2_4_1_1__3")) - int(ReportData.GetValue("Ф251__2_4_1_1_1__3"))));
        ReportData.set("Ф251__2_4_1_1_2__4", (int(ReportData.GetValue("Ф251__2_4_1_1__4")) - int(ReportData.GetValue("Ф251__2_4_1_1_1__4"))));
        ReportData.set("Ф251__2_4_1_1_2__5", (int(ReportData.GetValue("Ф251__2_4_1_1__5")) - int(ReportData.GetValue("Ф251__2_4_1_1_1__5"))));
        ReportData.set("Ф251__2_4_1_1_2__6", (int(ReportData.GetValue("Ф251__2_4_1_1__6")) - int(ReportData.GetValue("Ф251__2_4_1_1_1__6"))));
end;


macro line_2_4_1_1_2_1()
//debugbreak;
        var data;
        macro createQuery_2_4_1_1_2_1(currency): string
                        var query;
      if (currency == "Rub")
        query=s2_4_1_1_2_1_rub;
      else          
        query=s2_4_1_1_2_1_val;
      end;
       return query;
  end;
  data = TRsbDataset(createQuery_2_4_1_1_2_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_4_1_1_2_1__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_4_1_1_2_1__6", data.value(1, null, V_DOUBLE));
  end;          
  data = TRsbDataset(createQuery_2_4_1_1_2_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_4_1_1_2_1__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_4_1_1_2_1__5", data.value(1, null, V_DOUBLE));
  end;          
end; //line_2_4_1_1_2_1 ()


macro line_2_4_1_2()
//debugbreak;
        var data;
        macro createQuery_2_4_1_2(currency): string
        var query;
      if (currency == "Rub")
        query=s2_4_1_2_rub;
      else          
        query=s2_4_1_2_val;
      end;
        return query;
  end;
  data = TRsbDataset(createQuery_2_4_1_2("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_4_1_2__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_4_1_2__6", data.value(1, null, V_DOUBLE));
  end;          
  data = TRsbDataset(createQuery_2_4_1_2("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_4_1_2__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_4_1_2__5", data.value(1, null, V_DOUBLE));
  end;          
end; //line_2_4_1_2()


macro line_2_4_1_2_1 ()
//debugbreak;
        var data;
        macro createQuery_2_4_1_2_1 (currency): string
        var query;
      if (currency == "Rub")
        query=s2_4_1_2_1_rub;
      else          
        query=s2_4_1_2_1_val;
      end;
        return query;
  end;
  data = TRsbDataset(createQuery_2_4_1_2_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_4_1_2_1__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_4_1_2_1__6", data.value(1, null, V_DOUBLE));
  end;          
  data = TRsbDataset(createQuery_2_4_1_2_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_4_1_2_1__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_4_1_2_1__5", data.value(1, null, V_DOUBLE));
  end;          
end; //line_2_4_1_2_1 ()


macro line_2_4_1_2_2()
//debugbreak;
        ReportData.set("Ф251__2_4_1_2_2__4",int(ReportData.GetValue("Ф251__2_4_1_2__4")) - int(ReportData.GetValue("Ф251__2_4_1_2_1__4")));
        ReportData.set("Ф251__2_4_1_2_2__6",int(ReportData.GetValue("Ф251__2_4_1_2__6")) - int(ReportData.GetValue("Ф251__2_4_1_2_1__6")));
        ReportData.set("Ф251__2_4_1_2_2__3",int(ReportData.GetValue("Ф251__2_4_1_2__3")) - int(ReportData.GetValue("Ф251__2_4_1_2_1__3")));
        ReportData.set("Ф251__2_4_1_2_2__5",int(ReportData.GetValue("Ф251__2_4_1_2__5")) - int(ReportData.GetValue("Ф251__2_4_1_2_1__5")));

end; //line_2_4_1_2_2()




macro line_2_4_2 ()
//debugbreak;
        var data;
        macro createQuery_2_4_2 (currency): string
                        var query;
      if (currency == "Rub")
        query=s2_4_2_rub;

      else          
        query=s2_4_2_val;

      end;
                return query;
  end;
                 
  data = TRsbDataset(createQuery_2_4_2("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_4_2__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_4_2__6", data.value(1, null, V_DOUBLE));
  end;          
               
  data = TRsbDataset(createQuery_2_4_2("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_4_2__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_4_2__5", data.value(1, null, V_DOUBLE));
  end;          

end; //line_2_4_2 ()



macro line_2_4_2_1 ()
//debugbreak;
        var data;
        macro createQuery_2_4_2_1 (currency): string
        var query;
      if (currency == "Rub")
        query=s2_4_2_1_rub;
      else          
        query=s2_4_2_1_val;
      end;
        return query;
  end;
  data = TRsbDataset(createQuery_2_4_2_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_4_2_1__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_4_2_1__6", data.value(1, null, V_DOUBLE));
  end;          
  data = TRsbDataset(createQuery_2_4_2_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_4_2_1__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_4_2_1__5", data.value(1, null, V_DOUBLE));
  end;          
end; //line_2_4_2_1 ()


macro line_2_4_2_1_1()
//debugbreak;
        var data;
        macro createQuery_2_4_2_1_1(currency): string
        var query;
      if (currency == "Rub")
        query=s2_4_2_1_1_rub;
      else          
        query=s2_4_2_1_1_val;
      end;
        return query;
  end;
  data = TRsbDataset(createQuery_2_4_2_1_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_4_2_1_1__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_4_2_1_1__6", data.value(1, null, V_DOUBLE));
  end;          
  data = TRsbDataset(createQuery_2_4_2_1_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_4_2_1_1__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_4_2_1_1__5", data.value(1, null, V_DOUBLE));
  end;          
end; //line_2_4_2_1_1()


macro line_2_4_2_1_2()

        ReportData.set("Ф251__2_4_2_1_2__4",int(ReportData.GetValue("Ф251__2_4_2_1__4")) - int(ReportData.GetValue("Ф251__2_4_2_1_1__4")));
        ReportData.set("Ф251__2_4_2_1_2__6",int(ReportData.GetValue("Ф251__2_4_2_1__6")) - int(ReportData.GetValue("Ф251__2_4_2_1_1__6")));
        ReportData.set("Ф251__2_4_2_1_2__3",int(ReportData.GetValue("Ф251__2_4_2_1__3")) - int(ReportData.GetValue("Ф251__2_4_2_1_1__3")));
        ReportData.set("Ф251__2_4_2_1_2__5",int(ReportData.GetValue("Ф251__2_4_2_1__5")) - int(ReportData.GetValue("Ф251__2_4_2_1_1__5")));

end; //line_2_4_2_1_2()


macro line_2_4_2_1_2_1()
//debugbreak;
        var data;
        macro createQuery_2_4_2_1_2_1(currency): string
        var query;
      if (currency == "Rub")
        query=s2_4_2_1_2_1_rub;
      else          
        query=s2_4_2_1_2_1_val;
      end;
        return query;
  end;
  data = TRsbDataset(createQuery_2_4_2_1_2_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_4_2_1_2_1__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_4_2_1_2_1__6", data.value(1, null, V_DOUBLE));
  end;          
  data = TRsbDataset(createQuery_2_4_2_1_2_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_4_2_1_2_1__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_4_2_1_2_1__5", data.value(1, null, V_DOUBLE));
  end;          
end; //line_2_4_2_1_2_1()


macro line_2_4_2_2 ()
//debugbreak;  qqqq
        var data;
        macro createQuery_2_4_2_2(currency): string
        var query;
      if (currency == "Rub")
        query=s2_4_2_2_rub;
      else          
        query=s2_4_2_2_val;
      end;
        return query;
  end;
  data = TRsbDataset(createQuery_2_4_2_2("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_4_2_2__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_4_2_2__6", data.value(1, null, V_DOUBLE));
  end;          
  data = TRsbDataset(createQuery_2_4_2_2("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_4_2_2__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_4_2_2__5", data.value(1, null, V_DOUBLE));
  end;
end; //line_2_4_2_2 ()

macro line_2_4_2_2_1 ()
//debugbreak;
        var data;
        macro createQuery_2_4_2_2_1 (currency): string
        var query;
      if (currency == "Rub")
        query=s2_4_2_2_1_rub;
      else          
        query=s2_4_2_2_1_val;
      end;
        return query;
  end;
  data = TRsbDataset(createQuery_2_4_2_2_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_4_2_2_1__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_4_2_2_1__6", data.value(1, null, V_DOUBLE));
  end;          
  data = TRsbDataset(createQuery_2_4_2_2_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_4_2_2_1__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_4_2_2_1__5", data.value(1, null, V_DOUBLE));
  end;          
end; //line_2_4_2_2_1()


macro line_2_4_2_2_2()

        ReportData.set("Ф251__2_4_2_2_2__4",int(ReportData.GetValue("Ф251__2_4_2_2__4")) - int(ReportData.GetValue("Ф251__2_4_2_2_1__4")));
        ReportData.set("Ф251__2_4_2_2_2__6",int(ReportData.GetValue("Ф251__2_4_2_2__6")) - int(ReportData.GetValue("Ф251__2_4_2_2_1__6")));
        ReportData.set("Ф251__2_4_2_2_2__3",int(ReportData.GetValue("Ф251__2_4_2_2__3")) - int(ReportData.GetValue("Ф251__2_4_2_2_1__3")));
        ReportData.set("Ф251__2_4_2_2_2__5",int(ReportData.GetValue("Ф251__2_4_2_2__5")) - int(ReportData.GetValue("Ф251__2_4_2_2_1__5")));

end; //line_2_4_2_2_2()


macro line_2_5 ()
//debugbreak;
        var data;
        macro createQuery_2_5 (currency): string
                        var query;
      if (currency == "Rub")
        query= "        select sum ( cn ), nvl ( round ( sum ( sm ) / 1000 ), 0 )       "+
"       from ( select count ( 1 ) cn, sum ( t_sum_payer ) sm  "+
"              from ( select acc.t_account      "+
"                     from daccount_dbt acc,   dparty_dbt party   left join  dpersn_dbt persn   on ( party.t_partyid = persn.t_personid )       "+
"                     where     substr ( acc.t_account, 1, 3 ) between '401' and '408'  "+
"                           and substr ( acc.t_account, 1, 5 ) not in ('40803', '40810', '40813', '40817', '40820')     "+
"                           and (    acc.t_type_account not like '%П%'  "+
"                                and acc.t_type_account not like '%U%'  "+
"                                and acc.t_type_account not like '%Н%' )        "+
"                           and acc.t_client = party.t_partyid  "+
"                           and ( ( persn.t_isemployer = 'X' and party.t_legalform = 2 ) or ( party.t_legalform = 1 ) ) "+
"                           and acc.t_chapter = 1       "+
"                           and acc.t_code_currency = 0 "+
"                     union     "+
"                     select acc.t_account      "+
"                     from daccount_dbt acc, dparty_dbt party   "+
"                     where ( substr ( t_account, 1, 5 ) between '42309' and '42315'    "+
"                            or substr ( t_account, 1, 5 ) between '42609' and '42615'  "+
"                            or substr ( t_account, 1, 5 ) in   "+
"                                  ( '40803', '40810', '40811', '40813', '47603', '47605','47608', '47609', '40806', '40809',   "+
"                                   '40812', '40814', '40815', '40818', '40819', '40817', '40820' ) )   "+
"                           and (    acc.t_type_account not like '%П%'  "+
"                                and acc.t_type_account not like '%U%'  "+
"                                and acc.t_type_account not like '%Н%' )        "+
"                           and acc.t_code_currency = 0 "+
"                           and acc.t_chapter = 1       "+
"                           and acc.t_client = party.t_partyid  "+
"                           and ( party.t_partyid < 22291 or party.t_partyid > 22291 )  "+
"                           and party.t_legalform = 2   "+
"                     union     "+
"                     select acc.t_account      "+
"                     from daccount_dbt acc     "+
"                     where regexp_like ( acc.t_account, '^30109|^30112|^30113|^30122|^30123|^30230|^30231|^30214' )    "+
"                           and (    acc.t_type_account not like '%П%'  "+
"                                and acc.t_type_account not like '%U%'  "+
"                                and acc.t_type_account not like '%Н%' )        "+
"                           and acc.t_chapter = 1 ) t1, "+
"                   dacctrn_dbt prov    "+
"              where ( ( t1.t_account = prov.t_account_payer and prov.t_account_receiver like '70601%' )        "+
"                     or ( t1.t_account = prov.t_account_receiver and prov.t_account_payer like '70606%' ) )    "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
"                    and prov.t_state = 1 "+
"                    and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )      "+
"                    and prov.t_shifr_oper = '09'       "+
"                    and trim ( prov.t_kind_oper ) = '6'        "+
"                    and prov.t_chapter = 1     "+
"              union    "+
"              select count ( 1 ) cn, sum ( t_sum_payer ) sm  "+
"              from dacctrn_dbt prov    "+
"              where prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )    and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )        "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
"                    and prov.t_state = 1 "+
"                    and ( ( prov.t_shifr_oper = '17' and trim ( prov.t_kind_oper ) = '6' )     "+
"                         or ( prov.t_shifr_oper = '17' and trim ( prov.t_kind_oper ) = '9' ) ) "+
"                    and prov.t_chapter = 1 )   ";

      else  query=" "+
"       select sum ( cn ), nvl ( round ( sum ( sm ) / 1000 ), 0 )       "+
"       from ( select count ( 1 ) cn, sum ( t_sum_payer ) sm  "+
"              from ( select acc.t_account      "+
"                     from daccount_dbt acc,   dparty_dbt party   left join  dpersn_dbt persn   on ( party.t_partyid = persn.t_personid )      "+
"                     where     substr ( acc.t_account, 1, 3 ) between '401' and '408'  "+
"                           and substr ( acc.t_account, 1, 5 ) not in ('40803', '40810', '40813', '40817', '40820')     "+
"                           and acc.t_client = party.t_partyid  "+
"                           and ( ( persn.t_isemployer = 'X' and party.t_legalform = 2 ) or ( party.t_legalform = 1 ) ) "+
"                           and acc.t_chapter = 1       "+
"                           and acc.t_code_currency > 0 "+
"                     union     "+
"                     select acc.t_account      "+
"                     from daccount_dbt acc, dparty_dbt party  "+
"                     where ( substr ( t_account, 1, 5 ) between '42309' and '42315'    "+
"                            or substr ( t_account, 1, 5 ) between '42609' and '42615'  "+
"                            or substr ( t_account, 1, 5 ) in   "+
"                                  ( '40803', '40810', '40811', '40813', '47603', '47605','47608', '47609', '40806', '40809',   "+
"                                   '40812', '40814', '40815', '40818', '40819', '40817', '40820' ) )   "+
"                           and acc.t_code_currency > 0 "+
"                           and acc.t_chapter = 1       "+
"                           and acc.t_client = party.t_partyid  "+
"                           and ( party.t_partyid < 22291 or party.t_partyid > 22291 )  "+
"                           and party.t_legalform = 2   "+
"                     union     "+
"                     select acc.t_account      "+
"                     from daccount_dbt acc    "+
"                     where regexp_like ( acc.t_account, '^30109|^30112|^30113|^30122|^30123|^30230|^30231|^30214' )    "+
"                           and (    acc.t_type_account like '%П%'      "+
"                                or acc.t_type_account like '%U%'       "+
"                                or acc.t_type_account like '%Н%' )     "+
"                           and acc.t_chapter = 1   ) t1,   dacctrn_dbt prov   "+
"              where ( ( t1.t_account = prov.t_account_payer and prov.t_account_receiver like '70601%' )        "+
"                     or ( t1.t_account = prov.t_account_receiver and prov.t_account_payer like '70606%' ) )    "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
"                    and prov.t_state = 1 "+
"                    and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )      "+
"                    and prov.t_shifr_oper = '09'       "+
"                    and trim ( prov.t_kind_oper ) = '6'        "+
"                    and prov.t_chapter = 1     "+
"              union    "+
"              select count ( 1 ) cn, sum ( t_sum_payer ) sm  "+
"              from dacctrn_dbt prov   "+
"              where prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )    and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )        "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
"                    and prov.t_state = 1 "+
"                    and ( ( prov.t_shifr_oper = '17' and trim ( prov.t_kind_oper ) = '6' )     "+
"                         or ( prov.t_shifr_oper = '17' and trim ( prov.t_kind_oper ) = '9' ) ) "+
"                    and prov.t_chapter = 1 )   ";

      end;
                return query;
  end;
           //getstring(createQuery_2_5("Cur"));
  data = TRsbDataset(createQuery_2_5("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_5__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_5__6", data.value(1, null, V_DOUBLE));
  end;          
               
  data = TRsbDataset(createQuery_2_5("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_5__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_5__5", data.value(1, null, V_DOUBLE));
  end;          

end; //line_2_5 ()




macro line_2_5_1 ()
//debugbreak;
        var data;
        macro createQuery_2_5_1 (currency): string
                        var query;
      if (currency == "Rub")
        query= "        select sum ( cn ), nvl ( round ( sum ( sm ) / 1000 ), 0 )       "+
"       from ( select count ( 1 ) cn, sum ( t_sum_payer ) sm  "+
"              from ( select acc.t_account      "+
"                     from daccount_dbt acc,   dparty_dbt party   left join  dpersn_dbt persn   on ( party.t_partyid = persn.t_personid )       "+
"                     where     substr ( acc.t_account, 1, 3 ) between '401' and '408'  "+
"                           and substr ( acc.t_account, 1, 5 ) not in ('40803', '40810', '40813', '40817', '40820')     "+
"                           and (    acc.t_type_account not like '%П%'  "+
"                                and acc.t_type_account not like '%U%'  "+
"                                and acc.t_type_account not like '%Н%' )        "+
"                           and acc.t_client = party.t_partyid  "+
"                           and ( ( persn.t_isemployer = 'X' and party.t_legalform = 2 ) or ( party.t_legalform = 1 ) ) "+
"                           and acc.t_chapter = 1       "+
"                           and acc.t_code_currency = 0 "+
"                     union     "+
"                     select acc.t_account      "+
"                     from daccount_dbt acc, dparty_dbt party   "+
"                     where ( substr ( t_account, 1, 5 ) between '42309' and '42315'    "+
"                            or substr ( t_account, 1, 5 ) between '42609' and '42615'  "+
"                            or substr ( t_account, 1, 5 ) in   "+
"                                  ( '40803', '40810', '40811', '40813', '47603', '47605','47608', '47609', '40806', '40809',   "+
"                                   '40812', '40814', '40815', '40818', '40819', '40817', '40820' ) )   "+
"                           and (    acc.t_type_account not like '%П%'  "+
"                                and acc.t_type_account not like '%U%'  "+
"                                and acc.t_type_account not like '%Н%' )        "+
"                           and acc.t_code_currency = 0 "+
"                           and acc.t_chapter = 1       "+
"                           and acc.t_client = party.t_partyid  "+
"                           and ( party.t_partyid < 22291 or party.t_partyid > 22291 )  "+
"                           and party.t_legalform = 2   "+
"                     union     "+
"                     select acc.t_account      "+
"                     from daccount_dbt acc     "+
"                     where regexp_like ( acc.t_account, '^30109|^30112|^30113|^30122|^30123|^30230|^30231|^30214' )    "+
"                           and (    acc.t_type_account not like '%П%'  "+
"                                and acc.t_type_account not like '%U%'  "+
"                                and acc.t_type_account not like '%Н%' )        "+
"                           and acc.t_chapter = 1 ) t1, "+
"                   dacctrn_dbt prov    "+
"              where ( ( t1.t_account = prov.t_account_payer and prov.t_account_receiver like '70601%' )        "+
"                     or ( t1.t_account = prov.t_account_receiver and prov.t_account_payer like '70606%' ) )    "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
"                    and prov.t_state = 1 "+
"                    and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )      "+
"                    and prov.t_shifr_oper = '09'       "+
"                    and trim ( prov.t_kind_oper ) = '6'        "+
"                    and prov.t_chapter = 1     "+
"              union    "+
"              select count ( 1 ) cn, sum ( t_sum_payer ) sm  "+
"              from dacctrn_dbt prov    "+
"              where prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )    and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )        "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
"                    and prov.t_state = 1 "+
"                    and ( ( prov.t_shifr_oper = '17' and trim ( prov.t_kind_oper ) = '6' )     "+
"                         or ( prov.t_shifr_oper = '17' and trim ( prov.t_kind_oper ) = '9' ) ) "+
"                    and prov.t_chapter = 1     "+
"                                                  and (substr(prov.t_account_payer,1,5)='70606' or substr(prov.t_account_receiver,1,5)='70601')        )       ";

      else  query=" "+
"       select sum ( cn ), nvl ( round ( sum ( sm ) / 1000 ), 0 )       "+
"       from ( select count ( 1 ) cn, sum ( t_sum_payer ) sm  "+
"              from ( select acc.t_account      "+
"                     from daccount_dbt acc,   dparty_dbt party   left join  dpersn_dbt persn   on ( party.t_partyid = persn.t_personid )      "+
"                     where     substr ( acc.t_account, 1, 3 ) between '401' and '408'  "+
"                           and substr ( acc.t_account, 1, 5 ) not in ('40803', '40810', '40813', '40817', '40820')     "+
"                           and acc.t_client = party.t_partyid  "+
"                           and ( ( persn.t_isemployer = 'X' and party.t_legalform = 2 ) or ( party.t_legalform = 1 ) ) "+
"                           and acc.t_chapter = 1       "+
"                           and acc.t_code_currency > 0 "+
"                     union     "+
"                     select acc.t_account      "+
"                     from daccount_dbt acc, dparty_dbt party  "+
"                     where ( substr ( t_account, 1, 5 ) between '42309' and '42315'    "+
"                            or substr ( t_account, 1, 5 ) between '42609' and '42615'  "+
"                            or substr ( t_account, 1, 5 ) in   "+
"                                  ( '40803', '40810', '40811', '40813', '47603', '47605','47608', '47609', '40806', '40809',   "+
"                                   '40812', '40814', '40815', '40818', '40819', '40817', '40820' ) )   "+
"                           and acc.t_code_currency > 0 "+
"                           and acc.t_chapter = 1       "+
"                           and acc.t_client = party.t_partyid  "+
"                           and ( party.t_partyid < 22291 or party.t_partyid > 22291 )  "+
"                           and party.t_legalform = 2   "+
"                     union     "+
"                     select acc.t_account      "+
"                     from daccount_dbt acc    "+
"                     where regexp_like ( acc.t_account, '^30109|^30112|^30113|^30122|^30123|^30230|^30231|^30214' )    "+
"                           and (    acc.t_type_account like '%П%'      "+
"                                or acc.t_type_account like '%U%'       "+
"                                or acc.t_type_account like '%Н%' )     "+
"                           and acc.t_chapter = 1   ) t1,   dacctrn_dbt prov   "+
"              where ( ( t1.t_account = prov.t_account_payer and prov.t_account_receiver like '70601%' )        "+
"                     or ( t1.t_account = prov.t_account_receiver and prov.t_account_payer like '70606%' ) )    "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
"                    and prov.t_state = 1 "+
"                    and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )      "+
"                    and prov.t_shifr_oper = '09'       "+
"                    and trim ( prov.t_kind_oper ) = '6'        "+
"                    and prov.t_chapter = 1     "+
"              union    "+
"              select count ( 1 ) cn, sum ( t_sum_payer ) sm  "+
"              from dacctrn_dbt prov   "+
"              where prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )    and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )        "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
"                    and prov.t_state = 1 "+
"                    and ( ( prov.t_shifr_oper = '17' and trim ( prov.t_kind_oper ) = '6' )     "+
"                         or ( prov.t_shifr_oper = '17' and trim ( prov.t_kind_oper ) = '9' ) ) "+
"                    and prov.t_chapter = 1     "+
"                                                  and (substr(prov.t_account_payer,1,5)='70606' or substr(prov.t_account_receiver,1,5)='70601')        )       ";

      end;
                return query;
  end;
           //getstring(createQuery_2_5("Cur"));
  data = TRsbDataset(createQuery_2_5_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_5_1__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_5_1__6", data.value(1, null, V_DOUBLE));
  end;          
               
  data = TRsbDataset(createQuery_2_5_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_5_1__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__2_5_1__5", data.value(1, null, V_DOUBLE));
  end;          

end; //line_2_5 ()




macro line_2_spr(); //03.04.2012 vihrov C-9859-6
    var data;
        data = TRsbDataset(s2_spr_rub);
   if (data.movenext)
         ReportData.set("Ф251__2_spr_kolwo", data.value(0, null, V_DOUBLE));
         ReportData.set("Ф251__2_spr_summa", data.value(1, null, V_DOUBLE));
   end;         

end; //line_2_spr();


macro line_3_1 ()
//debugbreak;
        var data;
        macro createQuery_3_1 (currency): string
          return ternary (currency == "Rub", s3_1_rub, s3_1_val);  
        end;
  data = TRsbDataset(createQuery_3_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__3_1__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__3_1__6", data.value(1, null, V_DOUBLE));
  end;          
               
  data = TRsbDataset(createQuery_3_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__3_1__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__3_1__5", data.value(1, null, V_DOUBLE));
  end;          

end; //line_3_1 ()



/*переписано по новому ТЗ в рамках старой технологии
macro line_3_1_1 ()
//debugbreak;
        var data;
        macro createQuery_3_1_1 (currency): string
                        var query;
      if (currency == "Rub")
              query=    
"       /* Formatted on 14.10.2010 18:20:39 (QP5 v5.115.810.9015) */    "+
"       select count ( 1 ), nvl ( round ( sum ( t_sum ) / 1000 ), 0 )   "+
"       from ( select acc.t_account     "+
"              from daccount_dbt acc,   dparty_dbt party        "+
"                                     left join "+
"                                       dpersn_dbt persn        "+
"                                     on ( party.t_partyid = persn.t_personid ) "+
"              where substr ( acc.t_account, 1, 3 ) between '401' and '408'     "+
"                    and substr ( acc.t_account, 1, 5 ) not in ('40803', '40810', '40813', '40817', '40820')    "+
"                    and (    acc.t_type_account not like '%П%' "+
"                         and acc.t_type_account not like '%U%' "+
"                         and acc.t_type_account not like '%Н%' )       "+
"                    and acc.t_client = party.t_partyid "+
"                    and ( ( persn.t_isemployer = 'X' and party.t_legalform = 2 ) or ( party.t_legalform = 1 ) )        "+
"                    and acc.t_chapter = 1      "+
"                    and acc.t_code_currency = 0        "+
"              and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' )    "+
"              union    "+
"              select acc.t_account     "+
"              from daccount_dbt acc, dparty_dbt party  "+
"              where ( substr ( t_account, 1, 5 ) between '42309' and '42315'   "+
"                     or substr ( t_account, 1, 5 ) between '42609' and '42615' "+
"                     or substr ( t_account, 1, 5 ) in  "+
"                           ( '40803', '40810', '40811', '40813','47603', '47605', '47608', '47609', '40806','40809',   "+
"                            '40812', '40814',  '40815', '40818','40819', '40817','40820' ) )   "+
"                    and (    acc.t_type_account not like '%П%'  and acc.t_type_account not like '%U%'  and acc.t_type_account not like '%Н%' ) "+
"                    and acc.t_code_currency = 0        "+
"                    and acc.t_chapter = 1      "+
"                    and acc.t_client = party.t_partyid "+
"                    and ( party.t_partyid < 22291 or party.t_partyid > 22291 ) "+
"                    and party.t_legalform = 2  "+
"              and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' )    "+
"              union    "+
"              select t_account acc"+
"              from daccount_dbt        acc"+
"              where ( substr ( t_account, 1, 5 ) in    "+
"                         ( '30232', '30233','47411','47416','47422','47426', '52501', '60301', '60302','60309','60310',        "+
"                          '60311', '60312','60314', '60320', '60322', '60323' )        "+
"                     or substr ( t_account, 1, 3 ) = '706' )   "+
"                    and t_client = 3045        "+
"              and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' )    "+
"              union    "+
"              select t_account "+
"              from daccount_dbt        acc"+
"              where substr ( t_account, 1, 5 ) in ('40911', '40912', '40913') "+
"              and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' )  "+
"                    and acc.t_chapter = 1              ) t1,   "+
"            darhdoc_dbt prov   "+
"       where t1.t_account = prov.t_account_payer       "+
"             and substr(prov.t_account_receiver,1,5) in        "+
"                    ( '30109', '30112', '30113', '30122', '30123', '30230', '30231', '30214', '30110', '30114', '30115', '30213' )     "+
"             and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )   "+
"                                       and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )    ";
        
        else
        query=" "+
"       /* Formatted on 14.10.2010 18:20:39 (QP5 v5.115.810.9015) */    "+
"       select count ( 1 ), nvl ( round ( sum ( t_sum ) / 1000 ), 0 )   "+
"       from ( select acc.t_account     "+
"              from daccount_dbt acc,   dparty_dbt party        "+
"                                     left join "+
"                                       dpersn_dbt persn        "+
"                                     on ( party.t_partyid = persn.t_personid ) "+
"              where substr ( acc.t_account, 1, 3 ) between '401' and '408'     "+
"                    and substr ( acc.t_account, 1, 5 ) not in ('40803', '40810', '40813', '40817', '40820')    "+
"                    and (    acc.t_type_account like '%П%'  or acc.t_type_account like '%U%' or acc.t_type_account like '%Н%' )        "+
"                    and acc.t_client = party.t_partyid "+
"                    and ( ( persn.t_isemployer = 'X' and party.t_legalform = 2 ) or ( party.t_legalform = 1 ) )        "+
"                    and acc.t_chapter = 1      "+
"                    and acc.t_code_currency = 0        "+
"                    and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' )        "+
"       union   "+
"              select acc.t_account     "+
"              from daccount_dbt acc, dparty_dbt party  "+
"              where ( substr ( t_account, 1, 5 ) between '42309' and '42315'   "+
"                     or substr ( t_account, 1, 5 ) between '42609' and '42615' "+
"                     or substr ( t_account, 1, 5 ) in  "+
"                           ( '40803', '40810', '40811', '40813','47603', '47605', '47608', '47609', '40806','40809',   "+
"                            '40812', '40814',  '40815', '40818','40819', '40817','40820' ) )   "+
"                    and (    acc.t_type_account like '%П%'  or acc.t_type_account like '%U%' or acc.t_type_account like '%Н%' )        "+
"                    and acc.t_code_currency = 0        "+
"                    and acc.t_chapter = 1      "+
"                    and acc.t_client = party.t_partyid "+
"                    and ( party.t_partyid < 22291 or party.t_partyid > 22291 ) "+
"                    and party.t_legalform = 2  "+
"                    and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' )        "+
"              union    "+
"              select t_account "+
"              from daccount_dbt acc    "+
"              where ( substr ( t_account, 1, 5 ) in    "+
"                         ( '30232', '30233','47411','47416','47422','47426', '52501', '60301', '60302','60309','60310',        "+
"                          '60311', '60312','60314', '60320', '60322', '60323' )        "+
"                     or substr ( t_account, 1, 3 ) = '706' )   "+
"                    and (    acc.t_type_account like '%П%'  or acc.t_type_account like '%U%' or acc.t_type_account like '%Н%' )                "+
"                    and t_client = 3045        "+
"                    and acc.t_code_currency = 0        "+
"                    and t_chapter=1    "+
"                    and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' )        "+
"              union    "+
"              select t_account         "+
"              from daccount_dbt acc    "+
"              where substr ( t_account, 1, 5 ) in ('40911', '40912', '40913')  "+
"                  and (    acc.t_type_account like '%П%'  or acc.t_type_account like '%U%' or acc.t_type_account like '%Н%' )          "+
"                  and acc.t_code_currency = 0          "+
"                  and t_chapter=1      "+
"                                and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' )            "+
"        ) t1,  "+
"            darhdoc_dbt prov   "+
"       where t1.t_account = prov.t_account_payer       "+
"             and substr(prov.t_account_receiver,1,5) in        "+
"                    ( '30109', '30112', '30113', '30122', '30123', '30230', '30231', '30214', '30110', '30114', '30115', '30213' )     "+
"             and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )   "+
"                                       and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )    "+
"             and prov.t_chapter=1      ";

      end;
      //getstring(query);
                return query;
  end;
//  debugbreak;
  data = TRsbDataset(createQuery_3_1_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__3_1_1__4", data.value(0));
        ReportData.set("Ф251__3_1_1__6", data.value(1));
  end;          
//getstring(createQuery_3_1_1("Rub"));                 
               
  data = TRsbDataset(createQuery_3_1_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__3_1_1__3", data.value(0));
        ReportData.set("Ф251__3_1_1__5", data.value(1));
  end;          

end; //line_3_1_1 ()
*/

macro line_3_2()
//debugbreak;
        var data;
        macro createQuery_3_2(currency): string
          return ternary (currency == "Rub", s3_2_rub, s3_2_val);  
        end;
  data = TRsbDataset(createQuery_3_2("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__3_2__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__3_2__6", data.value(1, null, V_DOUBLE));
  end;          
  data = TRsbDataset(createQuery_3_2("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__3_2__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__3_2__5", data.value(1, null, V_DOUBLE));
  end;          
end; //line_3_2()



macro line_3_4()
//debugbreak;
        var data;
        macro createQuery_3_4(currency): string
          return ternary (currency == "Rub", s3_4_rub, s3_4_val);  
        end;
  data = TRsbDataset(createQuery_3_4("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__3_4__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__3_4__6", data.value(1, null, V_DOUBLE));
  end;          
  data = TRsbDataset(createQuery_3_4("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__3_4__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__3_4__5", data.value(1, null, V_DOUBLE));
  end;          
end; //line_3_4()

macro line_3_1_1()
//debugbreak;
        var data;
        macro createQuery_3_1_1(currency): string
          return ternary (currency == "Rub", s3_1_1_rub, s3_1_1_val);  
        end;
  data = TRsbDataset(createQuery_3_1_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__3_1_1__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__3_1_1__6", data.value(1, null, V_DOUBLE));
  end;          
  data = TRsbDataset(createQuery_3_1_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__3_1_1__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__3_1_1__5", data.value(1, null, V_DOUBLE));
  end;          
end; //line_3_1_1()


macro line_3_4_1()
//debugbreak;
        var data;
        macro createQuery_3_4_1(currency): string
          return ternary (currency == "Rub", s3_4_1_rub, s3_4_1_val);  
        end;
  data = TRsbDataset(createQuery_3_4_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__3_4_1__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__3_4_1__6", data.value(1, null, V_DOUBLE));
  end;          
  data = TRsbDataset(createQuery_3_4_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__3_4_1__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__3_4_1__5", data.value(1, null, V_DOUBLE));
  end;          
end; //line_3_4_1()


/* переписано по новому ТЗ
macro line_3_4 ()
//debugbreak;
        var data;
        macro createQuery_3_4 (currency): string
                        var query;
      if (currency == "Rub")
        query=" "+
"       /* Formatted on 14.10.2010 18:20:39 (QP5 v5.115.810.9015) */    "+
"       select count ( 1 ), nvl ( round ( sum ( t_sum ) / 1000 ), 0 )   "+
"       from ( select acc.t_account     "+
"              from daccount_dbt acc,   dparty_dbt party        "+
"                                     left join "+
"                                       dpersn_dbt persn        "+
"                                     on ( party.t_partyid = persn.t_personid ) "+
"              where substr ( acc.t_account, 1, 3 ) between '401' and '408'     "+
"                    and substr ( acc.t_account, 1, 5 ) not in ('40803', '40810', '40813', '40817', '40820')    "+
"                           and (    acc.t_type_account not like '%П%'  and acc.t_type_account not like '%U%'   and acc.t_type_account not like '%Н%' ) "+
"                    and acc.t_client = party.t_partyid "+
"                    and ( ( persn.t_isemployer = 'X' and party.t_legalform = 2 ) or ( party.t_legalform = 1 ) )        "+
"                    and acc.t_chapter = 1      "+
"                    and acc.t_code_currency = 0        "+
"                   /* and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' ) */           "+
"       union   "+
"              select acc.t_account     "+
"              from daccount_dbt acc, dparty_dbt party  "+
"              where ( substr ( t_account, 1, 5 ) between '42309' and '42315'   "+
"                     or substr ( t_account, 1, 5 ) between '42609' and '42615' "+
"                     or substr ( t_account, 1, 5 ) in  "+
"                           ( '40803', '40810', '40811', '40813','47603', '47605', '47608', '47609', '40806','40809',   "+
"                            '40812', '40814',  '40815', '40818','40819', '40817','40820' ) )   "+
"                           and (    acc.t_type_account not like '%П%'  and acc.t_type_account not like '%U%'   and acc.t_type_account not like '%Н%' ) "+
"                    and acc.t_code_currency = 0        "+
"                    and acc.t_chapter = 1      "+
"                    and acc.t_client = party.t_partyid "+
"                    and ( party.t_partyid < 22291 or party.t_partyid > 22291 ) "+
"                    and party.t_legalform = 2  "+
"                   /* and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' ) */           "+
"              union    "+
"              select t_account "+
"              from daccount_dbt acc    "+
"              where ( substr ( t_account, 1, 5 ) in    "+
"                         ( '30232', '30233','47411','47416','47422','47426', '52501', '60301', '60302','60309','60310',        "+
"                          '60311', '60312','60314', '60320', '60322', '60323' )        "+
"                     or substr ( t_account, 1, 3 ) = '706' )   "+
"                           and (    acc.t_type_account not like '%П%'  and acc.t_type_account not like '%U%'   and acc.t_type_account not like '%Н%' ) "+
"                    and t_client = 3045        "+
"                    and acc.t_code_currency = 0        "+
"                    and t_chapter=1    "+
"           /*         and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' ) */           "+
"              union    "+
"              select t_account         "+
"              from daccount_dbt acc    "+
"              where substr ( t_account, 1, 5 ) in ('40911', '40912', '40913')  "+
"                           and (    acc.t_type_account not like '%П%'  and acc.t_type_account not like '%U%'   and acc.t_type_account not like '%Н%' ) "+
"                  and acc.t_code_currency = 0          "+
"                  and t_chapter=1      "+
"            /*  and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' )*/          "+
"        ) t1,  "+
"            darhdoc_dbt prov   "+
"       where t1.t_account = prov.t_account_payer       "+
"             and substr(prov.t_account_receiver,1,5) ='30102'  "+
"             and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )   "+
"                                       and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )    "+
"             and prov.t_chapter=1      ";

      else          
        query=" /* Formatted on 14.10.2010 18:20:39 (QP5 v5.115.810.9015) */    "+
"       select count ( 1 ), nvl ( round ( sum ( t_sum ) / 1000 ), 0 )   "+
"       from ( select acc.t_account     "+
"              from daccount_dbt acc,   dparty_dbt party        "+
"                                     left join "+
"                                       dpersn_dbt persn        "+
"                                     on ( party.t_partyid = persn.t_personid ) "+
"              where substr ( acc.t_account, 1, 3 ) between '401' and '408'     "+
"                    and substr ( acc.t_account, 1, 5 ) not in ('40803', '40810', '40813', '40817', '40820')    "+
"                    and (    acc.t_type_account like '%П%'  or acc.t_type_account like '%U%' or acc.t_type_account like '%Н%' )        "+
"                    and acc.t_client = party.t_partyid "+
"                    and ( ( persn.t_isemployer = 'X' and party.t_legalform = 2 ) or ( party.t_legalform = 1 ) )        "+
"                    and acc.t_chapter = 1      "+
"                    and acc.t_code_currency = 0        "+
"                   /* and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' ) */           "+
"       union   "+
"              select acc.t_account     "+
"              from daccount_dbt acc, dparty_dbt party  "+
"              where ( substr ( t_account, 1, 5 ) between '42309' and '42315'   "+
"                     or substr ( t_account, 1, 5 ) between '42609' and '42615' "+
"                     or substr ( t_account, 1, 5 ) in  "+
"                           ( '40803', '40810', '40811', '40813','47603', '47605', '47608', '47609', '40806','40809',   "+
"                            '40812', '40814',  '40815', '40818','40819', '40817','40820' ) )   "+
"                    and (    acc.t_type_account like '%П%'  or acc.t_type_account like '%U%' or acc.t_type_account like '%Н%' )        "+
"                    and acc.t_code_currency = 0        "+
"                    and acc.t_chapter = 1      "+
"                    and acc.t_client = party.t_partyid "+
"                    and ( party.t_partyid < 22291 or party.t_partyid > 22291 ) "+
"                    and party.t_legalform = 2  "+
"                   /* and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' ) */           "+
"              union    "+
"              select t_account "+
"              from daccount_dbt acc    "+
"              where ( substr ( t_account, 1, 5 ) in    "+
"                         ( '30232', '30233','47411','47416','47422','47426', '52501', '60301', '60302','60309','60310',        "+
"                          '60311', '60312','60314', '60320', '60322', '60323' )        "+
"                     or substr ( t_account, 1, 3 ) = '706' )   "+
"                    and (    acc.t_type_account like '%П%'  or acc.t_type_account like '%U%' or acc.t_type_account like '%Н%' )                "+
"                    and t_client = 3045        "+
"                    and acc.t_code_currency = 0        "+
"                    and t_chapter=1    "+
"           /*         and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' ) */           "+
"              union    "+
"              select t_account         "+
"              from daccount_dbt acc    "+
"              where substr ( t_account, 1, 5 ) in ('40911', '40912', '40913')  "+
"                  and (    acc.t_type_account like '%П%'  or acc.t_type_account like '%U%' or acc.t_type_account like '%Н%' )          "+
"                  and acc.t_code_currency = 0          "+
"                  and t_chapter=1      "+
"            /*  and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' )*/          "+
"        ) t1,  "+
"            darhdoc_dbt prov   "+
"       where t1.t_account = prov.t_account_payer       "+
"             and substr(prov.t_account_receiver,1,5) ='30102'  "+
"             and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )   "+
"                                       and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )    "+
"             and prov.t_chapter=1      ";
      end;
                return query;
  end;
                 
  data = TRsbDataset(createQuery_3_4("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__3_4__4", data.value(0));
        ReportData.set("Ф251__3_4__6", data.value(1));
  end;          
               
  data = TRsbDataset(createQuery_3_4("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__3_4__3", data.value(0));
        ReportData.set("Ф251__3_4__5", data.value(1));
  end;          

end; //line_3_4 ()
*/




/*
macro line_3_4_1 ()
//debugbreak;
        var data;
        macro createQuery_3_4_1 (currency): string
                        var query;
      if (currency == "Rub")
        query=" "+
"       /* Formatted on 14.10.2010 18:20:39 (QP5 v5.115.810.9015) */    "+
"       select count ( 1 ), nvl ( round ( sum ( t_sum ) / 1000 ), 0 )   "+
"       from ( select acc.t_account     "+
"              from daccount_dbt acc,   dparty_dbt party        "+
"                                     left join "+
"                                       dpersn_dbt persn        "+
"                                     on ( party.t_partyid = persn.t_personid ) "+
"              where substr ( acc.t_account, 1, 3 ) between '401' and '408'     "+
"                    and substr ( acc.t_account, 1, 5 ) not in ('40803', '40810', '40813', '40817', '40820')    "+
"                           and (    acc.t_type_account not like '%П%'  and acc.t_type_account not like '%U%'   and acc.t_type_account not like '%Н%' ) "+
"                    and acc.t_client = party.t_partyid "+
"                    and ( ( persn.t_isemployer = 'X' and party.t_legalform = 2 ) or ( party.t_legalform = 1 ) )        "+
"                    and acc.t_chapter = 1      "+
"                    and acc.t_code_currency = 0        "+
"                    and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' )        "+
"       union   "+
"              select acc.t_account     "+
"              from daccount_dbt acc, dparty_dbt party  "+
"              where ( substr ( t_account, 1, 5 ) between '42309' and '42315'   "+
"                     or substr ( t_account, 1, 5 ) between '42609' and '42615' "+
"                     or substr ( t_account, 1, 5 ) in  "+
"                           ( '40803', '40810', '40811', '40813','47603', '47605', '47608', '47609', '40806','40809',   "+
"                            '40812', '40814',  '40815', '40818','40819', '40817','40820' ) )   "+
"                           and (    acc.t_type_account not like '%П%'  and acc.t_type_account not like '%U%'   and acc.t_type_account not like '%Н%' ) "+
"                    and acc.t_code_currency = 0        "+
"                    and acc.t_chapter = 1      "+
"                    and acc.t_client = party.t_partyid "+
"                    and ( party.t_partyid < 22291 or party.t_partyid > 22291 ) "+
"                    and party.t_legalform = 2  "+
"                    and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' )        "+
"              union    "+
"              select t_account "+
"              from daccount_dbt acc    "+
"              where ( substr ( t_account, 1, 5 ) in    "+
"                         ( '30232', '30233','47411','47416','47422','47426', '52501', '60301', '60302','60309','60310',        "+
"                          '60311', '60312','60314', '60320', '60322', '60323' )        "+
"                     or substr ( t_account, 1, 3 ) = '706' )   "+
"                           and (    acc.t_type_account not like '%П%'  and acc.t_type_account not like '%U%'   and acc.t_type_account not like '%Н%' ) "+
"                    and t_client = 3045        "+
"                    and acc.t_code_currency = 0        "+
"                    and t_chapter=1    "+
"                    and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' )        "+
"              union    "+
"              select t_account         "+
"              from daccount_dbt acc    "+
"              where substr ( t_account, 1, 5 ) in ('40911', '40912', '40913')  "+
"                           and (    acc.t_type_account not like '%П%'  and acc.t_type_account not like '%U%'   and acc.t_type_account not like '%Н%' ) "+
"                  and acc.t_code_currency = 0          "+
"                  and t_chapter=1      "+
"              and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' )      "+
"        ) t1,  "+
"            darhdoc_dbt prov   "+
"       where t1.t_account = prov.t_account_payer       "+
"             and substr(prov.t_account_receiver,1,5) ='30102'  "+
"             and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )   "+
"                                       and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )    "+
"             and prov.t_chapter=1      ";


      else          
        query=" "+
"       /* Formatted on 14.10.2010 18:20:39 (QP5 v5.115.810.9015) */    "+
"       select count ( 1 ), nvl ( round ( sum ( t_sum ) / 1000 ), 0 )   "+
"       from ( select acc.t_account     "+
"              from daccount_dbt acc,   dparty_dbt party        "+
"                                     left join "+
"                                       dpersn_dbt persn        "+
"                                     on ( party.t_partyid = persn.t_personid ) "+
"              where substr ( acc.t_account, 1, 3 ) between '401' and '408'     "+
"                    and substr ( acc.t_account, 1, 5 ) not in ('40803', '40810', '40813', '40817', '40820')    "+
"                    and (    acc.t_type_account like '%П%'  or acc.t_type_account like '%U%' or acc.t_type_account like '%Н%' )        "+
"                    and acc.t_client = party.t_partyid "+
"                    and ( ( persn.t_isemployer = 'X' and party.t_legalform = 2 ) or ( party.t_legalform = 1 ) )        "+
"                    and acc.t_chapter = 1      "+
"                    and acc.t_code_currency = 0        "+
"                    and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' )        "+
"       union   "+
"              select acc.t_account     "+
"              from daccount_dbt acc, dparty_dbt party  "+
"              where ( substr ( t_account, 1, 5 ) between '42309' and '42315'   "+
"                     or substr ( t_account, 1, 5 ) between '42609' and '42615' "+
"                     or substr ( t_account, 1, 5 ) in  "+
"                           ( '40803', '40810', '40811', '40813','47603', '47605', '47608', '47609', '40806','40809',   "+
"                            '40812', '40814',  '40815', '40818','40819', '40817','40820' ) )   "+
"                    and (    acc.t_type_account like '%П%'  or acc.t_type_account like '%U%' or acc.t_type_account like '%Н%' )        "+
"                    and acc.t_code_currency = 0        "+
"                    and acc.t_chapter = 1      "+
"                    and acc.t_client = party.t_partyid "+
"                    and ( party.t_partyid < 22291 or party.t_partyid > 22291 ) "+
"                    and party.t_legalform = 2  "+
"                    and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' )        "+
"              union    "+
"              select t_account "+
"              from daccount_dbt acc    "+
"              where ( substr ( t_account, 1, 5 ) in    "+
"                         ( '30232', '30233','47411','47416','47422','47426', '52501', '60301', '60302','60309','60310',        "+
"                          '60311', '60312','60314', '60320', '60322', '60323' )        "+
"                     or substr ( t_account, 1, 3 ) = '706' )   "+
"                    and (    acc.t_type_account like '%П%'  or acc.t_type_account like '%U%' or acc.t_type_account like '%Н%' )                "+
"                    and t_client = 3045        "+
"                    and acc.t_code_currency = 0        "+
"                    and t_chapter=1    "+
"                    and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' )        "+
"              union    "+
"              select t_account         "+
"              from daccount_dbt acc    "+
"              where substr ( t_account, 1, 5 ) in ('40911', '40912', '40913')  "+
"                  and (    acc.t_type_account like '%П%'  or acc.t_type_account like '%U%' or acc.t_type_account like '%Н%' )          "+
"                  and acc.t_code_currency = 0          "+
"                  and t_chapter=1      "+
"             and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' )       "+
"        ) t1,  "+
"            darhdoc_dbt prov   "+
"       where t1.t_account = prov.t_account_payer       "+
"             and substr(prov.t_account_receiver,1,5) ='30102'  "+
"             and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )   "+
"                                       and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )    "+
"             and prov.t_chapter=1      ";

      end;
                return query;
  end;
  //debugbreak;               
  data = TRsbDataset(createQuery_3_4_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__3_4_1__4", data.value(0));
        ReportData.set("Ф251__3_4_1__6", data.value(1));
  end;          
               
  data = TRsbDataset(createQuery_3_4_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__3_4_1__3", data.value(0));
        ReportData.set("Ф251__3_4_1__5", data.value(1));
  end;          

end; //line_3_4_1 ()
*/

/* Расчет строки арифметически */
/*
2.1.1 + 2.1.2 + 2.1.3 + 
2.1.4 + 2.2.1 + 2.2.2 + 
2.2.3 + 2.2.4 + 2.3.1 + 
2.3.2 + 2.3.3 + 2.3.4 + 
2.4   + 2.5   - 3.1   - 
3.2 - 3.4*/
macro line_3_3 ()
        var val_3_3__3, val_3_3__4, val_3_3__5, val_3_3__6;

        //debugbreak;
        val_3_3__3 = int(ReportData.GetValue("Ф251__2_1_1__3")) + int(ReportData.GetValue("Ф251__2_1_2__3")) + int(ReportData.GetValue("Ф251__2_1_3__3")) +
                     int(ReportData.GetValue("Ф251__2_1_4__3")) + int(ReportData.GetValue("Ф251__2_1_5__3")) + int(ReportData.GetValue("Ф251__2_1_6__3"))+
                     int(ReportData.GetValue("Ф251__2_2_1__3")) + int(ReportData.GetValue("Ф251__2_2_2__3")) + int(ReportData.GetValue("Ф251__2_2_3__3"))+
                     int(ReportData.GetValue("Ф251__2_2_4__3")) + int(ReportData.GetValue("Ф251__2_2_5__3")) + int(ReportData.GetValue("Ф251__2_2_6__3"))+
                     int(ReportData.GetValue("Ф251__2_3_1__3"))/*+int(ReportData.GetValue("Ф251__2_3_2__3"))*/+int(ReportData.GetValue("Ф251__2_3_3__3"))+
                     int(ReportData.GetValue("Ф251__2_3_4__3")) + int(ReportData.GetValue("Ф251__2_3_5__3")) + int(ReportData.GetValue("Ф251__2_3_6__3"))+
                     int(ReportData.GetValue("Ф251__2_4__3"))   - int(ReportData.GetValue("Ф251__3_1__3"))   -/*int(ReportData.GetValue("Ф251__3_2__3"))-*/
                     int(ReportData.GetValue("Ф251__3_4__3"))   - int(ReportData.GetValue("Ф251__2_4_1_1_2_1__3"))-int(ReportData.GetValue("Ф251__2_4_2_1_2_1__3"));

        val_3_3__4 = int(ReportData.GetValue("Ф251__2_1_1__4")) + int(ReportData.GetValue("Ф251__2_1_2__4")) + int(ReportData.GetValue("Ф251__2_1_3__4")) +
                     int(ReportData.GetValue("Ф251__2_1_4__4")) + int(ReportData.GetValue("Ф251__2_1_5__4")) + int(ReportData.GetValue("Ф251__2_1_6__4"))+
                     int(ReportData.GetValue("Ф251__2_2_1__4")) + int(ReportData.GetValue("Ф251__2_2_2__4")) + int(ReportData.GetValue("Ф251__2_2_3__4"))+
                     int(ReportData.GetValue("Ф251__2_2_4__4")) + int(ReportData.GetValue("Ф251__2_2_5__4")) + int(ReportData.GetValue("Ф251__2_2_6__4"))+
                     int(ReportData.GetValue("Ф251__2_3_1__4")) +/*int(ReportData.GetValue("Ф251__2_3_2__4"))+*/int(ReportData.GetValue("Ф251__2_3_3__4"))+
                     int(ReportData.GetValue("Ф251__2_3_4__4")) + int(ReportData.GetValue("Ф251__2_3_5__4")) + int(ReportData.GetValue("Ф251__2_3_6__4"))+
                     int(ReportData.GetValue("Ф251__2_4__4"))   - int(ReportData.GetValue("Ф251__3_1__4"))   -/*int(ReportData.GetValue("Ф251__3_2__4"))-*/
                     int(ReportData.GetValue("Ф251__3_4__4"))   - int(ReportData.GetValue("Ф251__2_4_1_1_2_1__4"))-int(ReportData.GetValue("Ф251__2_4_2_1_2_1__4"));

        val_3_3__5 = int(ReportData.GetValue("Ф251__2_1_1__5")) + int(ReportData.GetValue("Ф251__2_1_2__5")) + int(ReportData.GetValue("Ф251__2_1_3__5")) +
                     int(ReportData.GetValue("Ф251__2_1_4__5")) + int(ReportData.GetValue("Ф251__2_1_5__5")) + int(ReportData.GetValue("Ф251__2_1_6__5"))+
                     int(ReportData.GetValue("Ф251__2_2_1__5")) + int(ReportData.GetValue("Ф251__2_2_2__5")) + int(ReportData.GetValue("Ф251__2_2_3__5"))+
                     int(ReportData.GetValue("Ф251__2_2_4__5")) + int(ReportData.GetValue("Ф251__2_2_5__5")) + int(ReportData.GetValue("Ф251__2_2_6__5"))+
                     int(ReportData.GetValue("Ф251__2_3_1__5")) +/*int(ReportData.GetValue("Ф251__2_3_2__5"))+*/int(ReportData.GetValue("Ф251__2_3_3__5"))+
                     int(ReportData.GetValue("Ф251__2_3_4__5")) + int(ReportData.GetValue("Ф251__2_3_5__5")) + int(ReportData.GetValue("Ф251__2_3_6__5"))+
                     int(ReportData.GetValue("Ф251__2_4__5"))   - int(ReportData.GetValue("Ф251__3_1__5"))   -/*int(ReportData.GetValue("Ф251__3_2__5"))-     */
                     int(ReportData.GetValue("Ф251__3_4__5"))   - int(ReportData.GetValue("Ф251__2_4_1_1_2_1__5"))-int(ReportData.GetValue("Ф251__2_4_2_1_2_1__5"));

        val_3_3__6 = int(ReportData.GetValue("Ф251__2_1_1__6")) + int(ReportData.GetValue("Ф251__2_1_2__6")) + int(ReportData.GetValue("Ф251__2_1_3__6")) +
                     int(ReportData.GetValue("Ф251__2_1_4__6")) + int(ReportData.GetValue("Ф251__2_1_5__6")) + int(ReportData.GetValue("Ф251__2_1_6__6"))+
                     int(ReportData.GetValue("Ф251__2_2_1__6")) + int(ReportData.GetValue("Ф251__2_2_2__6")) + int(ReportData.GetValue("Ф251__2_2_3__6"))+
                     int(ReportData.GetValue("Ф251__2_2_4__6")) + int(ReportData.GetValue("Ф251__2_2_5__6")) + int(ReportData.GetValue("Ф251__2_2_6__6"))+
                     int(ReportData.GetValue("Ф251__2_3_1__6")) +/*int(ReportData.GetValue("Ф251__2_3_2__6"))+*/int(ReportData.GetValue("Ф251__2_3_3__6"))+
                     int(ReportData.GetValue("Ф251__2_3_4__6")) + int(ReportData.GetValue("Ф251__2_3_5__6")) + int(ReportData.GetValue("Ф251__2_3_6__6"))+
                     int(ReportData.GetValue("Ф251__2_4__6"))   - int(ReportData.GetValue("Ф251__3_1__6"))   -/*int(ReportData.GetValue("Ф251__3_2__6")) -*/
                     int(ReportData.GetValue("Ф251__3_4__6"))   - int(ReportData.GetValue("Ф251__2_4_1_1_2_1__6"))-int(ReportData.GetValue("Ф251__2_4_2_1_2_1__6"));

        ReportData.set("Ф251__3_3__3", val_3_3__3);
        ReportData.set("Ф251__3_3__4", val_3_3__4);
        ReportData.set("Ф251__3_3__5", val_3_3__5);
        ReportData.set("Ф251__3_3__6", val_3_3__6);
end;

/* Расчет строки арифметически */ 
/*2.1.1.1 + 2.1.2.1 + 2.1.3.1 + 2.1.4.1 + 2.1.6.1 + 2.2.1.1 + 2.2.2.1 + 2.2.3.1 + 2.2.4.1 + 2.2.6.1 + 2.3.1.1 + 2.3.2.1 + 2.3.3.1 + 2.3.4.1 + 2.3.6.1 - 3.1.1 - 3.2.1 - 3.4.1*/
macro line_3_3_1 () 
        var val_3_3_1__3, val_3_3_1__4, val_3_3_1__5, val_3_3_1__6;
        val_3_3_1__3 = int(ReportData.GetValue("Ф251__2_1_1_1__3")) + int(ReportData.GetValue("Ф251__2_1_2_1__3")) + int(ReportData.GetValue("Ф251__2_1_3__3")) +
                       int(ReportData.GetValue("Ф251__2_1_4__3"))   + int(ReportData.GetValue("Ф251__2_1_6__3"))   + int(ReportData.GetValue("Ф251__2_2_1_1__3")) +
                       int(ReportData.GetValue("Ф251__2_2_2_1__3")) + int(ReportData.GetValue("Ф251__2_2_3_1__3")) + int(ReportData.GetValue("Ф251__2_2_4_1__3")) +
                       int(ReportData.GetValue("Ф251__2_2_6__3"))   + int(ReportData.GetValue("Ф251__2_3_1_1__3")) + /*int(ReportData.GetValue("Ф251__2_3_2_1__3")) + */
                       int(ReportData.GetValue("Ф251__2_3_3_1__3")) + int(ReportData.GetValue("Ф251__2_3_4_1__3")) + int(ReportData.GetValue("Ф251__2_3_6_1__3")) -
                       int(ReportData.GetValue("Ф251__3_1_1__3"))   - /*int(ReportData.GetValue("Ф251__3_2_1__3"))   -*/ int(ReportData.GetValue("Ф251__3_4_1__3"));

        val_3_3_1__4 = int(ReportData.GetValue("Ф251__2_1_1_1__4")) + int(ReportData.GetValue("Ф251__2_1_2_1__4")) + int(ReportData.GetValue("Ф251__2_1_3__4")) +
                       int(ReportData.GetValue("Ф251__2_1_4__4"))   + int(ReportData.GetValue("Ф251__2_1_6__4"))   + int(ReportData.GetValue("Ф251__2_2_1_1__4")) +
                       int(ReportData.GetValue("Ф251__2_2_2_1__4")) + int(ReportData.GetValue("Ф251__2_2_3_1__4")) + int(ReportData.GetValue("Ф251__2_2_4_1__4")) +
                       int(ReportData.GetValue("Ф251__2_2_6__4"))   + int(ReportData.GetValue("Ф251__2_3_1_1__4")) + /*int(ReportData.GetValue("Ф251__2_3_2_1__4")) +*/
                       int(ReportData.GetValue("Ф251__2_3_3_1__4")) + int(ReportData.GetValue("Ф251__2_3_4_1__4")) + int(ReportData.GetValue("Ф251__2_3_6_1__4")) -
                       int(ReportData.GetValue("Ф251__3_1_1__4"))   - /*int(ReportData.GetValue("Ф251__3_2_1__4"))   -*/ int(ReportData.GetValue("Ф251__3_4_1__4"));

        val_3_3_1__5 = int(ReportData.GetValue("Ф251__2_1_1_1__5")) + int(ReportData.GetValue("Ф251__2_1_2_1__5")) + int(ReportData.GetValue("Ф251__2_1_3__5")) +
                       int(ReportData.GetValue("Ф251__2_1_4__5"))   + int(ReportData.GetValue("Ф251__2_1_6__5"))   + int(ReportData.GetValue("Ф251__2_2_1_1__5")) +
                       int(ReportData.GetValue("Ф251__2_2_2_1__5")) + int(ReportData.GetValue("Ф251__2_2_3_1__5")) + int(ReportData.GetValue("Ф251__2_2_4_1__5")) +
                       int(ReportData.GetValue("Ф251__2_2_6__5"))   + int(ReportData.GetValue("Ф251__2_3_1_1__5")) + /*int(ReportData.GetValue("Ф251__2_3_2_1__5")) + */
                       int(ReportData.GetValue("Ф251__2_3_3_1__5")) + int(ReportData.GetValue("Ф251__2_3_4_1__5")) + int(ReportData.GetValue("Ф251__2_3_6_1__5")) -
                       int(ReportData.GetValue("Ф251__3_1_1__5"))   - /*int(ReportData.GetValue("Ф251__3_2_1__5"))   -*/ int(ReportData.GetValue("Ф251__3_4_1__5"));

        val_3_3_1__6 = int(ReportData.GetValue("Ф251__2_1_1_1__6")) + int(ReportData.GetValue("Ф251__2_1_2_1__6")) + int(ReportData.GetValue("Ф251__2_1_3__6")) +
                       int(ReportData.GetValue("Ф251__2_1_4__6"))   + int(ReportData.GetValue("Ф251__2_1_6__6"))   + int(ReportData.GetValue("Ф251__2_2_1_1__6")) +
                       int(ReportData.GetValue("Ф251__2_2_2_1__6")) + int(ReportData.GetValue("Ф251__2_2_3_1__6")) + int(ReportData.GetValue("Ф251__2_2_4_1__6")) +
                       int(ReportData.GetValue("Ф251__2_2_6__6"))   + int(ReportData.GetValue("Ф251__2_3_1_1__6")) + /*int(ReportData.GetValue("Ф251__2_3_2_1__6")) +*/
                       int(ReportData.GetValue("Ф251__2_3_3_1__6")) + int(ReportData.GetValue("Ф251__2_3_4_1__6")) + int(ReportData.GetValue("Ф251__2_3_6_1__6")) -
                       int(ReportData.GetValue("Ф251__3_1_1__6"))   - /*int(ReportData.GetValue("Ф251__3_2_1__6"))   -*/ int(ReportData.GetValue("Ф251__3_4_1__6"));

        ReportData.set("Ф251__3_3_1__3", val_3_3_1__3);
        ReportData.set("Ф251__3_3_1__4", val_3_3_1__4);
        ReportData.set("Ф251__3_3_1__5", val_3_3_1__5);
        ReportData.set("Ф251__3_3_1__6", val_3_3_1__6);
end;



macro line_4_1 ()
//debugbreak;
        var data;
        macro createQuery_4_1 (currency): string
        var query;
      if (currency == "Rub")
        query=s4_1_rub;
      else          
        query=s4_1_val;
      end;
        return query;
  end;
  data = TRsbDataset(createQuery_4_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__4_1__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__4_1__6", data.value(1, null, V_DOUBLE));
  end;          
  data = TRsbDataset(createQuery_4_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__4_1__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__4_1__5", data.value(1, null, V_DOUBLE));
  end;          
end; //line_4_1 ()



macro line_4_1_1 ()
//debugbreak;
        var data;
        macro createQuery_4_1_1 (currency): string
        var query;
              if (currency == "Rub")
                query=s4_1_1_rub;
              else          
                query=s4_1_1_val;
              end;
        return query;
        end;
                 
  data = TRsbDataset(createQuery_4_1_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__4_1_1__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__4_1_1__6", data.value(1, null, V_DOUBLE));
  end;          
               
  data = TRsbDataset(createQuery_4_1_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__4_1_1__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__4_1_1__5", data.value(1, null, V_DOUBLE));
  end;          
end; //line_4_1_1 ()

macro line_4_1_3 ()
//debugbreak;
        var data;
        macro createQuery_4_1_3 (currency): string
        var query;
              if (currency == "Rub")
                query=s4_1_3_rub;
              else          
                query=s4_1_3_val;
              end;
        return query;
        end;
                 
  data = TRsbDataset(createQuery_4_1_3("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__4_1_3__4", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__4_1_3__6", data.value(1, null, V_DOUBLE));
  end;          
               
  data = TRsbDataset(createQuery_4_1_3("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__4_1_3__3", data.value(0, null, V_DOUBLE));
        ReportData.set("Ф251__4_1_3__5", data.value(1, null, V_DOUBLE));
  end;          
end; //line_4_1_3 ()




/*
macro EvProc (rsrec, cmd, id, key)
    if(( cmd == DLG_KEY ) and ( key == 13 ))
      return CM_SELECT;
    end;
end;
     */
 /*Обработчик диалоговой панели ввода исходных данных для печати*/
MACRO Event (dlg, cmd, id, key) 

   var const_mess = " ~F3~ Выбор значения из списка ~F2~ Продолжить ~ESC~ Выход ",
   SQLQuery, SQLQuery1, rsrec, cmd1;

   /*Первоначальная инициализация полей*/
   if(cmd == DLG_INIT)
      var m_den:integer = 0, m_mes:integer = 0, m_god:integer = 0;
      DateSplit({curDate}, m_den, m_mes, m_god);
      if        ((m_mes >= 4) and (m_mes <= 6)) 
        dlg.rec.BeginDate = date(1,1,m_god);
        dlg.rec.EndDate = date(31,3,m_god);
      elif ((m_mes >= 7) and (m_mes <= 9))
        dlg.rec.BeginDate = date(1,4,m_god);
        dlg.rec.EndDate = date(30,6,m_god);
      elif ((m_mes >= 10) and (m_mes <= 12))
        dlg.rec.BeginDate = date(1,9,m_god);
        dlg.rec.EndDate = date(31,12,m_god);
      elif ((m_mes >= 1) and (m_mes <= 3))
        dlg.rec.BeginDate = date(1,9,m_god-1);
        dlg.rec.EndDate = date(31,12,m_god-1);
      else
        dlg.rec.BeginDate = {curDate};
        dlg.rec.EndDate = {curDate};
      end;

      BeginDate  = dlg.rec.BeginDate;
      EndDate  = dlg.rec.EndDate;
      UpdateFields(dlg); 
   end;
   
   /*Установка подсказок в строке состояния*/
   if (cmd==DLG_SETFOCUS)
       message(const_mess);
   end;
   
   if (cmd == DLG_REMFOCUS)
     /*Проверка корректности дат отчета*/
      UpdateFields(dlg); 
   end;

   if (cmd == DLG_KEY)
     /*Выход из диалогового окна формирования отчета*/
     if (KEY == KEY_ESC)
       return exit(1);//CM_CANCEL;
     elif (KEY == KEY_ENTER)
       return CM_IGNORE;
     /*Выбор данных из списка*/
     elif ( KEY == KEY_F3)
        if (FldName(dlg,id) == "BeginDate")
          dlg.rec.BeginDate = GetDateByCalendar ({curDate}-1);
        end;
        if (FldName(dlg,id) == "EndDate")
          dlg.rec.EndDate = GetDateByCalendar ({curDate}-1);
        end;
     elif (( KEY == KEY_F2 ) )         //Проверки при вводе
        if ( dlg.rec.BeginDate > dlg.rec.EndDate )
                MsgBox("Дата начала периода должна быть меньше даты окончания");
                return CM_IGNORE;
        end;
/*        if (GetTrue(TRUE,"Сейчас будет выполнено проставление забалансовых символов. Вы уверены?"))
           BeginDate  = dlg.rec.BeginDate;
           EndDate  = dlg.rec.EndDate;
           Return CM_SAVE;
        else
          return  CM_IGNORE;    
        end;    */

        BeginDate  = dlg.rec.BeginDate;
        EndDate  = dlg.rec.EndDate;
        Return CM_SAVE;
     end;
      else
           Return CM_IGNORE;
   end;
        
END;
/*-------------------------- таблица печати, коментарий для удобства поиска GSP ------------------------------*/

macro printReport()
   [                                                                                                                  БАНКОВСКАЯ ОТЧЕТНОСТЬ];
   [                                                                   ┌──────────┬───────────────────────────────────────────────────────┐];
   [                                                                   │Код терри-│Код кредитной организации (филиала)                    │];
   [                                                                   │тории     ├──────────┬───────────────┬───────────────┬────────────┤];
   [                                                                   │по ОКАТО  │ по ОКПО  │   основной    │регистрационный│    БИК     │];
   [                                                                   │          │          │государственный│     номер     │            │];
   [                                                                   │          │          │регистрационный│(/порядковый   │            │];
   [                                                                   │          │          │    номер      │   номер)      │            │];
   [                                                                   ├──────────┼──────────┼───────────────┼───────────────┼────────────┤];  
//   [                                                                   │##########│##########│###############│###############│############│]
//                                                                       ( Код_СОАТО:c, Код_ОКПО:c, ОГРН:c,   РегНомерБанка:c, {MFO_Bank}:c);
   [                                                                   └──────────┴──────────┴───────────────┴───────────────┴────────────┘];
   [ ];
   [                     СВЕДЕНИЯ О СЧЕТАХ КЛИЕНТОВ И ПЛАТЕЖАХ, ПРОВЕДЕННЫХ ЧЕРЕЗ КРЕДИТНУЮ ОРГАНТИЗАЦИЮ (ЕЁ ФИЛИАЛ)                       ];
   [ ];
   /* 24.08.2007 Malakhova 111238*/
//   [                                                                 # ](string("ЗА ",RcbDatePrintPeriod()):c);
   [ ];
   [Наименование кредитной организации (ее филиала)];
   [##############################################################################################################]( {Name_Bank}:l:w);
   [ ];
   [Почтовый адрес___# ]({Post_Addr}:l:w); 
   [ ];
   [                                                                                                                      Код формы 0409251];
   [                                                                                                                            Квартальная];
   [                                                                                                                              тыс. руб.];
   [┌──────────┬──────────────────────────────────────────────┬─────────────────────────────────────┬─────────────────────────────────────┐];
   [│ Номер    │ Наименование показателя                      │ Количество,  единиц                 │ Сумма,                              │];
   [│ строки   │                                              │                                     │ тыс. руб.                           │];
   [│          │                                              ├──────────────────┬──────────────────┼──────────────────┬──────────────────┤];
   [│          │                                              │ в валюте         │ в иностранной    │ в валюте         │ в иностранной    │];
   [│          │                                              │ Российской       │ валюте           │ Российской       │ валюте           │];
   [│          │                                              │ Федерации        │                  │ Федерации        │                  │];
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│    1     │                    2                         │        3         │        4         │         5        │        6         │];
   [└──────────┴──────────────────────────────────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┘]; 
   [          ];
   [ Раздел 1.];
   [          ];
   [┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐];
   [│ 1. Сведения о количестве счетов клиентов кредитной организации (ее филиала)                                                         │];
   [├──────────┬──────────────────────────────────────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────┤];
   [│          │ Счета, открытые клиентам - юридическим лицам,│ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__1_1__3") : r, printValue("Ф251__1_1__4"):r,printValue("Ф251__1_1__5"):r, printValue("Ф251__1_1__6"):r) ; 
   [│          │ не являющимся кредитными организациями,      │                  │                  │                  │                  │];
   [│ 1.1      │ и индивидуальным предпринимателям, которые   │                  │                  │                  │                  │];
   [│          │ могут использоваться для проведения платежей,│                  │                  │                  │                  │];
   [│          │ всего                                        │                  │                  │                  │                  │]; 
   [│          │ Из них:                                      │                  │                  │                  │                  │];
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 1.1.1    │ Счета, по которым с начала отчетного года    │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__1_1_1__3") : r, printValue("Ф251__1_1_1__4") : r, printValue("Ф251__1_1_1__5") : r, printValue("Ф251__1_1_1__6") : r);
   [│          │ проводились операции по списанию денежных    │                  │                  │                  │                  │];
   [│          │ средств                                      │                  │                  │                  │                  │];
   [│          │ Из них:                                      │                  │                  │                  │                  │];                                             
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 1.1.1.1  │ Доступ к которым предоставлен дистанционным  │ ################ │ ################ │  X               │ X                │](printValue("Ф251__1_1_1_1__3") : r, printValue("Ф251__1_1_1_1__4") : r);
   [│          │ способом                                     │                  │                  │                  │                  │];
   [│          │ Из них:                                      │                  │                  │                  │                  │];                                             
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 1.1.1.1.1│ Доступ к которым предоставлен через сеть     │ ################ │ ################ │  X               │ X                │](printValue("Ф251__1_1_1_1_1__3") : r, printValue("Ф251__1_1_1_1_1__4") : r);
   [│          │ Интернет                                     │                  │                  │                  │                  │];                                             
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 1.1.2    │ Cчета, открытые платежным агентам            │ ################ │ ################ │  X               │ X                │](printValue("Ф251__1_1_2__3") : r, printValue("Ф251__1_1_2__4") : r); //, printValue("Ф251__1_1_2__5") : r, printValue("Ф251__1_1_2__6") : r);
   [│          │                                              │                  │                  │                  │                  │];
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 1.1.3    │ Cчета, открытые банковским платежным         │ ################ │ ################ │  X               │ X                │](printValue("Ф251__1_1_3__3") : r, printValue("Ф251__1_1_3__4") : r); //, printValue("Ф251__1_1_3__5") : r, printValue("Ф251__1_1_3__6") : r);
   [│          │ агентам (субагентам)                         │                  │                  │                  │                  │];
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 1.2      │ Счета, открытые клиентам-физическим лицам на │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__1_2__3") : r, printValue("Ф251__1_2__4") : r, printValue("Ф251__1_2__5") : r, printValue("Ф251__1_2__6") : r);
   [│          │ основании договора банковского счета и       │                  │                  │                  │                  │];
   [│          │ договора банковского вклада, которые могут   │                  │                  │                  │                  │];
   [│          │ использоваться для проведения платежей, всего│                  │                  │                  │                  │];
   [│          │ Из них:                                      │                  │                  │                  │                  │]; 
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 1.2.1    │ Счета, открытые на основании договора        │ ################ │ ################ │  X               │ X                │](printValue("Ф251__1_2_1__3") : r, printValue("Ф251__1_2_1__4") : r);
   [│          │ банковского счета                            │                  │                  │                  │                  │];
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 1.2.2    │ Счета, по которым с начала отчетного года    │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__1_2_2__3") : r, printValue("Ф251__1_2_2__4") : r, printValue("Ф251__1_2_2__5") : r, printValue("Ф251__1_2_2__6") : r);
   [│          │ проводились операции по списанию денежных    │                  │                  │                  │                  │];                                             
   [│          │ средств                                      │                  │                  │                  │                  │];                                             
   [│          │ Из них:                                      │                  │                  │                  │                  │];                                             
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 1.2.2.1  │ Доступ к которым предоставлен дистанционным  │ ################ │ ################ │  X               │ X                │](printValue("Ф251__1_2_2_1__3") : r, printValue("Ф251__1_2_2_1__4") : r);
   [│          │ способом                                     │                  │                  │                  │                  │];                                             
   [│          │ Из них:                                      │                  │                  │                  │                  │];                                             
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 1.2.2.1.1│ Доступ к которым предоставлен через сеть     │ ################ │ ################ │  X               │ X                │](printValue("Ф251__1_2_2_1_1__3") : r, printValue("Ф251__1_2_2_1_1__4") : r);
   [│          │ Интернет                                     │                  │                  │                  │                  │];                                             
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 1.2.2.1.2│ Доступ к которым предоставлен с              │ ################ │ ################ │  X               │ X                │](printValue("Ф251__1_2_2_1_2__3") : r, printValue("Ф251__1_2_2_1_2__4") : r);
   [│          │ использованием мобильных телефонов           │                  │                  │                  │                  │];                                             
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 1.3      │ Корреспондентские счета, счета участников    │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__1_3__3") : r, printValue("Ф251__1_3__4") : r,printValue("Ф251__1_3__5") : r, printValue("Ф251__1_3__6") : r);
   [│          │ расчетов,  открытые кредитным организациям   │                  │                  │                  │                  │];                                             
   [│          │ (их филиалам)                                │                  │                  │                  │                  │];                                             
   [└──────────┴──────────────────────────────────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┘]; 
   [          ];
   [ Раздел 2.];
   [          ];
   [┌──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐];
   [│ 2.1. Сведения о платежах клиентов - юридических лиц, не являющихся кредитными организациями,  с использованием:                      │];
   [├───────────┬──────────────────────────────────────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────┤];
   [│ 2.1.1     │ Платежных поручений                          │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_1_1__3") : r, printValue("Ф251__2_1_1__4") : r, printValue("Ф251__2_1_1__5") : r, printValue("Ф251__2_1_1__6") : r);
   [│           │ Из них:                                      │                  │                  │                  │                  │];                                             
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.1.1.1   │ Представленных в кредитную организацию       │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_1_1_1__3") : r, printValue("Ф251__2_1_1_1__4") : r, printValue("Ф251__2_1_1_1__5") : r, printValue("Ф251__2_1_1_1__6") : r);
   [│           │ электронно                                   │                  │                  │                  │                  │];                                             
   [│           │ Из них:                                      │                  │                  │                  │                  │];                                             
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.1.1.1.1 │ Через сеть Интернет                          │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_1_1_1__3") : r, printValue("Ф251__2_1_1_1__4") : r, printValue("Ф251__2_1_1_1__5") : r, printValue("Ф251__2_1_1_1__6") : r);
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.1.2     │ Аккредитивов                                 │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_1_2__3") : r, printValue("Ф251__2_1_2__4") : r, printValue("Ф251__2_1_2__5") : r, printValue("Ф251__2_1_2__6") : r);
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.1.2.1   │ по распоряжениям об открытии аккредитива     │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_1_2_1__3") : r, printValue("Ф251__2_1_2_1__4") : r, printValue("Ф251__2_1_2_1__5") : r, printValue("Ф251__2_1_2_1__6") : r);
   [│           │ в электронном виде                           │                  │                  │                  │                  │]; 
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.1.3     │ Платежных требований,из них:                 │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_1_3__3") : r, printValue("Ф251__2_1_3__4") : r, printValue("Ф251__2_1_3__5") : r, printValue("Ф251__2_1_3__6") : r);
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.1.3.1   │ по распоряжениям в электронном виде,из них:  │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_1_3__3") : r, printValue("Ф251__2_1_3__4") : r, printValue("Ф251__2_1_3__5") : r, printValue("Ф251__2_1_3__6") : r);
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.1.3.1.1 │ через сеть Интернет                          │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_1_3_1_1__3") : r, printValue("Ф251__2_1_3_1_1__4") : r, printValue("Ф251__2_1_3_1_1__5") : r, printValue("Ф251__2_1_3_1_1__6") : r);
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.1.4     │ Инкассовых поручений,из них:                 │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_1_4__3") : r, printValue("Ф251__2_1_4__4") : r, printValue("Ф251__2_1_4__5") : r, printValue("Ф251__2_1_4__6") : r);
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.1.4.1   │ по распоряжениям в электронном виде          │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_1_4__3") : r, printValue("Ф251__2_1_4__4") : r, printValue("Ф251__2_1_4__5") : r, printValue("Ф251__2_1_4__6") : r);
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.1.5     │ Чеков                                        │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_1_5__3") : r, printValue("Ф251__2_1_5__4") : r, printValue("Ф251__2_1_5__5") : r, printValue("Ф251__2_1_5__6") : r);
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.1.6     │ Банковских ордеров - всего, из них:          │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_1_6__3") : r, printValue("Ф251__2_1_6__4") : r, printValue("Ф251__2_1_6__5") : r, printValue("Ф251__2_1_6__6") : r);
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.1.6.1   │ составленным в электронном виде              │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_1_6__3") : r, printValue("Ф251__2_1_6__4") : r, printValue("Ф251__2_1_6__5") : r, printValue("Ф251__2_1_6__6") : r);
   [├───────────┴──────────────────────────────────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┤];
   [│ 2.2. Сведения о платежах клиентов - физических лиц, с использованием:                                                                │];
   [├───────────┬──────────────────────────────────────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────┤];
   [│ 2.2.1     │ Платежных поручений                          │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_2_1__3") : r, printValue("Ф251__2_2_1__4") : r, printValue("Ф251__2_2_1__5" ) : r, printValue("Ф251__2_2_1__6") : r);
   [│           │ Из них:                                      │                  │                  │                  │                  │];                                             
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.2.1.1   │ Представленных в кредитную организацию       │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_2_1_1__3" ) : r, printValue("Ф251__2_2_1_1__4") : r, printValue("Ф251__2_2_1_1__5") : r, printValue("Ф251__2_2_1_1__6") : r);
   [│           │ электронно, Из них:                          │                  │                  │                  │                  │];                                             
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.2.1.1.1 │ Через сеть Интернет                          │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_2_1_1__3") : r, printValue("Ф251__2_2_1_1__4") : r, printValue("Ф251__2_2_1_1__5") : r, printValue("Ф251__2_2_1_1__6") : r);
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.2.1.1.2 │ С использованием мобильныых телефонов        │                  │                  │                  │                  │];//(printValue("Ф251__2_2_1_1_2__3") : r, printValue("Ф251__2_2_1_1_2__4") : r, printValue("Ф251__2_2_1_1_2__5") : r, printValue("Ф251__2_2_1_1_2__6") : r);
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.2.2     │ Аккредитивов                                 │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_2_2__3") : r, printValue("Ф251__2_2_2__4") : r, printValue("Ф251__2_2_2__5") : r, printValue("Ф251__2_2_2__6") : r);
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.2.2.1   │ по распоряжениям об открытии аккредитива     │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_2_2_1__3") : r, printValue("Ф251__2_2_2_1__4") : r, printValue("Ф251__2_2_2_1__5") : r, printValue("Ф251__2_2_2_1__6") : r);
   [│           │ в электронном виде                           │                  │                  │                  │                  │];
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.2.3     │ Платежных требований                         │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_2_3__3") : r, printValue("Ф251__2_2_3__4") : r, printValue("Ф251__2_2_3__5") : r, printValue("Ф251__2_2_3__6") : r);
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.2.3.1   │ по распоряжениям в электронном виде          │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_2_3_1__3") : r, printValue("Ф251__2_2_3_1__4") : r, printValue("Ф251__2_2_3_1__5") : r, printValue("Ф251__2_2_3_1__6") : r);
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.2.3.1.1 │ через сеть Интернет                          │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_2_3_1_1__3") : r, printValue("Ф251__2_2_3_1_1__4") : r, printValue("Ф251__2_2_3_1_1__5") : r, printValue("Ф251__2_2_3_1_1__6") : r);
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.2.4     │ Инкассовых поручений                         │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_2_4__3") : r, printValue("Ф251__2_2_4__4") : r, printValue("Ф251__2_2_4__5") : r, printValue("Ф251__2_2_4__6") : r);
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.2.4.1   │ по распоряжениям в электронном виде          │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_2_4_1__3") : r, printValue("Ф251__2_2_4_1__4") : r, printValue("Ф251__2_2_4_1__5") : r, printValue("Ф251__2_2_4_1__6") : r);
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.2.5     │ Чеков                                        │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_2_5__3") : r, printValue("Ф251__2_2_5__4") : r, printValue("Ф251__2_2_5__5") : r, printValue("Ф251__2_2_5__6") : r);
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.2.6     │ Банковских ордеров - всего, из них:          │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_2_6__3") : r, printValue("Ф251__2_2_6__4") : r, printValue("Ф251__2_2_6__5") : r, printValue("Ф251__2_2_6__6") : r);
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.2.6.1   │ по распоряжениям в электронном виде          │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_2_6__3") : r, printValue("Ф251__2_2_6__4") : r, printValue("Ф251__2_2_6__5") : r, printValue("Ф251__2_2_6__6") : r);
   [├───────────┴──────────────────────────────────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┤];
   [│ 2.3. Сведения о платежах самой кредитной организации (ее филиала),  с использованием:                                                │];
   [├───────────┬──────────────────────────────────────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────┤];
   [│ 2.3.1     │ Платежных порученийб из них:                 │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_3_1__3") : r, printValue("Ф251__2_3_1__4") : r, printValue("Ф251__2_3_1__5") : r, printValue("Ф251__2_3_1__6") : r);
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.3.1.1   │ по распоряжениям в электронном виде, из них: │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_3_1_1__3") : r, printValue("Ф251__2_3_1_1__4") : r, printValue("Ф251__2_3_1_1__5") : r, printValue("Ф251__2_3_1_1__6") : r);
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.3.1.1.1 │ через сеть Интернет                          │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_3_1_1_1__3") : r, printValue("Ф251__2_3_1_1_1__4") : r, printValue("Ф251__2_3_1_1_1__5") : r, printValue("Ф251__2_3_1_1_1__6") : r);
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.3.2     │ Аккредитивов                                 │                  │                  │                  │                  │];//(printValue("Ф251__2_3_2__3") : r, printValue("Ф251__2_3_2__4") : r, printValue("Ф251__2_3_2__5") : r, printValue("Ф251__2_3_2__6") : r);
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.3.2.1   │ по распоряжениям об открытии аккредитива     │                  │                  │                  │                  │];//(printValue("Ф251__2_3_2__3") : r, printValue("Ф251__2_3_2__4") : r, printValue("Ф251__2_3_2__5") : r, printValue("Ф251__2_3_2__6") : r);
   [│           │ в электронном виде                           │                  │                  │                  │                  │];
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.3.3     │ Платежных требований                         │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_3_3__3") : r, printValue("Ф251__2_3_3__4") : r, printValue("Ф251__2_3_3__5") : r, printValue("Ф251__2_3_3__6") : r);
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.3.3.1   │ по распоряжениям в электронном виде, из них: │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_3_3_1__3") : r, printValue("Ф251__2_3_3_1__4") : r, printValue("Ф251__2_3_3_1__5") : r, printValue("Ф251__2_3_3_1__6") : r);
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.3.3.1.1 │ через сеть Интернет                          │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_3_3_1_1__3") : r, printValue("Ф251__2_3_3_1_1__4") : r, printValue("Ф251__2_3_3_1_1__5") : r, printValue("Ф251__2_3_3_1_1__6") : r);
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.3.4     │ Инкассовых поручений                         │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_3_4__3") : r, printValue("Ф251__2_3_4__4") : r, printValue("Ф251__2_3_4__5") : r, printValue("Ф251__2_3_4__6") : r);
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.3.4.1   │ по распоряжениям в электронном виде, из них: │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_3_4_1__3") : r, printValue("Ф251__2_3_4_1__4") : r, printValue("Ф251__2_3_4_1__5") : r, printValue("Ф251__2_3_4_1__6") : r);
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.3.5     │ Чеков                                        │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_3_5__3") : r, printValue("Ф251__2_3_5__4") : r, printValue("Ф251__2_3_5__5") : r, printValue("Ф251__2_3_5__6") : r);
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.3.6     │ Банковских ордеров - всего, из них:          │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_3_6__3") : r, printValue("Ф251__2_3_6__4") : r, printValue("Ф251__2_3_6__5") : r, printValue("Ф251__2_3_6__6") : r);
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.3.6.1   │ составленных в электронном виде              │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_3_6_1__3") : r, printValue("Ф251__2_3_6_1__4") : r, printValue("Ф251__2_3_6_1__5") : r, printValue("Ф251__2_3_6_1__6") : r);
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.4       │ Сведения о переводах  физических лиц без     │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_4__3") : r, printValue("Ф251__2_4__4") : r, printValue("Ф251__2_4__5") : r, printValue("Ф251__2_4__6") : r);
   [│           │ открытия банковского счета, всего, в том     │                  │                  │                  │                  │];                                             
   [│           │ числе проведенных:                           │                  │                  │                  │                  │];                                             
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.4.1     │ через кассовое подразделение кредитной       │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_4_1__3") : r, printValue("Ф251__2_4_1__4") : r, printValue("Ф251__2_4_1__5") : r, printValue("Ф251__2_4_1__6") : r);
   [│           │ организации (ее филиала)                     │                  │                  │                  │                  │];                                             
   [│           │ в том числе осуществленные:                  │                  │                  │                  │                  │];                                             
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.4.1.1   │ осуществленные в пределах Российской         │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_4_1_1__3") : r, printValue("Ф251__2_4_1_1__4") : r, printValue("Ф251__2_4_1_1__5") : r, printValue("Ф251__2_4_1_1__6") : r);
   [│           │ Федерации, всего, из них:                    │                  │                  │                  │                  │];                                             
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.4.1.1.1 │ в пользу физических лиц                      │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_4_1_1_1__3") : r, printValue("Ф251__2_4_1_1_1__4") : r, printValue("Ф251__2_4_1_1_1__5") : r, printValue("Ф251__2_4_1_1_1__6") : r);
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.4.1.1.2 │ в пользу юридических лич, из них:            │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_4_1_1_2__3") : r, printValue("Ф251__2_4_1_1_2__4") : r, printValue("Ф251__2_4_1_1_2__5") : r, printValue("Ф251__2_4_1_1_2__6") : r);
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│2.4.1.1.2.1│ в погашение кредитов                         │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_4_1_1_2_1__3") : r, printValue("Ф251__2_4_1_1_2_1__4") : r, printValue("Ф251__2_4_1_1_2_1__5") : r, printValue("Ф251__2_4_1_1_2_1__6") : r);
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.4.1.2   │ за пределы Российской Федерации,всего,из них:│ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_4_1_2__3") : r, printValue("Ф251__2_4_1_2__4") : r, printValue("Ф251__2_4_1_2__5") : r, printValue("Ф251__2_4_1_2__6") : r);
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.4.1.2.1 │ в пользу физических лиц                      │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_4_1_2_1__3") : r, printValue("Ф251__2_4_1_2_1__4") : r, printValue("Ф251__2_4_1_2_1__5") : r, printValue("Ф251__2_4_1_2_1__6") : r);
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.4.1.2.2 │ в пользу юридических лиц                     │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_4_1_2_2__3") : r, printValue("Ф251__2_4_1_2_2__4") : r, printValue("Ф251__2_4_1_2_2__5") : r, printValue("Ф251__2_4_1_2_2__6") : r);
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.4.2     │ посредством банкоматов и платежных терминалов│ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_4_2__3") : r, printValue("Ф251__2_4_2__4") : r, printValue("Ф251__2_4_2__5") : r, printValue("Ф251__2_4_2__6") : r);
   [│           │ в том числе осуществленные:                  │                  │                  │                  │                  │];                                             
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.4.2.1   │ в пределах Российской Федерации,всего,из них:│ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_4_2_1__3") : r, printValue("Ф251__2_4_2_1__4") : r, printValue("Ф251__2_4_2_1__5") : r, printValue("Ф251__2_4_2_1__6") : r);
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.4.2.1.1 │ в пользу физических лиц                      │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_4_2_1_1__3") : r, printValue("Ф251__2_4_2_1_1__4") : r, printValue("Ф251__2_4_2_1_1__5") : r, printValue("Ф251__2_4_2_1_1__6") : r);
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.4.2.1.2 │ в пользу юридических лиц, из них:            │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_4_2_1_2__3") : r, printValue("Ф251__2_4_2_1_2__4") : r, printValue("Ф251__2_4_2_1_2__5") : r, printValue("Ф251__2_4_2_1_2__6") : r);
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│2.4.2.1.2.1│ в погашение кредитов                         │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_4_2_1_2_1__3") : r, printValue("Ф251__2_4_2_1_2_1__4") : r, printValue("Ф251__2_4_2_1_2_1__5") : r, printValue("Ф251__2_4_2_1_2_1__6") : r);
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.4.2.2   │ за пределы Российской Федерации,всего,из них:│ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_4_2_2__3") : r, printValue("Ф251__2_4_2_2__4") : r, printValue("Ф251__2_4_2_2__5") : r, printValue("Ф251__2_4_2_2__6") : r);
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.4.2.2.1 │ в пользу физических лиц                      │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_4_2_2_1__3") : r, printValue("Ф251__2_4_2_2_1__4") : r, printValue("Ф251__2_4_2_2_1__5") : r, printValue("Ф251__2_4_2_2_1__6") : r);
   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.4.2.2.2 │ в пользу юридических лиц                     │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_4_2_2_2__3") : r, printValue("Ф251__2_4_2_2_2__4") : r, printValue("Ф251__2_4_2_2_2__5") : r, printValue("Ф251__2_4_2_2_2__6") : r);
//   [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
//   [│ справочно │ Платежи юридических лиц в рамках             │ ################ │  X               │ ################ │  X               │](printValue("Ф251__2_spr_kolwo") : r, printValue("Ф251__2_spr_summa") : r);
//   [│           │ выполнения ими функций платежного агента     │                  │                  │                  │                  │];                                             
//   [│           │ (банковского платежного агента)              │                  │                  │                  │                  │];                                             
// [├───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
// [│ 2.5       │ Платежи с использованием банковских          │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_5__3") : r, printValue("Ф251__2_5__4") : r, printValue("Ф251__2_5__5") : r, printValue("Ф251__2_5__6") : r);
// [│           │ ордеров, всего, из них:                      │                  │                  │                  │                  │];                                             
// [└───────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤]; 
// [│ 2.5.1     │ по уплате (списанию) процентов по привлечен- │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_5_1__3") : r, printValue("Ф251__2_5_1__4") : r, printValue("Ф251__2_5_1__5") : r, printValue("Ф251__2_5_1__6") : r);
// [│           │ным и размещенным денежным средствам, комиссии│                  │                  │                  │                  │];                                             
   [└───────────┴──────────────────────────────────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┘]; 
   [          ];
   [ Раздел 3.];
   [          ];
   [┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐];
   [│ 3. Сведения о платежах проведенных                                                                                                  │];
   [├──────────┬──────────────────────────────────────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────┤];
   [│ 3.1      │ Через корреспондентские счета кредитных      │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__3_1__3" ) : r, printValue("Ф251__3_1__4") : r, printValue("Ф251__3_1__5") : r, printValue("Ф251__3_1__6") : r);
   [│          │ организаций (их филиалов), кроме открытых в  │                  │                  │                  │                  │];
   [│          │ Банке России, и счета участников расчетов    │                  │                  │                  │                  │];
   [│          │ в расчетных небанковских кредитных           │                  │                  │                  │                  │];
   [│          │ организациях, всего. Из них:                 │                  │                  │                  │                  │];
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 3.1.1    │ Электронным cпособом                         │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__3_1_1__3") : r, printValue("Ф251__3_1_1__4") : r, printValue("Ф251__3_1_1__5") : r, printValue("Ф251__3_1_1__6") : r);
   [│          │                                              │                  │                  │                  │                  │];
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
if(fgBank.is_EXV)
   [│ 3.2      │ Через счета межфилиальны расчетов, всего     │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__3_2__3") : r, printValue("Ф251__3_2__4") : r, printValue("Ф251__3_2__5") : r, printValue("Ф251__3_2__6") : r);
else
   [│ 3.2      │ Через счета межфилиальны расчетов, всего     │                  │                  │                  │                  │];//(printValue("Ф251__3_2__3") : r, printValue("Ф251__3_2__4") : r, printValue("Ф251__3_2__5") : r, printValue("Ф251__3_2__6") : r);
end;
   [│          │ из них:                                      │                  │                  │                  │                  │];
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 3.2.1    │ Электронным cпособом                         │                  │                  │                  │                  │];//(printValue("Ф251__3_2_1__3") : r, printValue("Ф251__3_2_1__4") : r, printValue("Ф251__3_2_1__5") : r, printValue("Ф251__3_2_1__6") : r);
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 3.3      │ В пределах одного подразделения кредитной    │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__3_3__3") : r, printValue("Ф251__3_3__4") : r, printValue("Ф251__3_3__5") : r, printValue("Ф251__3_3__6") : r);
   [│          │ организации, всего, из них                   │                  │                  │                  │                  │];
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 3.3.1    │ Электронным способом                         │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__3_3_1__3") : r, printValue("Ф251__3_3_1__4") : r, printValue("Ф251__3_3_1__5") : r, printValue("Ф251__3_3_1__6") : r);
   [│          │                                              │                  │                  │                  │                  │];
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 3.4      │ Через платежную систему Банка России, из них:│ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__3_4__3") : r, printValue("Ф251__3_4__4") : r, printValue("Ф251__3_4__5") : r, printValue("Ф251__3_4__6") : r);
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 3.4.1    │ Электронным способом                         │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__3_4_1__3") : r, printValue("Ф251__3_4_1__4") : r, printValue("Ф251__3_4_1__5") : r, printValue("Ф251__3_4_1__6") : r);
   [│          │                                              │                  │                  │                  │                  │];
   [└──────────┴──────────────────────────────────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┘]; 
   [ Раздел 4.];
   [          ];
   [┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐];
   [│ 4. Сведения о межбанковских переводах и осуществлениях                                                                              │];
   [├──────────┬──────────────────────────────────────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────┤];
   [│ 4.1      │ Межбанковские переводы, проведенные          │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__4_1__3" ) : r, printValue("Ф251__4_1__4") : r, printValue("Ф251__4_1__5") : r, printValue("Ф251__4_1__6") : r);
   [│          │ кредитной организацией (ее филиалом)         │                  │                  │                  │                  │];
   [│          │ со счетов клиентов - кредитных организаций   │                  │                  │                  │                  │];
   [│          │ (филиалов),всего.                            │                  │                  │                  │                  │];
   [│          │ из них:                                      │                  │                  │                  │                  │];
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
/*   [│ 4.1.1    │ на корреспондентские счета других кредитных  │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__4_1_1__3") : r, printValue("Ф251__4_1_1__4") : r, printValue("Ф251__4_1_1__5") : r, printValue("Ф251__4_1_1__6") : r);
   [│          │ организаций (филиалов), открытые в одном     │                  │                  │                  │                  │];
   [│          │ подразделении кредитной организации          │                  │                  │                  │                  │];
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 4.1.2    │ на корреспондентские счета, открытые другим  │                  │                  │                  │                  │];
   [│          │ кредитным организациям (филиалам), через     │                  │                  │                  │                  │];
   [│          │ счета межфилиальных расчетов                 │                  │                  │                  │                  │];
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤]; */
   [│ 4.1.1    │ через платежную систему Банка России         │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__4_1_1__3") : r, printValue("Ф251__4_1_1__4") : r, printValue("Ф251__4_1_1__5") : r, printValue("Ф251__4_1_1__6") : r);
   [└──────────┴──────────────────────────────────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┘]; 
   [ ];
   /* 24.08.2007 Malakhova 111238*/
   [#                                    #]( {Name_Boss}:l, {FIO_Boss}:l );
   [#                                    #]( {Name_Book}:l, {FIO_Book}:l );
   [М.П.];
/*   [Исполнитель                          #](getExecutorName():l);
   [телефон:                             #](ТелефонИсполнителя:l );
  */ [#](trim(string({curdate}:m)));
end;


macro calculate()
   var query, data, query_count, datacount, branch_sql, first, iinsert;
                initprogress(60,"начало расчета","Идет расчет строк отчета");

   var qwas;
//qwas={selfid};
//getstring(qwas);

ttruncate = "TRUNCATE TABLE USR_251_c4eta; " ;
iinsert = rsdcommand(ttruncate);  
iinsert.execute;
ttruncate = "TRUNCATE TABLE USR_251_prov; " ;
iinsert = rsdcommand(ttruncate);  
iinsert.execute;
//ttruncate = "commit" ;     iinsert = rsdcommand(ttruncate);  iinsert.execute;

s1_1_dataopen=" "+
"             and ( ( acc.t_close_date > to_date ( '"+enddate+"', 'dd.mm.yyyy' )        "+
"                    and t_open_date <= to_date ( '"+enddate+"', 'dd.mm.yyyy' ) )       "+
"                  or ( acc.t_close_date = to_date ( '01.01.0001', 'dd.mm.yyyy' )       "+
"                      and t_open_date <= to_date ( '"+enddate+"', 'dd.mm.yyyy' ) ) )   ";

s1_1_c4eta_rub=" "+
"         FROM   daccount_dbt acc,dparty_dbt party LEFT JOIN dpersn_dbt persn ON (party.t_partyid = persn.t_personid) "+
"        WHERE    substr(acc.t_account,1,3) BETWEEN '401' AND '408'      "+
"            AND ((substr(acc.t_account,1,5) <> '40821') or ((substr(acc.t_account,1,5) = '40821') and (substr(acc.t_account,11,1) = 3)))"+
"            AND subStr( acc.t_account, 1, 5 ) NOT IN ('40803', '40810', '40813', '40817', '40820')    "+
"            AND acc.t_client = party.t_partyid "+
"            AND ( (persn.t_isemployer = 'X' AND party.t_legalform = 2) OR (party.t_legalform = 1))     "+
"            AND acc.t_chapter = 1      "+
"            AND acc.t_code_currency = 0 " + s1_1_dataopen;

s1_1_c4eta_val=" "+
"         FROM   daccount_dbt acc,dparty_dbt party LEFT JOIN dpersn_dbt persn ON (party.t_partyid = persn.t_personid) "+
"        WHERE    substr(acc.t_account,1,3) BETWEEN '401' AND '408'      "+
"            AND ((substr(acc.t_account,1,5) <> '40821') or ((substr(acc.t_account,1,5) = '40821') and (substr(acc.t_account,11,1) = 3)))"+
"            AND subStr( acc.t_account, 1, 5 ) NOT IN ('40803', '40810', '40813', '40817', '40820')    "+
"            AND acc.t_client = party.t_partyid "+
"            AND ( (persn.t_isemployer = 'X' AND party.t_legalform = 2) OR (party.t_legalform = 1))     "+
"            AND acc.t_chapter = 1      "+
"            AND acc.t_code_currency <> 0 " + s1_1_dataopen;                                                                                                            //GSP 26.03.2014


s1_1_m_rub= "insert /*+ APPEND*/ into usr_251_c4eta select 11, acc.t_account,1,acc.t_code_currency "+s1_1_c4eta_rub;
message("Вставить счета s1_1_m_rub ");
vstavit_c4eta(s1_1_m_rub);
s1_1_m_rub="            "+
" select count ( 1 ), nvl( round(sum ( rsb_account.resta ( c4et, to_date ( '"+enddate+"', 'DD-MM-YYYY' ), 1, null ) ) / 1000), 0 ) from usr_251_c4eta where stroka=11 and rubli=1";

s1_1_1_rub="insert /*+ APPEND*/ into usr_251_c4eta select 111, c4et,1,code_currency  from usr_251_c4eta where stroka=11 and rubli=1 "+
"             and exists        "+
"                  (select 1    "+
"                   from dacctrn_dbt prov       "+
"                   where prov.t_account_payer = c4et   "+
"                         and prov.t_date_carry between to_date ( '01.01."+substr(string(begindate),7)+"', 'dd.mm.yyyy' )       "+
"                                              and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )     "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
"                         and prov.t_state = 1 "+
"                         and prov.t_chapter = 1        "+
"                         and prov.t_fiid_payer = 0) ";
message("Вставить счета s1_1_m_rub ");
vstavit_c4eta(s1_1_1_rub);
s1_1_1_rub=" select count ( 1 ), nvl( round(sum ( rsb_account.resta ( c4et, to_date ( '"+enddate+"', 'DD-MM-YYYY' ), 1, null ) ) / 1000), 0 ) from usr_251_c4eta where stroka=111 and rubli=1";


s1_1_1_1_rub="insert /*+ APPEND*/ into usr_251_c4eta select 1111, c4et,1,code_currency from usr_251_c4eta, daccount_dbt acc where c4et=acc.t_account and stroka=111 and rubli=1 "+
"             and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' )       and acc.t_chapter=1";
vstavit_c4eta(s1_1_1_1_rub);
s1_1_1_1_rub="select count ( 1 ), nvl( round(sum ( rsb_account.resta ( c4et, to_date ( '"+enddate+"', 'DD-MM-YYYY' ), 1, null ) ) / 1000), 0 ) from usr_251_c4eta where stroka=1111 and rubli=1";


s1_1_1_1_1_rub="insert /*+ APPEND*/ into usr_251_c4eta select 11111, c4et,1,code_currency from usr_251_c4eta, daccount_dbt acc where c4et=acc.t_account and stroka=1111 and rubli=1"+
"             and (acc.t_usertypeaccount like '%Ё%'  )  and acc.t_chapter=1";
vstavit_c4eta(s1_1_1_1_1_rub);
s1_1_1_1_1_rub="select count ( 1 ), nvl( round(sum ( rsb_account.resta ( c4et, to_date ( '"+enddate+"', 'DD-MM-YYYY' ), 1, null ) ) / 1000), 0 ) from usr_251_c4eta where stroka=11111 and rubli=1";



s1_1_m_val= "insert /*+ APPEND*/ into usr_251_c4eta select 11, acc.t_account,0, acc.t_code_currency "+s1_1_c4eta_val;
message("Вставить счета s1_1_m_val ");
vstavit_c4eta(s1_1_m_val);
s1_1_m_val=" select count ( 1 ), nvl( round(sum ( rsb_account.resta ( c4et, to_date ( '"+enddate+"', 'DD-MM-YYYY' ), 1, null,code_currency,0 ) ) / 1000), 0 ) from usr_251_c4eta where stroka=11 and rubli=0";

s1_1_1_val="insert /*+ APPEND*/ into usr_251_c4eta select 111, c4et,0,code_currency from usr_251_c4eta where stroka=11 and rubli=0 "+
"             and exists        "+
"                  (select 1    "+
"                   from dacctrn_dbt prov       "+
"                   where prov.t_account_payer = c4et   "+
"                         and prov.t_date_carry between to_date ( '01.01."+substr(string(begindate),7)+"', 'dd.mm.yyyy' )       "+
"                                              and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )     "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
"                         and prov.t_state = 1 "+
"                         and prov.t_chapter = 1        "+
"                         and prov.t_fiid_payer <> 0) ";                                                                                                         //GSP 26.03.2014 ???
vstavit_c4eta(s1_1_1_val);
s1_1_1_val=" select count ( 1 ), nvl( round(sum ( rsb_account.resta ( c4et, to_date ( '"+enddate+"', 'DD-MM-YYYY' ), 1, null, code_currency,0 ) ) / 1000), 0 ) from usr_251_c4eta where stroka=111 and rubli=0";


s1_1_1_1_val="insert /*+ APPEND*/ into usr_251_c4eta select 1111, c4et,0,code_currency from usr_251_c4eta, daccount_dbt acc where c4et=acc.t_account and stroka=111 and rubli=0"+
"             and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' )       and acc.t_chapter=1";
vstavit_c4eta(s1_1_1_1_val);
s1_1_1_1_val="select count ( 1 ), nvl( round(sum ( rsb_account.resta ( c4et, to_date ( '"+enddate+"', 'DD-MM-YYYY' ), 1, null,code_currency,0 ) ) / 1000), 0 ) from usr_251_c4eta where stroka=1111 and rubli=0";


s1_1_1_1_1_val="insert /*+ APPEND*/ into usr_251_c4eta select 11111, c4et,0,code_currency from usr_251_c4eta, daccount_dbt acc where c4et=acc.t_account and stroka=1111 and rubli=0"+
"             and (acc.t_usertypeaccount like '%Ё%'  )  and acc.t_chapter=1";
vstavit_c4eta(s1_1_1_1_1_val);
s1_1_1_1_1_val="select count ( 1 ), nvl( round(sum ( rsb_account.resta ( c4et, to_date ( '"+enddate+"', 'DD-MM-YYYY' ), 1, null,code_currency,0 ) ) / 1000), 0 ) from usr_251_c4eta where stroka=11111 and rubli=0";


/*------------------------------- 2926-У begin ----------------------------------GSP*/
s1_1_2_c4eta_rub=" "+
"         FROM   daccount_dbt acc,dparty_dbt party LEFT JOIN dpersn_dbt persn ON (party.t_partyid = persn.t_personid) "+
"        WHERE    substr(acc.t_account,1,5) = '40821' "+ 
"            AND substr(acc.t_account,11,1) = 0 "+
"            AND acc.t_client = party.t_partyid "+
"            AND ( (persn.t_isemployer = 'X' AND party.t_legalform = 2) OR (party.t_legalform = 1))     "+
"            AND acc.t_chapter = 1      "+
"            AND acc.t_code_currency = 0        ";

s1_1_2_m_rub= "insert /*+ APPEND*/ into usr_251_c4eta select 112, acc.t_account,1,acc.t_code_currency "+s1_1_2_c4eta_rub+s1_1_dataopen;
message("Вставить счета s1_1_2_m_rub ");
vstavit_c4eta(s1_1_2_m_rub);
s1_1_2_m_rub=" " + " select count ( 1 ), nvl( round(sum ( rsb_account.resta ( c4et, to_date ( '"+enddate+"', 'DD-MM-YYYY' ), 1, null ) ) / 1000), 0 ) from usr_251_c4eta where stroka=112 and rubli = 1";

s1_1_2_c4eta_val=" "+
"         FROM   daccount_dbt acc,dparty_dbt party LEFT JOIN dpersn_dbt persn ON (party.t_partyid = persn.t_personid) "+
"        WHERE    substr(acc.t_account,1,5) = '40821' "+ 
"            AND substr(acc.t_account,11,1) = 0 "+
"            AND acc.t_client = party.t_partyid "+
"            AND ( (persn.t_isemployer = 'X' AND party.t_legalform = 2) OR (party.t_legalform = 1))     "+
"            AND acc.t_chapter = 1      "+
"            AND acc.t_code_currency <> 0        ";

s1_1_2_m_val= "insert /*+ APPEND*/ into usr_251_c4eta select 112, acc.t_account,0,acc.t_code_currency "+s1_1_2_c4eta_val+s1_1_dataopen;
vstavit_c4eta(s1_1_2_m_val);
s1_1_2_m_val=" " + " select count ( 1 ), nvl( round(sum ( rsb_account.resta ( c4et, to_date ( '"+enddate+"', 'DD-MM-YYYY' ), 1, null,code_currency,0 ) ) / 1000), 0 ) from usr_251_c4eta where stroka=112 and rubli = 0";

s1_1_3_c4eta_rub=" "+
"         FROM   daccount_dbt acc,dparty_dbt party LEFT JOIN dpersn_dbt persn ON (party.t_partyid = persn.t_personid) "+
"        WHERE   substr(acc.t_account,1,5) = '40821' "+ 
"            AND substr(acc.t_account,11,1) in(1,2) "+
"            AND acc.t_client = party.t_partyid "+
"            AND ( (persn.t_isemployer = 'X' AND party.t_legalform = 2) OR (party.t_legalform = 1))     "+
"            AND acc.t_chapter = 1      "+
"            AND acc.t_code_currency = 0        ";

s1_1_3_m_rub= "insert /*+ APPEND*/ into usr_251_c4eta select 113, acc.t_account,1,acc.t_code_currency "+s1_1_3_c4eta_rub+s1_1_dataopen;
message("Вставить счета s1_3_m_rub ");
vstavit_c4eta(s1_1_3_m_rub);
s1_1_3_m_rub=" " + " select count ( 1 ), nvl( round(sum ( rsb_account.resta ( c4et, to_date ( '"+enddate+"', 'DD-MM-YYYY' ), 1, null ) ) / 1000), 0 ) from usr_251_c4eta where stroka=113 and rubli = 1";

s1_1_3_c4eta_val=" "+
"         FROM   daccount_dbt acc,dparty_dbt party LEFT JOIN dpersn_dbt persn ON (party.t_partyid = persn.t_personid) "+
"        WHERE   substr(acc.t_account,1,5) = '40821' "+ 
"            AND substr(acc.t_account,11,1) in(1,2) "+
"            AND acc.t_client = party.t_partyid "+
"            AND ( (persn.t_isemployer = 'X' AND party.t_legalform = 2) OR (party.t_legalform = 1))     "+
"            AND acc.t_chapter = 1      "+
"            AND acc.t_code_currency <> 0        ";

s1_1_3_m_val= "insert /*+ APPEND*/ into usr_251_c4eta select 113, acc.t_account,0,acc.t_code_currency "+s1_1_3_c4eta_val+s1_1_dataopen;
vstavit_c4eta(s1_1_3_m_val);
s1_1_3_m_val=" " + " select count ( 1 ), nvl( round(sum ( rsb_account.resta ( c4et, to_date ( '"+enddate+"', 'DD-MM-YYYY' ), 1, null,code_currency ) ) / 1000), 0 ) from usr_251_c4eta where stroka=113 and rubli = 0";

/*------------------------------- 2926-У end ------------------------------------*/

s1_2_c4eta_m1=
"      FROM   daccount_dbt acc                                                                  "+
"     WHERE   acc.t_chapter = 1                                                                                    "+
"         AND (  (   subStr( acc.t_account, 1, 5 ) BETWEEN '42309' AND '42315'                                                   "+
"                 or subStr( acc.t_account, 1, 5 ) BETWEEN '42609' AND '42615'                                                   "+
"                 or subStr( acc.t_account, 1, 5 ) IN ('40803', '40810', '40811', '40813', '47603', '47605', '47608', '47609')   "+
"                )                                                                                                 "+
"             OR (   subStr( acc.t_account, 1, 5 ) IN ('40806', '40809', '40812', '40814', '40815', '40818', '40819')            "+
"                and substr(acc.t_account,-5) not between '00001' and '06999'                                      "+
"                and substr(acc.t_account,-5) not between '10000' and '39999'                                      "+
"                and substr(acc.t_account,-5) not between '58700' and '59999'                                      "+
"                and substr(acc.t_account,-5) not between '80000' and '99999'                                      "+
"                )                                                                                                 "+
"             OR (   subStr( acc.t_account, 1, 5 ) IN ('40817', '40820')                                                         "+
"                and substr(acc.t_account,-5) <> '60164'                                                           "+
"                )                                                                                                 "+
"             )                                                                                                    ";
s1_2_c4eta_rub_=
"            AND substr(acc.t_account,6,3) = '810' ";
s1_2_c4eta_val_=
"            AND substr(acc.t_account,6,3) <> '810' ";

s1_2_dataopen=" "+
"                      AND acc.t_open_date <= TO_DATE ('"+enddate+"', 'dd.mm.yyyy')     "+
"                      AND (acc.t_close_date > TO_DATE ('"+enddate+"', 'dd.mm.yyyy') OR acc.t_close_date = TO_DATE ('01.01.0001', 'dd.mm.yyyy'))        ";


s1_2_c4eta_rub     =s1_2_c4eta_m1 + s1_2_c4eta_rub_ + s1_2_dataopen;
s1_2_c4eta_val     =s1_2_c4eta_m1 + s1_2_c4eta_val_ + s1_2_dataopen;

s1_2_m_rub="insert /*+ APPEND*/ into usr_251_c4eta select 12, acc.t_account,1,acc.t_code_currency "+s1_2_c4eta_rub;
message("Вставить счета s1_2_m_rub ");
vstavit_c4eta(s1_2_m_rub);
s1_2_m_val="insert /*+ APPEND*/ into usr_251_c4eta select 12, acc.t_account,0,acc.t_code_currency "+s1_2_c4eta_val;
vstavit_c4eta(s1_2_m_val);

s1_2_m_rub=" select count ( 1 ), nvl( round(sum ( rsb_account.resta ( c4et, to_date ( '"+enddate+"', 'DD-MM-YYYY' ), 1, null ) ) / 1000), 0 ) from usr_251_c4eta where stroka=12 and rubli=1";
s1_2_m_val=" select count ( 1 ), nvl( round(sum ( rsb_account.resta ( c4et, to_date ( '"+enddate+"', 'DD-MM-YYYY' ), 1, null, code_currency, 0 ) ) / 1000), 0 ) from usr_251_c4eta where stroka=12 and rubli=0"; //GSP 26.03.2014


s1_2_1_rub="insert /*+ APPEND*/ into usr_251_c4eta select 121, c4et,1,code_currency from usr_251_c4eta,daccount_dbt acc "+
" where c4et=acc.t_account and ( (subStr( acc.t_account, 1, 5 ) = '40817' OR subStr( acc.t_account, 1, 5 ) = '40820') AND substr(acc.t_account,-5) <> '60164') "+
" and stroka=12 and rubli=1   ";
message("Вставить счета s1_2_1_rub ");
vstavit_c4eta(s1_2_1_rub);
s1_2_1_rub=" select count ( 1 ), nvl( round(sum ( rsb_account.resta ( c4et, to_date ( '"+enddate+"', 'DD-MM-YYYY' ), 1, null ) ) / 1000), 0 ) from usr_251_c4eta where stroka=121 and rubli=1";

s1_2_1_val="insert /*+ APPEND*/ into usr_251_c4eta select 121, c4et,0,acc.t_code_currency from usr_251_c4eta,daccount_dbt acc "+
" where c4et=acc.t_account and ( (subStr( acc.t_account, 1, 5 ) = '40817' OR subStr( acc.t_account, 1, 5 ) = '40820') AND substr(acc.t_account,-5) <> '60164') "+
" and stroka=12 and rubli=0   ";
vstavit_c4eta(s1_2_1_val);
s1_2_1_val=" select count ( 1 ), nvl( round(sum ( rsb_account.resta ( c4et, to_date ( '"+enddate+"', 'DD-MM-YYYY' ), 1, null, code_currency, 0 ) ) / 1000), 0 ) from usr_251_c4eta where stroka=121 and rubli=0";


s1_2_2_rub="insert /*+ APPEND*/ into usr_251_c4eta select 122, c4et,1,code_currency from usr_251_c4eta where stroka=12 and rubli=1 "+  //здесь может быть так же надо как и для 1.2 - отдельно по счетам для кол-ва, отдельно по счетам для остатков
"             and exists        "+
"                  (select 1    "+
"                   from dacctrn_dbt    "+
"                   where t_account_payer = c4et        "+
"                         and t_date_carry between to_date ( '01.01."+substr(string(begindate),7)+"', 'dd.mm.yyyy' )    "+
"                                              and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )     "+
"                         and t_chapter = 1     "+
"                         and t_fiid_payer = 0                       "+
"                         and substr ( t_account_receiver, 1, 3 ) <> '202')     ";
message("Вставить счета s1_2_2_rub ");
vstavit_c4eta(s1_2_2_rub);
s1_2_2_rub=" select count ( 1 ), nvl( round(sum ( rsb_account.resta ( c4et, to_date ( '"+enddate+"', 'DD-MM-YYYY' ), 1, null ) ) / 1000), 0 ) from usr_251_c4eta where stroka=122 and rubli=1";

s1_2_2_1_rub="insert /*+ APPEND*/ into usr_251_c4eta select 1221, c4et,1,code_currency from usr_251_c4eta,daccount_dbt acc where stroka=122 and rubli=1 "+
"and acc.t_account=c4et and ( acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' ) and acc.t_chapter=1";
vstavit_c4eta(s1_2_2_1_rub);
s1_2_2_1_rub=" select count ( 1 ), nvl( round(sum ( rsb_account.resta ( c4et, to_date ( '"+enddate+"', 'DD-MM-YYYY' ), 1, null ) ) / 1000), 0 ) from usr_251_c4eta where stroka=1221 and rubli=1";


s1_2_2_val="insert /*+ APPEND*/ into usr_251_c4eta select 122, c4et,0,code_currency from usr_251_c4eta where stroka=12 and rubli=0 "+
"             and exists        "+
"                  (select 1    "+
"                   from dacctrn_dbt    "+
"                   where t_account_payer = c4et        "+
"                         and t_date_carry between to_date ( '01.01."+substr(string(begindate),7)+"', 'dd.mm.yyyy' )    "+
"                                              and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )     "+
"                         and t_chapter = 1     "+
"                         and t_fiid_payer <> 0                       "+
"                         and substr ( t_account_receiver, 1, 3 ) <> '202')     ";
vstavit_c4eta(s1_2_2_val);
s1_2_2_val=" select count ( 1 ), nvl( round(sum ( rsb_account.resta ( c4et, to_date ( '"+enddate+"', 'DD-MM-YYYY' ), 1, null,code_currency,0 ) ) / 1000), 0 ) from usr_251_c4eta where stroka=122 and rubli=0";

s1_2_2_1_val="insert /*+ APPEND*/ into usr_251_c4eta select 1221, c4et,0,code_currency from usr_251_c4eta,daccount_dbt acc where stroka=122 and rubli=0 "+
"and acc.t_account=c4et and ( acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' ) and acc.t_chapter=1";
vstavit_c4eta(s1_2_2_1_val);
s1_2_2_1_val=" select count ( 1 ), nvl( round(sum ( rsb_account.resta ( c4et, to_date ( '"+enddate+"', 'DD-MM-YYYY' ), 1, null,code_currency,0 ) ) / 1000), 0 ) from usr_251_c4eta where stroka=1221 and rubli=0";


var s1_3_c4eta_rub:string=" "+
"         FROM   daccount_dbt acc     "+
"        WHERE   acc.t_code_currency = 0        "+
"            AND acc.t_chapter = 1      "+
"            AND subStr( acc.t_account, 1, 5 ) IN ('30109', '30111', '30112', '30113', '30122', '30123', '30214', '30230', '30231')    "+s1_2_dataopen;

s1_3_m_rub="insert /*+ APPEND*/ into usr_251_c4eta select 13,acc.t_account,1,acc.t_code_currency "+s1_3_c4eta_rub;
message("Вставить счета s1_3_m_rub ");
vstavit_c4eta(s1_3_m_rub);
s1_3_m_rub=" select COUNT (1), nvl (ROUND (SUM (rsb_account.resta (c4et, TO_DATE ('"+enddate+"', 'DD-MM-YYYY'), 1, NULL)) / 1000), 0)   from usr_251_c4eta where stroka=13 and rubli=1";

var s1_3_c4eta_val:string=" "+
"         FROM   daccount_dbt acc     "+
"        WHERE   acc.t_code_currency <> 0   "+
"            AND acc.t_chapter = 1      "+
"            AND subStr( acc.t_account, 1, 5 ) IN ('30109', '30111', '30112', '30113', '30122', '30123', '30214', '30230', '30231')    "+s1_2_dataopen;

s1_3_m_val="insert /*+ APPEND*/ into usr_251_c4eta select 13,acc.t_account,0, acc.t_code_currency "+s1_3_c4eta_val;
vstavit_c4eta(s1_3_m_val);
s1_3_m_val=" select COUNT (1), nvl (ROUND (SUM (rsb_account.resta (c4et, TO_DATE ('"+enddate+"', 'DD-MM-YYYY'), 1, NULL,code_currency,0)) / 1000), 0)   from usr_251_c4eta where stroka=13 and rubli=0";

/*------------------------------- 2926-У begin ----------------------------------GSP*/
/*Для объединения выборки по строкам 11,112,113 и дальнейшего использования*/
s11_112_113_s4eta_rub = "         FROM   daccount_dbt acc,dparty_dbt party LEFT JOIN dpersn_dbt persn ON (party.t_partyid = persn.t_personid) "+
"        WHERE   substr(acc.t_account,1,3) BETWEEN '401' AND '408'      "+
"            AND ((substr(acc.t_account,1,5) <> '40821') or ((substr(acc.t_account,1,5) = '40821') and (substr(acc.t_account,11,1) in (0,1,2,3))))"+
"            AND subStr( acc.t_account, 1, 5 ) NOT IN ('40803', '40810', '40813', '40817', '40820')    "+
"            AND acc.t_client = party.t_partyid "+
"            AND ( (persn.t_isemployer = 'X' AND party.t_legalform = 2) OR (party.t_legalform = 1))     "+
"            AND acc.t_chapter = 1      "+
"            AND acc.t_code_currency = 0 " + s1_1_dataopen;

s11_112_113_s4eta_val = "         FROM   daccount_dbt acc,dparty_dbt party LEFT JOIN dpersn_dbt persn ON (party.t_partyid = persn.t_personid) "+
"        WHERE   substr(acc.t_account,1,3) BETWEEN '401' AND '408'      "+
"            AND ((substr(acc.t_account,1,5) <> '40821') or ((substr(acc.t_account,1,5) = '40821') and (substr(acc.t_account,11,1) in (0,1,2,3))))"+
"            AND subStr( acc.t_account, 1, 5 ) NOT IN ('40803', '40810', '40813', '40817', '40820')    "+
"            AND acc.t_client = party.t_partyid "+
"            AND ( (persn.t_isemployer = 'X' AND party.t_legalform = 2) OR (party.t_legalform = 1))     "+
"            AND acc.t_chapter = 1      "+
"            AND acc.t_code_currency <> 0 " + s1_1_dataopen;
/*------------------------------- 2926-У end ------------------------------------*/

s2_1_1_uni = 
"     FROM   usr_251_c4eta, dacctrn_dbt prov                                                       "+
"    WHERE   c4et = prov.t_account_payer                                                           "+
"            AND stroka = 211                                                                      "+
"            AND substr(prov.t_account_payer,-5) <> substr(prov.t_account_receiver,-5)             "+
"            AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"','dd.mm.yyyy')                  "+
"                                      AND TO_DATE ('"+enddate+"','dd.mm.yyyy')                    "+
"            and prov.t_state = 1                                                                  "+ // EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
"            AND prov.t_chapter = 1                                                                "+
"            AND (prov.t_shifr_oper = '01'                                                         "+
"                OR (prov.t_shifr_oper = '16'                                                      "+
"                    and exists (select 1                                                          "+
"                                 from dpmdocs_dbt docs, dpmrmprop_dbt pmrm, dpmlink_dbt pmlnk     "+
"                                where prov.t_acctrnid = DOCS.t_acctrnid               "+
"                                  and DOCS.T_PAYMENTID = pmlnk.T_PURPOSEPAYMENT                   "+
"                                  and PMLNK.T_INITIALPAYMENT = PMRM.T_PAYMENTID                   "+
"                                  and PMRM.T_SHIFROPER = '01')))                                  ";

originExists = 
"            and exists(select 1 from dpmdocs_dbt docs, dpmpaym_dbt pm                                       "+
"                        where prov.t_acctrnid = DOCS.t_acctrnid                                 "+
"                          and DOCS.T_PAYMENTID = PM.T_PAYMENTID                                             "+
"                          and  case when (pm.t_dockind in (15,16,17,18,27,70,201,202,203,400,410,420,430))  "+
"                               then decode( user_ea.getOrigin(pm.t_docKind, pm.t_paymentID),                "+
"                               9999, decode( pm.t_primdocorigin, 9999, pm.t_origin, pm.t_primdocorigin ),   "+
"                               user_ea.getOrigin(pm.t_docKind, pm.t_paymentID) )                            "+
"                               else decode( pm.t_primdocorigin, 9999, pm.t_origin, pm.t_primdocorigin ) end "; 

s2_1_1_rub="insert /*+ APPEND*/ into usr_251_c4eta select 211, acc.t_account,1,acc.t_code_currency "+ s11_112_113_s4eta_rub;
message("Вставить счета s2_1_1_rub ");
vstavit_c4eta(s2_1_1_rub);
s2_1_1_val="insert /*+ APPEND*/ into usr_251_c4eta select 211, acc.t_account,0,acc.t_code_currency "+ s11_112_113_s4eta_val;
vstavit_c4eta(s2_1_1_val);

s2_1_1_rub = " insert /*+ APPEND*/ into usr_251_prov select 211, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry,    "+ 
             "                                 prov.t_sum_natcur, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper "+ s2_1_1_uni + " AND rubli = 1 ";
vstavit_c4eta(s2_1_1_rub);
s2_1_1_rub = " select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=211 and rubli=1 ";
s2_1_1_val = " insert /*+ APPEND*/ into usr_251_prov select 211, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, "+
             "                                 prov.t_sum_natcur, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper "+ s2_1_1_uni + " AND rubli = 0 ";
vstavit_c4eta(s2_1_1_val);
s2_1_1_val = " select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=211 and rubli=0 ";



s2_1_1_1_rub="insert /*+ APPEND*/ into usr_251_c4eta select 2111, acc.t_account,1,acc.t_code_currency "+s1_1_c4eta_rub ; 
vstavit_c4eta(s2_1_1_1_rub);

s2_1_1_1_rub=" "+
"  insert /*+ APPEND*/ into usr_251_prov  select 2111, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
   s2_1_1_uni + " AND rubli = 1 " + originExists + " in (2,6,2100,3200)) ";
vstavit_c4eta(s2_1_1_1_rub);
s2_1_1_1_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2111 and rubli=1 ";


s2_1_1_1_val="insert /*+ APPEND*/ into usr_251_c4eta select 2111, acc.t_account,0,acc.t_code_currency "+s1_1_c4eta_val ; 
vstavit_c4eta(s2_1_1_1_val);
s2_1_1_1_val=" "+
"  insert /*+ APPEND*/ into usr_251_prov  select 2111, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
   s2_1_1_uni + " AND rubli = 0 " + originExists + " in (2,6,2100,3200)) ";
vstavit_c4eta(s2_1_1_1_val);
s2_1_1_1_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2111 and rubli=0 ";




s2_1_1_1_1_rub="insert /*+ APPEND*/ into usr_251_c4eta select 21111, acc.t_account,1,acc.t_code_currency "+s1_1_c4eta_rub ;
message("Вставить счета s2_1_1_1_1_rub ");
vstavit_c4eta(s2_1_1_1_1_rub);
s2_1_1_1_1_rub=" "+
"   insert /*+ APPEND*/   into usr_251_prov  select 21111, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
"     FROM   usr_251_c4eta, dacctrn_dbt prov                                                       "+
"    WHERE   c4et = prov.t_account_payer                                                           "+
"            AND stroka = 21111                                                                    "+
"            and (substr(prov.t_account_payer,1,5) <> substr(prov.t_account_receiver,1,5)          "+
"                 or substr(prov.t_account_payer,-5) <> substr(prov.t_account_receiver,-5))        "+
"            AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"','dd.mm.yyyy')                  "+
"                                      AND TO_DATE ('"+enddate+"','dd.mm.yyyy')                    "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
"            and prov.t_state = 1 "+
"            AND prov.t_chapter = 1                                                                "+
"            AND prov.t_shifr_oper = '01'                                                          "+
"            AND rubli = 1 " + originExists + " in (2,6,2100,3200))                                ";

vstavit_c4eta(s2_1_1_1_1_rub);
s2_1_1_1_1_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=21111 and rubli=1 ";

s2_1_1_1_1_val="insert /*+ APPEND*/ into usr_251_c4eta select 21111, acc.t_account,0,acc.t_code_currency "+s1_1_c4eta_val ;
vstavit_c4eta(s2_1_1_1_1_val);
s2_1_1_1_1_val=" "+
"  insert /*+ APPEND*/ into usr_251_prov  select 21111, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
"     FROM   usr_251_c4eta, dacctrn_dbt prov                                                       "+
"    WHERE   c4et = prov.t_account_payer                                                           "+
"            AND stroka = 21111                                                                    "+
"            and (substr(prov.t_account_payer,1,5) <> substr(prov.t_account_receiver,1,5)          "+
"                 or substr(prov.t_account_payer,-5) <> substr(prov.t_account_receiver,-5))        "+
"            AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"','dd.mm.yyyy')                  "+
"                                      AND TO_DATE ('"+enddate+"','dd.mm.yyyy')                    "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
"            and prov.t_state = 1 "+
"            AND prov.t_chapter = 1                                                                "+
"            AND prov.t_shifr_oper = '01'                                                          "+
"            AND rubli = 0 " + originExists + " in (2,6,2100,3200))                                ";
vstavit_c4eta(s2_1_1_1_1_val);
s2_1_1_1_1_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=21111 and rubli=0 ";

/*------------------------------- 2926-У begin ----------------------------------GSP*/
/*------------ переписано условие отбора. добавлена новая строка.------------------ */
s2_1_2_rub="insert /*+ APPEND*/ into usr_251_c4eta select 212, acc.t_account,1,acc.t_code_currency "+s1_1_c4eta_rub;
s2_1_2_val="insert /*+ APPEND*/ into usr_251_c4eta select 212, acc.t_account,0,acc.t_code_currency "+s1_1_c4eta_val;
message("Вставить счета s2_1_2_rub ");
vstavit_c4eta(s2_1_2_rub);
vstavit_c4eta(s2_1_2_val);
s2_1_2_rub=" "+
"  insert /*+ APPEND*/ into usr_251_prov  select 212, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 1,prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
"  from usr_251_c4eta, dacctrn_dbt prov, dpmrmprop_dbt pmrm, dpmdocs_dbt docs "+
"where stroka=212 and rubli=1 and c4et=prov.t_account_payer  "+
"      and prov.t_acctrnid = docs.t_acctrnid "+
"      and pmrm.t_paymentid = docs.t_paymentid "+
"      and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )    "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
"      and prov.t_state = 1 "+
"      and substr ( prov.t_account_payer, 6, 3 ) = '810' "+
"      and (substr( prov.t_account_receiver, 1, 5 )='40901' or substr( prov.t_account_receiver, 1, 5 )='40902' or pmrm.t_shifroper = '08') "+
"      and prov.t_chapter=1 ";
vstavit_c4eta(s2_1_2_rub);
s2_1_2_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=212 and rubli=1 ";

s2_1_2_val=" "+
"  insert /*+ APPEND*/ into usr_251_prov  select 212, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 0,prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
"  from usr_251_c4eta, dacctrn_dbt prov "+
"where  stroka=212 and rubli=0 and c4et=prov.t_account_payer"+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
"      and prov.t_state = 1 "+
"      and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )    "+
"      and substr ( prov.t_account_payer, 6, 3 ) != '810' "+
"      and substr ( prov.t_account_payer, 1, 5 ) in ('47409','47410')  "+
"      and substr( prov.t_account_receiver, 1, 5 ) like '301%'"+
"      and prov.t_chapter=1 ";
vstavit_c4eta(s2_1_2_val);
s2_1_2_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=212 and rubli=0 ";


s2_1_2_1_rub=" "+
"   insert /*+ APPEND*/ into usr_251_prov  select 2121, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 1,prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
"     from usr_251_c4eta, dacctrn_dbt prov, dpmpaym_dbt paym, dpmdocs_dbt docs, dpmrmprop_dbt pmrm"+
"    where stroka=212 and rubli=1 and c4et=prov.t_account_payer  "+
"      and prov.t_acctrnid = docs.t_acctrnid "+
"      and docs.t_paymentid = paym.t_paymentid "+
"      and pmrm.t_paymentid = paym.t_paymentid "+
"      and paym.t_origin in (2,3200,3300) "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
"      and prov.t_state = 1 "+
"      and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )    "+
"      and substr ( prov.t_account_payer, 6, 3 ) = '810' "+
"      and (substr( prov.t_account_receiver, 1, 5 )='40901' or substr( prov.t_account_receiver, 1, 5 )='40902' or pmrm.t_shifroper = '08') "+
"      and prov.t_chapter=1 ";
vstavit_c4eta(s2_1_2_1_rub);
s2_1_2_1_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2121 and rubli=1 ";

s2_1_2_1_val=" "+
"   insert /*+ APPEND*/ into usr_251_prov  select 2121, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 0,prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
"     from usr_251_c4eta, dacctrn_dbt prov, dpmpaym_dbt paym, dpmdocs_dbt docs "+
"    where  stroka=212 and rubli=0 and c4et=prov.t_account_payer"+
"      and prov.t_acctrnid = docs.t_acctrnid "+
"      and docs.t_paymentid = paym.t_paymentid "+
"      and paym.t_origin in (2,3200) "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
"      and prov.t_state = 1 "+
"      and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )    "+
"      and substr ( prov.t_account_payer, 6, 3 ) != '810' "+
"      and substr ( prov.t_account_payer, 1, 5 ) in ('47409','47410')  "+
"      and substr( prov.t_account_receiver, 1, 5 ) like '301%'"+
"      and prov.t_chapter=1 ";
vstavit_c4eta(s2_1_2_1_val);
s2_1_2_1_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2121 and rubli=0 ";
/*------------------------------- 2926-У end ------------------------------------*/

/*s2_1_3_uni = /*   Берем шифр операции с проводки */
"     FROM   usr_251_c4eta, darhdoc_dbt prov                                                       "+
"    WHERE   c4et = prov.t_account_payer                                                           "+
"            AND stroka = 213                                                                      "+
"            and (substr(prov.t_account_payer,1,5) <> substr(prov.t_account_receiver,1,5)          "+
"                 or substr(prov.t_account_payer,-5) <> substr(prov.t_account_receiver,-5))        "+
"            AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"','dd.mm.yyyy')                  "+
"                                      AND TO_DATE ('"+enddate+"','dd.mm.yyyy')                    "+
"            AND prov.t_chapter = 1                                                                "+
"            AND (prov.t_shifr_oper = '02'                                                         "+
"                OR (prov.t_shifr_oper = '16'                                                      "+
"                    and exists (select 1                                                          "+
"                                 from dpmdocs_dbt docs, dpmrmprop_dbt pmrm, dpmlink_dbt pmlnk     "+
"                                where prov.T_APPLICATIONKEY = DOCS.T_APPLICATIONKEY               "+
"                                  and DOCS.T_PAYMENTID = pmlnk.T_PURPOSEPAYMENT                   "+
"                                  and pmlnk.T_INITIALPAYMENT = PMRM.T_PAYMENTID                   "+
"                                  and PMRM.T_SHIFROPER in ('02','09'))))                          ";
*/



s2_1_3_uni = /*   Берем шифр операции из свойств документа */
"     FROM   usr_251_c4eta, dacctrn_dbt prov,dpmdocs_dbt docs, dpmrmprop_dbt pmrm                 "+
"    WHERE   c4et = prov.t_account_payer                                                          "+ 
"            and prov.t_acctrnid = DOCS.t_acctrnid                                    "+
"            and DOCS.T_PAYMENTID = PMRM.T_PAYMENTID                                              "+
"            AND stroka = 213                                                                     "+ 
"            and (substr(prov.t_account_payer,1,5) <> substr(prov.t_account_receiver,1,5)         "+ 
"                 or substr(prov.t_account_payer,-5) <> substr(prov.t_account_receiver,-5))       "+ 
"            AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"','dd.mm.yyyy')                 "+
"                                      AND TO_DATE ('"+enddate+"','dd.mm.yyyy')                   "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
"            and prov.t_state = 1 "+
"            AND prov.t_chapter = 1                                                               "+ 
"            AND (PMRM.T_SHIFROPER = '02'                                                         "+
"                OR (PMRM.T_SHIFROPER = '16'                                                      "+
"                    and exists (select 1                                                         "+ 
"                                 from dpmpaym_dbt paym                                           "+
"                                where DOCS.T_PAYMENTID = PAYM.T_PAYMENTID                        "+
"                                  and PAYM.T_PARTPAYMSHIFRMAIN in ('02','09'))))                 ";

s2_1_3_rub="insert /*+ APPEND*/ into usr_251_c4eta select 213, acc.t_account,1,acc.t_code_currency "+ s11_112_113_s4eta_rub;
s2_1_3_val="insert /*+ APPEND*/ into usr_251_c4eta select 213, acc.t_account,0,acc.t_code_currency "+ s11_112_113_s4eta_val;
message("Вставить счета s2_1_3_rub ");
vstavit_c4eta(s2_1_3_rub);
vstavit_c4eta(s2_1_3_val);

s2_1_3_rub=" "+
" insert /*+ APPEND*/ into usr_251_prov  select 213, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+ s2_1_3_uni + " AND rubli = 1 ";
vstavit_c4eta(s2_1_3_rub);
s2_1_3_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=213 and rubli=1 ";
s2_1_3_val=" "+
" insert /*+ APPEND*/ into usr_251_prov  select 213, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+  s2_1_3_uni + " AND rubli = 0 ";
vstavit_c4eta(s2_1_3_val);
s2_1_3_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=213 and rubli=0 ";

/*------------------------------- 2926-У begin ----------------------------------GSP*/
/* -------------------- реализация строк 2.1.3.1 и 2.1.3.1.1 -----------------------*/
s2_1_3_1_rub=" "+
" insert /*+ APPEND*/ into usr_251_prov  select 2131, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+ s2_1_3_uni + " AND rubli = 1"+ originExists + "in (2,6,2100,3200,3300))";


/*" from usr_251_c4eta, darhdoc_dbt prov, dpmpaym_dbt paym, dpmdocs_dbt docs "+
"where stroka=213 and rubli=1 and c4et=prov.t_account_payer and (trim(prov.t_shifr_oper) = '02' or trim(prov.t_shifr_oper) = '16')"
"      and prov.t_applicationkey = docs.t_applicationkey "+
"      and docs.t_paymentid = paym.t_paymentid "+
"      and paym.t_origin in (2,3200,3300) "+
"      and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )    "+
"      and substr ( prov.t_account_payer, 6, 3 ) = '810' "+
"      and prov.t_chapter=1 ";*/

vstavit_c4eta(s2_1_3_1_rub);
s2_1_3_1_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2131 and rubli=1 ";

s2_1_3_1_val=" "+
" insert /*+ APPEND*/ into usr_251_prov  select 2131, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+ s2_1_3_uni + " AND rubli = 0"+ originExists + "in (2,6,2100,3200,3300))";
/*" from usr_251_c4eta, darhdoc_dbt prov, dpmpaym_dbt paym, dpmdocs_dbt docs "+
"where stroka=213 and rubli=0 and c4et=prov.t_account_payer and (trim(prov.t_shifr_oper) = '02' or trim(prov.t_shifr_oper) = '16') " +
"      and prov.t_applicationkey = docs.t_applicationkey "+
"      and docs.t_paymentid = paym.t_paymentid "+
"      and paym.t_origin in (2,3200) "+
"      and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )    "+
"      and substr ( prov.t_account_payer, 6, 3 ) != '810' "+
"      and prov.t_chapter=1 ";*/
vstavit_c4eta(s2_1_3_1_val);
s2_1_3_1_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2131 and rubli=0 ";


s2_1_3_1_1_rub=" "+
" insert /*+ APPEND*/ into usr_251_prov  select 21311, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
"     FROM   usr_251_c4eta, dacctrn_dbt prov,dpmdocs_dbt docs, dpmrmprop_dbt pmrm                 "+
"    WHERE   c4et = prov.t_account_payer                                                          "+ 
"            and prov.t_acctrnid = DOCS.t_acctrnid                                    "+
"            and DOCS.T_PAYMENTID = PMRM.T_PAYMENTID                                              "+
"            AND stroka = 213                                                                     "+ 
"            and (substr(prov.t_account_payer,1,5) <> substr(prov.t_account_receiver,1,5)         "+ 
"                 or substr(prov.t_account_payer,-5) <> substr(prov.t_account_receiver,-5))       "+ 
"            AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"','dd.mm.yyyy')                 "+
"                                      AND TO_DATE ('"+enddate+"','dd.mm.yyyy')                   "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
"            and prov.t_state = 1 "+
"            AND prov.t_chapter = 1                                                               "+ 
"            AND PMRM.T_SHIFROPER = '02'                                                          "+
"            AND rubli = 1"+ originExists + "in (2,6,2100,3200,3300))";
vstavit_c4eta(s2_1_3_1_1_rub);
s2_1_3_1_1_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=21311 and rubli=1 ";

s2_1_3_1_1_val=" "+
" insert /*+ APPEND*/ into usr_251_prov  select 2131, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+ 
"     FROM   usr_251_c4eta, dacctrn_dbt prov,dpmdocs_dbt docs, dpmrmprop_dbt pmrm                 "+
"    WHERE   c4et = prov.t_account_payer                                                          "+ 
"            and prov.t_acctrnid = DOCS.t_acctrnid                                    "+
"            and DOCS.T_PAYMENTID = PMRM.T_PAYMENTID                                              "+
"            AND stroka = 213                                                                     "+ 
"            and (substr(prov.t_account_payer,1,5) <> substr(prov.t_account_receiver,1,5)         "+ 
"                 or substr(prov.t_account_payer,-5) <> substr(prov.t_account_receiver,-5))       "+ 
"            AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"','dd.mm.yyyy')                 "+
"                                      AND TO_DATE ('"+enddate+"','dd.mm.yyyy')                   "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
"            and prov.t_state = 1 "+
"            AND prov.t_chapter = 1                                                               "+ 
"            AND PMRM.T_SHIFROPER = '02'                                                          "+
"            AND rubli = 0"+ originExists + "in (2,6,2100,3200,3300))                             ";
vstavit_c4eta(s2_1_3_1_1_val);
s2_1_3_1_1_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=21311 and rubli=0 ";
/*------------------------------- 2926-У end ------------------------------------*/

s2_1_4_uni = 
"     FROM   usr_251_c4eta, dacctrn_dbt prov                                                       "+
"    WHERE   c4et = prov.t_account_payer                                                           "+
"            AND stroka = 214                                                                      "+
"            and (substr(prov.t_account_payer,1,5) <> substr(prov.t_account_receiver,1,5)          "+
"                 or substr(prov.t_account_payer,-5) <> substr(prov.t_account_receiver,-5))        "+
"            AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"','dd.mm.yyyy')                  "+
"                                      AND TO_DATE ('"+enddate+"','dd.mm.yyyy')                    "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
"            and prov.t_state = 1 "+
"            AND prov.t_chapter = 1                                                                "+
"            AND (prov.t_shifr_oper = '06'                                                         "+
"                OR (prov.t_shifr_oper = '16'                                                      "+
"                    and exists (select 1                                                          "+
"                                 from dpmdocs_dbt docs, dpmrmprop_dbt pmrm, dpmlink_dbt pmlnk     "+
"                                where prov.t_acctrnid = DOCS.t_acctrnid               "+
"                                  and DOCS.T_PAYMENTID = pmlnk.T_PURPOSEPAYMENT                   "+
"                                  and PMLNK.T_INITIALPAYMENT = PMRM.T_PAYMENTID                   "+
"                                  and PMRM.T_SHIFROPER = '06')))                                  ";

s2_1_4_rub="insert /*+ APPEND*/ into usr_251_c4eta select 214, acc.t_account,1,acc.t_code_currency "+ s11_112_113_s4eta_rub; 
s2_1_4_val="insert /*+ APPEND*/ into usr_251_c4eta select 214, acc.t_account,0,acc.t_code_currency "+ s11_112_113_s4eta_val; 
message("Вставить счета s2_1_4_rub ");
vstavit_c4eta(s2_1_4_rub);
vstavit_c4eta(s2_1_4_val);

s2_1_4_rub=" insert /*+ APPEND*/ into usr_251_prov  select 214, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+ s2_1_4_uni + " AND rubli = 1 ";
vstavit_c4eta(s2_1_4_rub);
s2_1_4_rub=" select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=214 and rubli=1 ";

s2_1_4_val=" insert /*+ APPEND*/ into usr_251_prov  select 214, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+ s2_1_4_uni + " AND rubli = 0 ";
vstavit_c4eta(s2_1_4_val);
s2_1_4_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=214 and rubli=0 ";

/*------------------------------- 2926-У begin ----------------------------------GSP*/
/* ------------------------- реализация строк 2.1.4.1 ------------------------------*/
s2_1_4_1_rub=" insert /*+ APPEND*/ into usr_251_prov  select 2141, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, t_sum_natcur, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+ s2_1_4_uni + " AND rubli = 1"+ originExists + "in (2,6,2100,3200,3300,19))";
/*" from usr_251_c4eta, darhdoc_dbt prov, dpmpaym_dbt paym, dpmdocs_dbt docs "+
"where stroka=214 and rubli=1 and c4et=prov.t_account_payer and (trim(prov.t_shifr_oper) = '06' or trim(prov.t_shifr_oper) = '16')" +
"      and prov.t_applicationkey = docs.t_applicationkey "+
"      and docs.t_paymentid = paym.t_paymentid "+
"      and paym.t_origin in (2,3200,3300) "+
"      and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )    "+
"      and substr ( prov.t_account_payer, 6, 3 ) = '810' "+
"      and prov.t_chapter=1 ";*/
vstavit_c4eta(s2_1_4_1_rub);
s2_1_4_1_rub=" select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2141 and rubli=1 ";

s2_1_4_1_val=" insert /*+ APPEND*/ into usr_251_prov  select 2141, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+ s2_1_4_uni + " AND rubli = 0"+ originExists + "in (2,6,2100,3200,3300,19))";
/*" from usr_251_c4eta, darhdoc_dbt prov, dpmpaym_dbt paym, dpmdocs_dbt docs "+
"where stroka=214 and rubli=0 and c4et=prov.t_account_payer and (trim(prov.t_shifr_oper) = '06' or trim(prov.t_shifr_oper) = '16')" +
"      and prov.t_applicationkey = docs.t_applicationkey "+
"      and docs.t_paymentid = paym.t_paymentid "+
"      and paym.t_origin in (2,3200) "+
"      and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )    "+
"      and substr ( prov.t_account_payer, 6, 3 ) != '810' "+
"      and prov.t_chapter=1 ";*/
vstavit_c4eta(s2_1_4_1_val);
s2_1_4_1_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2141 and rubli=0 ";
/*------------------------------- 2926-У end ------------------------------------*/

s2_1_5_rub="insert /*+ APPEND*/ into usr_251_c4eta select 215, c4et,1,code_currency from usr_251_c4eta where stroka=212 and rubli=1";
s2_1_5_val="insert /*+ APPEND*/ into usr_251_c4eta select 215, c4et,0,code_currency from usr_251_c4eta where stroka=212 and rubli=0";
vstavit_c4eta(s2_1_5_rub);
vstavit_c4eta(s2_1_5_val);

s2_1_5_rub=" insert /*+ APPEND*/ into usr_251_prov  select 215, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
" from usr_251_c4eta, dacctrn_dbt prov "+
"where stroka=215 and rubli=1 and c4et=prov.t_account_payer and (trim(prov.t_shifr_oper) = '07' ) "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
"      and prov.t_state = 1 "+
"      and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )    "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
"      and prov.t_state = 1 "+
"      and substr ( prov.t_account_payer, 6, 3 ) = '810' "+
"      and prov.t_chapter=1 ";
message("Вставить счета s2_1_5_rub ");
vstavit_c4eta(s2_1_5_rub);
s2_1_5_rub=" select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=215 and rubli=1 ";

s2_1_5_val=" insert /*+ APPEND*/ into usr_251_prov  select 215, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
" from usr_251_c4eta, dacctrn_dbt prov "+
"where stroka=215 and rubli=0 and c4et=prov.t_account_payer and (trim(prov.t_shifr_oper) = '07' ) "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
"      and prov.t_state = 1 "+
"      and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )    "+
"      and substr ( prov.t_account_payer, 6, 3 ) != '810' "+
"      and prov.t_chapter=1 ";
vstavit_c4eta(s2_1_5_val);
s2_1_5_val=" select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=215 and rubli=0 ";

debugbreak;
debugbreak;

s2_1_6_rub="insert /*+ APPEND*/ into usr_251_c4eta select 216, c4et,1,code_currency from usr_251_c4eta where stroka=212 and rubli=1";
s2_1_6_val="insert /*+ APPEND*/ into usr_251_c4eta select 216, c4et,0,code_currency from usr_251_c4eta where stroka=212 and rubli=0";
vstavit_c4eta(s2_1_6_rub);
vstavit_c4eta(s2_1_6_val);


s2_1_6_rub=" insert /*+ APPEND*/ into usr_251_prov  "+
" select 216, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper   "+ 
" from usr_251_c4eta, dacctrn_dbt prov "+
" where stroka=216 and rubli=1 AND ((c4et = prov.t_account_payer) or ( substr( prov.t_account_payer, 1, 5 ) ='70606' and t_account_receiver = c4et)) "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
"      and prov.t_state = 1 "+
"      and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )                  "+
"                                and to_date ( '"+enddate+"', 'dd.mm.yyyy' )                    "+
"      and substr ( prov.t_account_payer, 6, 3 ) = '810'                                        "+
"      AND (TRIM (prov.t_shifr_oper) = '17'                                                     "+
"           OR (prov.t_shifr_oper = '16'                                                        "+
"              and exists (select 1                                                             "+
"                            from dpmdocs_dbt docs, dpmrmprop_dbt pmrm, dpmlink_dbt pmlnk       "+
"                           where prov.t_acctrnid = DOCS.t_acctrnid                             "+
"                             and DOCS.T_PAYMENTID = pmlnk.T_PURPOSEPAYMENT                     "+
"                             and PMLNK.T_INITIALPAYMENT = PMRM.T_PAYMENTID                     "+
"                             and PMRM.T_SHIFROPER = '17')))                                    "+
"      AND  (TRIM (t_kind_oper) = '1' OR TRIM (t_kind_oper) = '6')                              "+
"      and not substr(prov.t_account_receiver,1,3) between '441' and '458'                      "+
"      and substr(prov.t_account_receiver,1,5) not in ('30232','40602','40701','40702','40703') "+  /* GSP C-34616 */
"      and prov.t_chapter=1                                                                     "+
"      UNION all                                                                                "+
" select 216, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper    from usr_251_c4eta, dacctrn_dbt prov"+
" where prov.t_shifr_oper = '09' and  TRIM (t_kind_oper) = '6' "+
" and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
" and prov.t_state = 1 "+
" and prov.t_chapter=1  "+
" and stroka=216 and rubli=1 "+
" and ((c4et=prov.t_account_payer and substr( prov.t_account_receiver, 1, 5 )='70601') or (c4et=prov.t_account_receiver and substr( prov.t_account_payer, 1, 5 )='70606')) and not substr(prov.t_account_receiver,1,3) between '441' and '458' ";
vstavit_c4eta(s2_1_6_rub);
s2_1_6_rub=" select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=216 and rubli=1 ";

s2_1_6_val=" insert /*+ APPEND*/ into usr_251_prov  "+
" select 216, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper   from usr_251_c4eta, dacctrn_dbt prov "+
" where stroka=216 and rubli=0 AND ((c4et = prov.t_account_payer) or (subStr( prov.t_account_payer, 1, 5 ) ='70606' and t_account_receiver = c4et)) "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
"      and prov.t_state = 1                                                                     "+
"      and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )                  "+
"                                and to_date ( '"+enddate+"', 'dd.mm.yyyy' )                    "+
"      /*and substr ( prov.t_account_payer, 6, 3 ) = '810'*/                                    "+
"      AND (TRIM (prov.t_shifr_oper) = '17'                                                     "+
"           OR (prov.t_shifr_oper = '16'                                                        "+
"              and exists (select 1                                                             "+
"                            from dpmdocs_dbt docs, dpmrmprop_dbt pmrm, dpmlink_dbt pmlnk       "+
"                           where prov.t_acctrnid = DOCS.t_acctrnid                             "+
"                             and DOCS.T_PAYMENTID = pmlnk.T_PURPOSEPAYMENT                     "+
"                             and PMLNK.T_INITIALPAYMENT = PMRM.T_PAYMENTID                     "+
"                             and PMRM.T_SHIFROPER = '17')))                                    "+
"      AND  (TRIM (t_kind_oper) = '1' OR TRIM (t_kind_oper) = '6')                              "+
"      and not substr(prov.t_account_receiver,1,3) between '441' and '458'                      "+
"      and substr(prov.t_account_receiver,1,5) not in ('30232','40602','40701','40702','40703') "+  /* GSP C-34616 */
"      and prov.t_chapter = 1                                                                   "+
"      UNION all                                                                                "+
" select 216, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper   from usr_251_c4eta, dacctrn_dbt prov"+
" where prov.t_shifr_oper = '09' and  TRIM (t_kind_oper) = '6' "+
" and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
" and prov.t_state = 1 "+
" and prov.t_chapter=1  "+
" and stroka=216 and rubli=0 "+
" and ((c4et=prov.t_account_payer and substr( prov.t_account_receiver, 1, 5 )='70601') or (c4et=prov.t_account_receiver and substr( prov.t_account_payer, 1, 5 )='70606'))  and not substr(prov.t_account_receiver,1,3) between '441' and '458' ";
vstavit_c4eta(s2_1_6_val);
s2_1_6_val=" select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=216 and rubli=0 ";

/*------------------------------- 2926-У begin ----------------------------------GSP*/
/*------------------- реализация строк 2.1.6.1 и 2.1.6.2.1--------------------------*/
s2_1_6_1_rub=" insert /*+ APPEND*/ into usr_251_prov  "+
" select 2161, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper   "+ 
" from usr_251_c4eta, dacctrn_dbt prov, dpmpaym_dbt paym, dpmdocs_dbt docs "+
" where stroka=216 and rubli=1 AND ((c4et = prov.t_account_payer) or (subStr( prov.t_account_payer, 1, 5 ) ='70606' and t_account_receiver = c4et)) "+
"      and prov.t_acctrnid = docs.t_acctrnid "+
"      and docs.t_paymentid = paym.t_paymentid "+
"      and paym.t_origin in (2,3200,3300) "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
"      and prov.t_state = 1 "+
"      and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )    "+
"      and substr ( prov.t_account_payer, 6, 3 ) = '810'   "+
"      AND TRIM (prov.t_shifr_oper) = '17'   "+
"      AND  (TRIM (t_kind_oper) = '1' OR TRIM (t_kind_oper) = '6')      "+
"      and prov.t_chapter=1 and not substr(prov.t_account_receiver,1,3) between '441' and '458' "+
"      and substr(prov.t_account_receiver,1,5) not in ('30232','40602','40701','40702','40703') "+  /* GSP C-34616 */
"       UNION   "+
" select 2161, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper   "+
" from usr_251_c4eta, dacctrn_dbt prov,  dpmpaym_dbt paym, dpmdocs_dbt docs  "+
" where prov.t_acctrnid = docs.t_acctrnid "+
"      and docs.t_paymentid = paym.t_paymentid "+
"      and paym.t_origin in (2,3200,3300) "+
" and prov.t_shifr_oper = '09' and  TRIM (t_kind_oper) = '6' "+
" and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
" and prov.t_state = 1 "+
" and prov.t_chapter=1  "+
" and stroka=216 and rubli=1 "+
" and ((c4et=prov.t_account_payer and substr( prov.t_account_receiver, 1, 5 )='70601') or (c4et=prov.t_account_receiver and substr( prov.t_account_payer, 1, 5 )='70606')) and not substr(prov.t_account_receiver,1,3) between '441' and '458' ";
vstavit_c4eta(s2_1_6_1_rub);
s2_1_6_1_rub=" select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2161 and rubli=1 ";

s2_1_6_1_val=" insert /*+ APPEND*/ into usr_251_prov  "+
" select 2161, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
" from usr_251_c4eta, dacctrn_dbt prov, dpmpaym_dbt paym, dpmdocs_dbt docs "+
" where stroka=216 and rubli=0 AND ((c4et = prov.t_account_payer) or (subStr( prov.t_account_payer, 1, 5 ) ='70606' and t_account_receiver = c4et)) "+
"      and prov.t_acctrnid = docs.t_acctrnid "+
"      and docs.t_paymentid = paym.t_paymentid "+
"      and paym.t_origin in (2,3200) "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
"      and prov.t_state = 1 "+
"      and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )    "+
"      /*and substr ( prov.t_account_payer, 6, 3 ) = '810'*/   "+
"      AND TRIM (prov.t_shifr_oper) = '17'   "+
"      AND  (TRIM (t_kind_oper) = '1' OR TRIM (t_kind_oper) = '6')      "+
"      and prov.t_chapter=1 and not substr(prov.t_account_receiver,1,3) between '441' and '458' "+
"      and substr(prov.t_account_receiver,1,5) not in ('30232','40602','40701','40702','40703') "+  /* GSP C-34616 */
"       UNION "+
" select 2161, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
" from usr_251_c4eta, dacctrn_dbt prov,  dpmpaym_dbt paym, dpmdocs_dbt docs "+
" where prov.t_acctrnid = docs.t_acctrnid "+
"      and docs.t_paymentid = paym.t_paymentid "+
"      and paym.t_origin in (2,3200) "+
" and prov.t_shifr_oper = '09' and  TRIM (t_kind_oper) = '6' "+
" and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
" and prov.t_state = 1 "+
" and prov.t_chapter=1  "+
" and stroka=216 and rubli=0 "+
" and ((c4et=prov.t_account_payer and substr( prov.t_account_receiver, 1, 5 )='70601') or (c4et=prov.t_account_receiver and substr( prov.t_account_payer, 1, 5 )='70606'))  and not substr(prov.t_account_receiver,1,3) between '441' and '458' ";
vstavit_c4eta(s2_1_6_1_val);
s2_1_6_1_val=" select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2161 and rubli=0 ";

/* C-33991
s2_1_6_2_1_rub =
" select count ( 1 ) cc, round(nvl(sum ( t_sum_natcur ),0)/1000) ss "+
"  from usr_251_c4eta, dacctrn_dbt prov,  dpmpaym_dbt paym, dpmdocs_dbt docs "+
" where prov.t_acctrnid = docs.t_acctrnid "+
"   and docs.t_paymentid = paym.t_paymentid "+
"   and paym.t_origin in (2,3200,3300) "+
"   and ( (prov.t_shifr_oper = '09' and  TRIM (t_kind_oper) = '6' ) or "+
"         ( TRIM (prov.t_shifr_oper) = '17'    AND  (TRIM (t_kind_oper) = '1' OR TRIM (t_kind_oper) = '6') )    "+
"     ) "+
"   and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )       "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
"   and prov.t_state = 1 "+
"   and prov.t_chapter=1    "+
"   and stroka=216 and rubli=1 "+
"   and ((c4et=prov.t_account_payer and substr( prov.t_account_receiver, 1, 5 )='70601') or (c4et=prov.t_account_receiver and substr( prov.t_account_payer, 1, 5 )='70606')) ";

s2_1_6_2_1_val =
" select count ( 1 ) cc, round(nvl(sum ( t_sum_natcur ),0)/1000) ss "+
"  from usr_251_c4eta, dacctrn_dbt prov,  dpmpaym_dbt paym, dpmdocs_dbt docs "+
" where prov.t_acctrnid = docs.t_acctrnid "+
"   and docs.t_paymentid = paym.t_paymentid "+
"   and paym.t_origin in (2,3200,3300) "+
"   and ( (prov.t_shifr_oper = '09' and  TRIM (t_kind_oper) = '6' ) or "+
"         (  TRIM (prov.t_shifr_oper) = '17'    AND  (TRIM (t_kind_oper) = '1' OR TRIM (t_kind_oper) = '6') )   "+
"     ) "+
"   and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )       "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
"   and prov.t_state = 1 "+
"   and prov.t_chapter=1    "+
"   and stroka=216 and rubli=0 "+
"   and ((c4et=prov.t_account_payer and substr( prov.t_account_receiver, 1, 5 )='70601') or (c4et=prov.t_account_receiver and substr( prov.t_account_payer, 1, 5 )='70606')) ";

/*------------------------------- 2926-У end ------------------------------------*/

s2_1_6_2_rub=
" select count ( 1 ) cc, round(nvl(sum ( t_sum_natcur ),0)/1000) ss from usr_251_c4eta, dacctrn_dbt prov"+
" where ( (prov.t_shifr_oper = '09' and  TRIM (t_kind_oper) = '6' ) or "+
"         ( TRIM (prov.t_shifr_oper) = '17'    AND  (TRIM (t_kind_oper) = '1' OR TRIM (t_kind_oper) = '6') )    "+
"     ) "+
" and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
" and prov.t_state = 1 "+
" and prov.t_chapter=1    "+
" and stroka=216 and rubli=1 "+
" and ((c4et=prov.t_account_payer and substr( prov.t_account_receiver, 1, 5 )='70601') or (c4et=prov.t_account_receiver and substr( prov.t_account_payer, 1, 5 )='70606')) ";

s2_1_6_2_val=
" select count ( 1 ) cc, round(nvl(sum ( t_sum_natcur ),0)/1000) ss from usr_251_c4eta, dacctrn_dbt prov"+
" where ( (prov.t_shifr_oper = '09' and  TRIM (t_kind_oper) = '6' ) or "+
"         (  TRIM (prov.t_shifr_oper) = '17'    AND  (TRIM (t_kind_oper) = '1' OR TRIM (t_kind_oper) = '6') )   "+
"     ) "+
" and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
" and prov.t_state = 1 "+
" and prov.t_chapter=1    "+
" and stroka=216 and rubli=0 "+
" and ((c4et=prov.t_account_payer and substr( prov.t_account_receiver, 1, 5 )='70601') or (c4et=prov.t_account_receiver and substr( prov.t_account_payer, 1, 5 )='70606')) ";

*/


s2_2_1_rub="insert /*+ APPEND*/ into usr_251_c4eta select 221, acc.t_account,1,acc.t_code_currency "+s1_2_c4eta_rub;
s2_2_1_val="insert /*+ APPEND*/ into usr_251_c4eta select 221, acc.t_account,0,acc.t_code_currency "+s1_2_c4eta_val;
message("Вставить счета s2_2_1_rub ");
vstavit_c4eta(s2_2_1_rub);
vstavit_c4eta(s2_2_1_val);

s2_2_1_rub=" insert /*+ APPEND*/ into usr_251_prov  select 221, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
" from usr_251_c4eta, dacctrn_dbt prov "+
" where stroka=221 and rubli=1 and c4et=prov.t_account_payer "+
" and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
" and prov.t_state = 1 "+
" and (TRIM (prov.t_shifr_oper) = '01' or TRIM (prov.t_shifr_oper) = '16') "+
" and prov.t_chapter=1 ";
vstavit_c4eta(s2_2_1_rub);
s2_2_1_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=221 and rubli=1 ";

s2_2_1_val=" insert /*+ APPEND*/ into usr_251_prov  select 221, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
" from usr_251_c4eta, dacctrn_dbt prov "+
" where stroka=221 and rubli=0 and c4et=prov.t_account_payer "+
" and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
" and prov.t_state = 1 "+
" and (TRIM (prov.t_shifr_oper) = '01' or TRIM (prov.t_shifr_oper) = '16') "+
" and prov.t_chapter=1 ";
vstavit_c4eta(s2_2_1_val);
s2_2_1_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=221 and rubli=0 ";

s2_2_1_1_rub="select count ( 1 ) cc, round(nvl(sum ( t_sum_natcur ),0)/1000) ss from usr_251_c4eta, dacctrn_dbt prov, daccount_dbt acc "+
" where stroka=221 and rubli=1 and c4et=prov.t_account_payer "+
" and c4et=acc.t_account and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' ) "+
" and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
" and prov.t_state = 1 "+
" and TRIM (prov.t_shifr_oper) = '01' "+
" and prov.t_chapter=1 ";

s2_2_1_1_val="select count ( 1 ) cc, round(nvl(sum ( t_sum_natcur ),0)/1000) ss from usr_251_c4eta, dacctrn_dbt prov, daccount_dbt acc "+
" where stroka=221 and rubli=0 and c4et=prov.t_account_payer "+
" and c4et=acc.t_account and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' ) "+
" and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
" and prov.t_state = 1 "+
" and TRIM (prov.t_shifr_oper) = '01' "+
" and prov.t_chapter=1 ";


s2_2_1_1_1_rub="select count ( 1 ) cc, round(nvl(sum ( t_sum_natcur ),0)/1000) ss from usr_251_c4eta, dacctrn_dbt prov, daccount_dbt acc "+
" where stroka=221 and rubli=1 and c4et=prov.t_account_payer "+
" and c4et=acc.t_account and (acc.t_usertypeaccount like '%Ё%'  ) "+
" and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
" and prov.t_state = 1 "+
" and TRIM (prov.t_shifr_oper) = '01' "+
" and prov.t_chapter=1 ";

s2_2_1_1_1_val="select count ( 1 ) cc, round(nvl(sum ( t_sum_natcur ),0)/1000) ss from usr_251_c4eta, dacctrn_dbt prov, daccount_dbt acc "+
" where stroka=221 and rubli=0 and c4et=prov.t_account_payer "+
" and c4et=acc.t_account and (acc.t_usertypeaccount like '%Ё%'  ) "+
" and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
" and prov.t_state = 1 "+
" and TRIM (prov.t_shifr_oper) = '01' "+
" and prov.t_chapter=1 ";

s2_2_2_rub="insert /*+ APPEND*/ into usr_251_c4eta select 222, c4et, 1,code_currency from usr_251_c4eta where stroka=221 and rubli=1 ";
vstavit_c4eta(s2_2_2_rub);
/*
s2_2_2_rub="  insert /*+ APPEND*/ into usr_251_prov  select 222, prov.t_account_payer, prov.t_account_receiver, prov.t_date_carry, prov.t_sum_payer, 1,prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
"  from usr_251_c4eta, darhdoc_dbt prov "+
" where stroka=222 and rubli=1 and c4et=prov.t_account_payer "+
" and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
"      and (substr( prov.t_account_receiver, 1, 5 )='90907' or substr( prov.t_account_receiver, 1, 5 )='90908') "+
"      and prov.t_chapter=3 ";
vstavit_c4eta(s2_2_2_rub);
s2_2_2_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=222 and rubli=1 ";

s2_2_2_val="insert /*+ APPEND*/ into usr_251_c4eta select 222, c4et, 0 from usr_251_c4eta where stroka=221 and rubli=0 ";
vstavit_c4eta(s2_2_2_val);
s2_2_2_val="  insert /*+ APPEND*/ into usr_251_prov  select 222, prov.t_account_payer, prov.t_account_receiver, prov.t_date_carry, prov.t_sum_payer, 0,prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
"from usr_251_c4eta, darhdoc_dbt prov "+
" where stroka=222 and rubli=0 and c4et=prov.t_account_payer "+
" and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
"      and (substr( prov.t_account_receiver, 1, 5 )='90907' or substr( prov.t_account_receiver, 1, 5 )='90908') "+
"      and prov.t_chapter=3 ";
vstavit_c4eta(s2_2_2_val);
s2_2_2_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=222 and rubli=0 ";
*/


s2_2_2_rub=" "+
"  insert /*+ APPEND*/ into usr_251_prov  select 222, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 1,prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
"  from usr_251_c4eta, dacctrn_dbt prov, dpmrmprop_dbt pmrm, dpmdocs_dbt docs, daccount_dbt acc "+
"where stroka=222 and rubli=1 and c4et=prov.t_account_payer  "+
"      and prov.t_account_receiver = acc.t_account "+
"      and prov.t_acctrnid = docs.t_acctrnid "+
"      and pmrm.t_paymentid = docs.t_paymentid "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
"      and prov.t_state = 1 "+
"      and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )    "+
"      and substr ( prov.t_account_payer, 6, 3 ) = '810' "+
"      and acc.t_chapter = 1 "+
"      and acc.t_client = 60313 "+
"      and (substr( prov.t_account_receiver, 1, 5 )='40901' or substr( prov.t_account_receiver, 1, 5 )='40902' or pmrm.t_shifroper = '08') "+
"      and prov.t_chapter=1 ";
message("Вставить счета s2_2_2_rub ");
vstavit_c4eta(s2_2_2_rub);
s2_2_2_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=222 and rubli=1 ";

s2_2_2_val=" "+
"  insert /*+ APPEND*/ into usr_251_prov  select 222, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 0,prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
"  from usr_251_c4eta, dacctrn_dbt prov, daccount_dbt acc "+
"where  stroka=222 and rubli=0 and c4et=prov.t_account_payer"+
"      and prov.t_account_payer = acc.t_account "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
"      and prov.t_state = 1 "+
"      and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )    "+
"      and substr ( prov.t_account_payer, 6, 3 ) != '810' "+
"      and substr ( prov.t_account_payer, 1, 5 ) in ('47409','47410')  "+
"      and acc.t_chapter = 1 "+
"      and acc.t_client = 60313 "+
"      and substr( prov.t_account_receiver, 1, 5 ) like '301%'"+
"      and prov.t_chapter=1 ";
vstavit_c4eta(s2_2_2_val);
s2_2_2_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=222 and rubli=0 ";


/*------------------------------- 2926-У begin ----------------------------------GSP*/
/*------------------- реализация строк 2.2.2.1 --------------------------*/
//debugbreak;
s2_2_2_1_rub="insert /*+ APPEND*/ into usr_251_c4eta select 2221, c4et, 1,code_currency from usr_251_c4eta where stroka=221 and rubli=1 ";
vstavit_c4eta(s2_2_2_1_rub);
s2_2_2_1_rub="  insert /*+ APPEND*/ into usr_251_prov  select 2221, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 1,prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
"     from usr_251_c4eta, dacctrn_dbt prov, dpmrmprop_dbt pmrm, dpmdocs_dbt docs, daccount_dbt acc, dpmpaym_dbt paym "+
"    where stroka=2221 and rubli=1 and c4et=prov.t_account_payer  "+
"      and prov.t_acctrnid = docs.t_acctrnid "+
"      and docs.t_paymentid = paym.t_paymentid "+
"      and paym.t_origin in (2,3200,3300) "+
"      and prov.t_account_receiver = acc.t_account "+
"      and paym.t_paymentid = pmrm.t_paymentid  "+
"      and acc.t_chapter = 1 "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
"      and prov.t_state = 1 "+
"      and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )    "+
"      and substr ( prov.t_account_payer, 6, 3 ) = '810' "+
"      and acc.t_client = 60313 "+
"      and (substr( prov.t_account_receiver, 1, 5 )='40901' or substr( prov.t_account_receiver, 1, 5 )='40902' or pmrm.t_shifroper = '08') "+
"      and prov.t_chapter=1 ";
vstavit_c4eta(s2_2_2_1_rub);
s2_2_2_1_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2221 and rubli=1 ";

s2_2_2_1_val="insert /*+ APPEND*/ into usr_251_c4eta select 2221, c4et, 0, code_currency from usr_251_c4eta where stroka=221 and rubli=0 ";
vstavit_c4eta(s2_2_2_1_val);
s2_2_2_1_val="  insert /*+ APPEND*/ into usr_251_prov  select 2221, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 0,prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
"  from usr_251_c4eta, dacctrn_dbt prov, daccount_dbt acc, dpmpaym_dbt paym, dpmdocs_dbt docs "+
"where  stroka=222 and rubli=0 and c4et=prov.t_account_payer"+
"      and prov.t_acctrnid = docs.t_acctrnid "+
"      and docs.t_paymentid = paym.t_paymentid "+
"      and paym.t_origin in (2,3200) "+
"      and acc.t_chapter = 1 "+
"      and prov.t_account_payer = acc.t_account "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
"      and prov.t_state = 1 "+
"      and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )    "+
"      and substr ( prov.t_account_payer, 6, 3 ) != '810' "+
"      and substr ( prov.t_account_payer, 1, 5 ) in ('47409','47410')  "+
"      and acc.t_client = 60313 "+
"      and substr( prov.t_account_receiver, 1, 5 ) like '301%'"+
"      and prov.t_chapter=1 ";
vstavit_c4eta(s2_2_2_1_val);
s2_2_2_1_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2221 and rubli=0 ";
/*------------------------------- 2926-У end ------------------------------------*/


s2_2_3_rub="insert /*+ APPEND*/ into usr_251_c4eta select 223, c4et, 1,code_currency from usr_251_c4eta where stroka=122 and rubli=1 ";
vstavit_c4eta(s2_2_3_rub);
s2_2_3_rub="  insert /*+ APPEND*/ into usr_251_prov  select 223, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
" from usr_251_c4eta, dacctrn_dbt prov, daccount_dbt acc "+
" where stroka=223 and rubli=1 and c4et=prov.t_account_payer "+
" and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
"      and prov.t_state = 1 "+
"      and t_account_payer=acc.t_account "+
"      and prov.t_chapter=1 and acc.t_chapter=1  "+
"          and not((substr( prov.t_account_payer, 1, 5 )='40817' or substr( prov.t_account_payer, 1, 5 )='40820')  and t_client = 60164) "+
"          and (prov.t_shifr_oper='02' or prov.t_shifr_oper='16') ";
message("Вставить счета s2_2_3_rub ");
vstavit_c4eta(s2_2_3_rub);
s2_2_3_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=223 and rubli=1 ";

s2_2_3_val="insert /*+ APPEND*/ into usr_251_c4eta select 223, c4et, 0,code_currency from usr_251_c4eta where stroka=122 and rubli=0 ";
vstavit_c4eta(s2_2_3_val);
s2_2_3_val="  insert /*+ APPEND*/ into usr_251_prov  select 223, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
" from usr_251_c4eta, dacctrn_dbt prov, daccount_dbt acc "+
" where stroka=223 and rubli=0 and c4et=prov.t_account_payer "+
" and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
"      and prov.t_state = 1 "+
"      and t_account_payer=acc.t_account "+
"      and prov.t_chapter=1 and acc.t_chapter=1  "+
"          and not((substr( prov.t_account_payer, 1, 5 )='40817' or substr( prov.t_account_payer, 1, 5 )='40820')  and t_client = 60164) "+
"          and (prov.t_shifr_oper='02' or prov.t_shifr_oper='16') ";
vstavit_c4eta(s2_2_3_val);
s2_2_3_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=223 and rubli=0 ";


/*------------------------------- 2926-У begin ----------------------------------GSP*/
/*------------------- реализация строк 2.2.3.1 и 2.2.3.1.1--------------------------*/
s2_2_3_1_rub="insert /*+ APPEND*/ into usr_251_c4eta select 2231, c4et, 1,code_currency from usr_251_c4eta where stroka=122 and rubli=1 ";
vstavit_c4eta(s2_2_3_1_rub);
s2_2_3_1_rub="  insert /*+ APPEND*/ into usr_251_prov  select 2231, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
" from usr_251_c4eta, dacctrn_dbt prov, daccount_dbt acc, dpmpaym_dbt paym, dpmdocs_dbt docs "+
" where stroka=2231 and rubli=1 and c4et=prov.t_account_payer "+
"   and prov.t_acctrnid = docs.t_acctrnid "+
"   and docs.t_paymentid = paym.t_paymentid "+
"   and paym.t_origin in (2,3200,3300) "+
"   and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )       "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
"   and prov.t_state = 1 "+
"   and t_account_payer=acc.t_account "+
"   and prov.t_chapter=1 and acc.t_chapter=1  "+
"   and not((substr( prov.t_account_payer, 1, 5 )='40817' or substr( prov.t_account_payer, 1, 5 )='40820')  and t_client = 60164) "+
"   and (prov.t_shifr_oper='02' or prov.t_shifr_oper='16') ";
vstavit_c4eta(s2_2_3_1_rub);
s2_2_3_1_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2231 and rubli=1 ";

s2_2_3_1_val="insert /*+ APPEND*/ into usr_251_c4eta select 2231, c4et, 0, code_currency from usr_251_c4eta where stroka=122 and rubli=0 ";
vstavit_c4eta(s2_2_3_1_val);
s2_2_3_1_val="  insert /*+ APPEND*/ into usr_251_prov  select 2231, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
" from usr_251_c4eta, dacctrn_dbt prov, daccount_dbt acc, dpmpaym_dbt paym, dpmdocs_dbt docs "+
" where stroka=2231 and rubli=0 and c4et=prov.t_account_payer "+
"   and prov.t_acctrnid = docs.t_acctrnid "+
"   and docs.t_paymentid = paym.t_paymentid "+
"   and paym.t_origin in (2,3200) "+
"   and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )       "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
"   and prov.t_state = 1 "+
"   and t_account_payer=acc.t_account "+
"   and prov.t_chapter=1 and acc.t_chapter=1  "+
"   and not((substr( prov.t_account_payer, 1, 5 )='40817' or substr( prov.t_account_payer, 1, 5 )='40820')  and t_client = 60164) "+
"   and (prov.t_shifr_oper='02' or prov.t_shifr_oper='16') ";
vstavit_c4eta(s2_2_3_1_val);
s2_2_3_1_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2231 and rubli=0 ";


s2_2_3_1_1_rub="insert /*+ APPEND*/ into usr_251_c4eta select 22311, c4et, 1,code_currency from usr_251_c4eta where stroka=122 and rubli=1 ";
vstavit_c4eta(s2_2_3_1_1_rub);
s2_2_3_1_1_rub="  insert /*+ APPEND*/ into usr_251_prov  select 22311, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
" from usr_251_c4eta, dacctrn_dbt prov, daccount_dbt acc, dpmpaym_dbt paym, dpmdocs_dbt docs "+
" where stroka=22311 and rubli=1 and c4et=prov.t_account_payer "+
"   and prov.t_acctrnid = docs.t_acctrnid "+
"   and docs.t_paymentid = paym.t_paymentid "+
"   and paym.t_origin in (3200) "+
"   and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )       "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
"   and prov.t_state = 1 "+
"   and t_account_payer=acc.t_account "+
"   and prov.t_chapter=1 and acc.t_chapter=1  "+
"   and not((substr( prov.t_account_payer, 1, 5 )='40817' or substr( prov.t_account_payer, 1, 5 )='40820')  and t_client = 60164) "+
"   and (prov.t_shifr_oper='02' or prov.t_shifr_oper='16') ";
vstavit_c4eta(s2_2_3_1_1_rub);
s2_2_3_1_1_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=22311 and rubli = 1 ";

s2_2_3_1_1_val="insert /*+ APPEND*/ into usr_251_c4eta select 22311, c4et, 0,code_currency from usr_251_c4eta where stroka=122 and rubli=0 ";
vstavit_c4eta(s2_2_3_1_1_val);
s2_2_3_1_1_val="  insert /*+ APPEND*/ into usr_251_prov  select 22311, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
" from usr_251_c4eta, dacctrn_dbt prov, daccount_dbt acc, dpmpaym_dbt paym, dpmdocs_dbt docs "+
" where stroka=2231 and rubli=0 and c4et=prov.t_account_payer "+
"   and prov.t_acctrnid = docs.t_acctrnid "+
"   and docs.t_paymentid = paym.t_paymentid "+
"   and paym.t_origin in (3200) "+
"   and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )       "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
"   and prov.t_state = 1 "+
"   and t_account_payer=acc.t_account "+
"   and prov.t_chapter=1 and acc.t_chapter=1  "+
"   and not((substr( prov.t_account_payer, 1, 5 )='40817' or substr( prov.t_account_payer, 1, 5 )='40820')  and t_client = 60164) "+
"   and (prov.t_shifr_oper='02' or prov.t_shifr_oper='16') ";
vstavit_c4eta(s2_2_3_1_1_val);
s2_2_3_1_1_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=22311 and rubli = 0 ";
/*------------------------------- 2926-У end ------------------------------------*/


s2_2_4_rub="insert /*+ APPEND*/ into usr_251_c4eta select 224, c4et, 1,code_currency from usr_251_c4eta where stroka=122 and rubli=1 ";
message("Вставить счета s2_2_4_rub ");
vstavit_c4eta(s2_2_4_rub);
s2_2_4_rub="  insert /*+ APPEND*/ into usr_251_prov  select 224, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
" from usr_251_c4eta, dacctrn_dbt prov, daccount_dbt acc "+
" where stroka=224 and rubli=1 and c4et=prov.t_account_payer "+
"      and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )    "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
"      and prov.t_state = 1 "+
"      and t_account_payer=acc.t_account "+
"      and prov.t_chapter=1 and acc.t_chapter=1  "+
"          and not((substr( prov.t_account_payer, 1, 5 )='40817' or substr( prov.t_account_payer, 1, 5 )='40820')  and t_client=22291) "+
"          and (prov.t_shifr_oper='06' or prov.t_shifr_oper='16') ";
vstavit_c4eta(s2_2_4_rub);
s2_2_4_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=224 and rubli=1 ";

s2_2_4_val="insert /*+ APPEND*/ into usr_251_c4eta select 224, c4et, 0,code_currency from usr_251_c4eta where stroka=122 and rubli=0 ";
vstavit_c4eta(s2_2_4_val);
s2_2_4_val="  insert /*+ APPEND*/ into usr_251_prov  select 224, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
" from usr_251_c4eta, dacctrn_dbt prov, daccount_dbt acc "+
" where stroka=224 and rubli=0 and c4et=prov.t_account_payer "+
"  and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )        "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
"      and prov.t_state = 1 "+
"      and t_account_payer=acc.t_account "+
"      and prov.t_chapter=1 and acc.t_chapter=1  "+
"          and not((substr( prov.t_account_payer, 1, 5 )='40817' or substr( prov.t_account_payer, 1, 5 )='40820')  and t_client=22291) "+
"          and (prov.t_shifr_oper='06' or prov.t_shifr_oper='16') ";
vstavit_c4eta(s2_2_4_val);
s2_2_4_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=224 and rubli=0 ";

/*------------------------------- 2926-У begin ----------------------------------GSP*/
/*------------------- реализация строк 2.2.4.1--------------------------*/
s2_2_4_1_rub="insert /*+ APPEND*/ into usr_251_c4eta select 2241, c4et, 1,code_currency from usr_251_c4eta where stroka=122 and rubli=1 ";
vstavit_c4eta(s2_2_4_1_rub);
s2_2_4_1_rub="  insert /*+ APPEND*/ into usr_251_prov  select 2241, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
" from usr_251_c4eta, dacctrn_dbt prov, daccount_dbt acc, dpmpaym_dbt paym, dpmdocs_dbt docs "+
" where stroka=224 and rubli=1 and c4et=prov.t_account_payer "+
"   and prov.t_acctrnid = docs.t_acctrnid "+
"   and docs.t_paymentid = paym.t_paymentid "+
"   and paym.t_origin in (3200) "+
"   and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )       "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
"   and prov.t_state = 1 "+
"   and t_account_payer=acc.t_account "+
"   and prov.t_chapter=1 and acc.t_chapter=1  "+
"   and not((substr( prov.t_account_payer, 1, 5 )='40817' or substr( prov.t_account_payer, 1, 5 )='40820')  and t_client=22291) "+
"   and (prov.t_shifr_oper='06' or prov.t_shifr_oper='16') ";
vstavit_c4eta(s2_2_4_1_rub);
s2_2_4_1_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2241 and rubli=1 ";

s2_2_4_1_val="insert /*+ APPEND*/ into usr_251_c4eta select 2241, c4et, 0,code_currency from usr_251_c4eta where stroka=122 and rubli=0 ";
vstavit_c4eta(s2_2_4_1_val);
s2_2_4_1_val="  insert /*+ APPEND*/ into usr_251_prov  select 2241, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
" from usr_251_c4eta, dacctrn_dbt prov, daccount_dbt acc, dpmpaym_dbt paym, dpmdocs_dbt docs "+
" where stroka=224 and rubli=0 and c4et=prov.t_account_payer "+
"   and prov.t_acctrnid = docs.t_acctrnid "+
"   and docs.t_paymentid = paym.t_paymentid "+
"   and paym.t_origin in (3200) "+
"   and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )       "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
"   and prov.t_state = 1 "+
"   and t_account_payer=acc.t_account "+
"   and prov.t_chapter=1 and acc.t_chapter=1  "+
"   and not((substr( prov.t_account_payer, 1, 5 )='40817' or substr( prov.t_account_payer, 1, 5 )='40820')  and t_client=22291) "+
"   and (prov.t_shifr_oper='06' or prov.t_shifr_oper='16') ";
vstavit_c4eta(s2_2_4_1_val);
s2_2_4_1_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2241 and rubli=0 ";
/*------------------------------- 2926-У end ------------------------------------*/

s2_2_5_rub="insert /*+ APPEND*/ into usr_251_c4eta select 225, c4et, 1,code_currency from usr_251_c4eta where stroka=122 and rubli=1 ";
message("Вставить счета s2_2_5_rub ");
vstavit_c4eta(s2_2_5_rub);
s2_2_5_rub="  insert /*+ APPEND*/ into usr_251_prov  select 225, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
" from usr_251_c4eta, dacctrn_dbt prov, daccount_dbt acc "+
" where stroka=225 and rubli=1 and c4et=prov.t_account_payer "+
"      and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )    "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
"      and prov.t_state = 1 "+
"      and t_account_payer=acc.t_account "+
"      and prov.t_chapter=1 and acc.t_chapter=1  "+
"          and not((substr( prov.t_account_payer, 1, 5 )='40817' or substr( prov.t_account_payer, 1, 5 )='40820')  and t_client=22291) "+
"          and (prov.t_shifr_oper='07') ";
vstavit_c4eta(s2_2_5_rub);
s2_2_5_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=225 and rubli=1 ";

s2_2_5_val="insert /*+ APPEND*/ into usr_251_c4eta select 225, c4et, 0,code_currency from usr_251_c4eta where stroka=122 and rubli=0 ";
vstavit_c4eta(s2_2_5_val);
s2_2_5_val="  insert /*+ APPEND*/ into usr_251_prov  select 225, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
" from usr_251_c4eta, dacctrn_dbt prov, daccount_dbt acc "+
" where stroka=225 and rubli=0 and c4et=prov.t_account_payer "+
" and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
"      and prov.t_state = 1 "+
"      and t_account_payer=acc.t_account "+
"      and prov.t_chapter=1 and acc.t_chapter=1  "+
"          and not((substr( prov.t_account_payer, 1, 5 )='40817' or substr( prov.t_account_payer, 1, 5 )='40820')  and t_client=22291) "+
"          and (prov.t_shifr_oper='07') ";
vstavit_c4eta(s2_2_5_val);
s2_2_5_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=225 and rubli=0 ";

debugbreak;
debugbreak;

s2_2_6_rub="insert /*+ APPEND*/ into usr_251_c4eta select 226, c4et, 1, code_currency from usr_251_c4eta where stroka=122 and rubli=1 ";
s2_2_6_val="insert /*+ APPEND*/ into usr_251_c4eta select 226, c4et, 0, code_currency from usr_251_c4eta where stroka=122 and rubli=0 ";
message("Вставить счета s2_2_6_rub ");
vstavit_c4eta(s2_2_6_rub);
vstavit_c4eta(s2_2_6_val);


s2_2_6_rub = "/* Formatted on 16.04.2012 16:03:45 (QP5 v5.115.810.9015) disa */ " + 
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  226, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "   FROM  usr_251_c4eta, dacctrn_dbt prov " +
      "  WHERE  (stroka = 226 AND rubli = 1 AND c4et = prov.t_account_payer) " +
      "           AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " +
      // EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
      "           and prov.t_state = 1 "+
      "           AND SUBSTR (prov.t_account_payer, 6, 3) = '810' " +
      "           AND ( (TRIM (prov.t_shifr_oper) = '17' AND (TRIM (t_kind_oper) = '1' OR TRIM (t_kind_oper) = '6') " +
      "           AND SUBSTR (t_account_receiver, 1, 5) not in ('30232','45503','45504','45505','45506','45507','45207','45208')) "+       /*GSP C-34616*/
      "                  OR (SUBSTR (t_account_receiver, 1, 5) = '70601' AND TRIM (prov.t_shifr_oper) = '09' AND TRIM (t_kind_oper) = '6')) " +
      "           AND prov.t_chapter = 1 " ;

/* GSP - лишнее условие, уже учтено в первой части.
      "  UNION   "+
      " SELECT  226, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "   FROM  usr_251_c4eta, dacctrn_dbt prov " +
      "  WHERE  (stroka = 226 AND rubli = 1 AND c4et = prov.t_account_receiver ) " +
      "           AND substr( prov.t_account_payer, 1, 5 ) = '70606' " +
      "           AND TRIM (prov.t_shifr_oper) = '09' " +
      "           AND TRIM (t_kind_oper) = '6' " +
      "           AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " +
      // EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
      "           and prov.t_state = 1 "+
      "           AND prov.t_chapter = 1 ";*/
vstavit_c4eta(s2_2_6_rub);
s2_2_6_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=226 and rubli=1 ";

s2_2_6_val = "/* Formatted on 16.04.2012 16:03:45 (QP5 v5.115.810.9015) disa */ " + 
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  226, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "   FROM  usr_251_c4eta, dacctrn_dbt prov " +
      "  WHERE  (stroka = 226 AND rubli = 0 AND c4et = prov.t_account_payer) " +
      "           AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " +
      // EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
      "           and prov.t_state = 1 "+
      "           AND SUBSTR (prov.t_account_payer, 6, 3) = '810' " +
      "           AND ( (TRIM (prov.t_shifr_oper) = '17' AND (TRIM (t_kind_oper) = '1' OR TRIM (t_kind_oper) = '6') " +
      "           AND SUBSTR (t_account_receiver, 1, 5) not in ('30232','45503','45504','45505','45506','45507','45207','45208')) "+       /*GSP C-34616*/
      "                  OR (SUBSTR (t_account_receiver, 1, 5) = '70601' AND TRIM (prov.t_shifr_oper) = '09' AND TRIM (t_kind_oper) = '6')) " +
      "           AND prov.t_chapter = 1 " ;
/* GSP - лишнее условие, уже учтено в первой части.
"       UNION   "+
      " SELECT  226, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "   FROM  usr_251_c4eta, dacctrn_dbt prov " +
      "  WHERE  (stroka = 226 AND rubli = 0 AND c4et = prov.t_account_receiver ) " +
      "           AND substr( prov.t_account_payer, 1, 5 ) = '70606' " +
      "           AND TRIM (prov.t_shifr_oper) = '09' " +
      "           AND TRIM (t_kind_oper) = '6' " +
      "           AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " +
      // EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
      "           and prov.t_state = 1 "+
      "           AND prov.t_chapter = 1 ";*/
vstavit_c4eta(s2_2_6_val);
s2_2_6_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=226 and rubli=0 ";

/*------------------------------- 2926-У begin ----------------------------------GSP*/
/*------------------- реализация строк 2.2.6.1 и 2.2.6.2.1--------------------------*/
s2_2_6_1_rub = "/* Formatted on 16.04.2012 16:03:45 (QP5 v5.115.810.9015) disa */ " + 
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  2261, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "   FROM  usr_251_c4eta, dacctrn_dbt prov, dpmpaym_dbt paym, dpmdocs_dbt docs  " +
      "  WHERE  (stroka = 226 AND rubli = 1 AND c4et = prov.t_account_payer) " +
      "    and prov.t_acctrnid = docs.t_acctrnid "+
      "    and docs.t_paymentid = paym.t_paymentid "+
      "    and paym.t_origin in (2,3200,3300) "+
      "    AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " +
      // EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
      "    and prov.t_state = 1 "+
      "    AND SUBSTR (prov.t_account_payer, 6, 3) = '810' " +
      "    AND ( (TRIM (prov.t_shifr_oper) = '17' AND (TRIM (t_kind_oper) = '1' OR TRIM (t_kind_oper) = '6') " +
      "           AND SUBSTR (t_account_receiver, 1, 5) not in ('30232','45503','45504','45505','45506','45507','45207','45208')) "+       /*GSP C-34616*/
      "         OR (SUBSTR (t_account_receiver, 1, 5) = '70601' AND TRIM (prov.t_shifr_oper) = '09' AND TRIM (t_kind_oper) = '6')) " +
      "    AND prov.t_chapter = 1 " ;
/*
"       UNION   "+
      " SELECT  2261, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "   FROM  usr_251_c4eta, dacctrn_dbt prov, dpmpaym_dbt paym, dpmdocs_dbt docs " +
      "  WHERE  (stroka = 226 AND rubli = 1 AND c4et = prov.t_account_receiver ) " +
      "    and prov.t_acctrnid = docs.t_acctrnid "+
      "    and docs.t_paymentid = paym.t_paymentid "+
      "    and paym.t_origin in (2,3200,3300) "+
      "    AND substr( prov.t_account_payer, 1, 5 ) = '70606' " +
      "    AND TRIM (prov.t_shifr_oper) = '09' " +
      "    AND TRIM (t_kind_oper) = '6' " +
      "    AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " +
      // EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
      "    and prov.t_state = 1 "+
      "    AND prov.t_chapter = 1 ";*/
vstavit_c4eta(s2_2_6_1_rub);
s2_2_6_1_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2261 and rubli=1 ";

s2_2_6_1_val = "/* Formatted on 16.04.2012 16:03:45 (QP5 v5.115.810.9015) disa */ " + 
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  2261, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "   FROM  usr_251_c4eta, dacctrn_dbt prov, dpmpaym_dbt paym, dpmdocs_dbt docs " +
      "  WHERE  (stroka = 226 AND rubli = 0 AND c4et = prov.t_account_payer) " +
      "    and prov.t_acctrnid = docs.t_acctrnid "+
      "    and docs.t_paymentid = paym.t_paymentid "+
      "    and paym.t_origin in (2,3200) "+
      "    AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " +
      // EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
      "    and prov.t_state = 1 "+
      "    AND SUBSTR (prov.t_account_payer, 6, 3) = '810' " +
      "    AND ( (TRIM (prov.t_shifr_oper) = '17' AND (TRIM (t_kind_oper) = '1' OR TRIM (t_kind_oper) = '6') " +
      "           AND SUBSTR (t_account_receiver, 1, 5) not in ('30232','45503','45504','45505','45506','45507','45207','45208')) "+       /*GSP C-34616*/
      "          OR (SUBSTR (t_account_receiver, 1, 5) = '70601' AND TRIM (prov.t_shifr_oper) = '09' AND TRIM (t_kind_oper) = '6')) " +
      "    AND prov.t_chapter = 1 " ;
/*
"       UNION   "+
      " SELECT  2261, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "   FROM  usr_251_c4eta, dacctrn_dbt prov, dpmpaym_dbt paym, dpmdocs_dbt docs " +
      "  WHERE  (stroka = 226 AND rubli = 0 AND c4et = prov.t_account_receiver ) " +
      "    and prov.t_acctrnid = docs.t_acctrnid "+
      "    and docs.t_paymentid = paym.t_paymentid "+
      "    and paym.t_origin in (2,3200) "+
      "    AND substr( prov.t_account_payer, 1, 5 ) = '70606' " +
      "    AND TRIM (prov.t_shifr_oper) = '09' " +
      "    AND TRIM (t_kind_oper) = '6' " +
      "    AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " +
      // EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
      "    and prov.t_state = 1 "+
      "    AND prov.t_chapter = 1 ";*/
vstavit_c4eta(s2_2_6_1_val);
s2_2_6_1_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2261 and rubli=0 ";

/*
s2_2_6_2_1_rub = "/* Formatted on 16.04.2012 17:37:08 (QP5 v5.115.810.9015) disa */ " + 
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  22621, payer, receiver, ddata, summa, 1, osnov, prov.shifr, prov.vid " +
      "   FROM  usr_251_prov prov, usr_251_c4eta acc1 " +
      "  WHERE  (prov.payer = acc1.c4et ) " +
      "    AND (prov.stroka = 2261 AND prov.rubli = 1 AND acc1.stroka = 226 AND acc1.rubli = 1) " +
      "    AND (substr( receiver, 1, 5 ) = '70601' ) " +
      " UNION " +
      " SELECT  22621, payer, receiver, ddata, summa, 1, osnov, prov.shifr, prov.vid " +
      "   FROM  usr_251_prov prov, usr_251_c4eta acc2 " +
      "  WHERE  (prov.receiver = acc2.c4et ) " +
      "    AND (prov.stroka = 2261 AND prov.rubli = 1 AND acc2.stroka = 226 AND acc2.rubli = 1) " +
      "    AND (substr( payer, 1, 5 ) = '70606' ) " ;
vstavit_c4eta(s2_2_6_2_1_rub);
s2_2_6_2_1_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=22621 and rubli=1 ";

s2_2_6_2_1_val = "/* Formatted on 16.04.2012 17:37:08 (QP5 v5.115.810.9015) disa */ " + 
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  22621, payer, receiver, ddata, summa, 0, osnov, prov.shifr, prov.vid " +
      "   FROM  usr_251_prov prov, usr_251_c4eta acc1 " +
      "  WHERE  (prov.payer = acc1.c4et ) " +
      "    AND (prov.stroka = 2261 AND prov.rubli = 0 AND acc1.stroka = 226 AND acc1.rubli = 0) " +
      "    AND (substr( receiver, 1, 5 ) = '70601' ) " +
      " UNION " +
      " SELECT  22621, payer, receiver, ddata, summa, 0, osnov, prov.shifr, prov.vid " +
      "   FROM  usr_251_prov prov, usr_251_c4eta acc2 " +
      "  WHERE  (prov.receiver = acc2.c4et ) " +
      "    AND (prov.stroka = 2261 AND prov.rubli = 0 AND acc2.stroka = 226 AND acc2.rubli = 0) " +
      "    AND (substr( payer, 1, 5 ) = '70606' ) " ;
vstavit_c4eta(s2_2_6_2_1_val);
s2_2_6_2_1_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=22621 and rubli=0 ";
/*------------------------------- 2926-У end ------------------------------------*/
/*------------------ переименовано из 2.2.6.1 в 2.2.6.2 -------------------------------GSP*/
s2_2_6_2_rub = "/* Formatted on 16.04.2012 17:37:08 (QP5 v5.115.810.9015) disa */ " + 
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  2262, payer, receiver, ddata, summa, 1, osnov, prov.shifr, prov.vid " +
      "   FROM  usr_251_prov prov, usr_251_c4eta acc1 " +
      "  WHERE  (prov.payer = acc1.c4et ) " +
      "    AND (prov.stroka = 226 AND prov.rubli = 1 AND acc1.stroka = 226 AND acc1.rubli = 1) " +
      "    AND (substr( receiver, 1, 5 ) = '70601' ) " +
      " UNION " +
      " SELECT  2262, payer, receiver, ddata, summa, 1, osnov, prov.shifr, prov.vid " +
      "   FROM  usr_251_prov prov, usr_251_c4eta acc2 " +
      "  WHERE  (prov.receiver = acc2.c4et ) " +
      "    AND (prov.stroka = 226 AND prov.rubli = 1 AND acc2.stroka = 226 AND acc2.rubli = 1) " +
      "    AND (substr( payer, 1, 5 ) = '70606' ) " ;
vstavit_c4eta(s2_2_6_2_rub);
s2_2_6_2_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2262 and rubli=1 ";

s2_2_6_2_val = "/* Formatted on 16.04.2012 17:37:08 (QP5 v5.115.810.9015) disa */ " + 
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  2262, payer, receiver, ddata, summa, 0, osnov, prov.shifr, prov.vid " +
      "   FROM  usr_251_prov prov, usr_251_c4eta acc1 " +
      "  WHERE  (prov.payer = acc1.c4et ) " +
      "    AND (prov.stroka = 226 AND prov.rubli = 0 AND acc1.stroka = 226 AND acc1.rubli = 0) " +
      "    AND (substr( receiver, 1, 5 ) = '70601' ) " +
      " UNION " +
      " SELECT  2262, payer, receiver, ddata, summa, 0, osnov, prov.shifr, prov.vid " +
      "   FROM  usr_251_prov prov, usr_251_c4eta acc2 " +
      "  WHERE  (prov.receiver = acc2.c4et ) " +
      "    AND (prov.stroka = 226 AND prov.rubli = 0 AND acc2.stroka = 226 AND acc2.rubli = 0) " +
      "    AND (substr( payer, 1, 5 ) = '70606' ) " ;
vstavit_c4eta(s2_2_6_2_val);
s2_2_6_2_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2262 and rubli=0 ";
*/


s2_3_1_rub="insert /*+ APPEND*/ into usr_251_c4eta select 231, acc.t_account,1,acc.t_code_currency "+ day_c4eta231(true);
//getstring(s2_3_1_rub);
s2_3_1_val="insert /*+ APPEND*/ into usr_251_c4eta select 231, acc.t_account,0,acc.t_code_currency "+ day_c4eta231(false);
message("Вставить счета s2_3_1_rub ");
vstavit_c4eta(s2_3_1_rub);
vstavit_c4eta(s2_3_1_val);

s2_3_1_rub = "/* Formatted on 16.04.2012 18:29:59 (QP5 v5.115.810.9015) disa */ " + 
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  231, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
/*------------------------------- новое условие в ТЗ ----------------------------------------GSP*/
      "  FROM   dacctrn_dbt prov                                                 "+
      " WHERE   (SUBSTR (PROV.T_ACCOUNT_PAYER, 1, 5) IN ('47426', '70606')       "+
      "          OR SUBSTR (PROV.T_ACCOUNT_PAYER, 1, 3) IN ('603'))              "+
      "         AND SUBSTR (PROV.T_ACCOUNT_PAYER, 6, 3) = '810'                  "+
      "         AND SUBSTR (PROV.T_ACCOUNT_RECEIVER, 6, 3) = '810'               "+
      "         AND t_chapter = 1                                                "+
      "         AND PROV.T_SHIFR_OPER = '01'                                     "+
      "         AND t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') "+ 
      "         AND TO_DATE('"+enddate+"', 'dd.mm.yyyy')                         "+
      // EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
      "         and prov.t_state = 1 ";

/*----------------------------------------------------------------------------------------------*/

/*      "         FROM  usr_251_c4eta, darhdoc_dbt prov " +
      "  WHERE  stroka = 231 " +
      "           AND rubli = 1 " +
      "           AND c4et = prov.t_account_payer " +
      "           AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " +
      "           AND ( (prov.t_shifr_oper = '01' AND TRIM (t_kind_oper) = '1') " +
      "                  OR (prov.t_shifr_oper = '01' AND TRIM (t_kind_oper) = '6') " +
      "                  OR (prov.t_shifr_oper = '13' AND TRIM (t_kind_oper) = '1') " +
      "                  OR (prov.t_shifr_oper = '13' AND TRIM (t_kind_oper) = '6') " +
      "                  OR (prov.t_shifr_oper = '16' AND TRIM (t_kind_oper) = '1') " +
      "                  OR (prov.t_shifr_oper = '16' AND TRIM (t_kind_oper) = '6')) " +
      "           AND NOT (t_account_payer LIKE '47416%' AND t_account_receiver NOT LIKE '30102%') " +
      "           AND prov.t_chapter = 1 " ;*/
vstavit_c4eta(s2_3_1_rub);
s2_3_1_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=231 and rubli=1 ";

s2_3_1_val = "/* Formatted on 16.04.2012 18:39:40 (QP5 v5.115.810.9015) disa */ " + 
      " insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  231, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
/*------------------------------- новое условие в ТЗ ----------------------------------------GSP*/
      "  FROM   dacctrn_dbt prov                                                     "+
      " WHERE   (SUBSTR (PROV.T_ACCOUNT_PAYER, 6, 3) <> '810'                        "+
      "             or SUBSTR (PROV.T_ACCOUNT_RECEIVER, 6, 3) <> '810')              "+
      "         AND t_chapter = 1                                                    "+
      "         AND prov.t_date_carry BETWEEN TO_DATE('"+begindate+"', 'dd.mm.yyyy') "+
      "                                   AND TO_DATE('"+enddate+"', 'dd.mm.yyyy')   "+
      // EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
      "         and prov.t_state = 1 ";

    if(fgBank.is_VUZ)
      s2_3_1_val = s2_3_1_val +
      "         AND (SUBSTR (PROV.T_ACCOUNT_PAYER, 1, 5) IN ('47426', '70606')       "+
      "          OR SUBSTR (PROV.T_ACCOUNT_PAYER, 1, 3) IN ('603'))                  "+
      "         AND PROV.T_SHIFR_OPER = '01'                                         ";
    else
      s2_3_1_val = s2_3_1_val +
      "         AND SUBSTR (PROV.T_ACCOUNT_RECEIVER, 1, 3) IN ('301','747')          "+
      "         AND SUBSTR (PROV.T_ACCOUNT_PAYER, 1, 5) IN ('47426', '70606')        "+
      "         AND PROV.T_SHIFR_OPER = '09'                                         ";
    end;
/*----------------------------------------------------------------------------------------------*/
/*      "         FROM  usr_251_c4eta, darhdoc_dbt prov " +
      "  WHERE  stroka = 231 " +
      "           AND rubli = 0 " +
      "           AND c4et = prov.t_account_payer " +
      "           AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " +
      "           AND ( (prov.t_shifr_oper = '01' AND TRIM (t_kind_oper) = '1') " +
      "                  OR (prov.t_shifr_oper = '01' AND TRIM (t_kind_oper) = '6') " +
      "                  OR (prov.t_shifr_oper = '13' AND TRIM (t_kind_oper) = '1') " +
      "                  OR (prov.t_shifr_oper = '13' AND TRIM (t_kind_oper) = '6') " +
      "                  OR (prov.t_shifr_oper = '16' AND TRIM (t_kind_oper) = '1') " +
      "                  OR (prov.t_shifr_oper = '16' AND TRIM (t_kind_oper) = '6')) " +
      "           AND NOT (t_account_payer LIKE '47416%' AND t_account_receiver NOT LIKE '30102%') " +
      "           AND prov.t_chapter = 1 " +
      " UNION " +
      " SELECT  231, prov.t_account_payer, prov.t_account_receiver, prov.t_date_carry, prov.t_sum, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "   FROM  dacctrn_dbt prov " +
      "  WHERE  prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " +
      "           AND TRIM (prov.t_shifr_oper) = '09' " +
      "           AND TRIM (t_kind_oper) = '1' " +
      "           AND prov.t_chapter = 1 " ;*/
vstavit_c4eta(s2_3_1_val);
s2_3_1_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) s1 from usr_251_prov where stroka=231 and rubli=0 ";

/*------------------------------- 2926-У begin ----------------------------------GSP*/
/*------------------- реализация строк 2.3.1.1 и 2.3.1.1.1--------------------------*/
s2_3_1_1_rub = "/* Formatted on 16.04.2012 18:29:59 (QP5 v5.115.810.9015) disa */ " + 
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  2311, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "  FROM   dacctrn_dbt prov, dpmdocs_dbt docs, dpmpaym_dbt pm                   "+
      " WHERE   PROV.t_acctrnid = DOCS.t_acctrnid                        "+
      "         AND DOCS.T_PAYMENTID = PM.T_PAYMENTID                                "+
      "         AND(SUBSTR (PROV.T_ACCOUNT_PAYER, 1, 5) IN ('47426', '70606')        "+
      "              OR SUBSTR (PROV.T_ACCOUNT_PAYER, 1, 3) IN ('603'))              "+
      "         AND SUBSTR (PROV.T_ACCOUNT_PAYER, 6, 3) = '810'                      "+
      "         AND SUBSTR (PROV.T_ACCOUNT_RECEIVER, 6, 3) = '810'                   "+
      "         AND prov.t_chapter = 1                                               "+
      "         AND PROV.T_SHIFR_OPER = '01'                                         "+
      "         AND user_ea.getOrigin(pm.t_docKind, pm.t_paymentID)in (2,3200,10003,3300)  "+
      // EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
      "         and prov.t_state = 1 "+
      "         AND prov.t_date_carry BETWEEN TO_DATE('"+begindate+"', 'dd.mm.yyyy') "+
      "         AND TO_DATE('"+enddate+"', 'dd.mm.yyyy')                             ";
/*      "         FROM  usr_251_c4eta, darhdoc_dbt prov, dpmpaym_dbt paym, dpmdocs_dbt docs " +
      "  WHERE  stroka = 231 " +
      "    and prov.t_applicationkey = docs.t_applicationkey "+
      "    and docs.t_paymentid = paym.t_paymentid "+
      "    and paym.t_origin in (2,3200,3300) "+
      "    AND rubli = 1 " +
      "    AND c4et = prov.t_account_payer " +
      "    AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " +
      "    AND ( (prov.t_shifr_oper = '01' AND TRIM (t_kind_oper) = '1') " +
      "        OR (prov.t_shifr_oper = '01' AND TRIM (t_kind_oper) = '6') " +
      "        OR (prov.t_shifr_oper = '13' AND TRIM (t_kind_oper) = '1') " +
      "        OR (prov.t_shifr_oper = '13' AND TRIM (t_kind_oper) = '6') " +
      "        OR (prov.t_shifr_oper = '16' AND TRIM (t_kind_oper) = '1') " +
      "        OR (prov.t_shifr_oper = '16' AND TRIM (t_kind_oper) = '6')) " +
      "    AND NOT (t_account_payer LIKE '47416%' AND t_account_receiver NOT LIKE '30102%') " +
      "    AND prov.t_chapter = 1 " ;
*/
//vstavit_c4eta(s2_3_1_1_rub);
s2_3_1_1_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2311 and rubli=1 ";

s2_3_1_1_val = "/* Formatted on 16.04.2012 18:39:40 (QP5 v5.115.810.9015) disa */ " + 
      " insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  2311, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "  FROM   dacctrn_dbt prov, dpmdocs_dbt docs, dpmpaym_dbt pm                   "+
      " WHERE   PROV.t_acctrnid = DOCS.t_acctrnid                        "+
      "         AND DOCS.T_PAYMENTID = PM.T_PAYMENTID                                "+
      "         AND SUBSTR (PROV.T_ACCOUNT_PAYER, 1, 5) IN ('47426', '70606')        "+
      "         AND SUBSTR (PROV.T_ACCOUNT_RECEIVER, 1, 3) IN ('301','747')          "+
      "         AND (SUBSTR (PROV.T_ACCOUNT_PAYER, 6, 3) <> '810'                    "+
      "             or SUBSTR (PROV.T_ACCOUNT_RECEIVER, 6, 3) <> '810')              "+
      "         AND prov.t_chapter = 1                                               "+
      "         AND PROV.T_SHIFR_OPER = '09'                                         "+
      "         AND user_ea.getOrigin(pm.t_docKind, pm.t_paymentID)in (2,3200,10003,3300)  "+
      // EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
      "         and prov.t_state = 1 "+
      "         AND prov.t_date_carry BETWEEN TO_DATE('"+begindate+"', 'dd.mm.yyyy') "+
      "         AND TO_DATE('"+enddate+"', 'dd.mm.yyyy')                             ";
/*      "         FROM  usr_251_c4eta, darhdoc_dbt prov, dpmpaym_dbt paym, dpmdocs_dbt docs " +
      "  WHERE  stroka = 231 " +
      "    and prov.t_applicationkey = docs.t_applicationkey "+
      "    and docs.t_paymentid = paym.t_paymentid "+
      "    and paym.t_origin in (2,3200) "+
      "    AND rubli = 0 " +
      "    AND c4et = prov.t_account_payer " +
      "    AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " +
      "    AND ( (prov.t_shifr_oper = '01' AND TRIM (t_kind_oper) = '1') " +
      "          OR (prov.t_shifr_oper = '01' AND TRIM (t_kind_oper) = '6') " +
      "          OR (prov.t_shifr_oper = '13' AND TRIM (t_kind_oper) = '1') " +
      "          OR (prov.t_shifr_oper = '13' AND TRIM (t_kind_oper) = '6') " +
      "          OR (prov.t_shifr_oper = '16' AND TRIM (t_kind_oper) = '1') " +
      "          OR (prov.t_shifr_oper = '16' AND TRIM (t_kind_oper) = '6')) " +
      "    AND NOT (t_account_payer LIKE '47416%' AND t_account_receiver NOT LIKE '30102%') " +
      "    AND prov.t_chapter = 1 " +
      " UNION " +
      " SELECT  2311, prov.t_account_payer, prov.t_account_receiver, prov.t_date_carry, prov.t_sum, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "   FROM  darhdoc_dbt prov, dpmpaym_dbt paym, dpmdocs_dbt docs " +
      "  WHERE  prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " +
      "    and prov.t_applicationkey = docs.t_applicationkey "+
      "    and docs.t_paymentid = paym.t_paymentid "+
      "    and paym.t_origin in (2,3200) "+
      "    AND TRIM (prov.t_shifr_oper) = '09' " +
      "    AND TRIM (t_kind_oper) = '1' " +
      "    AND prov.t_chapter = 1 " ;*/
//vstavit_c4eta(s2_3_1_1_val);
s2_3_1_1_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2311 and rubli=0 ";

s2_3_1_1_1_rub = "/* Formatted on 16.04.2012 18:29:59 (QP5 v5.115.810.9015) disa */ " + 
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  23111, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "   FROM  usr_251_c4eta, dacctrn_dbt prov, dpmpaym_dbt paym, dpmdocs_dbt docs " +
      "  WHERE  stroka = 231 " +
      "    and prov.t_acctrnid = docs.t_acctrnid "+
      "    and docs.t_paymentid = paym.t_paymentid "+
      "    and paym.t_origin in (3200) "+
      "    AND rubli = 1 " +
      "    AND c4et = prov.t_account_payer " +
      "    AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " +
      // EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
      "    and prov.t_state = 1 "+
      "    AND ( (prov.t_shifr_oper = '01' AND TRIM (t_kind_oper) = '1') " +
      "          OR (prov.t_shifr_oper = '01' AND TRIM (t_kind_oper) = '6') " +
      "          OR (prov.t_shifr_oper = '13' AND TRIM (t_kind_oper) = '1') " +
      "          OR (prov.t_shifr_oper = '13' AND TRIM (t_kind_oper) = '6') " +
      "          OR (prov.t_shifr_oper = '16' AND TRIM (t_kind_oper) = '1') " +
      "          OR (prov.t_shifr_oper = '16' AND TRIM (t_kind_oper) = '6')) " +
      "    AND NOT (t_account_payer LIKE '47416%' AND t_account_receiver NOT LIKE '30102%') " +
      "    AND prov.t_chapter = 1 " ;
//vstavit_c4eta(s2_3_1_1_1_rub);
s2_3_1_1_1_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=23111 and rubli=1 ";

s2_3_1_1_1_val = "/* Formatted on 16.04.2012 18:39:40 (QP5 v5.115.810.9015) disa */ " + 
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  23111, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "   FROM  usr_251_c4eta, dacctrn_dbt prov, dpmpaym_dbt paym, dpmdocs_dbt docs " +
      "  WHERE  stroka = 231 " +
      "    and prov.t_acctrnid = docs.t_acctrnid "+
      "    and docs.t_paymentid = paym.t_paymentid "+
      "    and paym.t_origin in (3200) "+
      "    AND rubli = 0 " +
      "    AND c4et = prov.t_account_payer " +
      "    AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " +
      // EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
      "    and prov.t_state = 1 "+
      "    AND ( (prov.t_shifr_oper = '01' AND TRIM (t_kind_oper) = '1') " +
      "          OR (prov.t_shifr_oper = '01' AND TRIM (t_kind_oper) = '6') " +
      "          OR (prov.t_shifr_oper = '13' AND TRIM (t_kind_oper) = '1') " +
      "          OR (prov.t_shifr_oper = '13' AND TRIM (t_kind_oper) = '6') " +
      "          OR (prov.t_shifr_oper = '16' AND TRIM (t_kind_oper) = '1') " +
      "          OR (prov.t_shifr_oper = '16' AND TRIM (t_kind_oper) = '6')) " +
      "    AND NOT (t_account_payer LIKE '47416%' AND t_account_receiver NOT LIKE '30102%') " +
      "    AND prov.t_chapter = 1 " +
      " UNION " +
      " SELECT  23111, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "   FROM  dacctrn_dbt prov, dpmpaym_dbt paym, dpmdocs_dbt docs " +
      "  WHERE  prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " +
      // EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
      "    and prov.t_state = 1 "+
      "    and prov.t_acctrnid = docs.t_acctrnid "+
      "    and docs.t_paymentid = paym.t_paymentid "+
      "    and paym.t_origin in (3200) "+
      "    AND TRIM (prov.t_shifr_oper) = '09' " +
      "    AND TRIM (t_kind_oper) = '1' " +
      "    AND prov.t_chapter = 1 " ;
//vstavit_c4eta(s2_3_1_1_1_val);
s2_3_1_1_1_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=23111 and rubli=0 ";
/*------------------------------- 2926-У end ------------------------------------*/



/*

s2_1_6_rub=" "+
"       /* Formatted on 24.01.2011 17:19:46 (QP5 v5.115.810.9015) disa */       "+
"  select count(cc), sum(ss) from ( "+
"       SELECT   COUNT (1) cc, ROUND (NVL (SUM (t_sum), 0) / 1000)      ss"+
"         FROM   darhdoc_dbt prov,      "+
"                (SELECT   acc.t_account, acc.t_chapter "+
"                   FROM   daccount_dbt acc,dparty_dbt party LEFT JOIN dpersn_dbt persn ON (party.t_partyid = persn.t_personid)       "+
"                  WHERE   SUBSTR (acc.t_account, 1, 3) BETWEEN '401' AND '408' "+
"                      AND substr( prov.t_account_payer, 1, 5 ) NOT IN ('40803', '40810', '40813', '40817', '40820')  "+
"                      AND (acc.t_type_account NOT LIKE '%П%' AND acc.t_type_account NOT LIKE '%U%' AND acc.t_type_account NOT LIKE '%Н%')      "+
"                      AND acc.t_client = party.t_partyid       "+
"                      AND ( (persn.t_isemployer = 'X' AND party.t_legalform = 2) OR (party.t_legalform = 1))   "+
"                      AND acc.t_chapter = 1    "+
"                      AND acc.t_code_currency = 0) t1  "+
"        WHERE   prov.t_date_carry BETWEEN TO_DATE (' "+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy')   "+
"            AND prov.t_chapter = 1     "+
"            AND t1.t_chapter = prov.t_chapter  "+
"            AND t1.t_account = prov.t_account_payer    "+
"            AND TRIM (prov.t_shifr_oper) = '17'        "+
"            AND (TRIM (t_kind_oper) = '01' OR TRIM (t_kind_oper) = '06')       "+
"       UNION   "+
"       SELECT   COUNT (1) cc, ROUND (NVL (SUM (t_sum), 0) / 1000)      ss"+
"         FROM   darhdoc_dbt prov,      "+
"                (SELECT   acc.t_account, acc.t_chapter "+
"                   FROM   daccount_dbt acc,dparty_dbt party LEFT JOIN dpersn_dbt persn ON (party.t_partyid = persn.t_personid)       "+
"                  WHERE   SUBSTR (acc.t_account, 1, 3) BETWEEN '401' AND '408' "+
"                      AND substr( prov.t_account_payer, 1, 5 ) NOT IN ('40803', '40810', '40813', '40817', '40820')  "+
"                      AND (acc.t_type_account NOT LIKE '%П%' AND acc.t_type_account NOT LIKE '%U%' AND acc.t_type_account NOT LIKE '%Н%')      "+
"                      AND acc.t_client = party.t_partyid       "+
"                      AND ( (persn.t_isemployer = 'X' AND party.t_legalform = 2) OR (party.t_legalform = 1))   "+
"                      AND acc.t_chapter = 1    "+
"                      AND acc.t_code_currency = 0) t1  "+
"        WHERE   prov.t_date_carry BETWEEN TO_DATE (' "+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy')   "+
"            AND prov.t_chapter = 1     "+
"            AND t1.t_chapter = prov.t_chapter  "+
"            AND t1.t_account = prov.t_account_payer    "+
"            AND prov.t_account_receiver LIKE '70601%'  "+
"            AND TRIM (prov.t_shifr_oper) = '19'        "+
"            AND TRIM (t_kind_oper) = '06'      "+
"       UNION   "+
"       SELECT   COUNT (1) cc, ROUND (NVL (SUM (t_sum), 0) / 1000)      ss"+
"         FROM   darhdoc_dbt prov,      "+
"                (SELECT   acc.t_account, acc.t_chapter "+
"                   FROM   daccount_dbt acc,dparty_dbt party LEFT JOIN dpersn_dbt persn ON (party.t_partyid = persn.t_personid)       "+
"                  WHERE   SUBSTR (acc.t_account, 1, 3) BETWEEN '401' AND '408' "+
"                      AND substr( prov.t_account_payer, 1, 5 ) NOT IN ('40803', '40810', '40813', '40817', '40820')  "+
"                      AND (acc.t_type_account NOT LIKE '%П%' AND acc.t_type_account NOT LIKE '%U%' AND acc.t_type_account NOT LIKE '%Н%')      "+
"                      AND acc.t_client = party.t_partyid       "+
"                      AND ( (persn.t_isemployer = 'X' AND party.t_legalform = 2) OR (party.t_legalform = 1))   "+
"                      AND acc.t_chapter = 1    "+
"                      AND acc.t_code_currency = 0) t2  "+
"        WHERE   prov.t_date_carry BETWEEN TO_DATE (' "+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy')   "+
"            AND prov.t_chapter = 1     "+
"            AND t2.t_chapter = prov.t_chapter  "+
"            AND t2.t_account = prov.t_account_receiver "+
"            AND prov.t_account_payer LIKE '70601%'     "+
"            AND TRIM (prov.t_shifr_oper) = '19'        "+
"            AND TRIM (t_kind_oper) = '06')     ";


s2_1_6_val=" "+
"       /* Formatted on 24.01.2011 17:19:46 (QP5 v5.115.810.9015) disa */       "+
"  select count(cc), sum(ss) from ( "+
"       SELECT   COUNT (1) cc, ROUND (NVL (SUM (t_sum), 0) / 1000) ss   "+
"         FROM   darhdoc_dbt prov,      "+
"                (SELECT   acc.t_account, acc.t_chapter "+
"                   FROM   daccount_dbt acc,dparty_dbt party LEFT JOIN dpersn_dbt persn ON (party.t_partyid = persn.t_personid)       "+
"                  WHERE   SUBSTR (acc.t_account, 1, 3) BETWEEN '401' AND '408' "+
"                      AND substr( prov.t_account_payer, 1, 5 ) NOT IN ('40803', '40810', '40813', '40817', '40820')  "+
"                      AND (acc.t_type_account LIKE '%П%' or acc.t_type_account  LIKE '%U%' or acc.t_type_account  LIKE '%Н%')  "+
"                      AND acc.t_client = party.t_partyid       "+
"                      AND ( (persn.t_isemployer = 'X' AND party.t_legalform = 2) OR (party.t_legalform = 1))   "+
"                      AND acc.t_chapter = 1    "+
"                      AND acc.t_code_currency = 0) t1  "+
"        WHERE   prov.t_date_carry BETWEEN TO_DATE (' "+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy')   "+
"            AND prov.t_chapter = 1     "+
"            AND t1.t_chapter = prov.t_chapter  "+
"            AND t1.t_account = prov.t_account_payer    "+
"            AND TRIM (prov.t_shifr_oper) = '17'        "+
"            AND (TRIM (t_kind_oper) = '01' OR TRIM (t_kind_oper) = '06')       "+
"       UNION   "+
"       SELECT   COUNT (1) cc , ROUND (NVL (SUM (t_sum), 0) / 1000)     ss "+
"         FROM   darhdoc_dbt prov,      "+
"                (SELECT   acc.t_account, acc.t_chapter "+
"                   FROM   daccount_dbt acc,dparty_dbt party LEFT JOIN dpersn_dbt persn ON (party.t_partyid = persn.t_personid)       "+
"                  WHERE   SUBSTR (acc.t_account, 1, 3) BETWEEN '401' AND '408' "+
"                      AND substr( prov.t_account_payer, 1, 5 ) NOT IN ('40803', '40810', '40813', '40817', '40820')  "+
"                      AND (acc.t_type_account  LIKE '%П%' or acc.t_type_account  LIKE '%U%' or acc.t_type_account  LIKE '%Н%') "+
"                      AND acc.t_client = party.t_partyid       "+
"                      AND ( (persn.t_isemployer = 'X' AND party.t_legalform = 2) OR (party.t_legalform = 1))   "+
"                      AND acc.t_chapter = 1    "+
"                      AND acc.t_code_currency = 0) t1  "+
"        WHERE   prov.t_date_carry BETWEEN TO_DATE (' "+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy')   "+
"            AND prov.t_chapter = 1     "+
"            AND t1.t_chapter = prov.t_chapter  "+
"            AND t1.t_account = prov.t_account_payer    "+
"            AND prov.t_account_receiver LIKE '70601%'  "+
"            AND TRIM (prov.t_shifr_oper) = '19'        "+
"            AND TRIM (t_kind_oper) = '06'      "+
"       UNION   "+
"       SELECT   COUNT (1) cc, ROUND (NVL (SUM (t_sum), 0) / 1000)      ss"+
"         FROM   darhdoc_dbt prov,      "+
"                (SELECT   acc.t_account, acc.t_chapter "+
"                   FROM   daccount_dbt acc,dparty_dbt party LEFT JOIN dpersn_dbt persn ON (party.t_partyid = persn.t_personid)       "+
"                  WHERE   SUBSTR (acc.t_account, 1, 3) BETWEEN '401' AND '408' "+
"                      AND substr( prov.t_account_payer, 1, 5 ) NOT IN ('40803', '40810', '40813', '40817', '40820')  "+
"                      AND (acc.t_type_account  LIKE '%П%' or acc.t_type_account  LIKE '%U%' or acc.t_type_account  LIKE '%Н%') "+
"                      AND acc.t_client = party.t_partyid       "+
"                      AND ( (persn.t_isemployer = 'X' AND party.t_legalform = 2) OR (party.t_legalform = 1))   "+
"                      AND acc.t_chapter = 1    "+
"                      AND acc.t_code_currency = 0) t2  "+
"        WHERE   prov.t_date_carry BETWEEN TO_DATE (' "+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy')   "+
"            AND prov.t_chapter = 1     "+
"            AND t2.t_chapter = prov.t_chapter  "+
"            AND t2.t_account = prov.t_account_receiver "+
"            AND prov.t_account_payer LIKE '70601%'     "+
"            AND TRIM (prov.t_shifr_oper) = '19'        "+
"            AND TRIM (t_kind_oper) = '06')     ";
*/


vstavit_c4eta("insert /*+ APPEND*/ into usr_251_c4eta select 41, acc.t_account,1,acc.t_code_currency "+ day_c4eta41(true));
vstavit_c4eta("insert /*+ APPEND*/ into usr_251_c4eta select 41, acc.t_account,0,acc.t_code_currency "+ day_c4eta41(false));
s4_1_rub=" "+
" select count ( 1 ) cc, round(nvl(sum ( t_sum_natcur ),0)/1000) ss from usr_251_c4eta, dacctrn_dbt prov "+
" where stroka=41 and rubli=1 and c4et=prov.t_account_payer "+
" and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
" and prov.t_state = 1 "+
" and prov.t_account_payer not like '202%' "+
" and prov.t_account_payer not like '30233%' "+
" and prov.t_account_payer not like '313%' "+
" and prov.t_account_payer not like '320%' "+
" and prov.t_account_payer not like '47408%' "+
" and prov.t_account_payer not like '47422%' ";

s4_1_val=" "+
" select count ( 1 ) cc, round(nvl(sum ( t_sum_natcur ),0)/1000) ss from usr_251_c4eta, dacctrn_dbt prov "+
" where stroka=41 and rubli=0 and c4et=prov.t_account_payer "+
" and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
" and prov.t_state = 1 "+
" and prov.t_account_payer not like '202%' "+
" and prov.t_account_payer not like '30233%' "+
" and prov.t_account_payer not like '313%' "+
" and prov.t_account_payer not like '320%' "+
" and prov.t_account_payer not like '47408%' "+
" and prov.t_account_payer not like '47422%' "+
" and prov.t_account_payer not like '70603%' ";

/*пункт отменен
s4_1_1_rub=" select count ( 1 ) cc, round(nvl(sum ( t_sum ),0)/1000) ss from usr_251_c4eta, darhdoc_dbt prov, daccount_dbt acc1, daccount_dbt acc2 "+
" where stroka=41 and rubli=1 and c4et=prov.t_account_payer and t_account_payer=acc1.t_account and acc2.t_account=t_account_receiver "+
" and acc1.t_chapter=acc2.t_chapter and acc1.t_chapter=prov.t_chapter and prov.t_chapter=1 and acc1.t_client<>acc2.t_client  "+
" and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
" and acc2.t_account in (select c4et from usr_251_c4eta where stroka=41 and rubli=1) ";

s4_1_1_val=" select count ( 1 ) cc, round(nvl(sum ( t_sum ),0)/1000) ss from usr_251_c4eta, darhdoc_dbt prov, daccount_dbt acc1, daccount_dbt acc2 "+
" where stroka=41 and rubli=0 and c4et=prov.t_account_payer and t_account_payer=acc1.t_account and acc2.t_account=t_account_receiver "+
" and acc1.t_chapter=acc2.t_chapter and acc1.t_chapter=prov.t_chapter and prov.t_chapter=1 and acc1.t_client<>acc2.t_client "+
" and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
" and acc2.t_account in (select c4et from usr_251_c4eta where stroka=41 and rubli=0) ";
*/
/*переименовано из 4.1.3 в 4.1.1*/
s4_1_1_rub=" select count ( 1 ) cc, round(nvl(sum ( t_sum_natcur ),0)/1000) ss from usr_251_c4eta, dacctrn_dbt prov "+
" where stroka=41 and rubli=1 and c4et=prov.t_account_payer and substr( prov.t_account_receiver, 1, 5 )='30102' "+
"  and prov.t_chapter=1 "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
" and prov.t_state = 1 "+
" and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) ";

s4_1_1_val=" select count ( 1 ) cc, round(nvl(sum ( t_sum_natcur ),0)/1000) ss from usr_251_c4eta, dacctrn_dbt prov "+
" where stroka=41 and rubli=0 and c4et=prov.t_account_payer and substr( prov.t_account_receiver, 1, 5 )='30102' "+
"  and prov.t_chapter=1 "+
// EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
" and prov.t_state = 1 "+
" and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) ";


s2_3_3_rub = "/* Formatted on 17.04.2012 13:13:36 (QP5 v5.115.810.9015) disa */ " + 
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  233, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "  FROM   dacctrn_dbt prov                                                 "+
      " WHERE   (SUBSTR (PROV.T_ACCOUNT_PAYER, 1, 5) IN ('47426', '70606')       "+
      "          OR SUBSTR (PROV.T_ACCOUNT_PAYER, 1, 3) IN ('603'))              "+
      "         AND SUBSTR (PROV.T_ACCOUNT_PAYER, 6, 3) = '810'                  "+
      "         AND SUBSTR (PROV.T_ACCOUNT_RECEIVER, 6, 3) = '810'               "+
      "         AND t_chapter = 1                                                "+
      "         AND PROV.T_SHIFR_OPER = '02'                                     "+
      // EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
      "         and prov.t_state = 1 "+
      "         AND t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') "+ 
      "         AND TO_DATE('"+enddate+"', 'dd.mm.yyyy')                         ";
/*      "         FROM  usr_251_c4eta, darhdoc_dbt prov " +
      "  WHERE  stroka = 231 " +
      "           AND rubli = 1 " +
      "           AND c4et = prov.t_account_payer " +
      "           AND prov.t_chapter = 1 " +
      "           AND (TRIM (prov.t_shifr_oper) = '02' OR TRIM (prov.t_shifr_oper) = '16' OR TRIM (prov.t_shifr_oper) = '2') " +
      "           AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " ;*/
message("Вставить счета s2_3_3_rub ");
vstavit_c4eta(s2_3_3_rub);
s2_3_3_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=233 and rubli=1 ";

s2_3_3_val = "/* Formatted on 17.04.2012 13:13:36 (QP5 v5.115.810.9015) disa */ " + 
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  233, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
/*------------------------------- новое условие в ТЗ ----------------------------------------GSP*/
      "  FROM   dacctrn_dbt prov                                                     "+
      " WHERE   (SUBSTR (PROV.T_ACCOUNT_PAYER, 6, 3) <> '810'                        "+
      "             or SUBSTR (PROV.T_ACCOUNT_RECEIVER, 6, 3) <> '810')              "+
      "         AND t_chapter = 1                                                    "+
      // EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
      "         and prov.t_state = 1 "+
      "         AND prov.t_date_carry BETWEEN TO_DATE('"+begindate+"', 'dd.mm.yyyy') "+
      "         AND TO_DATE('"+enddate+"', 'dd.mm.yyyy')                             ";
    if(fgBank.is_VUZ)
      s2_3_3_val = s2_3_3_val +
      "         AND (SUBSTR (PROV.T_ACCOUNT_PAYER, 1, 5) IN ('47426', '70606')       "+
      "          OR SUBSTR (PROV.T_ACCOUNT_PAYER, 1, 3) IN ('603'))                  "+
      "         AND PROV.T_SHIFR_OPER = '02'                                         ";
    else
      s2_3_3_val = s2_3_3_val +
      "         AND SUBSTR (PROV.T_ACCOUNT_RECEIVER, 1, 3) IN ('301','747')          "+
      "         AND SUBSTR (PROV.T_ACCOUNT_PAYER, 1, 5) IN ('47426', '70606')        "+
      "         AND PROV.T_SHIFR_OPER = '02'                                         ";
    end;
/*----------------------------------------------------------------------------------------------*/
/*      "         FROM  usr_251_c4eta, darhdoc_dbt prov " +
      "  WHERE  stroka = 231 " +
      "           AND rubli = 0 " +
      "           AND c4et = prov.t_account_payer " +
      "           AND prov.t_chapter = 1 " +
      "           AND (TRIM (prov.t_shifr_oper) = '02' OR TRIM (prov.t_shifr_oper) = '16' OR TRIM (prov.t_shifr_oper) = '2') " +
      "           AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " ;*/
vstavit_c4eta(s2_3_3_val);
s2_3_3_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=233 and rubli=0 ";

/*------------------------------- 2926-У begin ----------------------------------GSP*/
/*------------------- реализация строк 2.3.3.1 и 2.3.3.1.1--------------------------*/
s2_3_3_1_rub = " " + 
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  2331, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "   FROM  usr_251_c4eta, dacctrn_dbt prov, dpmpaym_dbt paym, dpmdocs_dbt docs " +
      "  WHERE  stroka = 231 " +
      "    and prov.t_acctrnid = docs.t_acctrnid "+
      "    and docs.t_paymentid = paym.t_paymentid "+
      "    and paym.t_origin in (2,3200,3300) "+
      "           AND rubli = 1 " +
      "           AND c4et = prov.t_account_payer " +
      "           AND prov.t_chapter = 1 " +
      "           AND (TRIM (prov.t_shifr_oper) = '02' OR TRIM (prov.t_shifr_oper) = '16' OR TRIM (prov.t_shifr_oper) = '2') " +
      // EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
      "           and prov.t_state = 1 "+
      "           AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " ;
//vstavit_c4eta(s2_3_3_1_rub);
s2_3_3_1_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2331 and rubli=1 ";

s2_3_3_1_val = "/* Formatted on 17.04.2012 13:13:36 (QP5 v5.115.810.9015) disa */ " + 
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  2331, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "   FROM  usr_251_c4eta, dacctrn_dbt prov, dpmpaym_dbt paym, dpmdocs_dbt docs " +
      "  WHERE  stroka = 231 " +
      "    and prov.t_acctrnid = docs.t_acctrnid "+
      "    and docs.t_paymentid = paym.t_paymentid "+
      "    and paym.t_origin in (2,3200) "+
      "           AND rubli = 0 " +
      "           AND c4et = prov.t_account_payer " +
      "           AND prov.t_chapter = 1 " +
      "           AND (TRIM (prov.t_shifr_oper) = '02' OR TRIM (prov.t_shifr_oper) = '16' OR TRIM (prov.t_shifr_oper) = '2') " +
      // EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
      "           and prov.t_state = 1 "+
      "           AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " ;
//vstavit_c4eta(s2_3_3_1_val);
s2_3_3_1_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2331 and rubli=0 ";

s2_3_3_1_1_rub = "/* Formatted on 17.04.2012 13:13:36 (QP5 v5.115.810.9015) disa */ " + 
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  23311, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "   FROM  usr_251_c4eta, dacctrn_dbt prov, dpmpaym_dbt paym, dpmdocs_dbt docs " +
      "  WHERE  stroka = 231 " +
      "    and prov.t_acctrnid = docs.t_acctrnid "+
      "    and docs.t_paymentid = paym.t_paymentid "+
      "    and paym.t_origin in (3200) "+
      "           AND rubli = 1 " +
      "           AND c4et = prov.t_account_payer " +
      "           AND prov.t_chapter = 1 " +
      "           AND (TRIM (prov.t_shifr_oper) = '02' OR TRIM (prov.t_shifr_oper) = '16' OR TRIM (prov.t_shifr_oper) = '2') " +
      // EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
      "           and prov.t_state = 1 "+
      "           AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " ;
//vstavit_c4eta(s2_3_3_1_1_rub);
s2_3_3_1_1_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=23311 and rubli=1 ";

s2_3_3_1_1_val = "/* Formatted on 17.04.2012 13:13:36 (QP5 v5.115.810.9015) disa */ " + 
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  23311, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "   FROM  usr_251_c4eta, dacctrn_dbt prov, dpmpaym_dbt paym, dpmdocs_dbt docs " +
      "  WHERE  stroka = 231 " +
      "    and prov.t_acctrnid = docs.t_acctrnid "+
      "    and docs.t_paymentid = paym.t_paymentid "+
      "    and paym.t_origin in (3200) "+
      "           AND rubli = 0 " +
      "           AND c4et = prov.t_account_payer " +
      "           AND prov.t_chapter = 1 " +
      "           AND (TRIM (prov.t_shifr_oper) = '02' OR TRIM (prov.t_shifr_oper) = '16' OR TRIM (prov.t_shifr_oper) = '2') " +
      // EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
      "           and prov.t_state = 1 "+
      "           AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " ;
//vstavit_c4eta(s2_3_3_1_1_val);
s2_3_3_1_1_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=23311 and rubli=0 ";
/*------------------------------- 2926-У end ------------------------------------*/

s2_3_4_rub = "/* Formatted on 17.04.2012 13:18:26 (QP5 v5.115.810.9015) disa */ " + 
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  234, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "  FROM   dacctrn_dbt prov                                                 "+
      " WHERE   (SUBSTR (PROV.T_ACCOUNT_PAYER, 1, 5) IN ('47426', '70606')       "+
      "          OR SUBSTR (PROV.T_ACCOUNT_PAYER, 1, 3) IN ('603'))              "+
      "         AND SUBSTR (PROV.T_ACCOUNT_PAYER, 6, 3) = '810'                  "+
      "         AND SUBSTR (PROV.T_ACCOUNT_RECEIVER, 6, 3) = '810'               "+
      "         AND t_chapter = 1                                                "+
      "         AND PROV.T_SHIFR_OPER = '06'                                     "+
      "         AND t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') "+ 
      "         AND TO_DATE('"+enddate+"', 'dd.mm.yyyy')                         ";
/*      "         FROM  usr_251_c4eta, darhdoc_dbt prov " +
      "  WHERE  stroka = 231 " +
      "           AND rubli = 1 " +
      "           AND c4et = prov.t_account_payer " +
      "           AND prov.t_chapter = 1 " +
      "           AND (TRIM (prov.t_shifr_oper) = '06' OR TRIM (prov.t_shifr_oper) = '16' OR TRIM (prov.t_shifr_oper) = '6') " +
      "           AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " ;*/
message("Вставить счета s2_3_4_rub ");
vstavit_c4eta(s2_3_4_rub);
s2_3_4_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=234 and rubli=1 ";

s2_3_4_val = "/* Formatted on 17.04.2012 13:18:26 (QP5 v5.115.810.9015) disa */ " + 
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  234, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
/*------------------------------- новое условие в ТЗ ----------------------------------------GSP*/
      "  FROM   dacctrn_dbt prov                                                     "+
      " WHERE   (SUBSTR (PROV.T_ACCOUNT_PAYER, 6, 3) <> '810'                        "+
      "             or SUBSTR (PROV.T_ACCOUNT_RECEIVER, 6, 3) <> '810')              "+
      "         AND t_chapter = 1                                                    "+
      // EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
      "         and prov.t_state = 1 "+
      "         AND prov.t_date_carry BETWEEN TO_DATE('"+begindate+"', 'dd.mm.yyyy') "+
      "         AND TO_DATE('"+enddate+"', 'dd.mm.yyyy')                             ";
    if(fgBank.is_VUZ)
      s2_3_4_val = s2_3_4_val +
      "         AND (SUBSTR (PROV.T_ACCOUNT_PAYER, 1, 5) IN ('47426', '70606')       "+
      "          OR SUBSTR (PROV.T_ACCOUNT_PAYER, 1, 3) IN ('603'))                  "+
      "         AND PROV.T_SHIFR_OPER = '06'                                         ";
    else
      s2_3_4_val = s2_3_4_val +
      "         AND SUBSTR (PROV.T_ACCOUNT_RECEIVER, 1, 3) IN ('301','747')          "+
      "         AND SUBSTR (PROV.T_ACCOUNT_PAYER, 1, 5) IN ('47426', '70606')        "+
      "         AND PROV.T_SHIFR_OPER = '06'                                         ";
    end;
/*----------------------------------------------------------------------------------------------*/
/*      "         FROM  usr_251_c4eta, darhdoc_dbt prov " +
      "  WHERE  stroka = 231 " +
      "           AND rubli = 0 " +
      "           AND c4et = prov.t_account_payer " +
      "           AND prov.t_chapter = 1 " +
      "           AND (TRIM (prov.t_shifr_oper) = '06' OR TRIM (prov.t_shifr_oper) = '16' OR TRIM (prov.t_shifr_oper) = '6') " +
      "           AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " ;*/
vstavit_c4eta(s2_3_4_val);
s2_3_4_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=234 and rubli=0 ";


/*------------------------------- 2926-У begin ----------------------------------GSP*/
/*------------------- реализация строк 2.3.4.1 --------------------------*/
s2_3_4_1_rub = "/* Formatted on 17.04.2012 13:18:26 (QP5 v5.115.810.9015) disa */ " + 
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  2341, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "   FROM  usr_251_c4eta, dacctrn_dbt prov, dpmpaym_dbt paym, dpmdocs_dbt docs " +
      "  WHERE  stroka = 231 " +
      "    and prov.t_acctrnid = docs.t_acctrnid "+
      "    and docs.t_paymentid = paym.t_paymentid "+
      "    and paym.t_origin in (2,3200,3300) "+
      "    AND rubli = 1 " +                                                        
      "    AND c4et = prov.t_account_payer " +
      "    AND prov.t_chapter = 1 " +
      "    AND (TRIM (prov.t_shifr_oper) = '06' OR TRIM (prov.t_shifr_oper) = '16' OR TRIM (prov.t_shifr_oper) = '6') " +
      // EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
      "    and prov.t_state = 1 "+
      "    AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " ;
//vstavit_c4eta(s2_3_4_1_rub);
s2_3_4_1_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2341 and rubli=1 ";

s2_3_4_1_val = "/* Formatted on 17.04.2012 13:18:26 (QP5 v5.115.810.9015) disa */ " + 
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  2341, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "   FROM  usr_251_c4eta, dacctrn_dbt prov, dpmpaym_dbt paym, dpmdocs_dbt docs " +
      "  WHERE  stroka = 231 " +
      "    and prov.t_acctrnid = docs.t_acctrnid "+
      "    and docs.t_paymentid = paym.t_paymentid "+
      "    and paym.t_origin in (2,3200) "+
      "    AND rubli = 0 " +
      "    AND c4et = prov.t_account_payer " +
      "    AND prov.t_chapter = 1 " +
      "    AND (TRIM (prov.t_shifr_oper) = '06' OR TRIM (prov.t_shifr_oper) = '16' OR TRIM (prov.t_shifr_oper) = '6') " +
      // EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
      "    and prov.t_state = 1 "+
      "    AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " ;
//vstavit_c4eta(s2_3_4_1_val);
s2_3_4_1_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2341 and rubli=0 ";
/*------------------------------- 2926-У end ------------------------------------*/


s2_3_5_rub = "/* Formatted on 17.04.2012 13:22:27 (QP5 v5.115.810.9015) disa */ " + 
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  235, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "   FROM  usr_251_c4eta, dacctrn_dbt prov " +
      "  WHERE  stroka = 231 " +
      "           AND rubli = 1 " +
      "           AND c4et = prov.t_account_payer " +
      "           AND prov.t_chapter = 1 " +
      "           AND (TRIM (prov.t_shifr_oper) = '07' OR TRIM (prov.t_shifr_oper) = '7') " +
      // EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
      "           and prov.t_state = 1 "+
      "           AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " ;
vstavit_c4eta(s2_3_5_rub);
s2_3_5_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=235 and rubli=1 ";

s2_3_5_val = "/* Formatted on 17.04.2012 13:22:27 (QP5 v5.115.810.9015) disa */ " + 
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  235, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "   FROM  usr_251_c4eta, dacctrn_dbt prov " +
      "  WHERE  stroka = 231 " +
      "           AND rubli = 0 " +
      "           AND c4et = prov.t_account_payer " +
      "           AND prov.t_chapter = 1 " +
      "           AND (TRIM (prov.t_shifr_oper) = '07' OR TRIM (prov.t_shifr_oper) = '7') " +
      // EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
      "           and prov.t_state = 1 "+
      "           AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " ;

vstavit_c4eta(s2_3_5_val);
s2_3_5_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=235 and rubli=0 ";


s2_3_6_rub = "/* Formatted on 17.04.2012 13:34:07 (QP5 v5.115.810.9015) disa */ " + 
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  236, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "  FROM   dacctrn_dbt prov                                                 "+
      " WHERE   (SUBSTR (PROV.T_ACCOUNT_PAYER, 1, 5) IN ('47426', '70606')       "+
      "          OR SUBSTR (PROV.T_ACCOUNT_PAYER, 1, 3) IN ('603'))              "+
      "         AND SUBSTR (PROV.T_ACCOUNT_PAYER, 6, 3) = '810'                  "+
      "         AND SUBSTR (PROV.T_ACCOUNT_RECEIVER, 6, 3) = '810'               "+
      "         AND t_chapter = 1                                                "+
      "         AND PROV.T_SHIFR_OPER = '17'                                     "+
      // EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
      "         and prov.t_state = 1 "+
      "         AND t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') "+ 
      "         AND TO_DATE('"+enddate+"', 'dd.mm.yyyy')                         ";
/*      "         FROM  usr_251_c4eta c4_payer, darhdoc_dbt prov, usr_251_c4eta c4_receiver " +
      "  WHERE  c4_payer.stroka = 231 " +
      "           AND c4_payer.rubli = 1 " +
      "           AND c4_payer.c4et = prov.t_account_payer " +
      "           AND (c4_receiver.stroka = 211 OR c4_receiver.stroka = 221 OR c4_receiver.stroka = 41) " +
      "           AND c4_receiver.rubli = 1 " +
      "           AND c4_receiver.c4et = prov.t_account_receiver " +
      "           AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " +
      "           AND (TRIM (prov.t_shifr_oper) = '17' AND (TRIM (t_kind_oper) = '1' OR TRIM (t_kind_oper) = '6')) " +
      "           AND prov.t_chapter = 1 " ;*/
message("Вставить счета s2_3_6_rub ");
vstavit_c4eta(s2_3_6_rub);
s2_3_6_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=236 and rubli=1 ";

s2_3_6_val = "/* Formatted on 17.04.2012 13:34:07 (QP5 v5.115.810.9015) disa */ " + 
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  236, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
/*------------------------------- новое условие в ТЗ ----------------------------------------GSP*/
      "  FROM   dacctrn_dbt prov                                                     "+
      " WHERE   (SUBSTR (PROV.T_ACCOUNT_PAYER, 6, 3) <> '810'                        "+
      "             or SUBSTR (PROV.T_ACCOUNT_RECEIVER, 6, 3) <> '810')              "+
      "         AND t_chapter = 1                                                    "+
      // EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
      "         and prov.t_state = 1 "+
      "         AND prov.t_date_carry BETWEEN TO_DATE('"+begindate+"', 'dd.mm.yyyy') "+
      "         AND TO_DATE('"+enddate+"', 'dd.mm.yyyy')                             ";
    if(fgBank.is_VUZ)
      s2_3_6_val = s2_3_6_val +
      "         AND (SUBSTR (PROV.T_ACCOUNT_PAYER, 1, 5) IN ('47426', '70606')       "+
      "          OR SUBSTR (PROV.T_ACCOUNT_PAYER, 1, 3) IN ('603'))                  "+
      "         AND PROV.T_SHIFR_OPER in ('09','17')                                 ";
    else
      s2_3_6_val = s2_3_6_val +
      "         AND SUBSTR (PROV.T_ACCOUNT_PAYER, 1, 5) IN ('47426', '70606')        "+
      "         AND PROV.T_SHIFR_OPER = '09'                                         ";
    end;
/*----------------------------------------------------------------------------------------------*/
/*      "         FROM  usr_251_c4eta c4_payer, darhdoc_dbt prov, usr_251_c4eta c4_receiver " +
      "  WHERE  c4_payer.stroka = 231 " +
      "           AND c4_payer.rubli = 0 " +
      "           AND c4_payer.c4et = prov.t_account_payer " +
      "           AND (c4_receiver.stroka = 211 OR c4_receiver.stroka = 221 OR c4_receiver.stroka = 41) " +
      "           AND c4_receiver.rubli = 0 " +
      "           AND c4_receiver.c4et = prov.t_account_receiver " +
      "           AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " +
      "           AND (TRIM (prov.t_shifr_oper) = '17' AND (TRIM (t_kind_oper) = '1' OR TRIM (t_kind_oper) = '6')) " +
      "           AND prov.t_chapter = 1 " ;*/
vstavit_c4eta(s2_3_6_val);
s2_3_6_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=236 and rubli=0 ";

/*------------------------------- 2926-У begin ----------------------------------GSP*/
/*------------------- реализация строк 2.3.6.1, 2.3.6.2, 2.3.6.2.1 --------------------------*/
s2_3_6_1_rub = "/* Formatted on 17.04.2012 13:34:07 (QP5 v5.115.810.9015) disa */ " + 
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  2361, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "   FROM  usr_251_c4eta c4_payer, dacctrn_dbt prov, usr_251_c4eta c4_receiver, dpmpaym_dbt paym, dpmdocs_dbt docs " +
      "  WHERE  c4_payer.stroka = 231 " +
      "    and prov.t_acctrnid = docs.t_acctrnid "+
      "    and docs.t_paymentid = paym.t_paymentid "+
      "    and paym.t_origin in (2,3200,3300) "+
      "    AND c4_payer.rubli = 1 " +
      "    AND c4_payer.c4et = prov.t_account_payer " +
      "    AND (c4_receiver.stroka = 211 OR c4_receiver.stroka = 221 OR c4_receiver.stroka = 41) " +
      "    AND c4_receiver.rubli = 1 " +
      "    AND c4_receiver.c4et = prov.t_account_receiver " +
      "    AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " +
      // EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
      "    and prov.t_state = 1 "+
      "    AND (TRIM (prov.t_shifr_oper) = '17' AND (TRIM (t_kind_oper) = '1' OR TRIM (t_kind_oper) = '6')) " +
      "    AND prov.t_chapter = 1 " ;
//vstavit_c4eta(s2_3_6_1_rub);
s2_3_6_1_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2361 and rubli=1 ";

s2_3_6_1_val = "/* Formatted on 17.04.2012 13:34:07 (QP5 v5.115.810.9015) disa */ " + 
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  2361, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "   FROM  usr_251_c4eta c4_payer, dacctrn_dbt prov, usr_251_c4eta c4_receiver, dpmpaym_dbt paym, dpmdocs_dbt docs " +
      "  WHERE  c4_payer.stroka = 231 " +
      "    and prov.t_acctrnid = docs.t_acctrnid "+
      "    and docs.t_paymentid = paym.t_paymentid "+
      "    and paym.t_origin in (2,3200) "+
      "    AND c4_payer.rubli = 0 " +
      "    AND c4_payer.c4et = prov.t_account_payer " +
      "    AND (c4_receiver.stroka = 211 OR c4_receiver.stroka = 221 OR c4_receiver.stroka = 41) " +
      "    AND c4_receiver.rubli = 0 " +
      "    AND c4_receiver.c4et = prov.t_account_receiver " +
      "    AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " +
      // EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
      "    and prov.t_state = 1 "+
      "    AND (TRIM (prov.t_shifr_oper) = '17' AND (TRIM (t_kind_oper) = '1' OR TRIM (t_kind_oper) = '6')) " +
      "    AND prov.t_chapter = 1 " ;
//vstavit_c4eta(s2_3_6_1_val);
s2_3_6_1_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2361 and rubli=0 ";


s2_3_6_2_rub = "/* Formatted on 17.04.2012 13:34:07 (QP5 v5.115.810.9015) disa */ " + 
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  2362, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "  FROM   dacctrn_dbt prov                                                 "+
      " WHERE   SUBSTR (PROV.T_ACCOUNT_PAYER, 1, 5) IN ('70606')                 "+
      "         AND SUBSTR (PROV.T_ACCOUNT_PAYER, 6, 3) = '810'                  "+
      "         AND SUBSTR (PROV.T_ACCOUNT_RECEIVER, 6, 3) = '810'               "+
      "         AND t_chapter = 1                                                "+
      "         AND PROV.T_SHIFR_OPER = '17'                                     "+
      // EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
      "         and prov.t_state = 1 "+
      "         AND t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') "+ 
      "         AND TO_DATE('"+enddate+"', 'dd.mm.yyyy')                         ";
/*      "         FROM  usr_251_c4eta c4_payer, darhdoc_dbt prov, usr_251_c4eta c4_receiver " +
      "  WHERE  c4_payer.stroka = 231 " +
      "    AND c4_payer.rubli = 1 " +
      "    AND c4_payer.c4et = prov.t_account_payer " +
      "    AND c4_receiver.stroka = 41 " +
      "    AND c4_receiver.rubli = 1 " +
      "    AND c4_receiver.c4et = prov.t_account_receiver " +
      "    AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " +
      "    AND TRIM (prov.t_shifr_oper) = '17' " +
      "    AND prov.t_chapter = 1 " ;*/
vstavit_c4eta(s2_3_6_2_rub);
s2_3_6_2_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2362 and rubli=1 ";

s2_3_6_2_val = "/* Formatted on 17.04.2012 13:34:07 (QP5 v5.115.810.9015) disa */ " + 
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  2362, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "  FROM   dacctrn_dbt prov                                                     "+
      " WHERE   SUBSTR (PROV.T_ACCOUNT_PAYER, 1, 5) IN ('70606')                     "+
      "         AND (SUBSTR (PROV.T_ACCOUNT_PAYER, 6, 3) <> '810'                    "+
      "             or SUBSTR (PROV.T_ACCOUNT_RECEIVER, 6, 3) <> '810')              "+
      "         AND t_chapter = 1                                                    "+
      // EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
      "         and prov.t_state = 1 "+
      "         AND prov.t_date_carry BETWEEN TO_DATE('"+begindate+"', 'dd.mm.yyyy') "+
      "         AND TO_DATE('"+enddate+"', 'dd.mm.yyyy')                             ";
    if(fgBank.is_VUZ)
      s2_3_6_2_val = s2_3_6_2_val +
      "         AND PROV.T_SHIFR_OPER in ('17')                                      ";
    else
      s2_3_6_2_val = s2_3_6_2_val +
      "         AND PROV.T_SHIFR_OPER in ('09','17')                                 ";
    end;
/*    "   FROM  usr_251_c4eta c4_payer, darhdoc_dbt prov, usr_251_c4eta c4_receiver " +
      "  WHERE  c4_payer.stroka = 231 " +
      "    AND c4_payer.rubli = 0 " +
      "    AND c4_payer.c4et = prov.t_account_payer " +
      "    AND c4_receiver.stroka = 41 " +
      "    AND c4_receiver.rubli = 0 " +
      "    AND c4_receiver.c4et = prov.t_account_receiver " +
      "    AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " +
      "    AND TRIM (prov.t_shifr_oper) = '17' " +
      "    AND prov.t_chapter = 1 " ;*/
vstavit_c4eta(s2_3_6_2_val);
s2_3_6_2_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2362 and rubli=0 ";


s2_3_6_2_1_rub = "/* Formatted on 17.04.2012 13:34:07 (QP5 v5.115.810.9015) disa */ " + 
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  23621, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "   FROM  usr_251_c4eta c4_payer, dacctrn_dbt prov, usr_251_c4eta c4_receiver, dpmpaym_dbt paym, dpmdocs_dbt docs " +
      "  WHERE  c4_payer.stroka = 231 " +
      "    and prov.t_acctrnid = docs.t_acctrnid "+
      "    and docs.t_paymentid = paym.t_paymentid "+
      "    and paym.t_origin in (2,3200,3300) "+
      "    AND c4_payer.rubli = 1 " +
      "    AND c4_payer.c4et = prov.t_account_payer " +
      "    AND c4_receiver.stroka = 41 " +
      "    AND c4_receiver.rubli = 1 " +
      "    AND c4_receiver.c4et = prov.t_account_receiver " +
      "    AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " +
      // EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
      "    and prov.t_state = 1 "+
      "    AND TRIM (prov.t_shifr_oper) = '17' " +
      "    AND prov.t_chapter = 1 " ;
//vstavit_c4eta(s2_3_6_2_1_rub);
s2_3_6_2_1_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=23621 and rubli=1 ";

s2_3_6_2_1_val = "/* Formatted on 17.04.2012 13:34:07 (QP5 v5.115.810.9015) disa */ " + 
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  23621, prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "   FROM  usr_251_c4eta c4_payer, dacctrn_dbt prov, usr_251_c4eta c4_receiver, dpmpaym_dbt paym, dpmdocs_dbt docs " +
      "  WHERE  c4_payer.stroka = 231 " +
      "    and prov.t_acctrnid = docs.t_acctrnid "+
      "    and docs.t_paymentid = paym.t_paymentid "+
      "    and paym.t_origin in (2,3200) "+
      "    AND c4_payer.rubli = 0 " +
      "    AND c4_payer.c4et = prov.t_account_payer " +
      "    AND c4_receiver.stroka = 41 " +
      "    AND c4_receiver.rubli = 0 " +
      "    AND c4_receiver.c4et = prov.t_account_receiver " +
      "    AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " +
      // EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
      "    and prov.t_state = 1 "+
      "    AND TRIM (prov.t_shifr_oper) = '17' " +
      "    AND prov.t_chapter = 1 " ;
//vstavit_c4eta(s2_3_6_2_1_val);
s2_3_6_2_1_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=23621 and rubli=0 ";

/*------------------------------- 2926-У end ------------------------------------*/

/*
s2_4_1_m_rub=" "+
"       /* Formatted on 23.01.2011 19:28:38 (QP5 v5.115.810.9015) disa */       "+
"       SELECT   COUNT (1), NVL (ROUND (SUM (t_sum) / 1000), 0) "+
"         FROM   darhdoc_dbt prov, daccount_dbt acc1, daccount_dbt acc2, dobjcode_dbt do1 "+
"        WHERE   prov.t_chapter = 1     "+
"            AND t_account_payer = acc1.t_account       "+
"            AND t_account_receiver = acc2.t_account    "+
"            AND t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.rrrr') AND TO_DATE ('"+enddate+"', 'dd.mm.rrrr') "+
"            AND (acc1.t_type_account NOT LIKE '%П%' AND acc1.t_type_account NOT LIKE '%U%' AND acc1.t_type_account NOT LIKE '%Н%')     "+
"            AND acc1.t_chapter = acc2.t_chapter        "+
"            AND prov.t_chapter = acc1.t_chapter        "+
"            AND do1.t_objecttype = 3   "+
"            AND do1.t_codekind = 1     "+
"            AND acc1.t_client = do1.t_objectid "+
"            AND (substr( prov.t_account_payer, 1, 5 ) = '40911' OR substr( prov.t_account_payer, 1, 5 ) = '40912' OR substr( prov.t_account_payer, 1, 5 ) = '40913')  "+
"            AND (do1.t_code = '010000060231' OR do1.t_code = '010000060430' OR do1.t_code = '010000060431')    "+
"            AND substr( prov.t_account_receiver, 1, 5 ) <> '20202'     "+
"            AND substr( prov.t_account_receiver, 1, 5 ) <> '40817'     "+
"            AND substr( prov.t_account_receiver, 1, 5 ) <> '42301'     "+
"            AND substr( prov.t_account_receiver, 1, 5 ) <> '70601'     ";

s2_4_1_1_rub=s2_4_1_m_rub+" and substr( prov.t_account_payer, 1, 5 )='40911' ";
 */

/*------------------------------- 2926-У begin ----------------------------------GSP*/
/*------------------- реализация строк 2.4.1 полная смена алгоритма отбора -------------------------*/
/*----------- выделил общую часть для пунктов 2.4.* в отдельную переменную -----------*/
s2_4_all_rub = " prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
      "   FROM  dacctrn_dbt prov, dsymbcash_dbt symb                                                                                                  "+
      "  WHERE prov.t_acctrnid = symb.t_acctrnid                                                                                                      "+
      "    AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy')                            "+
      // EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
      "    and prov.t_state = 1 "+
      "    AND prov.t_chapter = 1                                                                                                                     "+ 
      "    and substr(prov.t_account_payer,6,3) in ('810')                                                                                            "+
      "    and substr(prov.t_account_receiver,6,3) in ('810')                                                                                         ";

s2_4_all_val = " prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
      "   FROM   dacctrn_dbt prov                                                                                                                     "+
      "  WHERE   prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy')                          "+
      // EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
      "    and prov.t_state = 1 "+
      "    AND   prov.t_chapter = 1                                                                                                                   "+
      "    and (substr(prov.t_account_payer,6,3) not in ('810')                                                                                       "+
      "         or substr(prov.t_account_receiver,6,3) not in ('810'))                                                                                ";

s2_4_1_rub =  
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT 241,t_account_payer, t_account_receiver, t_date_carry, t_sum_natcur, 1, t_ground, t_shifr_oper, t_kind_oper from("+
      " SELECT distinct prov.t_acctrnid,"+ s2_4_all_rub +
      "    AND substr(prov.t_account_payer,1,5) in ('20202') "+
      "    AND substr(prov.t_account_receiver,1,5) in ('40911','40912','40913') "+
      "    AND TRIM (symb.t_symbol) <> '32' )";
vstavit_c4eta(s2_4_1_rub);
s2_4_1_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=241 and rubli=1 ";

s2_4_1_rub_otr =  
      " select round(nvl(sum ( t_sum_natcur ),0)/1000) from ("+
      " SELECT 241,"+ s2_4_all_rub +
      "    AND substr(prov.t_account_payer,1,5) in ('20202') "+
      "    AND substr(prov.t_account_receiver,1,5) in ('40911','40912','40913') "+
      "    AND TRIM (symb.t_symbol) = '32' )";
//vstavit_c4eta(s2_4_1_rub);
//s2_4_1_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=241 and rubli=1 ";


s2_4_1_val = 
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT 241,t_account_payer, t_account_receiver, t_date_carry, t_sum_natcur, 0, t_ground, t_shifr_oper, t_kind_oper from("+
      " SELECT distinct prov.t_acctrnid,"+ s2_4_all_val +
      "    AND substr(prov.t_account_payer,1,5) in ('20202') "+
      "    AND substr(prov.t_account_receiver,1,5) in ('40911','40912','40913')) ";
/*      "    AND TRIM (symb.t_symbol) <> '32' ";*/
vstavit_c4eta(s2_4_1_val);
s2_4_1_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=241 and rubli=0 ";

/*s2_4_1_val_otr =  
      " select round(nvl(sum ( t_sum ),0)/1000) from ("+
      " SELECT 241,"+ s2_4_all_val +
      "    AND substr(prov.t_account_payer,1,5) in ('20202') "+
      "    AND substr(prov.t_account_receiver,1,5) in ('40911','40912','40913') "+
      "    AND TRIM (symb.t_symbol) = '32' )";*/



vstavit_c4eta("insert /*+ APPEND*/ into usr_251_c4eta select 2411, acc.t_account,1,acc.t_code_currency "+ day_c4eta241(true) + " and substr( acc.t_account, 1, 5 ) = '40911' " );
vstavit_c4eta("insert /*+ APPEND*/ into usr_251_c4eta select 2411, acc.t_account,0,acc.t_code_currency "+ day_c4eta241(false)+ " and substr( acc.t_account, 1, 5 ) = '40911' " );

s2_4_1_1_rub = 
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT 2411,t_account_payer, t_account_receiver, t_date_carry, t_sum_natcur, 1, t_ground, t_shifr_oper, t_kind_oper from("+
      " SELECT distinct prov.t_acctrnid,"+ s2_4_all_rub + 
      "    AND substr(prov.t_account_payer,1,5) in ('20202') "+
      "    AND substr(prov.t_account_receiver,1,5) in ('40911') "+
      "    AND TRIM (symb.t_symbol) <> '32') ";
vstavit_c4eta(s2_4_1_1_rub);
s2_4_1_1_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2411 and rubli=1 ";

s2_4_1_1_val =
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " select 2411,t_account_payer, t_account_receiver, t_date_carry, t_sum_natcur, 0, t_ground, t_shifr_oper, t_kind_oper from("+
      " SELECT distinct prov.t_acctrnid,"+ s2_4_all_val + 
      "    AND substr(prov.t_account_payer,1,5) in ('20202') "+
      "    AND substr(prov.t_account_receiver,1,5) in ('40911')) ";
/*      "    AND TRIM (symb.t_symbol) <> '32' ";*/
vstavit_c4eta(s2_4_1_1_val);
s2_4_1_1_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2411 and rubli=0 ";


s2_4_1_1_1_rub =
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " select 24111,t_account_payer, t_account_receiver, t_date_carry, t_sum_natcur, 1, t_ground, t_shifr_oper, t_kind_oper from("+
      " SELECT distinct prov.t_acctrnid,"+ s2_4_all_rub + 
      "    AND substr(prov.t_account_payer,1,5) in ('20202') "+
      "    AND substr(prov.t_account_receiver,1,5) in ('40911') "+
      "    AND TRIM (symb.t_symbol) in ('13','16','23','31')) ";
vstavit_c4eta(s2_4_1_1_1_rub);
s2_4_1_1_1_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=24111 and rubli=1 ";

s2_4_1_1_1_val =
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " select 2411,t_account_payer, t_account_receiver, t_date_carry, t_sum_natcur, 0, t_ground, t_shifr_oper, t_kind_oper from("+
      " SELECT distinct prov.t_acctrnid,"+ s2_4_all_val + 
      "    AND substr(prov.t_account_payer,1,5) in ('20202') "+
      "    AND substr(prov.t_account_receiver,1,5) in ('40911')) ";
/*      "    AND TRIM (symb.t_symbol) in ('13','16','23','31') ";*/
vstavit_c4eta(s2_4_1_1_1_val);
s2_4_1_1_1_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=24111 and rubli=0 ";


s2_4_1_1_2_1_rub =
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  241121,"+ s2_4_all_rub + 
      "    AND substr(prov.t_account_payer,1,5) in ('20202') "+
      "    AND substr(prov.t_account_receiver,1,5) in ('40911') "+
      "    AND TRIM (symb.t_symbol) in ('14') ";
vstavit_c4eta(s2_4_1_1_2_1_rub);
s2_4_1_1_2_1_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=241121 and rubli=1 ";

s2_4_1_1_2_1_val =
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  241121,"+ s2_4_all_val + 
      "    AND substr(prov.t_account_payer,1,5) in ('20202') "+
      "    AND substr(prov.t_account_receiver,1,5) in ('40911') ";
/*      "    AND TRIM (symb.t_symbol) in ('14') ";*/
vstavit_c4eta(s2_4_1_1_2_1_val);
s2_4_1_1_2_1_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=241121 and rubli=0 ";


s2_4_1_2_rub =
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " select 2412,t_account_payer, t_account_receiver, t_date_carry, t_sum_natcur, 1, t_ground, t_shifr_oper, t_kind_oper from("+
      " SELECT distinct prov.t_acctrnid,"+ s2_4_all_rub +
      "    AND substr(prov.t_account_payer,1,5) in ('20202') "+
      "    AND substr(prov.t_account_receiver,1,5) in ('40912','40913') "+
      "    AND TRIM (symb.t_symbol) not in ('32')) ";
vstavit_c4eta(s2_4_1_2_rub);
s2_4_1_2_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2412 and rubli=1 ";

s2_4_1_2_val =
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  2412,"+ s2_4_all_val + 
      "    AND substr(prov.t_account_payer,1,5) in ('20202') "+
      "    AND substr(prov.t_account_receiver,1,5) in ('40912','40913') ";
/*      "    AND TRIM (symb.t_symbol) not in ('32') ";*/
vstavit_c4eta(s2_4_1_2_val);
s2_4_1_2_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2412 and rubli=0 ";


s2_4_1_2_1_rub =
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  24121,"+ s2_4_all_rub + 
      "    AND substr(prov.t_account_payer,1,5) in ('20202') "+
      "    AND substr(prov.t_account_receiver,1,5) in ('40912','40913') "+
      "    AND TRIM (symb.t_symbol) in ('13','16','23','31') ";
vstavit_c4eta(s2_4_1_2_1_rub);
s2_4_1_2_1_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=24121 and rubli=1 ";

s2_4_1_2_1_val =
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  24121,"+ s2_4_all_val + 
      "    AND substr(prov.t_account_payer,1,5) in ('20202') "+
      "    AND substr(prov.t_account_receiver,1,5) in ('40912','40913') ";
/*      "    AND TRIM (symb.t_symbol) in ('13','16','23','31') ";*/
vstavit_c4eta(s2_4_1_2_1_val);
s2_4_1_2_1_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=24121 and rubli=0 ";

/*------------------------------- 2926-У end ------------------------------------*/
                                                                                                                     
/*
var s2_4_1_2_pref = "insert /*+ APPEND*/ INTO usr_251_prov SELECT ";
s2_4_1_2_rub_z=" "+
            " prov.t_account_payer, prov.t_account_receiver, prov.t_date_carry, prov.t_sum_payer, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
                " from usr_251_c4eta, dacctrn_dbt prov, dsymbcash_dbt symb   "+
                " where stroka=241 and rubli=1 and t_account_receiver=c4et   "+
                " AND symb.t_applicationkey = TO_CHAR (prov.t_iapplicationkind, 'fm09999') || prov.t_applicationkey     "+
                " and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
                "  and prov.t_chapter=1 "+
                " AND substr( prov.t_account_payer, 1, 5 ) = '20202' ";

s2_4_1_2_val_z=" "+
                " prov.t_account_payer, prov.t_account_receiver, prov.t_date_carry, prov.t_sum, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
                " from usr_251_c4eta, darhdoc_dbt prov, dsymbcash_dbt symb   "+
                " where stroka=241 and rubli=0 and t_account_receiver=c4et   "+
                " AND symb.t_applicationkey = TO_CHAR (prov.t_iapplicationkind, 'fm09999') || prov.t_applicationkey     "+
                " and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
                "  and prov.t_chapter=1 "+
                " AND substr( prov.t_account_payer, 1, 5 ) = '20202' ";

s2_4_1_2_rub_ = s2_4_1_2_pref + "2412," + s2_4_1_2_rub_z+
                " AND (TRIM (symb.t_symbol) = '13' OR TRIM (symb.t_symbol) = '16' OR TRIM (symb.t_symbol) = '23' OR TRIM (symb.t_symbol) = '31') ";
vstavit_c4eta(s2_4_1_2_rub_);
s2_4_1_2_rub_ = "select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2412 and rubli=1 ";

//getstring(s2_4_1_2_rub_);
s2_4_1_2_val_ = s2_4_1_2_pref + "2412," + s2_4_1_2_val_z+
                " AND (TRIM (symb.t_symbol) = '13' OR TRIM (symb.t_symbol) = '16' OR TRIM (symb.t_symbol) = '23' OR TRIM (symb.t_symbol) = '31') ";
vstavit_c4eta(s2_4_1_2_val_);
s2_4_1_2_val_ = "select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2412 and rubli=0 ";

// qqqqqqqqq
s2_4_1_2_1_rub = s2_4_1_2_pref + " 24121, " + s2_4_1_2_rub_z + "  AND TRIM (symb.t_symbol) = '14'  ";
vstavit_c4eta(s2_4_1_2_1_rub);
s2_4_1_2_1_rub = "select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=24121 and rubli=1 ";

s2_4_1_2_1_val = s2_4_1_2_pref + " 24121, " + s2_4_1_2_val_z + "  AND TRIM (symb.t_symbol) = '14'  ";
vstavit_c4eta(s2_4_1_2_1_val);
s2_4_1_2_1_val = "select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=24121 and rubli=1 ";
*/
/*
s2_4_1_2_m_rub="        /* Formatted on 23.01.2011 21:17:19 (QP5 v5.115.810.9015) disa */       "+
"       SELECT   COUNT (1), NVL (ROUND (SUM (prov.t_sum) / 1000), 0)    "+
"         FROM   darhdoc_dbt prov, daccount_dbt acc1, daccount_dbt acc2, dobjcode_dbt do2, dsymbcash_dbt symb     "+
"        WHERE   prov.t_chapter = 1     "+
"            AND t_account_payer = acc1.t_account       "+
"            AND t_account_receiver = acc2.t_account    "+
"            AND t_date_carry BETWEEN TO_DATE ('01.12.2010', 'dd.mm.rrrr') AND TO_DATE ('01.01.2011', 'dd.mm.rrrr')     "+
"            AND (acc1.t_type_account NOT LIKE '%П%' AND acc1.t_type_account NOT LIKE '%U%' AND acc1.t_type_account NOT LIKE '%Н%')     "+
"            AND acc1.t_chapter = acc2.t_chapter        "+
"            AND prov.t_chapter = acc1.t_chapter        "+
"            AND do2.t_objecttype = 3   "+
"            AND do2.t_codekind = 1     "+
"            AND acc2.t_client = do2.t_objectid "+
"            AND symb.t_applicationkey = TO_CHAR (prov.t_iapplicationkind, 'fm09999') || prov.t_applicationkey  "+
"            AND substr( prov.t_account_payer, 1, 5 ) = '20202'      "+
"            AND (do2.t_code = '010000060231' OR do2.t_code = '010000060430' OR do2.t_code = '010000060431')    "+
"            AND (substr( prov.t_account_receiver, 1, 5 ) = '40911' OR substr( prov.t_account_receiver, 1, 5 ) = '40912' OR substr( prov.t_account_receiver, 1, 5 ) = '40913')  ";

s2_4_1_2_rub=s2_4_1_2_m_rub+"  AND TRIM (symb.t_symbol) = '14'  ";

" AND (TRIM (symb.t_symbol) = '13' OR TRIM (symb.t_symbol) = '16' OR TRIM (symb.t_symbol) = '23' OR TRIM (symb.t_symbol) = '31') ";



s2_4_1_2_m_val="        /* Formatted on 23.01.2011 21:17:19 (QP5 v5.115.810.9015) disa */       "+
"       SELECT   COUNT (1), NVL (ROUND (SUM (prov.t_sum) / 1000), 0)    "+
"         FROM   darhdoc_dbt prov, daccount_dbt acc1, daccount_dbt acc2, dobjcode_dbt do2, dsymbcash_dbt symb     "+
"        WHERE   prov.t_chapter = 1     "+
"            AND t_account_payer = acc1.t_account       "+
"            AND t_account_receiver = acc2.t_account    "+
"            AND t_date_carry BETWEEN TO_DATE ('01.12.2010', 'dd.mm.rrrr') AND TO_DATE ('01.01.2011', 'dd.mm.rrrr')     "+
"            AND (acc1.t_type_account LIKE '%П%' or acc1.t_type_account  LIKE '%U%' or acc1.t_type_account  LIKE '%Н%') "+
"            AND acc1.t_chapter = acc2.t_chapter        "+
"            AND prov.t_chapter = acc1.t_chapter        "+
"            AND do2.t_objecttype = 3   "+
"            AND do2.t_codekind = 1     "+
"            AND acc2.t_client = do2.t_objectid "+
"            AND symb.t_applicationkey = TO_CHAR (prov.t_iapplicationkind, 'fm09999') || prov.t_applicationkey  "+
"            AND substr( prov.t_account_payer, 1, 5 ) = '20202'      "+
"            AND (do2.t_code = '010000060231' OR do2.t_code = '010000060430' OR do2.t_code = '010000060431')    "+
"            AND (substr( prov.t_account_receiver, 1, 5 ) = '40911' OR substr( prov.t_account_receiver, 1, 5 ) = '40912' OR substr( prov.t_account_receiver, 1, 5 ) = '40913')  ";

s2_4_1_2_val=s2_4_1_2_m_val+" "+
" AND (TRIM (symb.t_symbol) = '13' OR TRIM (symb.t_symbol) = '16' OR TRIM (symb.t_symbol) = '23' OR TRIM (symb.t_symbol) = '31') ";

s2_4_1_2_1_rub=s2_4_1_2_m_rub+"  AND TRIM (symb.t_symbol) = '14'  ";
s2_4_1_2_1_val=s2_4_1_2_m_val+"  AND TRIM (symb.t_symbol) = '14'  ";
*/

/*-------------------------------------------------------------------------------------------------------------------------------------------*/
/*vstavit_c4eta("insert /*+ APPEND*/ into usr_251_c4eta select 242, acc.t_account,1 "+ day_c4eta242(true));
vstavit_c4eta("insert /*+ APPEND*/ into usr_251_c4eta select 242, acc.t_account,0 "+ day_c4eta242(false));*/
s2_4_2_rub =
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  242,"+ 
      " prov.t_account_payer, nvl(prov.t_account_receiver, chr(1)) t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
      "   FROM  dacctrn_dbt prov, daccount_dbt acc1, daccount_dbt acc2/*, dsymbcash_dbt symb*/                                                            "+
      "  WHERE  acc1.t_account = prov.t_account_payer and acc2.t_account = prov.t_account_receiver                                                    "+
/*      "    AND LPAD (prov.t_iapplicationkind, 5, '0') || prov.t_applicationkey = symb.t_applicationkey                                                "+*/
      "    AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy')                            "+
      // EVG 20/1/2014 Добавлено, чтобы исп-л DACCTRN_DBT_IDX1
      "    and prov.t_state = 1 "+
      "    AND prov.t_chapter = 1 and acc1.t_chapter = 1 and acc2.t_chapter = 1                                                                       "+ 
      "    and acc1.t_code_currency = 0                     "+
      "    and acc2.t_code_currency = 0                     "+
      "    AND substr(prov.t_account_payer,1,5) in ('20208') "+
      "    AND substr(prov.t_account_receiver,1,5) in ('40911','40912','40913') ";
/*      "    AND TRIM (symb.t_symbol) not in ('32') ";*/
message("Вставить счета s2_4_2_rub ");
vstavit_c4eta(s2_4_2_rub);
s2_4_2_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=242 and rubli=1 ";

s2_4_2_val =
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  242,"+ s2_4_all_val + 
      "    AND substr(prov.t_account_payer,1,5) in ('20208') "+
      "    AND substr(prov.t_account_receiver,1,5) in ('40911','40912','40913') ";
/*      "    AND TRIM (symb.t_symbol) not in ('32') ";*/
vstavit_c4eta(s2_4_2_val);
s2_4_2_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=242 and rubli=0 ";

/*vstavit_c4eta("insert /*+ APPEND*/ into usr_251_c4eta select 2421, acc.t_account,1 "+ day_c4eta242(true) + " and substr( prov.t_account_payer, 1, 5 ) = '40911' " );
//vstavit_c4eta("insert /*+ APPEND*/ into usr_251_c4eta select 2421, acc.t_account,0 "+ day_c4eta242(false)+ " and substr( prov.t_account_payer, 1, 5 ) = '40911' " );
*/

s2_4_2_1_rub =
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  2421,"+ s2_4_all_rub + 
      "    AND substr(prov.t_account_payer,1,5) in ('20208') "+
      "    AND substr(prov.t_account_receiver,1,5) in ('40911') "+
      "    AND TRIM (symb.t_symbol) not in ('32') ";
vstavit_c4eta(s2_4_2_1_rub);
s2_4_2_1_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2421 and rubli=1 ";

s2_4_2_1_val =
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  2421,"+ s2_4_all_val + 
      "    AND substr(prov.t_account_payer,1,5) in ('20208') "+
      "    AND substr(prov.t_account_receiver,1,5) in ('40911') ";
/*      "    AND TRIM (symb.t_symbol) not in ('32') ";*/
vstavit_c4eta(s2_4_2_1_val);
s2_4_2_1_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2421 and rubli=0 ";


s2_4_2_1_1_rub =
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  24211,"+ s2_4_all_rub + 
      "    AND substr(prov.t_account_payer,1,5) in ('20208') "+
      "    AND substr(prov.t_account_receiver,1,5) in ('40911') "+
      "    AND TRIM (symb.t_symbol) in ('13','16','23','31') ";
vstavit_c4eta(s2_4_2_1_1_rub);
s2_4_2_1_1_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=24211 and rubli=1 ";

s2_4_2_1_1_val =
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  24211,"+ s2_4_all_val + 
      "    AND substr(prov.t_account_payer,1,5) in ('20208') "+
      "    AND substr(prov.t_account_receiver,1,5) in ('40911') ";
/*      "    AND TRIM (symb.t_symbol) in ('13','16','23','31') "; */
vstavit_c4eta(s2_4_2_1_1_val);
s2_4_2_1_1_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=24211 and rubli=0 ";


s2_4_2_1_2_1_rub =
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  242121,"+ s2_4_all_rub + 
      "    AND substr(prov.t_account_payer,1,5) in ('20208') "+
      "    AND substr(prov.t_account_receiver,1,5) in ('40911') "+
      "    AND TRIM (symb.t_symbol) in ('14') ";
vstavit_c4eta(s2_4_2_1_2_1_rub);
s2_4_2_1_2_1_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=242121 and rubli=1 ";

s2_4_2_1_2_1_val =
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  242121,"+ s2_4_all_val + 
      "    AND substr(prov.t_account_payer,1,5) in ('20208') "+
      "    AND substr(prov.t_account_receiver,1,5) in ('40911') ";
/*      "    AND TRIM (symb.t_symbol) in ('14') ";*/
vstavit_c4eta(s2_4_2_1_2_1_val);
s2_4_2_1_2_1_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=242121 and rubli=0 ";


s2_4_2_2_rub =
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  2422,"+ s2_4_all_rub + 
      "    AND substr(prov.t_account_payer,1,5) in ('20208') "+
      "    AND substr(prov.t_account_receiver,1,5) in ('40912','40913') "+
      "    AND TRIM (symb.t_symbol) not in ('32') ";
vstavit_c4eta(s2_4_2_2_rub);
s2_4_2_2_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2422 and rubli=1 ";

s2_4_2_2_val =
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  2422,"+ s2_4_all_val + 
      "    AND substr(prov.t_account_payer,1,5) in ('20208') "+
      "    AND substr(prov.t_account_receiver,1,5) in ('40912','40913') ";
/*      "    AND TRIM (symb.t_symbol) not in ('32') ";*/
vstavit_c4eta(s2_4_2_2_val);
s2_4_2_2_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2422 and rubli=0 ";


s2_4_2_2_1_rub =
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  24221,"+ s2_4_all_rub + 
      "    AND substr(prov.t_account_payer,1,5) in ('20208') "+
      "    AND substr(prov.t_account_receiver,1,5) in ('40912','40913') "+
      "    AND TRIM (symb.t_symbol) in ('13','16','23','31') ";
vstavit_c4eta(s2_4_2_2_1_rub);
s2_4_2_2_1_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=24221 and rubli=1 ";

s2_4_2_2_1_val =
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  24221,"+ s2_4_all_val + 
      "    AND substr(prov.t_account_payer,1,5) in ('20208') "+
      "    AND substr(prov.t_account_receiver,1,5) in ('40912','40913') ";
/*      "    AND TRIM (symb.t_symbol) in ('13','16','23','31') ";*/
vstavit_c4eta(s2_4_2_2_1_val);
s2_4_2_2_1_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=24221 and rubli=0 ";


/*---------------------------------------------------------------------------------------------------------------------------------------------------------*/
/*var s2_4_2_2_pref = "insert /*+ APPEND*/ INTO usr_251_prov SELECT ";
s2_4_2_2_rub_z=" "+
            " prov.t_account_payer, prov.t_account_receiver, prov.t_date_carry, prov.t_sum, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
                " from usr_251_c4eta, darhdoc_dbt prov, dsymbcash_dbt symb   "+
                " where stroka=242 and rubli=1 and t_account_receiver=c4et   "+
                " AND symb.t_applicationkey = TO_CHAR (prov.t_iapplicationkind, 'fm09999') || prov.t_applicationkey     "+
                " and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
                "  and prov.t_chapter=1 "+
                " AND substr( prov.t_account_payer, 1, 5 ) = '20202' ";

s2_4_2_2_val_z=" "+
            " prov.t_account_payer, prov.t_account_receiver, prov.t_date_carry, prov.t_sum, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
                " from usr_251_c4eta, darhdoc_dbt prov, dsymbcash_dbt symb   "+
                " where stroka=242 and rubli=0 and t_account_receiver=c4et   "+
                " AND symb.t_applicationkey = TO_CHAR (prov.t_iapplicationkind, 'fm09999') || prov.t_applicationkey     "+
                " and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
                "  and prov.t_chapter=1 "+
                " AND substr( prov.t_account_payer, 1, 5 ) = '20202' ";

s2_4_2_2_rub_ = s2_4_2_2_pref + "2422," + s2_4_2_2_rub_z+
                " AND (TRIM (symb.t_symbol) = '13' OR TRIM (symb.t_symbol) = '16' OR TRIM (symb.t_symbol) = '23' OR TRIM (symb.t_symbol) = '31') ";
vstavit_c4eta(s2_4_2_2_rub_);
s2_4_2_2_rub_ = "select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2422 and rubli=1 ";

s2_4_2_2_val_ = s2_4_2_2_pref + "2422," + s2_4_2_2_val_z+
                " AND (TRIM (symb.t_symbol) = '13' OR TRIM (symb.t_symbol) = '16' OR TRIM (symb.t_symbol) = '23' OR TRIM (symb.t_symbol) = '31') ";
vstavit_c4eta(s2_4_2_2_val_);
s2_4_2_2_val_ = "select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2422 and rubli=0 ";

// qqqqqqqqq
s2_4_2_2_1_rub = s2_4_2_2_pref + " 24221, " + s2_4_2_2_rub_z + "  AND TRIM (symb.t_symbol) = '14'  ";
vstavit_c4eta(s2_4_2_2_1_rub);
s2_4_2_2_1_rub = "select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=24221 and rubli=1 ";

s2_4_2_2_1_val = s2_4_2_2_pref + " 24221, " + s2_4_2_2_val_z + "  AND TRIM (symb.t_symbol) = '14'  ";
vstavit_c4eta(s2_4_2_2_1_val);
s2_4_2_2_1_val = "select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=24221 and rubli=0 ";*/





/*s2_spr_rub = "insert /*+ APPEND*/ INTO usr_251_prov " + 
      " SELECT  200, prov.t_account_payer, prov.t_account_receiver, prov.t_date_carry, prov.t_sum, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper   " +
      "   FROM  darhdoc_dbt prov, daccount_dbt acc1, daccount_dbt acc2 " +
      "  WHERE  (acc1.t_account = prov.t_account_payer AND acc2.t_account = prov.t_account_receiver) " +
      "                 AND acc1.t_chapter = acc2.t_chapter " +
      "                 AND acc1.t_chapter = prov.t_chapter " +
      "                 AND prov.t_chapter = 1) " +
      "           AND substr( prov.t_account_payer, 1, 5 ) = '40821' " +
      "           AND (TRIM (prov.t_shifr_oper) = '01' OR TRIM (prov.t_shifr_oper) = '1' OR TRIM (prov.t_shifr_oper) = '16') " +
      "           AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " +
      "           AND (acc1.t_type_account NOT LIKE '%П%' AND acc1.t_type_account NOT LIKE '%U%' AND acc1.t_type_account NOT LIKE '%Н%') " +
      "           AND (acc2.t_type_account NOT LIKE '%П%' AND acc2.t_type_account NOT LIKE '%U%' AND acc2.t_type_account NOT LIKE '%Н%') " ;
vstavit_c4eta(s2_spr_rub);
s2_spr_rub = "SELECT    COUNT (1), NVL (ROUND (SUM (summa) / 1000), 0) FROM     usr_251_prov WHERE      stroka = 200 AND rubli = 1 " ; 

*/




s3_1_rub = " " + 
      " insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  31, pr.payer, pr.receiver, pr.ddata, pr.summa, 1, pr.osnov, pr.shifr, pr.vid " +
      "   FROM  usr_251_prov pr " +
      "  WHERE  (pr.stroka IN (211, 212, 213, 214, 215, 216, 221, 222, 223, 224, 225, 226, 231, 232, 233, 234, 235, 236) " +
      "         AND pr.rubli = 1) " +
      "         AND substr( pr.receiver, 1, 5 ) IN ('30109', '30112', '30113', '30122', '30123', '30230', '30231', '30214', '30110', '30114', '30115', '30213') " +
      "     union all"+
      "    select  31, prov.t_account_payer, prov.t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper "+
      "      from  dacctrn_dbt prov "+
      "     where  prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') "+
      "       and  prov.t_chapter = 1 "+
      "       and  substr(prov.t_account_payer,6,3) = '810'                           "+ 
      "       and  substr(prov.t_account_receiver,6,3) = '810'                        "+ 
      "       and  (substr(prov.t_account_payer,1,5) in ('40911','40912','40913')     "+
      "        OR ( substr(prov.t_account_payer,13,1) in ('1','6','7') "+
      "         AND substr(prov.t_account_payer,1,12) like '30232____01_' ))"+
      "         AND substr(prov.t_account_receiver,1,5) IN ('30109', '30112', '30113', '30122', '30123', '30230', '30231', '30214', '30110', '30114', '30115', '30213') ";
//debugbreak;
//debugbreak;
message("Вставить счета s3_1_rub ");
vstavit_c4eta(s3_1_rub);
s3_1_rub = "SELECT      COUNT (1), NVL (ROUND (SUM (summa) / 1000), 0) FROM     usr_251_prov WHERE      stroka = 31 AND rubli = 1 " ; 

s3_1_val = " " + 
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  31, pr.payer, pr.receiver, pr.ddata, pr.summa, 0, pr.osnov, pr.shifr, pr.vid " +
      "   FROM  usr_251_prov pr " +
      "  WHERE  (pr.stroka IN (211, 212, 213, 214, 215, 216, 221, 222, 223, 224, 225, 226, 231, 232, 233, 234, 235, 236) " +
      "                 AND pr.rubli = 0) " +
      "           AND substr( pr.receiver, 1, 5 ) IN ('30109', '30112', '30113', '30122', '30123', '30230', '30231', '30214', '30110', '30114', '30115', '30213') " +
      "     union all  "+
      "    select  31, prov.t_account_payer, prov.t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper "+
      "      from  dacctrn_dbt prov "+
      "     where  prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') "+
      "       and  prov.t_chapter = 1 "+
      "       and  (substr(prov.t_account_payer,6,3) <> '810'                          "+ 
      "            or substr(prov.t_account_receiver,6,3) <> '810')                          "+ 
      "       and  (substr(prov.t_account_payer,1,5) in ('40911','40912','40913')     "+
      "        OR ( substr(prov.t_account_payer,13,1) in ('1','6','7') "+
      "         AND substr(prov.t_account_payer,1,12) like '30232____01_' ))"+
      "         AND substr(prov.t_account_receiver,1,5) IN ('30109', '30112', '30113', '30122', '30123', '30230', '30231', '30214', '30110', '30114', '30115', '30213') ";
//debugbreak;
//debugbreak;
vstavit_c4eta(s3_1_val);
s3_1_val = "SELECT      COUNT (1), NVL (ROUND (SUM (summa) / 1000), 0) FROM     usr_251_prov WHERE      stroka = 31 AND rubli = 0 " ; 



s3_1_1_rub =
      " insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  311, pr.payer, pr.receiver, pr.ddata, pr.summa, 1, pr.osnov, pr.shifr, pr.vid " +
      "   FROM  usr_251_prov pr " +
      "  WHERE  (pr.stroka IN (2111, 2121, 2131, 2141, 2161, 2211, 2221, 2231, 2241, 2261, 2311, 2321, 2331, 2341, 2361) " +
      "         AND pr.rubli = 1) " +
      "         AND substr( pr.receiver, 1, 5 ) IN ('30109', '30112', '30113', '30122', '30123', '30230', '30231', '30214', '30110', '30114', '30115', '30213') " ;
//debugbreak;
//debugbreak;
vstavit_c4eta(s3_1_1_rub);
s3_1_1_rub = "SELECT COUNT (1), NVL (ROUND (SUM (summa) / 1000), 0) FROM usr_251_prov WHERE stroka = 311 AND rubli = 1 " ; 

s3_1_1_val =
      " insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  311, pr.payer, pr.receiver, pr.ddata, pr.summa, 0, pr.osnov, pr.shifr, pr.vid " +
      "   FROM  usr_251_prov pr " +
      "  WHERE  (pr.stroka IN (2111, 2121, 2131, 2141, 2161, 2211, 2221, 2231, 2241, 2261, 2311, 2321, 2331, 2341, 2361) " +
      "         AND pr.rubli = 0) " +
      "         AND substr( pr.receiver, 1, 5 ) IN ('30109', '30112', '30113', '30122', '30123', '30230', '30231', '30214', '30110', '30114', '30115', '30213') " ;
//debugbreak;
//debugbreak;
vstavit_c4eta(s3_1_1_val);
s3_1_1_val = "SELECT COUNT (1), NVL (ROUND (SUM (summa) / 1000), 0) FROM usr_251_prov WHERE stroka = 311 AND rubli = 0 " ; 



s3_2_rub = "SELECT      COUNT (1), NVL (ROUND (SUM (summa) / 1000), 0) FROM ( "+ /*usr_251_prov WHERE   stroka = 34 AND rubli = 1 " ; */
      " SELECT  32, pr.payer, pr.receiver, pr.ddata, pr.summa, 1, pr.osnov, pr.shifr, pr.vid " +
      "   FROM  usr_251_prov pr " +
      "  WHERE  (pr.stroka IN (211, 212, 213, 214, 215, 216, 221, 222, 223, 224, 225, 226, 231, 232, 233, 234, 235, 236) " +
      "    AND  pr.rubli = 1) " +
      "    AND  substr(pr.receiver,1,5) IN ('30301','30302','30305','30306') " +
      "     union "+
      "    select  34, prov.t_account_payer, prov.t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper "+
      "      from  dacctrn_dbt prov "+
      "     where  prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') "+
      "       and  prov.t_chapter = 1 "+
      "       and  substr ( prov.t_account_payer, 6, 3 ) = '810' "+
      "       and  substr ( prov.t_account_receiver, 6, 3 ) = '810' "+
      "       and  (substr(prov.t_account_payer,1,5) in ('40911','40912','40913')     "+
      "            OR ( substr(prov.t_account_payer,13,1) in ('1','6','7') "+
      "                AND substr(prov.t_account_payer,1,13) like '30232____01_' ))"+
      "       AND  substr(prov.t_account_receiver,1,5) IN ('30301','30302','30305','30306')) ";



s3_2_val = "SELECT      COUNT (1), NVL (ROUND (SUM (summa) / 1000), 0) FROM ( "+        /*usr_251_prov WHERE    stroka = 34 AND rubli = 0 " ; */
      " SELECT  32, pr.payer, pr.receiver, pr.ddata, pr.summa, 0, pr.osnov, pr.shifr, pr.vid " +
      "   FROM  usr_251_prov pr " +
      "  WHERE  (pr.stroka IN (211, 212, 213, 214, 215, 216, 221, 222, 223, 224, 225, 226, 231, 232, 233, 234, 235, 236) " +
      "         AND pr.rubli = 0) " +
      "         AND  substr(pr.receiver,1,5) IN ('30301','30302','30305','30306') " +
      "     union  "+
      "    select  34, prov.t_account_payer, prov.t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper "+
      "      from  dacctrn_dbt prov "+
      "     where  prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') "+
      "       and  (substr ( prov.t_account_payer, 6, 3 ) <> '810' "+
      "            or  substr ( prov.t_account_receiver, 6, 3 ) <> '810' ) "+
      "       and  prov.t_chapter = 1 "+
      "       and  (substr(prov.t_account_payer,1,5) in ('40911','40912','40913')     "+
      "        OR ( substr(prov.t_account_payer,13,1) in ('1','6','7') "+
      "         AND substr(prov.t_account_payer,1,13) like '30232____01_' ))"+
      "         AND substr(prov.t_account_receiver,1,5) IN ('30301','30302','30305','30306')) ";

/*
s3_4_rub = "/* Formatted on 17.04.2012 14:43:24 (QP5 v5.115.810.9015) disa */ " + 
      " insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  34, pr.payer, pr.receiver, pr.ddata, pr.summa, 1, pr.osnov, pr.shifr, pr.vid " +
      "   FROM  usr_251_prov pr " +
      "  WHERE  (pr.stroka IN (211, 212, 213, 214, 215, 216, 221, 222, 223, 224, 225, 226, 231, 232, 233, 234, 235, 236) " +
      "         AND pr.rubli = 1) " +
      "     union all "+
      "    select  34, prov.t_account_payer, prov.t_account_receiver, prov.t_date_carry, prov.t_sum, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper "+
      "      from  darhdoc_dbt prov "+
      "     where  prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') "+
      "       and  prov.t_chapter = 1 "+
      "       and  (substr(prov.t_account_payer,1,5) in ('40911','40912','40913')     "+
      "        OR ( substr(prov.t_account_payer,13,1) in ('1','6','7') "+
      "         AND substr(prov.t_account_payer,1,13) like '30232____01_' "+
      "         AND substr(prov.t_account_receiver,1,5) IN ('30109', '30112', '30113', '30122', '30123', '30230', '30231', '30214', '30110', '30114', '30115', '30213'))) ";

vstavit_c4eta(s3_4_rub);*/
s3_4_rub = "SELECT      COUNT (1), NVL (ROUND (SUM (summa) / 1000), 0) FROM ( "+ /*usr_251_prov WHERE   stroka = 34 AND rubli = 1 " ; */
      " SELECT  34, pr.payer, pr.receiver, pr.ddata, pr.summa, 1, pr.osnov, pr.shifr, pr.vid " +
      "   FROM  usr_251_prov pr " +
      "  WHERE  (pr.stroka IN (211, 212, 213, 214, 215, 216, 221, 222, 223, 224, 225, 226, 231, 232, 233, 234, 235, 236) " +
      "    AND  pr.rubli = 1) " +
      "    AND  substr(pr.receiver,1,5) IN ('30102') " +
      "     union all "+
      "    select  34, prov.t_account_payer, prov.t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper "+
      "      from  dacctrn_dbt prov "+
      "     where  prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') "+
      "       and  prov.t_chapter = 1 "+
      "       and  substr ( prov.t_account_payer, 6, 3 ) = '810' "+
      "       and  substr ( prov.t_account_receiver, 6, 3 ) = '810' "+
      "       and  (substr(prov.t_account_payer,1,5) in ('40911','40912','40913')     "+
      "            OR ( substr(prov.t_account_payer,13,1) in ('1','6','7') "+
      "                AND substr(prov.t_account_payer,1,11) like '30232____01'))"+
      "       AND  substr(prov.t_account_receiver,1,5) IN ('30102')) ";
/*s3_4_val = "/* Formatted on 17.04.2012 14:43:24 (QP5 v5.115.810.9015) disa */ " + 
      "insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  34, pr.payer, pr.receiver, pr.ddata, pr.summa, 0, pr.osnov, pr.shifr, pr.vid " +
      "   FROM  usr_251_prov pr " +
      "  WHERE  (pr.stroka IN (211, 212, 213, 214, 215, 216, 221, 222, 223, 224, 225, 226, 231, 232, 233, 234, 235, 236) " +
      "                 AND pr.rubli = 0) " +
      "     union all "+
      "    select  34, prov.t_account_payer, prov.t_account_receiver, prov.t_date_carry, prov.t_sum, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper "+
      "      from  darhdoc_dbt prov "+
      "     where  prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') "+
      "       and  prov.t_chapter = 1 "+
      "       and  (substr(prov.t_account_payer,1,5) in ('40911','40912','40913')     "+
      "        OR ( substr(prov.t_account_payer,13,1) in ('1','6','7') "+
      "         AND substr(prov.t_account_payer,1,13) like '30232____01_' "+
      "         AND substr(prov.t_account_receiver,1,5) IN ('30109', '30112', '30113', '30122', '30123', '30230', '30231', '30214', '30110', '30114', '30115', '30213'))) ";

vstavit_c4eta(s3_4_val);*/
s3_4_val = "SELECT      COUNT (1), NVL (ROUND (SUM (summa) / 1000), 0) FROM ( "+        /*usr_251_prov WHERE    stroka = 34 AND rubli = 0 " ; */
      " SELECT  34, pr.payer, pr.receiver, pr.ddata, pr.summa, 0, pr.osnov, pr.shifr, pr.vid " +
      "   FROM  usr_251_prov pr " +
      "  WHERE  (pr.stroka IN (211, 212, 213, 214, 215, 216, 221, 222, 223, 224, 225, 226, 231, 232, 233, 234, 235, 236) " +
      "         AND pr.rubli = 0) " +
      "         AND  substr(pr.receiver,1,5) IN ('30102') " +
      "     union all "+
      "    select  34, prov.t_account_payer, prov.t_account_receiver, prov.t_date_carry, prov.t_sum_natcur, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper "+
      "      from  dacctrn_dbt prov "+
      "     where  prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') "+
      "       and  (substr ( prov.t_account_payer, 6, 3 ) <> '810' "+
      "            or  substr ( prov.t_account_receiver, 6, 3 ) <> '810' ) "+
      "       and  prov.t_chapter = 1 "+
      "       and  (substr(prov.t_account_payer,1,5) in ('40911','40912','40913')     "+
      "        OR ( substr(prov.t_account_payer,13,1) in ('1','6','7') "+
      "         AND substr(prov.t_account_payer,1,11) like '30232____01'))"+
      "         AND substr(prov.t_account_receiver,1,5) IN ('30102')) ";


/*s3_4_1_rub =
      " insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  341, pr.payer, pr.receiver, pr.ddata, pr.summa, 1, pr.osnov, pr.shifr, pr.vid " +
      "   FROM  usr_251_prov pr " +
      "  WHERE  (pr.stroka IN (2111, 2121, 2131, 2141, 2161, 2211, 2221, 2231, 2241, 2261, 2311, 2321, 2331, 2341, 2361) " +
      "         AND pr.rubli = 1) " +
      "         AND substr( pr.t_account_receiver, 1, 5 ) IN ('30102') " ;

vstavit_c4eta(s3_4_1_rub);*/
s3_4_1_rub = "SELECT COUNT (1), NVL (ROUND (SUM (summa) / 1000), 0) FROM ( "+ /* usr_251_prov WHERE stroka = 341 AND rubli = 1 " ; */
      " SELECT  341, pr.payer, pr.receiver, pr.ddata, pr.summa, 1, pr.osnov, pr.shifr, pr.vid " +
      "   FROM  usr_251_prov pr " +
      "  WHERE  (pr.stroka IN (2111, 2121, 2131, 2141, 2161, 2211, 2221, 2231, 2241, 2261, 2311, 2321, 2331, 2341, 2361) " +
      "         AND pr.rubli = 1) " +
      "         AND substr( pr.receiver, 1, 5 ) IN ('30102')) " ;



/*s3_4_1_val =
      " insert /*+ APPEND*/ INTO usr_251_prov " +
      " SELECT  341, pr.payer, pr.receiver, pr.ddata, pr.summa, 0, pr.osnov, pr.shifr, pr.vid " +
      "   FROM  usr_251_prov pr " +
      "  WHERE  (pr.stroka IN (2111, 2121, 2131, 2141, 2161, 2211, 2221, 2231, 2241, 2261, 2311, 2321, 2331, 2341, 2361) " +
      "         AND pr.rubli = 0) " +
      "         AND substr( pr.t_account_receiver, 1, 5 ) IN ('30102') " ;

vstavit_c4eta(s3_4_1_val);*/
s3_4_1_val = "SELECT COUNT (1), NVL (ROUND (SUM (summa) / 1000), 0) FROM ( "+ /*usr_251_prov WHERE stroka = 341 AND rubli = 0 " ; */
      " SELECT  341, pr.payer, pr.receiver, pr.ddata, pr.summa, 0, pr.osnov, pr.shifr, pr.vid " +
      "   FROM  usr_251_prov pr " +
      "  WHERE  (pr.stroka IN (2111, 2121, 2131, 2141, 2161, 2211, 2221, 2231, 2241, 2261, 2311, 2321, 2331, 2341, 2361) " +
      "         AND pr.rubli = 0) " +
      "         AND substr( pr.receiver, 1, 5 ) IN ('30102') )" ;

 /*


s2_4_2_2_rub=s2_4_2_2_m_rub+" "+
" AND (TRIM (symb.t_symbol) = '13' OR TRIM (symb.t_symbol) = '16' OR TRIM (symb.t_symbol) = '23' OR TRIM (symb.t_symbol) = '31') ";



s2_4_2_2_m_val="        /* Formatted on 23.01.2011 21:17:19 (QP5 v5.115.810.9015) disa */       "+
"       SELECT   COUNT (1), NVL (ROUND (SUM (prov.t_sum) / 1000), 0)    "+
"         FROM   darhdoc_dbt prov, daccount_dbt acc1, daccount_dbt acc2, dobjcode_dbt do2, dsymbcash_dbt symb     "+
"        WHERE   prov.t_chapter = 1     "+
"            AND t_account_payer = acc1.t_account       "+
"            AND t_account_receiver = acc2.t_account    "+
"            AND t_date_carry BETWEEN TO_DATE ('01.12.2010', 'dd.mm.rrrr') AND TO_DATE ('01.01.2011', 'dd.mm.rrrr')     "+
"            AND (acc1.t_type_account LIKE '%П%' or acc1.t_type_account  LIKE '%U%' or acc1.t_type_account  LIKE '%Н%') "+
"            AND acc1.t_chapter = acc2.t_chapter        "+
"            AND prov.t_chapter = acc1.t_chapter        "+
"            AND do2.t_objecttype = 3   "+
"            AND do2.t_codekind = 1     "+
"            AND acc2.t_client = do2.t_objectid "+
"            AND symb.t_applicationkey = TO_CHAR (prov.t_iapplicationkind, 'fm09999') || prov.t_applicationkey  "+
"            AND substr( prov.t_account_payer, 1, 5 ) = '20202'      "+
"            AND not (do2.t_code = '010000060231' OR do2.t_code = '010000060430' OR do2.t_code = '010000060431')        "+
"            AND (substr( prov.t_account_receiver, 1, 5 ) = '40911' OR substr( prov.t_account_receiver, 1, 5 ) = '40912' OR substr( prov.t_account_receiver, 1, 5 ) = '40913')  ";

s2_4_2_2_val=s2_4_2_2_m_val+" "+
" AND (TRIM (symb.t_symbol) = '13' OR TRIM (symb.t_symbol) = '16' OR TRIM (symb.t_symbol) = '23' OR TRIM (symb.t_symbol) = '31') ";

s2_4_2_2_1_rub=s2_4_2_2_m_rub+" AND TRIM (symb.t_symbol) = '14' and not (do2.t_code = '010000060295' )";
s2_4_2_2_1_val=s2_4_2_2_m_val+" AND TRIM (symb.t_symbol) = '14' and not (do2.t_code = '010000060295' )";
*/
//s2_1_1_rub=" ";


         
/*        msgbox(begindate);
          msgbox(string(begindate));
          msgbox(           substr(string(begindate),7)                 );*/
/*
line_2_1_1(); 
line_2_1_1_1(); 
line_2_1_1_1_1(); 
line_2_1_3(); 
line_2_1_4(); 
line_2_1_5(); 

   */ 
  
message("----------------------- считается пункт 1.1-----------");
   line_1_1();
   useprogress(1);

message("----------------------- считается пункт 1.1.1-----------");
   line_1_1_1();
   useprogress(2);


message("----------------------- считается пункт 1.1.1.1-----------");
   line_1_1_1_1();
   useprogress(3);

message("----------------------- считается пункт 1.1.1.1.1-----------");
   line_1_1_1_1_1();
   useprogress(4);

/*------------------------------- 2926-У begin ----------------------------------GSP*/
message("----------------------- считается пункт 1.1.2-----------");
   line_1_1_2();
   useprogress(5);

message("----------------------- считается пункт 1.1.3-----------");
   line_1_1_3();
   useprogress(6);
/*------------------------------- 2926-У end ------------------------------------*/

message("----------------------- считается пункт 1.2-----------");
   line_1_2();
   useprogress(7);

message("----------------------- считается пункт 1.2.1-----------");
   line_1_2_1();
   useprogress(8);

message("----------------------- считается пункт 1.2.2-----------");
   line_1_2_2();    
   useprogress(9);

message("----------------------- считается пункт 1.2.2.1-----------");
   line_1_2_2_1();
   useprogress(10);

message("----------------------- считается пункт 1.2.2.1.2-----------");
   line_1_2_2_1_2();
   useprogress(11);

message("----------------------- считается пункт 1.3-----------");
   line_1_3();
   useprogress(12);

message("----------------------- считается пункт 2.1.1-----------");
                
   line_2_1_1();
   useprogress(13);

message("----------------------- считается пункт 2.1.1.1-----------");
   line_2_1_1_1();
   useprogress(14);

/*message("----------------------- считается пункт 2.1.1.1.1-----------");
   line_2_1_1_1_1();
   useprogress(15);
*/
message("----------------------- считается пункт 2.1.2-----------");
   line_2_1_2(); 
   useprogress(16);

message("----------------------- считается пункт 2.1.2.1-----------");
   line_2_1_2_1(); 
   useprogress(16);

message("----------------------- считается пункт 2.1.3-----------");
   line_2_1_3();
   useprogress(17);

/*message("----------------------- считается пункт 2.1.3.1-----------");
   line_2_1_3_1();
   useprogress(17);
*/
message("----------------------- считается пункт 2.1.3.1.1-----------");
   line_2_1_3_1_1();
   useprogress(17);

message("----------------------- считается пункт 2.1.4-----------");
   line_2_1_4();
   useprogress(18);

/*message("----------------------- считается пункт 2.1.4.1-----------");
   line_2_1_4_1();
   useprogress(18);
*/
message("----------------------- считается пункт 2.1.5-----------");
   line_2_1_5();
   useprogress(19);
  
message("----------------------- считается пункт 2.1.6-----------");
   line_2_1_6();
   useprogress(20); 

/*message("----------------------- считается пункт 2.1.6.1---------");
   line_2_1_6_1();
   useprogress(21);  
*/
/*message("----------------------- считается пункт 2.1.6.2---------");
   line_2_1_6_2();
   useprogress(21);  
*/
/*message("----------------------- считается пункт 2.1.6.2.1---------");
   line_2_1_6_2_1();
   useprogress(21);  
*/
message("----------------------- считается пункт 2.2.1-----------");
   line_2_2_1();  
   useprogress(22);

message("----------------------- считается пункт 2.2.1.1-----------");
   line_2_2_1_1();  
   useprogress(23);

/*message("----------------------- считается пункт 2.2.1.1.1-----------");
   line_2_2_1_1_1();  
   useprogress(24);
*/
message("----------------------- считается пункт 2.2.2-----------");
   line_2_2_2();  
   useprogress(25);

message("----------------------- считается пункт 2.2.2.1-----------");
   line_2_2_2_1();  
   useprogress(25);

message("----------------------- считается пункт 2.2.3-----------");
   line_2_2_3();  
   useprogress(26);
                 
message("----------------------- считается пункт 2.2.3.1-----------");
   line_2_2_3_1();  
   useprogress(26);

message("----------------------- считается пункт 2.2.3.1.1-----------");
   line_2_2_3_1_1();  
   useprogress(26);

message("----------------------- считается пункт 2.2.4-----------");
   line_2_2_4();  
   useprogress(27);

message("----------------------- считается пункт 2.2.4.1-----------");
   line_2_2_4_1();  
   useprogress(27);

message("----------------------- считается пункт 2.2.5-----------");
   line_2_2_5();  
   useprogress(28);

message("----------------------- считается пункт 2.2.6-----------");
   line_2_2_6();  
   useprogress(29);

/*message("----------------------- считается пункт 2.2.6.1-----------");
   line_2_2_6_1();  
   useprogress(30);
*/
/*message("----------------------- считается пункт 2.2.6.2-----------");
   line_2_2_6_2();  
   useprogress(30);
*/
/*message("----------------------- считается пункт 2.2.6.2.1-----------");
   line_2_2_6_2_1();  
   useprogress(30);
*/
message("----------------------- считается пункт 2.3.1-----------");
   line_2_3_1();  
   useprogress(31);

message("----------------------- считается пункт 2.3.1.1-----------");
   line_2_3_1_1();  
   useprogress(31);

message("----------------------- считается пункт 2.3.1.1.1-----------");
   line_2_3_1_1_1();  
   useprogress(31);

message("----------------------- считается пункт 2.3.3-----------");
   line_2_3_3();  
   useprogress(32);
               
message("----------------------- считается пункт 2.3.3.1-----------");
   line_2_3_3_1();  
   useprogress(32);
               
message("----------------------- считается пункт 2.3.3.1.1-----------");
   line_2_3_3_1_1();  
   useprogress(32);
               
message("----------------------- считается пункт 2.3.4-----------");
   line_2_3_4();  
   useprogress(33);

message("----------------------- считается пункт 2.3.4.1-----------");
   line_2_3_4_1();  
   useprogress(33);

message("----------------------- считается пункт 2.3.5-----------");
   line_2_3_5();  
   useprogress(34);

message("----------------------- считается пункт 2.3.6-----------");
   line_2_3_6();  
   useprogress(35);

message("----------------------- считается пункт 2.3.6.1-----------");
   line_2_3_6_1();  
   useprogress(35);

/*message("----------------------- считается пункт 2.3.6.2-----------");
   line_2_3_6_2();  
   useprogress(35);

message("----------------------- считается пункт 2.3.6.2.1-----------");
   line_2_3_6_2_1();  
   useprogress(35);
*/
message("----------------------- считается пункт 2.4.1-----------");
   line_2_4_1();
   useprogress(36);

message("----------------------- считается пункт 2.4.1.1-----------");
   line_2_4_1_1();
   useprogress(37);

message("----------------------- считается пункт 2.4.1.1.1-----------");
   line_2_4_1_1_1();
   useprogress(37);

message("----------------------- считается пункт 2.4.1.1.2-----------");
   line_2_4_1_1_2();
   useprogress(38);

message("----------------------- считается пункт 2.4.1.1.2.1-----------");
   line_2_4_1_1_2_1();
   useprogress(38);

message("----------------------- считается пункт 2.4.1.2-----------");
   line_2_4_1_2(); 
   useprogress(39);

message("----------------------- считается пункт 2.4.1.2.1-----------");
   line_2_4_1_2_1(); 
   useprogress(39);

message("----------------------- считается пункт 2.4.1.2.2-----------");
   line_2_4_1_2_2(); 
   useprogress(39);

message("----------------------- считается пункт 2.4.2-----------");
   line_2_4_2();
   useprogress(40);

message("----------------------- считается пункт 2.4-----------");
   line_2_4();
   useprogress(41);

message("----------------------- считается пункт 2.4.2.1-----------");
   line_2_4_2_1();
   useprogress(42);

message("----------------------- считается пункт 2.4.2.1.1-----------");
   line_2_4_2_1_1();
   useprogress(42);

message("----------------------- считается пункт 2.4.2.1.2-----------");
   line_2_4_2_1_2();
   useprogress(42);

message("----------------------- считается пункт 2.4.2.1.2_1-----------");
   line_2_4_2_1_2_1();
   useprogress(42);

message("----------------------- считается пункт 2.4.2.2-----------");
   line_2_4_2_2();
   useprogress(43);

message("----------------------- считается пункт 2.4.2.2.1-----------");
   line_2_4_2_2_1();
   useprogress(44);

message("----------------------- считается пункт 2.4.2.2.2-----------");
   line_2_4_2_2_2();
   useprogress(44);

message("----------------------- считается пункт 'справочно' для раздела 2 ----------"); //03.04.2012 vihrov C-9859-6
//   line_2_spr();
   useprogress(45);

//message("----------------------- считается пункт 2.5-----------");
//    line_2_5();
//   useprogress(35);

//message("----------------------- считается пункт 2.5.1-----------");
//    line_2_5_1();
//   useprogress(35);
    
message("----------------------- считается пункт 3.1-----------");
    //debugbreak;
   line_3_1();
   useprogress(46);

message("----------------------- считается пункт 3.1.1-----------");
    //debugbreak;
   line_3_1_1(); 
   useprogress(47);

if(fgBank.is_EXV)
message("----------------------- считается пункт 3.4-----------");
   line_3_2();
   useprogress(48);
end;

message("----------------------- считается пункт 3.4-----------");
   line_3_4();
   useprogress(48);

message("----------------------- считается пункт 3.4.1-----------");
   line_3_4_1();
   useprogress(49);

message("----------------------- считается пункт 4.1-----------");
   line_4_1();
   useprogress(50);

message("----------------------- считается пункт 4.1.1-----------");
   line_4_1_1();
   useprogress(51);
                  
/*message("----------------------- считается пункт 4.1.3-----------");
   line_4_1_3();
   useprogress(52);
*/
message("----------------------- считается пункт 3.3-----------");
   line_3_3(); //расчитывается арифметически
   useprogress(53);

message("----------------------- считается пункт 3.3.1-----------");
   line_3_3_1(); // расчитывается арифметически
   useprogress(54);
                   
remprogress();  
  
   printReport();
end;


/*Точка входа в макрос*/
if (RunDialog(dlg, "Event"))                  
  calculate();
end; 


