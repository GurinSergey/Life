/* ──────────────────────────────────────────────────────────────────────────┐
   RS-Bank V6                                                 R-Style Softlab
   Файл подсистемы "Регламентированная отчетность"

   Форма 134. Контроллер расчет раздела.

   CREATED : 17.07.12 Ser.
   изменено: 03.09.2012 GSP изменены значения для ручного ввода, в расчет 
                            переменной 2_2_6 добавлен вычет РВП по счету 60206
                            внесены изменения из старой формы 134
             05.09.2012 GSP переменная 2_2_6 расчет резервов исправлен 
             19.03.2013 GSP изменения по расчету п. 2_1_2
└────────────────────────────────────────────────────────────────────────── */
//msgbox("in MACRO");
class (RcbPartCalculateController) F134PartCalculateController(reportCalculateController : Object /*TReportCalculateController*/, partId : String)
    initRcbPartCalculateController(reportCalculateController, partId);
    private var m_protocolView = m_dataSources.getProtocolView();

    private const PROFIT_WITHIOUT_PFI_NOTE_ID = 49;

    private const PFI_IMPL_NOTE_ID = 47;

    private const PROFIT_NOT_IMPL_NOTE_ID = 48;

    private const NOTEKIND_BOUGHT_OUT_COST = 23;

    private var m_costTransferDate : Date = null;

    private macro getYear(day : date)
        var y;
        dateSplit(day, null, null, y);

        return y;
    end;

    private macro getSpodEndDate()
        return f134Parameters.spodEndDate;
    end;

    macro printAttributeHead(attributeId : String)
        m_protocolView.printLine("\n***********************************");
        m_protocolView.printLine("Расчет атрибута: " + attributeId);
        m_protocolView.printLine("***********************************");
    end;

    private macro getCostTransferDate()
        if (m_costTransferDate == null)
            var dataSet = TRsbDataSet("SELECT t_date"
                +"\n"+                "  FROM drepdocument_vw"
                +"\n"+                " WHERE t_date BETWEEN " + getSqlDate(getSpodEndDate()) + " AND " + getSqlDate(date(31,01,getYear(m_report.getPeriod().endDate)))
                +"\n"+                "   AND (   (t_debetAccount like '70801%' AND (t_creditAccount like '10801%' OR  t_creditAccount like '10901%'))"
                +"\n"+                "        OR (t_debetAccount like '10901%' AND t_creditAccount like '70802%'))"
                +"\n"+                "   AND rowNum < 2");

            if (dataSet.moveNext())
                m_costTransferDate = dataSet.date;
            else
                m_costTransferDate = date();
            end;
        end;

        return m_costTransferDate;
    end;


    private macro isLastDayInMonth(day : Date)
        var m;
        var y;
        dateSplit(day, NULL, m, y);

        if (m == 12)
            m = 1;
            y = y + 1;
        else
            m = m + 1;
        end;

        return day == Date(1, m, y) - 1;
    end;

    macro processUserAttribute(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        m_protocolView.printLine("Атрибут пользователького ввода: " + attribute.getId());

        if (attribute.getValue() == null)
            m_protocolView.printLine("\nЗначение не заданно, полагаем равным нулю");
            
            attribute.setValue($0.0);
        end;

        m_protocolView.printLine("\n" + attribute.getId + " = " + attribute.getValue());
    end;


    private macro setValueCbDocument(attribute : RcbAttributeBase, creditSum : Money, debetSum : Money)
        var sum = creditSum - debetSum;

        m_protocolView.printLine("\n" + attribute.getId + " = Сумма по кредиту(" + creditSum + ") - Сумма по дебету(" + debetSum + ")");

        attribute.setValue(sum);

        m_protocolView.printLine("\n" + attribute.getId + " = " + attribute.getValue());
    end;

    private macro setValue(attribute : RcbAttributeBase, sum : Money)
        m_protocolView.printLine("\n" + attribute.getId + " = " + sum);

        attribute.setValue(sum);
    end;

    private macro plusValue(attribute : RcbAttributeBase, sum : Money)
        m_protocolView.printLine("\n" + attribute.getId + " = " + attribute.getId + "(" + attribute.getValue() + ") + " + sum);

        attribute.plus(sum);

        m_protocolView.printLine("\n" + attribute.getId + " = " + attribute.getValue());
    end;

    private macro minusValue(attribute : RcbAttributeBase, sum : Money)
        m_protocolView.printLine("\n" + attribute.getId + " = " + attribute.getId + "(" + attribute.getValue() + ") - " + sum);

        attribute.minus(sum);

        m_protocolView.printLine("\n" + attribute.getId + " = " + attribute.getValue());
    end;

    private macro setValueAttributes(attribute : RcbAttributeBase, plusPool : RcbArray, minusPool : RcbArray, isControlNegativeAmmount : Bool)
        m_protocolView.printLine("Собственное значение атрибута: " + attribute.getId() + "(" + attribute.getValue() + ")");

        var tmpAttribute = null;
        var value        = $0.0;

        plusPool.moveFirst();

        while (plusPool.moveNext())
             tmpAttribute = m_part.getAttribute(plusPool.getCurrentItem());

             value = tmpAttribute.getValue();

             if (isControlNegativeAmmount and (value <= $0.0))

                m_protocolView.printLine("Значение переменной  "  + tmpAttribute.getId() + "(" + value + ") <= 0, в расчете принимаем = 0");
                value = $0.0;
             end;

             attribute.plus(value);

             m_protocolView.printLine("+" + tmpAttribute.getId() + "(" + value + ")");
        end;

        minusPool.moveFirst();

        while (minusPool.moveNext())
             tmpAttribute = m_part.getAttribute(minusPool.getCurrentItem());

             value = tmpAttribute.getValue();


             if (isControlNegativeAmmount and (value <= $0.0))

                m_protocolView.printLine("Значение переменной  "  + tmpAttribute.getId() + "(" + value + ") <= 0, в расчете принимаем = 0");
                value = $0.0;
             end;

             attribute.minus(value);

             m_protocolView.printLine("-" + tmpAttribute.getId() + "(" + value + ")");
        end;

        m_protocolView.printLine("\n" + attribute.getId + " = " + attribute.getValue());
    end;

    private macro getCalculateAttributeData(attributeId : String, functionName : String, dependencesAttributeIdPool : RcbArray)
        if (dependencesAttributeIdPool == null)
            dependencesAttributeIdPool = RcbArray();
        end;

        var dependencesAttributePool = RcbArray();

        dependencesAttributeIdPool.moveFirst();
        while (dependencesAttributeIdPool.moveNext())
            dependencesAttributePool.push_back(m_part.getAttribute(dependencesAttributeIdPool.getCurrentItem()));
        end;

        return RcbCalculationAttributeData(m_part.getAttribute(attributeId), 
                                           RcbArray().initialize(RcbCalculationData(r2m(this, functionName),
                                                                                    RcbArray().initialize(attributeId))),
                                           RcbDependencesData(dependencesAttributePool));
    end;

end;
/**
 * Класс предварительного расчета отчета
 */
class (F134PartCalculateController) F134Part1CalculateController(reportCalculateController : Object /*TReportCalculateController*/)
    initF134PartCalculateController(reportCalculateController, "1");
//msgbox("in class");
    macro calculateEq2_1_1__2_1_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        
        printAttributeHead(attributeId);
        
        var dataSource = null;
        var filter     = null;
        
        if (f134Parameters.isCalculateACForPosting)

            dataSource = m_dataSources.getDataSource("CbDocument");
            filter     = m_dataSouceFilters.getFilter("CbDocument");

            filter.paymentCapitalChangeDateLessOrEqual(m_report.getPeriod().endDate).op("AND").isSatisfiesToBalanceMasks("10207*, 10208*", false);

            var sumCredit = dataSource.getData(filter, attribute, "Сумма по кредиту");
            
            filter     = m_dataSouceFilters.getFilter("CbDocument");

            filter.paymentCapitalChangeDateLessOrEqual(m_report.getPeriod().endDate).op("AND").isSatisfiesToBalanceMasks("10207*, 10208*", true);

            var sumDebet = dataSource.getData(filter, attribute, "Сумма по дебету");

            setValueCbDocument(attribute, sumCredit, sumDebet)
        else

            dataSource = m_dataSources.getDataSource("CbAccount");
            filter     = m_dataSouceFilters.getFilter("CbAccount");

            filter.isOpened().op("AND").isExistRest();

            filter.op("AND").isSatisfiesToBalanceMasks("10207, 10208").op("AND").op("(").op("(").isSatisfiesToBalanceMasks("10207").op("AND").op("NOT").isReportingCategoryExists("2.1.1 искл").op("AND").op("NOT").isReportingCategoryExists("3.7").op(")");

            filter.op("OR").op("(").isSatisfiesToBalanceMasks("10208").op("AND").op("NOT").isReportingCategoryExists("2.1.2 искл").op(")").op(")");

            setValue(attribute, dataSource.getData(filter, attribute));
        end;
    end;

    macro calculateEq2_1_3__2_1_4(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        
        printAttributeHead(attributeId);
        
        var dataSource = null;
        var filter     = null;
        
        if (f134Parameters.isCalculateACForPosting)

            dataSource = m_dataSources.getDataSource("CbDocument");
            filter     = m_dataSouceFilters.getFilter("CbDocument");

            filter.paymentCapitalChangeDateLessOrEqual(m_report.getPeriod().endDate).op("AND").isSatisfiesToBalanceMasks("10602*", false);

            var sumCredit = dataSource.getData(filter, attribute, "Сумма по кредиту");
            
            filter     = m_dataSouceFilters.getFilter("CbDocument");

            filter.paymentCapitalChangeDateLessOrEqual(m_report.getPeriod().endDate).op("AND").isSatisfiesToBalanceMasks("10602*", true);

            var sumDebet = dataSource.getData(filter, attribute, "Сумма по дебету");

            setValueCbDocument(attribute, sumCredit, sumDebet)
        else

            dataSource = m_dataSources.getDataSource("CbAccount");
            filter     = m_dataSouceFilters.getFilter("CbAccount");

            filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("10602");

            setValue(attribute, dataSource.getData(filter, attribute));
        end;
    end;

    macro calculateEq2_1_5(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        
        printAttributeHead(attributeId);

        var dataSource = null;
        var filter     = null;
        
        dataSource = m_dataSources.getDataSource("CbAccount");
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("107*").op("AND").isReportingCategoryExists("2.1.5");

        setValue(attribute, dataSource.getData(filter, attribute));

        setValueAttributes(attribute,
                           RcbArray(),
                           RcbArray().initialize("Eq2_1_7", "Eq3_3"));
    end;

    macro calculateEq2_1_6_data(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.ПрибыльТекущегоГодаПодтверждена)
            m_protocolView.PrintLine("Прибыль текущего года подтверждена.");
    
            var dataSource = m_dataSources.getDataSource("CbAccount");
            var filter     = m_dataSouceFilters.getFilter("CbAccount");
            var rest       = $0.0;
            //Сумма 1
            filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70601, 70603, 70604, 70605, 61301, 61304");

            rest = dataSource.getData(filter, attribute, null, f134Parameters.ДатаАудПодтв_ТекГ -1);

            //Сумма 2
            m_protocolView.PrintLine("Плюс");

            filter = m_dataSouceFilters.getFilter("CbAccount");

            filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10603, 70602").op("AND").isReportingCategoryExists("ТСС");

            rest = rest + dataSource.getData(filter, attribute, null, f134Parameters.ДатаАудПодтв_ТекГ -1);

            //Сумма 3
            m_protocolView.PrintLine("Минус");

            filter = m_dataSouceFilters.getFilter("CbAccount");

            filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70606, 70608, 70609, 70610, 70611, 70612, 50905, 61401, 61403");

            rest = rest - dataSource.getData(filter, attribute, null, f134Parameters.ДатаАудПодтв_ТекГ -1);

            //Сумма 4
            m_protocolView.PrintLine("Минус");

            filter = m_dataSouceFilters.getFilter("CbAccount");

            filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10605, 70607").op("AND").isReportingCategoryExists("ТСС");

            rest = rest - dataSource.getData(filter, attribute, null, f134Parameters.ДатаАудПодтв_ТекГ -1);
            
            setValue(attribute, rest);

            var minusPool = RcbArray();

            if (isLastDayInMonth(m_report.getPeriod().endDate))
                minusPool.push_back("Eq2_1_6ввод");
            end;

            setValueAttributes(attribute,
                               RcbArray().initialize("Eq_104.2_данные"),
                               minusPool);
        else
            m_protocolView.PrintLine("Прибыль текущего года не подтверждена.");
            m_protocolView.PrintLine("Значение переменной равно нулю.");
            setValue(attribute, $0.0);
        end;
    end;

    macro calculateEq2_1_6(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var sum = m_part.getAttribute("Eq2_1_6данные").getValue(); 

        if (sum >= 0)
            m_protocolView.PrintLine("Eq2_1_6данные (" + sum + ") >= 0");
            setValue(attribute, sum);
        else
            m_protocolView.PrintLine("Eq2_1_6данные (" + sum + ") < 0");
            setValue(attribute, $0.0);
        end;
    end;

    macro calculateEq2_1_6RevaluationData(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.ПрибыльТекущегоГодаПодтверждена)
            m_protocolView.PrintLine("Прибыль текущего года подтверждена.");

            var dataSource = m_dataSources.getDataSource("CbAccount");
            var filter     = m_dataSouceFilters.getFilter("CbAccount");
            var rest       = $0.0;
            //Сумма 1
            filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10603, 70602").op("AND").isReportingCategoryExists("ТСС");

            rest = dataSource.getData(filter, attribute, null, f134Parameters.ДатаАудПодтв_ТекГ -1);

            //Сумма 2
            m_protocolView.PrintLine("Минус");

            filter = m_dataSouceFilters.getFilter("CbAccount");

            filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10605, 70607").op("AND").isReportingCategoryExists("ТСС");

            rest = rest - dataSource.getData(filter, attribute, null, f134Parameters.ДатаАудПодтв_ТекГ -1);

            setValue(attribute, rest);
        else
            m_protocolView.PrintLine("Прибыль текущего года не подтверждена.");
            m_protocolView.PrintLine("Значение переменной равно нулю.");
            setValue(attribute, $0.0);
        end;
    end;

    macro calculateEq2_1_6Revaluation(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var sum = m_part.getAttribute("Eq2_1_6").getValue(); 

        if (sum >= 0)
            m_protocolView.PrintLine("Eq2_1_6 (" + sum + ") >= 0");

            sum = m_part.getAttribute("Eq2_1_6_переоценка_данные").getValue();

            m_protocolView.PrintLine("Значение переменной равно значению переменной Eq2_1_6_переоценка_данные (" + sum + ")");
            setValue(attribute, sum);
        else
            m_protocolView.PrintLine("Eq2_1_6 (" + sum + ") < 0");
            setValue(attribute, $0.0);
        end;
    end;

    macro calculateEq104_2data(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("Eq_104.2.1_данные", "Eq_104.2.2_нереал_полож_данные"),
                           RcbArray().initialize("Eq_104.2.2_нереал_отриц_данные"),
                           true);
    end;

    macro calculateEq104_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_104.2.1_ввод", "Строка_104.2.2_полож_ввод"),
                               RcbArray().initialize("Строка_104.2.2_отриц_ввод"),
                               true);
        else
            var sum = m_part.getAttribute("Eq2_1_6").getValue(); 

            if (sum > 0)
                m_protocolView.PrintLine("Eq2_1_6 (" + sum + ") > 0");

                sum = m_part.getAttribute("Eq_104.2_данные").getValue();

                m_protocolView.PrintLine("Значение переменной равно значению переменной Eq_104.2_данные (" + sum + ")");
                setValue(attribute, sum);
            else
                m_protocolView.PrintLine("Eq2_1_6 (" + sum + ") <= 0");
                setValue(attribute, $0.0);
            end;
        end;

    end;

    macro calculateEq104_2_1_dataSum1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        //Сумма 1
        var dataSource = m_dataSources.getDataSource("CbDocument");
        var filter     = m_dataSouceFilters.getFilter("CbDocument");

        filter.setDateCary(date(0, 0, 0), f134Parameters.ДатаАудПодтв_ТекГ - 1).op("AND").isSatisfiesToBalanceMasks("61601*", true).op("AND").isSatisfiesToBalanceMasks("70613*", false).op("AND").isOpuSymbolEqualTo("16101", false);

        setValue(attribute, dataSource.getData(filter, attribute));

        //Сумма 2

        setValueAttributes(attribute,
                           RcbArray().initialize("Eq_док_подтв_суммы_70613_ввод"),
                           RcbArray(),
                           true);

        //Сумма 3
        filter     = m_dataSouceFilters.getFilter("CbDocument");

        filter.setDateCary(date(0, 0, 0), f134Parameters.ДатаАудПодтв_ТекГ - 1).op("AND").isSatisfiesToBalanceMasks("70613*", true).op("AND").isSatisfiesToBalanceMasks("61601*", false).op("AND").isOpuSymbolEqualTo("16101", true);

        minusValue(attribute, dataSource.getData(filter, attribute));
    end;

    macro calculateEq104_2_1_dataSum2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = m_dataSources.getDataSource("CbDocument");
        var filter     = m_dataSouceFilters.getFilter("CbDocument");

        //Сумма 1

        filter.setDateCary(date(0, 0, 0), f134Parameters.ДатаАудПодтв_ТекГ - 1).op("AND").isSatisfiesToBalanceMasks("70614*", true).op("AND").isSatisfiesToBalanceMasks("61601*", false).op("AND").isOpuSymbolEqualTo("25101", true);

        setValue(attribute, dataSource.getData(filter, attribute));

        //Сумма 2

        setValueAttributes(attribute,
                           RcbArray("Eq_док_подтв_суммы_70614_ввод"),
                           RcbArray(),
                           true);

        //Сумма 3
        filter     = m_dataSouceFilters.getFilter("CbDocument");

        filter.setDateCary(date(0, 0, 0), f134Parameters.ДатаАудПодтв_ТекГ - 1).op("AND").isSatisfiesToBalanceMasks("61601*", true).op("AND").isSatisfiesToBalanceMasks("70614*", false).op("AND").isOpuSymbolEqualTo("25101", false);

        minusValue(attribute, dataSource.getData(filter, attribute));
    end;

    macro calculateEq104_2_1_data(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);


        setValueAttributes(attribute,
                           RcbArray().initialize("Eq_104.2.1_данныеСумма1"),
                           RcbArray().initialize("Eq_104.2.1_данныеСумма2"),
                           true);

    end;

    macro calculateEq104_2_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_104.2.1_ввод"),
                               RcbArray(),
                               true);
        else
            var sum = m_part.getAttribute("Eq2_1_6").getValue(); 

            if (sum > 0)
                m_protocolView.PrintLine("Eq2_1_6 (" + sum + ") > 0");

                sum = m_part.getAttribute("Eq_104.2.1_данные").getValue();

                m_protocolView.PrintLine("Значение переменной равно значению переменной Eq_104.2.1_данные (" + sum + ")");
                setValue(attribute, sum);
            else
                m_protocolView.PrintLine("Eq2_1_6 (" + sum + ") <= 0");
                setValue(attribute, $0.0);
            end;
        end;

    end;

    macro calculateEq104_2_2data(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (m_part.getAttribute("Eq_104.2.2_нереал_полож_данные").getValue() > 0)
            setValue(attribute, m_part.getAttribute("Eq_104.2.2_нереал_полож_данные").getValue());
        else
            setValue(attribute, m_part.getAttribute("Eq_104.2.2_нереал_отриц_данные").getValue());
        end;
    end;

    macro calculateEq104_2_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            if (m_part.getAttribute("Строка_104.2.2_полож_ввод").getValue() > 0)
                setValue(attribute, m_part.getAttribute("Строка_104.2.2_полож_ввод").getValue());
            else
                if (m_part.getAttribute("Строка_104.2.2_отриц_ввод").getValue() > 0)
                    setValue(attribute, m_part.getAttribute("Строка_104.2.2_отриц_ввод").getValue());
                else
                    setValue(attribute, $0.0);
                end;
            end;
        else
            var sum = m_part.getAttribute("Eq2_1_6").getValue(); 

            if (sum > 0)
                m_protocolView.PrintLine("Eq2_1_6 (" + sum + ") > 0");

                sum = m_part.getAttribute("Eq_104.2.2_данные").getValue();

                m_protocolView.PrintLine("Значение переменной равно значению переменной Eq_104.2.2_данные (" + sum + ")");
                setValue(attribute, sum);
            else
                m_protocolView.PrintLine("Eq2_1_6 (" + sum + ") <= 0");
                setValue(attribute, $0.0);
            end;
        end;
    end;

    macro calculateEq104_2_2NotImplPositiveDataSum1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        printAttributeHead(attributeId);

        var dataSource = null;
        var filter     = null;
        
        dataSource = m_dataSources.getDataSource("CbAccount");
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70613");

        setValue(attribute, dataSource.getData(filter, attribute, null, f134Parameters.ДатаАудПодтв_ТекГ -1));

        //2
        setValueAttributes(attribute,
                           RcbArray().initialize("Eq_70613_нер_корр_ввод"),
                           RcbArray().initialize("Eq_104.2.1_данныеСумма1"),
                           true);

        //3
        dataSource = m_dataSources.getDataSource("CbAccount");
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70613").op("AND").isReportingCategoryExists("ПФИ: искл. из  10.2");

        minusValue(attribute, dataSource.getData(filter, attribute, null, f134Parameters.ДатаАудПодтв_ТекГ -1));
    end;

    macro calculateEq104_2_2NotImplPositiveDataSum2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        printAttributeHead(attributeId);

        var dataSource = null;
        var filter     = null;

        //1

        dataSource = m_dataSources.getDataSource("CbAccount");
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70614");

        setValue(attribute, dataSource.getData(filter, attribute, null, f134Parameters.ДатаАудПодтв_ТекГ -1));

        //2
        setValueAttributes(attribute,
                           RcbArray().initialize("Eq_70614_нер_корр_ввод"),
                           RcbArray().initialize("Eq_104.2.1_данныеСумма2"),
                           true);
    end;

    macro calculateEq104_2_2NotImplPositiveData(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        printAttributeHead(attributeId);
        
        setValueAttributes(attribute,
                           RcbArray().initialize("Eq_104.2.2_нереал_полож_данныеСумма1"),
                           RcbArray().initialize("Eq_104.2.2_нереал_полож_данныеСумма2"),
                           true);

        //Обработка полученного значения

        if (attribute.getValue() > 0)
            m_protocolView.PrintLine("Значение переменной равно " + attribute.getValue() + "/100*60");
            attribute.setValue(attribute.getValue()/100*60);
        else
            m_protocolView.PrintLine("Полученное значение переменной " + attribute.getValue() + " <= 0, полагаем равным 0");
            attribute.setValue($0.0);
        end;
    end;

    macro calculateEq104_2_2NotImplPositive(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_104.2.2_полож_ввод"),
                               RcbArray(),
                               true);
        else
            var sum = m_part.getAttribute("Eq2_1_6").getValue(); 

            if (sum > 0)
                m_protocolView.PrintLine("Eq2_1_6 (" + sum + ") > 0");

                sum = m_part.getAttribute("Eq_104.2.2_нереал_полож_данные").getValue();

                m_protocolView.PrintLine("Значение переменной равно значению переменной Eq_104.2.2_нереал_полож_данные (" + sum + ")");
                setValue(attribute, sum);
            else
                m_protocolView.PrintLine("Eq2_1_6 (" + sum + ") <= 0");
                setValue(attribute, $0.0);
            end;
        end;
    end;

    macro calculateEq104_2_2NotImplNegativeData(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        
        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("Eq_104.2.2_нереал_полож_данныеСумма2"),
                           RcbArray().initialize("Eq_104.2.2_нереал_полож_данныеСумма1"),
                           true);

        //Обработка полученного значения

        if (attribute.getValue() > 0)
            attribute.setValue(attribute.getValue());
        else
            m_protocolView.PrintLine("Полученное значение переменной " + attribute.getValue() + " <= 0, полагаем равным 0");
            attribute.setValue($0.0);
        end;
    end;


    macro calculateEq104_2_2NotImplNegative(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_104.2.2_отриц_ввод"),
                               RcbArray(),
                               true);
        else
            var sum = m_part.getAttribute("Eq2_1_6").getValue(); 

            if (sum > 0)
                m_protocolView.PrintLine("Eq2_1_6 (" + sum + ") > 0");

                sum = m_part.getAttribute("Eq_104.2.2_нереал_отриц_данные").getValue();

                m_protocolView.PrintLine("Значение переменной равно значению переменной Eq_104.2.2_нереал_отриц_данные (" + sum + ")");
                setValue(attribute, sum);
            else
                m_protocolView.PrintLine("Eq2_1_6 (" + sum + ") <= 0");
                setValue(attribute, $0.0);
            end;
        end;
    end;

    macro calculateEqPriviousProfit(attributeId : String) 
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = null;
        var filter     = null;
        
        dataSource = m_dataSources.getDataSource("CbAccount");
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        //1
        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("70302, 70701, 70703, 70704, 70705");

        setValue(attribute, dataSource.getData(filter, attribute));

        //2

        setValueAttributes(attribute,
                           RcbArray().initialize("Eq_10801_без_ПФИ", "Eq_70801_без_ПФИ", "Eq_106.1_пред_лет"),
                           RcbArray().initialize("Eq_10901_без_ПФИ", "Eq_70802_без_ПФИ"));

        //3
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70702").op("AND").isReportingCategoryExists("ТСС");

        plusValue(attribute, dataSource.getData(filter, attribute));

        //4
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70402, 70706, 70708, 70709, 70710, 70711, 70712");

        minusValue(attribute, dataSource.getData(filter, attribute));

        //5
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70707").op("AND").isReportingCategoryExists("ТСС");

        minusValue(attribute, dataSource.getData(filter, attribute));
    end;

    macro calculateEq10801withoutPFI_Sum1(attributeId : String) 
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = m_dataSources.getDataSource("CbAccountNote");
        var filter     = m_dataSouceFilters.getFilter("CbAccount");
        
        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10801");

        setValue(attribute, dataSource.getData(filter, attribute, PROFIT_WITHIOUT_PFI_NOTE_ID));
    end;

    macro calculateEq10801withoutPFI_Sum2(attributeId : String) 
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = m_dataSources.getDataSource("CbAccount");
        var filter     = m_dataSouceFilters.getFilter("CbAccount");
        
        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10801").op("AND").op("NOT").isExistAccountNote(PROFIT_WITHIOUT_PFI_NOTE_ID);

        setValue(attribute, dataSource.getData(filter, attribute));
    end;

    macro calculateEq10801withoutPFI(attributeId : String) 
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("Eq_10801_без_ПФИ_Сумма1", "Eq_10801_без_ПФИ_Сумма2"),
                           RcbArray());
    end;

    macro calculateEq10901withoutPFI_Sum1(attributeId : String) 
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = m_dataSources.getDataSource("CbAccountNote");
        var filter     = m_dataSouceFilters.getFilter("CbAccount");
        
        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10901");

        setValue(attribute, dataSource.getData(filter, attribute, PROFIT_WITHIOUT_PFI_NOTE_ID));
    end;

    macro calculateEq10901withoutPFI_Sum2(attributeId : String) 
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = m_dataSources.getDataSource("CbAccount");
        var filter     = m_dataSouceFilters.getFilter("CbAccount");
        
        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10901").op("AND").op("NOT").isExistAccountNote(PROFIT_WITHIOUT_PFI_NOTE_ID);

        setValue(attribute, dataSource.getData(filter, attribute));
    end;

    macro calculateEq10901withoutPFI(attributeId : String) 
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("Eq_10901_без_ПФИ_Сумма1", "Eq_10901_без_ПФИ_Сумма2"),
                           RcbArray());
    end;

    macro calculateEq70801withoutPFI_Sum1(attributeId : String) 
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = m_dataSources.getDataSource("CbAccountNote");
        var filter     = m_dataSouceFilters.getFilter("CbAccount");
        
        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70801");

        setValue(attribute, dataSource.getData(filter, attribute, PROFIT_WITHIOUT_PFI_NOTE_ID));
    end;

    macro calculateEq70801withoutPFI_Sum2(attributeId : String) 
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = m_dataSources.getDataSource("CbAccount");
        var filter     = m_dataSouceFilters.getFilter("CbAccount");
        
        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70801").op("AND").op("NOT").isExistAccountNote(PROFIT_WITHIOUT_PFI_NOTE_ID);

        setValue(attribute, dataSource.getData(filter, attribute));
    end;

    macro calculateEq70801withoutPFI(attributeId : String) 
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("Eq_70801_без_ПФИ_Сумма1", "Eq_70801_без_ПФИ_Сумма2"),
                           RcbArray());
    end;

    macro calculateEq70802withoutPFI_Sum1(attributeId : String) 
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = m_dataSources.getDataSource("CbAccountNote");
        var filter     = m_dataSouceFilters.getFilter("CbAccount");
        
        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70802");

        setValue(attribute, dataSource.getData(filter, attribute, PROFIT_WITHIOUT_PFI_NOTE_ID));
    end;

    macro calculateEq70802withoutPFI_Sum2(attributeId : String) 
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = m_dataSources.getDataSource("CbAccount");
        var filter     = m_dataSouceFilters.getFilter("CbAccount");
        
        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70802").op("AND").op("NOT").isExistAccountNote(PROFIT_WITHIOUT_PFI_NOTE_ID);

        setValue(attribute, dataSource.getData(filter, attribute));
    end;
          
    macro calculateEq70802withoutPFI(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("Eq_70802_без_ПФИ_Сумма1", "Eq_70802_без_ПФИ_Сумма2"),
                           RcbArray().initialize());
    end;

    macro calculateEqPriviousYearProfit(attributeId : String) 
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = m_dataSources.getDataSource("CbAccount");
        var filter     = m_dataSouceFilters.getFilter("CbAccount");
        
        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70701, 70703, 70704, 70705");

        setValue(attribute, dataSource.getData(filter, attribute));

        //2
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70702").op("AND").isReportingCategoryExists("ТСС");

        plusValue(attribute, dataSource.getData(filter, attribute));

        //3
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70706, 70708, 70709, 70710, 70711, 70712");

        minusValue(attribute, dataSource.getData(filter, attribute));

        //4
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70707").op("AND").isReportingCategoryExists("ТСС");

        minusValue(attribute, dataSource.getData(filter, attribute));

        //5
        setValueAttributes(attribute,
                           RcbArray().initialize("Eq_70801_без_ПФИ", "Eq_106.1_прошл_года"),
                           RcbArray().initialize("Eq_70802_без_ПФИ"));
    end;

    macro calculateEq2_1_11(attributeId : String)
//msgbox("in macro 2_1_11");
        var attribute = m_part.getAttribute(attributeId);
        var NoAcsMon = $0;
        printAttributeHead(attributeId);

        var sumEqprevYears = m_part.getAttribute("Eq_Прибыль_пред_лет").getValue();
	f134Parameters.ПрибыльПрошлогоГодаПодтверждена = true;
        if (f134Parameters.ПрибыльПрошлогоГодаПодтверждена)
             m_protocolView.printLine("Прибыль прошлого года подтверждена.");


         NoAcsMon=$2850595000;
        Getmoney (NoAcsMon, "Подтвержд. прибыль, руб", 10);                          //GSP
                    setValue(attribute, NoAcsMon);

/*             if (sumEqprevYears > 0)
                setValueAttributes(attribute,
                                   RcbArray().initialize("Eq_Прибыль_пред_лет"),
                                   RcbArray());
             else
                setValueAttributes(attribute,
                                   RcbArray().initialize("Eq_Прибыль_прошл_года"),
                                   RcbArray(),
                                   true);
             end;
*/
        else
            m_protocolView.printLine("Прибыль прошлого года не подтверждена.");
            if (f134Parameters.unconfirmedProfitPreviousYear == "2.1.11")
                var sumEq2_1_6prev = m_report.getPreviousReport().getPart("1").getAttribute("Eq2_1_6").getValue();
                m_protocolView.printLine("Значение переменной равно min(Eq_Прибыль_пред_лет(" + sumEqprevYears + "), Eq2_1_6 за предыдущий период(" + sumEq2_1_6prev + "))");
                setValue(attribute, min(sumEqprevYears, nvl(sumEq2_1_6prev, $0.0)));
                if (attribute.getValue() < 0)
                    m_protocolView.PrintLine(attribute.getId() + "(" + attribute.getValue() + ") < 0");
                    setValue(attribute, $0.0);
                end;
            else
                m_protocolView.printLine("Настройка реестра 'НЕПОДТВ. ПРИБЫЛЬ ПРЕДШЕСТВ. ЛЕТ' имеет значение '3.9'");
                m_protocolView.printLine("Значение переменной равно нулю.");
            end;
        end;
    end;
    
    macro calculateEq106_1PrevYears(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("Eq_106.1.1_пред_лет", "Eq_106.1.2_нереал_полож_пред_лет"),
                           RcbArray().initialize("Eq_106.1.2_нереал_отриц_пред_лет"),
                           true);
    end;

    macro calculateEq106_1PrevYear(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("Eq_106.1.1_прошл_года", "Eq_106.1.2_нереал_полож_прошл_года"),
                           RcbArray().initialize("Eq_106.1.2_нереал_отриц_прошл_года"),
                           true);
    end;

    macro calculateEq106_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_106.1.1_ввод", "Строка_106.1.2_полож_ввод"),
                               RcbArray().initialize("Строка_106.1.2_отриц_ввод"),
                               true);
        else

            if (f134Parameters.ПрибыльПрошлогоГодаПодтверждена)
                m_protocolView.printLine("Прибыль прошлого года подтверждена.");

                if (m_part.getAttribute("Eq_Прибыль_пред_лет").getValue() > 0)
                   setValueAttributes(attribute,
                                      RcbArray().initialize("Eq_106.1_пред_лет"),
                                      RcbArray());
                else
                   setValueAttributes(attribute,
                                      RcbArray().initialize("Eq_106.1_прошл_года"),
                                      RcbArray(),
                                      true);
                end;
            else
                m_protocolView.printLine("Прибыль прошлого года не подтверждена.");
                if (f134Parameters.unconfirmedProfitPreviousYear == "2.1.11")
                    var sumEq104_2prev = m_report.getPreviousReport().getPart("1").getAttribute("Eq_104.2").getValue();
                    var sumEq_106_1prevYars = m_part.getAttribute("Eq_106.1_пред_лет").getValue();

                    m_protocolView.printLine("Значение переменной равно min(Eq_106.1_пред_лет(" + sumEq_106_1prevYars + "), Eq_104.2 за предыдущий период(" + sumEq104_2prev + "))");
                    setValue(attribute, min(sumEq_106_1prevYars, nvl(sumEq104_2prev, $0.0)));

                    if (attribute.getValue() < 0)
                        m_protocolView.PrintLine(attribute.getId() + "(" + attribute.getValue() + ") < 0");
                        setValue(attribute, $0.0);
                    end;
                else
                    m_protocolView.printLine("Настройка реестра 'НЕПОДТВ. ПРИБЫЛЬ ПРЕДШЕСТВ. ЛЕТ' имеет значение '3.9'");
                    m_protocolView.printLine("Значение переменной равно нулю.");
                end;
            end;
        end;
    end;

    macro calculateEq106_1_1PrevYears_Sum1(attributeId : String) 
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = m_dataSources.getDataSource("CbAccountNote");
        var filter     = m_dataSouceFilters.getFilter("CbAccount");
        
        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10801");

        setValue(attribute, dataSource.getData(filter, attribute, PFI_IMPL_NOTE_ID));
    end;
    
    macro calculateEq106_1_1PrevYears_Sum2(attributeId : String) 
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = m_dataSources.getDataSource("CbAccountNote");
        var filter     = m_dataSouceFilters.getFilter("CbAccount");
        
        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10901");

        setValue(attribute, dataSource.getData(filter, attribute, PFI_IMPL_NOTE_ID));
    end;
    
    macro calculateEq106_1_1PrevYears(attributeId : String) 
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (global.getRcbReport().context.period.endDate < getCostTransferDate())
            setValueAttributes(attribute,
                               RcbArray().initialize("Eq_106.1.1_прошл_года", "Eq_106.1.1_пред_лет_Сумма1"),
                               RcbArray().initialize("Eq_106.1.1_пред_лет_Сумма2"));
        else
            setValueAttributes(attribute,
                               RcbArray().initialize("Eq_106.1.1_пред_лет_Сумма1"),
                               RcbArray().initialize("Eq_106.1.1_пред_лет_Сумма2"));
        end;

    end;

    macro calculateEq106_1_1PrevYear_Sum1(attributeId : String) 
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        //Сумма 1
        var dataSource = m_dataSources.getDataSource("CbDocument");
        var filter     = m_dataSouceFilters.getFilter("CbDocument");

        filter.setDateCary(date(1, 1, getYear(global.getRcbReport().context.period.endDate)-1), date(31, 1, getYear(global.getRcbReport().context.period.endDate)-1));
        filter.op("AND").isSatisfiesToBalanceMasks("61601*", true).op("AND").isSatisfiesToBalanceMasks("70613*", false).op("AND").isOpuSymbolEqualTo("16101", false);

        setValue(attribute, dataSource.getData(filter, attribute));
    
        //Сумма 2
        filter     = m_dataSouceFilters.getFilter("CbDocument");

        filter.setDateCary(date(1, 1, getYear(global.getRcbReport().context.period.endDate)-1), date(31, 1, getYear(global.getRcbReport().context.period.endDate)-1));
        filter.op("AND").isSatisfiesToBalanceMasks("70613*", true).op("AND").isSatisfiesToBalanceMasks("61601*", false).op("AND").isOpuSymbolEqualTo("16101", true);

        minusValue(attribute, dataSource.getData(filter, attribute));
    
        //Сумма 3
        filter     = m_dataSouceFilters.getFilter("CbDocument");

        filter.setDateCary(date(1, 1, getYear(global.getRcbReport().context.period.endDate)), getSpodEndDate());
        filter.op("AND").isSatisfiesToBalanceMasks("61601*", true).op("AND").isSatisfiesToBalanceMasks("70713*", false).op("AND").isOpuSymbolEqualTo("16101", false).op("AND").isSpod();

        plusValue(attribute, dataSource.getData(filter, attribute));
    
        //Сумма 4
        filter     = m_dataSouceFilters.getFilter("CbDocument");

        filter.setDateCary(date(1, 1, getYear(global.getRcbReport().context.period.endDate)), getSpodEndDate());
        filter.op("AND").isSatisfiesToBalanceMasks("61601*", true).op("AND").isSatisfiesToBalanceMasks("70613*", false).op("AND").isOpuSymbolEqualTo("16101", false);

        minusValue(attribute, dataSource.getData(filter, attribute));

        //Сумма 5
        setValueAttributes(attribute,
                           RcbArray().initialize("Eq_док_подтв_суммы_доход_ПрошлГ_ввод"),
                           RcbArray());
    end;

    macro calculateEq106_1_1PrevYear_Sum2(attributeId : String) 
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        //Сумма 1
        var dataSource = m_dataSources.getDataSource("CbDocument");
        var filter     = m_dataSouceFilters.getFilter("CbDocument");

        filter.setDateCary(date(1, 1, getYear(global.getRcbReport().context.period.endDate)-1), date(31, 1, getYear(global.getRcbReport().context.period.endDate)-1));
        filter.op("AND").isSatisfiesToBalanceMasks("70614*", true).op("AND").isSatisfiesToBalanceMasks("61601*", false).op("AND").isOpuSymbolEqualTo("25101", true);

        setValue(attribute, dataSource.getData(filter, attribute));
    
        //Сумма 2
        filter     = m_dataSouceFilters.getFilter("CbDocument");

        filter.setDateCary(date(1, 1, getYear(global.getRcbReport().context.period.endDate)-1), date(31, 1, getYear(global.getRcbReport().context.period.endDate)-1));
        filter.op("AND").isSatisfiesToBalanceMasks("61601*", true).op("AND").isSatisfiesToBalanceMasks("70614*", false).op("AND").isOpuSymbolEqualTo("25101", false);

        minusValue(attribute, dataSource.getData(filter, attribute));
    
        //Сумма 3
        filter     = m_dataSouceFilters.getFilter("CbDocument");

        filter.setDateCary(date(1, 1, getYear(global.getRcbReport().context.period.endDate)), getSpodEndDate());
        filter.op("AND").isSatisfiesToBalanceMasks("70714*", true).op("AND").isSatisfiesToBalanceMasks("61601*", false).op("AND").isOpuSymbolEqualTo("25101", true).op("AND").isSpod();

        plusValue(attribute, dataSource.getData(filter, attribute));
    
        //Сумма 4
        filter     = m_dataSouceFilters.getFilter("CbDocument");

        filter.setDateCary(date(1, 1, getYear(global.getRcbReport().context.period.endDate)), getSpodEndDate());
        filter.op("AND").isSatisfiesToBalanceMasks("61601*", true).op("AND").isSatisfiesToBalanceMasks("70714*", false).op("AND").isOpuSymbolEqualTo("25101", false);

        minusValue(attribute, dataSource.getData(filter, attribute));

        //Сумма 5
        setValueAttributes(attribute,
                           RcbArray().initialize("Eq_док_подтв_суммы_расход_ПрошлГ_ввод"),
                           RcbArray());
    end;

    macro calculateEq106_1_1PrevYear(attributeId : String) 
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("Eq_106.1.1_прошл_года_Сумма1"),
                           RcbArray().initialize("Eq_106.1.1_прошл_года_Сумма2"));

    end;


    macro calculateEq106_1_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_106.1.1_ввод"),
                               RcbArray(),
                               true);
        else

            if (f134Parameters.ПрибыльПрошлогоГодаПодтверждена)
                m_protocolView.printLine("Прибыль прошлого года подтверждена.");

                if (m_part.getAttribute("Eq_Прибыль_пред_лет").getValue() > 0)
                   setValueAttributes(attribute,
                                      RcbArray().initialize("Eq_106.1.1_пред_лет"),
                                      RcbArray());
                else
                   setValueAttributes(attribute,
                                      RcbArray().initialize("Eq_106.1.1_прошл_года"),
                                      RcbArray(),
                                      true);
                end;
            else
                m_protocolView.printLine("Прибыль прошлого года не подтверждена.");
                if (f134Parameters.unconfirmedProfitPreviousYear == "2.1.11")
                    var sumEq104_2_1prev = m_report.getPreviousReport().getPart("1").getAttribute("Eq_104.2.1").getValue();
                    var sumEq_106_1_1prevYars = m_part.getAttribute("Eq_106.1.1_пред_лет").getValue();

                    m_protocolView.printLine("Значение переменной равно min(Eq_106.1.1_пред_лет(" + sumEq_106_1_1prevYars + "), Eq_104.2.1 за предыдущий период(" + sumEq104_2_1prev + "))");
                    setValue(attribute, min(sumEq_106_1_1prevYars, nvl(sumEq104_2_1prev, $0.0)));

                    if (attribute.getValue() < 0)
                        m_protocolView.PrintLine(attribute.getId() + "(" + attribute.getValue() + ") < 0");
                        setValue(attribute, $0.0);
                    end;
                else
                    m_protocolView.printLine("Настройка реестра 'НЕПОДТВ. ПРИБЫЛЬ ПРЕДШЕСТВ. ЛЕТ' имеет значение '3.9'");
                    m_protocolView.printLine("Значение переменной равно нулю.");
                end;
            end;
        end;
    end;

    macro calculateEq106_1_2prevYears(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (m_part.getAttribute("Eq_106.1.2_нереал_полож_пред_лет").getValue() > 0)
           setValueAttributes(attribute,
                              RcbArray().initialize("Eq_106.1.2_нереал_полож_пред_лет"),
                              RcbArray());
        else
           setValueAttributes(attribute,
                              RcbArray().initialize("Eq_106.1.2_нереал_отриц_пред_лет"),
                              RcbArray());
        end;
    end;

    macro calculateEq106_1_2prevYear(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (m_part.getAttribute("Eq_106.1.2_нереал_полож_прошл_года").getValue() > 0)
           setValueAttributes(attribute,
                              RcbArray().initialize("Eq_106.1.2_нереал_полож_прошл_года"),
                              RcbArray());
        else
           setValueAttributes(attribute,
                              RcbArray().initialize("Eq_106.1.2_нереал_отриц_прошл_года"),
                              RcbArray());
        end;
    end;

    macro calculateEq106_1_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            if (m_part.getAttribute("Строка_106.1.2_полож_ввод").getValue() > 0)
               setValueAttributes(attribute,
                                  RcbArray().initialize("Строка_106.1.2_полож_ввод"),
                                  RcbArray());
            else
               setValueAttributes(attribute,
                                  RcbArray().initialize("Строка_106.1.2_отриц_ввод"),
                                  RcbArray());
            end;
        else

            if (f134Parameters.ПрибыльПрошлогоГодаПодтверждена)
                m_protocolView.printLine("Прибыль прошлого года подтверждена.");

                if (m_part.getAttribute("Eq_Прибыль_пред_лет").getValue() >= 0)
                   setValueAttributes(attribute,
                                      RcbArray().initialize("Eq_106.1.2_пред_лет"),
                                      RcbArray());
                else
                   setValueAttributes(attribute,
                                      RcbArray().initialize("Eq_106.1.2_прошл_года"),
                                      RcbArray(),
                                      true);
                end;
            else
                m_protocolView.printLine("Прибыль прошлого года не подтверждена.");
                if (f134Parameters.unconfirmedProfitPreviousYear == "2.1.11")
                    var sumEq104_2_2prev = m_report.getPreviousReport().getPart("1").getAttribute("Eq_104.2.2").getValue();
                    var sumEq_106_1_2prevYars = m_part.getAttribute("Eq_106.1.2_пред_лет").getValue();

                    m_protocolView.printLine("Значение переменной равно min(Eq_106.1.2_пред_лет(" + sumEq_106_1_2prevYars + "), Eq_104.2.2 за предыдущий период(" + sumEq104_2_2prev + "))");
                    setValue(attribute, min(sumEq_106_1_2prevYars, nvl(sumEq104_2_2prev, $0.0)));

                    if (attribute.getValue() < 0)
                        m_protocolView.PrintLine(attribute.getId() + "(" + attribute.getValue() + ") < 0");
                        setValue(attribute, $0.0);
                    end;
                else
                    m_protocolView.printLine("Настройка реестра 'НЕПОДТВ. ПРИБЫЛЬ ПРЕДШЕСТВ. ЛЕТ' имеет значение '3.9'");
                    m_protocolView.printLine("Значение переменной равно нулю.");
                end;
            end;
        end;
    end;

    macro calculateEq106_1_2NotImplPrevYears_Sum1(attributeId : String) 
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = m_dataSources.getDataSource("CbAccountNote");
        var filter     = m_dataSouceFilters.getFilter("CbAccount");
        
        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10801");

        setValue(attribute, dataSource.getData(filter, attribute, PROFIT_NOT_IMPL_NOTE_ID));
    end;
    
    macro calculateEq106_1_2NotImplPrevYears_Sum2(attributeId : String) 
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = m_dataSources.getDataSource("CbAccountNote");
        var filter     = m_dataSouceFilters.getFilter("CbAccount");
        
        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10901");

        setValue(attribute, dataSource.getData(filter, attribute, PROFIT_NOT_IMPL_NOTE_ID));
    end;
    
    macro calculateEq106_1_2NotImplPrevYears(attributeId : String) 
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_106.1.2_полож_ввод"),
                               RcbArray());
        else

            setValueAttributes(attribute,
                               RcbArray().initialize("Eq_106.1.2_нереал_полож_пред_лет_Сумма1", "Eq_106.1.2_нереал_полож_прошл_года"),
                               RcbArray().initialize("Eq_106.1.2_нереал_полож_пред_лет_Сумма2"));


            if (attribute.getValue() > 0)
                m_protocolView.PrintLine("Значение переменной равно " + attribute.getValue() + "/100*60");
                attribute.setValue(attribute.getValue()/100*60);
            else
                m_protocolView.PrintLine("Полученное значение переменной " + attribute.getValue() + " <= 0, полагаем равным 0");
                attribute.setValue($0.0);
            end;
        end;
    end;

    macro calculateEq106_1_2NotImplPrevYear_Sum1(attributeId : String) 
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        //1
        var dataSource = m_dataSources.getDataSource("CbDocument");
        var filter     = m_dataSouceFilters.getFilter("CbDocument");

        filter.setDateCary(date(1, 1, getYear(global.getRcbReport().context.period.endDate)), getSpodEndDate());
        filter.op("AND").isSatisfiesToBalanceMasks("70713*", true).op("AND").isSatisfiesToBalanceMasks("70801*", false);

        setValue(attribute, dataSource.getData(filter, attribute));

        //2
        filter     = m_dataSouceFilters.getFilter("CbDocument");

        filter.setDateCary(date(1, 1, getYear(global.getRcbReport().context.period.endDate)), getSpodEndDate());
        filter.op("AND").isSatisfiesToBalanceMasks("70801*", true).op("AND").isSatisfiesToBalanceMasks("70713*", false);

        minusValue(attribute, dataSource.getData(filter, attribute));

        //3
        dataSource = m_dataSources.getDataSource("CbAccount");
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70713").op("AND").isReportingCategoryExists("ПФИ: искл. из  10.2");

        minusValue(attribute, dataSource.getData(filter, attribute));

        //4
        setValueAttributes(attribute,
                           RcbArray().initialize("Eq_70713_нер_корр_ввод"),
                           RcbArray().initialize("Eq_106.1.1_прошл_года_Сумма1"));

    end;

    macro calculateEq106_1_2NotImplPrevYear_Sum2(attributeId : String) 
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        //1
        var dataSource = m_dataSources.getDataSource("CbDocument");
        var filter     = m_dataSouceFilters.getFilter("CbDocument");

        filter.setDateCary(date(1, 1, getYear(global.getRcbReport().context.period.endDate)), getSpodEndDate());
        filter.op("AND").isSatisfiesToBalanceMasks("70802*", true).op("AND").isSatisfiesToBalanceMasks("70714*", false);

        setValue(attribute, dataSource.getData(filter, attribute));

        //2
        filter     = m_dataSouceFilters.getFilter("CbDocument");

        filter.setDateCary(date(1, 1, getYear(global.getRcbReport().context.period.endDate)), getSpodEndDate());
        filter.op("AND").isSatisfiesToBalanceMasks("70714*", true).op("AND").isSatisfiesToBalanceMasks("70802*", false);

        minusValue(attribute, dataSource.getData(filter, attribute));

        //3
        setValueAttributes(attribute,
                           RcbArray().initialize("Eq_70614_нер_корр_ввод"),
                           RcbArray().initialize("Eq_106.1.1_прошл_года_Сумма2"));

    end;

    macro calculateEq106_1_2NotImplPrevYear(attributeId : String) 
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_106.1.2_полож_ввод"),
                               RcbArray());
        else

            setValueAttributes(attribute,
                               RcbArray().initialize("Eq_106.1.2_нереал_полож_прошл_года_Сумма1"),
                               RcbArray().initialize("Eq_106.1.2_нереал_полож_прошл_года_Сумма2"));


            if (attribute.getValue() > 0)
                m_protocolView.PrintLine("Значение переменной равно " + attribute.getValue() + "/100*60");
                attribute.setValue(attribute.getValue()/100*60);
            else
                m_protocolView.PrintLine("Полученное значение переменной " + attribute.getValue() + " <= 0, полагаем равным 0");
                attribute.setValue($0.0);
            end;
        end;
    end;

    macro calculateEq106_1_2NotImplPositive(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.ПрибыльПрошлогоГодаПодтверждена)
             m_protocolView.printLine("Прибыль прошлого года подтверждена.");

             if (m_part.getAttribute("Eq_Прибыль_пред_лет").getValue() > 0)
                setValueAttributes(attribute,
                                   RcbArray().initialize("Eq_106.1.2_нереал_полож_пред_лет"),
                                   RcbArray());
             else
                setValueAttributes(attribute,
                                   RcbArray().initialize("Eq_106.1.2_нереал_полож_прошл_года"),
                                   RcbArray(),
                                   true);
             end;
        else
            m_protocolView.printLine("Прибыль прошлого года не подтверждена.");
            if (f134Parameters.unconfirmedProfitPreviousYear == "2.1.11")
                var sumA = m_part.getAttribute("Eq_106.1.2_нереал_полож_пред_лет").getValue();
                var sumB = m_report.getPreviousReport().getPart("1").getAttribute("Eq_104.2.2_нереал_полож").getValue();
                m_protocolView.printLine("Значение переменной равно min(Eq_106.1.2_нереал_полож_пред_лет(" + sumA + "), Eq_104.2.2_нереал_полож за предыдущий период(" + sumB + "))");
                setValue(attribute, min(sumA, nvl(sumB, $0.0)));
                if (attribute.getValue() < 0)
                    m_protocolView.PrintLine(attribute.getId() + "(" + attribute.getValue() + ") < 0");
                    setValue(attribute, $0.0);
                end;
            else
                m_protocolView.printLine("Настройка реестра 'НЕПОДТВ. ПРИБЫЛЬ ПРЕДШЕСТВ. ЛЕТ' имеет значение '3.9'");
                m_protocolView.printLine("Значение переменной равно нулю.");
            end;
        end;
    end;


    macro calculateEq106_1_2NotImplNegativePrevYears(attributeId : String) 
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_106.1.2_отриц_ввод"),
                               RcbArray());
        else

            setValueAttributes(attribute,
                               RcbArray().initialize("Eq_106.1.2_нереал_полож_пред_лет_Сумма2", "Eq_106.1.2_нереал_отриц_прошл_года"),
                               RcbArray().initialize("Eq_106.1.2_нереал_полож_пред_лет_Сумма1"));

            var atributeSum1 = m_part.getAttribute("Eq_106.1.2_нереал_полож_пред_лет_Сумма1");
            var atributeSum2 = m_part.getAttribute("Eq_106.1.2_нереал_полож_пред_лет_Сумма2");

            if (attribute.getValue() > 0)
                m_protocolView.PrintLine("Полученное значение " + attribute.getValue() + " > 0");
                m_protocolView.PrintLine(attribute.getId() + " = " + atributeSum2.getId() + "(" + atributeSum2.getValue() + ") - " + atributeSum1.getId() + "(" + atributeSum1.getValue() + ")");
                attribute.setValue(atributeSum2.getValue() - atributeSum1.getValue());
            else
                m_protocolView.PrintLine("Полученное значение переменной " + attribute.getValue() + " <= 0, полагаем равным 0");
                attribute.setValue($0.0);
            end;
        end;
    end;

    macro calculateEq106_1_2NotImplNegativePrevYear(attributeId : String) 
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_106.1.2_отриц_ввод"),
                               RcbArray());
        else

            setValueAttributes(attribute,
                               RcbArray().initialize("Eq_106.1.2_нереал_полож_прошл_года_Сумма2"),
                               RcbArray().initialize("Eq_106.1.2_нереал_полож_прошл_года_Сумма1"));

            if (attribute.getValue() <= 0)
                m_protocolView.PrintLine("Полученное значение переменной " + attribute.getValue() + " <= 0, полагаем равным 0");
                attribute.setValue($0.0);
            end;
        end;
    end;


    macro calculateEq106_1_2NotImplNegative(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.ПрибыльПрошлогоГодаПодтверждена)
             m_protocolView.printLine("Прибыль прошлого года подтверждена.");

             if (m_part.getAttribute("Eq_Прибыль_пред_лет").getValue() > 0)
                setValueAttributes(attribute,
                                   RcbArray().initialize("Eq_106.1.2_нереал_отриц_пред_лет"),
                                   RcbArray());
             else
                setValueAttributes(attribute,
                                   RcbArray().initialize("Eq_106.1.2_нереал_отриц_прошл_года"),
                                   RcbArray(),
                                   true);
             end;
        else
            m_protocolView.printLine("Прибыль прошлого года не подтверждена.");
            if (f134Parameters.unconfirmedProfitPreviousYear == "2.1.11")
                var sumA = m_part.getAttribute("Eq_106.1.2_нереал_отриц_пред_лет").getValue();
                var sumB = m_report.getPreviousReport().getPart("1").getAttribute("Eq_104.2.2_нереал_отриц").getValue();
                m_protocolView.printLine("Значение переменной равно min(Eq_106.1.2_нереал_отриц_пред_лет(" + sumA + "), Eq_104.2.2_нереал_отриц за предыдущий период(" + sumB + "))");
                setValue(attribute, min(sumA, nvl(sumB, $0.0)));
                if (attribute.getValue() < 0)
                    m_protocolView.PrintLine(attribute.getId() + "(" + attribute.getValue() + ") < 0");
                    setValue(attribute, $0.0);
                end;
            else
                m_protocolView.printLine("Настройка реестра 'НЕПОДТВ. ПРИБЫЛЬ ПРЕДШЕСТВ. ЛЕТ' имеет значение '3.9'");
                m_protocolView.printLine("Значение переменной равно нулю.");
            end;
        end;
    end;

    macro calculateEq2_1_12data(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        
        printAttributeHead(attributeId);

        var dataSource = null;
        var filter     = null;
        
        dataSource = m_dataSources.getDataSource("CbAccountSubCredit");
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("31309, 31409, 31509, 31609, 41107, 41207, 41307, 41407, 41507, 41607, 41707, 41807, 41907, 42007, 42107, 42207, 42507, 42807, 42907, 43007, 43107, 43207, 43307, 43407, 43507, 43607, 43707, 43807, 43907, 44007, 52006");
        filter.op("AND").isReportingCategoryExists("Субкредит 2.1.12");

        setValue(attribute, dataSource.getData(filter, attribute));
    end;


    macro calculateEq2_1_12(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        
        printAttributeHead(attributeId);


        setValueAttributes(attribute,
                           RcbArray().initialize("Eq2_1_1(2_1_2)","Eq2_1_3(2_1_4)","Eq2_1_5","Eq2_1_6","Eq2_1_7","Eq2_1_11"),
                           RcbArray().initialize("Eq2_2_1","Eq2_2_2(2_2_3)","Eq2_2_4","Eq2_2_5","Eq2_2_6","Eq2_2_8","Eq2_2_9"));

        var attributeEq2_1_12data = m_part.getAttribute("Eq2_1_12данные");

        m_protocolView.PrintLine("Значение переменной равно min(0.15*" + attribute.getValue() + ", " + attributeEq2_1_12data.getId() + "(" + attributeEq2_1_12data.getValue() + "))");

        attribute.setValue(min(0.15 * attribute.getValue(), attributeEq2_1_12data.getValue()));

        m_protocolView.PrintLine(attribute.getId() + " = " + attribute.getValue());
    end;

    macro calculateEqMainReal(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        
        printAttributeHead(attributeId);


        setValueAttributes(attribute,
                           RcbArray().initialize("Eq2_1_1(2_1_2)","Eq2_1_3(2_1_4)","Eq2_1_5","Eq2_1_6","Eq2_1_7","Eq2_1_11", "Eq2_1_12"),
                           RcbArray());
    end;


    macro calculateEq2_2_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        
        printAttributeHead(attributeId);

        var dataSource = null;
        var filter     = null;
        
        //1
        dataSource = m_dataSources.getDataSource("CbAccount");
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("60901, 60905");

        setValue(attribute, dataSource.getData(filter, attribute));

        //2
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("60701").op("AND").isReportingCategoryExists("НМА");

        plusValue(attribute, dataSource.getData(filter, attribute));

        //3
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("60903");

        minusValue(attribute, dataSource.getData(filter, attribute));
    end;

    macro calculateEq2_2_2__2_2_3(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        
        printAttributeHead(attributeId);

        var dataSource = null;
        var filter     = null;
        
        dataSource = m_dataSources.getDataSource("CbAccount");
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("10501");

        setValue(attribute, dataSource.getData(filter, attribute));

        if (nvl(attribute.getValue(), $0.0) != $0.0)
            setValueAttributes(attribute,
                               RcbArray().initialize("Eq2_2_2(2_2_3)ввод"),
                               RcbArray());
        else
            m_protocolView.PrintLine("Остаток на счете 10501 равен нулю, проверяем счет 10502");

            dataSource = m_dataSources.getDataSource("CbAccountNote");
            filter     = m_dataSouceFilters.getFilter("CbAccount");
            
            filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10502");

            setValue(attribute, dataSource.getData(filter, attribute, NOTEKIND_BOUGHT_OUT_COST));

            if (nvl(attribute.getValue(), $0.0) == $0.0)
                m_protocolView.PrintLine("Значение примечания \"Стоимость выкупленных долей\" на счете 10501 равно нулю, проверяем остатки.");
                dataSource = m_dataSources.getDataSource("CbAccount");

                setValue(attribute, dataSource.getData(filter, attribute));
            end;
        end;
    end;

    macro calculateEq2_2_4(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        
        printAttributeHead(attributeId);

        if (m_part.getAttribute("Eq_Прибыль_пред_лет").getValue() <= 0)
            m_protocolView.PrintLine("Eq_Прибыль_пред_лет <= 0");
            if (m_part.getAttribute("Eq_Прибыль_прошл_года").getValue() >= 0)
                m_protocolView.PrintLine("Eq_Прибыль_прошл_года >= 0");
                setValueAttributes(attribute,
                                   RcbArray().initialize("Eq_Прибыль_прошл_года"),
                                   RcbArray().initialize("Eq_Прибыль_пред_лет"));
            else
                m_protocolView.PrintLine("Eq_Прибыль_прошл_года < 0");
                setValueAttributes(attribute,
                                   RcbArray(),
                                   RcbArray().initialize("Eq_Прибыль_пред_лет"));
            end;
            
        else
            m_protocolView.PrintLine("Eq_Прибыль_пред_лет > 0");
            setValue(attribute, $0.0);
        end;
    end;

    macro calculateEq111_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_111.1.1_ввод", "Строка_111.1.2_отриц_ввод"),
                               RcbArray().initialize("Строка_111.1.2_полож_ввод"),
                               true);
        else
            if (m_part.getAttribute("Eq_Прибыль_пред_лет").getValue() <= 0)
                m_protocolView.PrintLine("Eq_Прибыль_пред_лет <= 0");
                if (m_part.getAttribute("Eq_Прибыль_прошл_года").getValue() >= 0)
                    m_protocolView.PrintLine("Eq_Прибыль_прошл_года >= 0");
                    setValueAttributes(attribute,
                                       RcbArray().initialize("Eq_106.1_прошл_года"),
                                       RcbArray().initialize("Eq_106.1_пред_лет"));
                else
                    m_protocolView.PrintLine("Eq_Прибыль_прошл_года < 0");
                    setValueAttributes(attribute,
                                       RcbArray(),
                                       RcbArray().initialize("Eq_106.1_пред_лет"));
                end;
                
            else
                m_protocolView.PrintLine("Eq_Прибыль_пред_лет > 0");
                setValue(attribute, $0.0);
            end;
        end;
    end;

    macro calculateEq111_1_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_111.1.1_ввод"),
                               RcbArray(),
                               true);
        else
            if (m_part.getAttribute("Eq_Прибыль_пред_лет").getValue() <= 0)
                m_protocolView.PrintLine("Eq_Прибыль_пред_лет <= 0");
                if (m_part.getAttribute("Eq_Прибыль_прошл_года").getValue() >= 0)
                    m_protocolView.PrintLine("Eq_Прибыль_прошл_года >= 0");
                    setValueAttributes(attribute,
                                       RcbArray().initialize("Eq_106.1.1_прошл_года"),
                                       RcbArray().initialize("Eq_106.1.1_пред_лет"));
                else
                    m_protocolView.PrintLine("Eq_Прибыль_прошл_года < 0");
                    setValueAttributes(attribute,
                                       RcbArray(),
                                       RcbArray().initialize("Eq_106.1.1_пред_лет"));
                end;
                
            else
                m_protocolView.PrintLine("Eq_Прибыль_пред_лет > 0");
                setValue(attribute, $0.0);
            end;
        end;
    end;

    macro calculateEq111_1_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            if (m_part.getAttribute("Строка_111.1.2_полож_ввод").getValue() > 0)
                m_protocolView.PrintLine("Строка_111.1.2_полож_ввод > 0");
                setValueAttributes(attribute,
                                   RcbArray().initialize("Строка_111.1.2_полож_ввод"),
                                   RcbArray());
            else
                m_protocolView.PrintLine("Строка_111.1.2_полож_ввод <= 0");
                setValueAttributes(attribute,
                                   RcbArray().initialize("Строка_111.1.2_отриц_ввод"),
                                   RcbArray());

            end;
        else

            if (m_part.getAttribute("Eq_Прибыль_пред_лет").getValue() <= 0)
                m_protocolView.PrintLine("Eq_Прибыль_пред_лет <= 0");
                if (m_part.getAttribute("Eq_Прибыль_прошл_года").getValue() >= 0)
                    m_protocolView.PrintLine("Eq_Прибыль_прошл_года >= 0");
                    setValueAttributes(attribute,
                                       RcbArray().initialize("Eq_106.1.2_прошл_года"),
                                       RcbArray().initialize("Eq_106.1.2_пред_лет"));
                else
                    m_protocolView.PrintLine("Eq_Прибыль_прошл_года < 0");
                    setValueAttributes(attribute,
                                       RcbArray(),
                                       RcbArray().initialize("Eq_106.1.2_пред_лет"));
                end;
                
            else
                m_protocolView.PrintLine("Eq_Прибыль_пред_лет > 0");
                setValue(attribute, $0.0);
            end;
        end;

    end;

    macro calculateEq111_1_2NotImplPositive(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_111.1.2_полож_ввод"),
                               RcbArray(),
                               true);
        else
            if (m_part.getAttribute("Eq_Прибыль_пред_лет").getValue() <= 0)
                m_protocolView.PrintLine("Eq_Прибыль_пред_лет <= 0");
                if (m_part.getAttribute("Eq_Прибыль_прошл_года").getValue() >= 0)
                    m_protocolView.PrintLine("Eq_Прибыль_прошл_года >= 0");
                    setValueAttributes(attribute,
                                       RcbArray().initialize("Eq_106.1.2_нереал_полож_прошл_года"),
                                       RcbArray().initialize("Eq_106.1.2_нереал_полож_пред_лет"));
                else
                    m_protocolView.PrintLine("Eq_Прибыль_прошл_года < 0");
                    setValueAttributes(attribute,
                                       RcbArray(),
                                       RcbArray().initialize("Eq_106.1.2_нереал_полож_пред_лет"));
                end;
                
            else
                m_protocolView.PrintLine("Eq_Прибыль_пред_лет > 0");
                setValue(attribute, $0.0);
            end;
        end;
    end;

    macro calculateEq111_1_2NotImplNegative(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_111.1.2_отриц_ввод"),
                               RcbArray(),
                               true);
        else
            if (m_part.getAttribute("Eq_Прибыль_пред_лет").getValue() <= 0)
                m_protocolView.PrintLine("Eq_Прибыль_пред_лет <= 0");
                if (m_part.getAttribute("Eq_Прибыль_прошл_года").getValue() >= 0)
                    m_protocolView.PrintLine("Eq_Прибыль_прошл_года >= 0");
                    setValueAttributes(attribute,
                                       RcbArray().initialize("Eq_106.1.2_нереал_отриц_прошл_года"),
                                       RcbArray().initialize("Eq_106.1.2_нереал_отриц_пред_лет"));
                else
                    m_protocolView.PrintLine("Eq_Прибыль_прошл_года < 0");
                    setValueAttributes(attribute,
                                       RcbArray(),
                                       RcbArray().initialize("Eq_106.1.2_нереал_отриц_пред_лет"));
                end;
                
            else
                m_protocolView.PrintLine("Eq_Прибыль_пред_лет > 0");
                setValue(attribute, $0.0);
            end;
        end;
    end;


    macro calculateEq2_2_5data(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = m_dataSources.getDataSource("CbAccount");
        var filter     = m_dataSouceFilters.getFilter("CbAccount");
        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10605, 70607,70606, 70608, 70609, 70610, 70611, 70612, 50905, 61401, 61403");

        setValue(attribute, dataSource.getData(filter, attribute));

/*        //2
        filter     = m_dataSouceFilters.getFilter("CbAccount");
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10605, 70607").op("AND").isReportingCategoryExists("ТСС");  //GSP

        plusValue(attribute, dataSource.getData(filter, attribute));
*/
        //3
        filter     = m_dataSouceFilters.getFilter("CbAccount");
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10603, 70602,70601, 70603, 70604, 70605, 61301, 61304");

        minusValue(attribute, dataSource.getData(filter, attribute));

/*        //4                                       	
        filter     = m_dataSouceFilters.getFilter("CbAccount");
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10603, 70602").op("AND").isReportingCategoryExists("ТСС"); //GSP

        minusValue(attribute, dataSource.getData(filter, attribute));
*/
        //5
        setValueAttributes(attribute,
                           RcbArray().initialize("Eq_112.2_данные"),
                           RcbArray());

        //6
        if (isLastDayInMonth(m_report.getPeriod().endDate))
            setValueAttributes(attribute,
                               RcbArray().initialize("Eq2_2_5ввод"),
                               RcbArray());
        end;
    end;

    macro calculateEq2_2_5(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("Eq2_2_5данные", "Eq2_1_6"),
                           RcbArray());

        if (attribute.getValue() < 0)
            m_protocolView.PrintLine("Полученное значение переменной " + attribute.getValue() + " < 0, полагаем равным 0");
            attribute.setValue($0.0);
        end;
    end;

    macro calculateEq112_2data(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("Eq_112.2.1_данные", "Eq_112.2.2_нереал_отриц_данные"),
                           RcbArray().initialize("Eq_112.2.2_нереал_полож_данные"),
                           true);
    end;

    macro calculateEq112_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_112.2.1_ввод"),
                               RcbArray().initialize("Строка_112.2.2_отриц_ввод", "Строка_112.2.2_полож_ввод"),
                               true);
        else
            if (m_part.getAttribute("Eq2_2_5").getValue() > 0)
                m_protocolView.PrintLine("Eq2_2_5 > 0");
                setValueAttributes(attribute,
                                   RcbArray().initialize("Eq_112.2_данные"),
                                   RcbArray());
            else
                m_protocolView.PrintLine("Eq2_2_5 <= 0");
                setValue(attribute, $0.0);
            end;
        end;
    end;

    macro calculateEq112_2_1dataSum1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);
        
        //1
        var dataSource = m_dataSources.getDataSource("CbDocument");
        var filter     = m_dataSouceFilters.getFilter("CbDocument");

        filter.setDateCary(date(1, 1, getYear(global.getRcbReport().context.period.endDate)), global.getRcbReport().context.period.endDate);
        filter.op("AND").isSatisfiesToBalanceMasks("70614*", true).op("AND").isSatisfiesToBalanceMasks("61601*", false).op("AND").isOpuSymbolEqualTo("25101", true);

        setValue(attribute, dataSource.getData(filter, attribute));
        
        //2
        filter     = m_dataSouceFilters.getFilter("CbDocument");

        filter.setDateCary(date(1, 1, getYear(global.getRcbReport().context.period.endDate)), global.getRcbReport().context.period.endDate);
        filter.op("AND").isSatisfiesToBalanceMasks("61601*", true).op("AND").isSatisfiesToBalanceMasks("70614*", false).op("AND").isOpuSymbolEqualTo("25101", false);

        minusValue(attribute, dataSource.getData(filter, attribute));

        //3

        setValueAttributes(attribute,
                           RcbArray().initialize("Eq_док_подтв_суммы_70614_ввод"),
                           RcbArray());
    end;

    macro calculateEq112_2_1dataSum2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        //1
        var dataSource = m_dataSources.getDataSource("CbDocument");
        var filter     = m_dataSouceFilters.getFilter("CbDocument");

        filter.setDateCary(date(1, 1, getYear(global.getRcbReport().context.period.endDate)), global.getRcbReport().context.period.endDate);
        filter.op("AND").isSatisfiesToBalanceMasks("61601*", true).op("AND").isSatisfiesToBalanceMasks("70613*", false).op("AND").isOpuSymbolEqualTo("16101", false);

        setValue(attribute, dataSource.getData(filter, attribute));
        
        //2
        filter     = m_dataSouceFilters.getFilter("CbDocument");

        filter.setDateCary(date(1, 1, getYear(global.getRcbReport().context.period.endDate)), global.getRcbReport().context.period.endDate);
        filter.op("AND").isSatisfiesToBalanceMasks("70613*", true).op("AND").isSatisfiesToBalanceMasks("61601*", false).op("AND").isOpuSymbolEqualTo("16101", true);

        minusValue(attribute, dataSource.getData(filter, attribute));

        //3

        setValueAttributes(attribute,
                           RcbArray().initialize("Eq_док_подтв_суммы_70613_ввод"),
                           RcbArray());
    end;

    macro calculateEq112_2_1data(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);
        

        setValueAttributes(attribute,
                           RcbArray().initialize("Eq_112.2.1_данные_Сумма1"),
                           RcbArray().initialize("Eq_112.2.1_данные_Сумма2"));
    end;

    macro calculateEq112_2_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_112.2.1_ввод "),
                               RcbArray(),
                               true);
        else
            if (m_part.getAttribute("Eq2_2_5").getValue() > 0)
                m_protocolView.PrintLine("Eq2_2_5 > 0");
                setValueAttributes(attribute,
                                   RcbArray().initialize("Eq_112.2.1_данные"),
                                   RcbArray());
            else
                m_protocolView.PrintLine("Eq2_2_5 <= 0");
                setValue(attribute, $0.0);
            end;
        end;
    end;

    macro calculateEq112_2_2data(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (m_part.getAttribute("Eq_112.2.2_нереал_полож_данные").getValue() > 0)
            setValueAttributes(attribute,
                               RcbArray().initialize("Eq_112.2.2_нереал_полож_данные"),
                               RcbArray());
        else
            m_protocolView.PrintLine("Eq_112.2.2_нереал_полож_данные <= 0");
            setValueAttributes(attribute,
                               RcbArray().initialize("Eq_112.2.2_нереал_отриц_данные"),
                               RcbArray());
        end;
    end;

    macro calculateEq112_2_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            if (m_part.getAttribute("Строка_112.2.2_полож_ввод").getValue() > 0)
                setValueAttributes(attribute,
                                   RcbArray().initialize("Строка_112.2.2_полож_ввод"),
                                   RcbArray());
            else
                m_protocolView.PrintLine("Строка_112.2.2_полож_ввод <= 0");
                setValueAttributes(attribute,
                                   RcbArray().initialize("Строка_112.2.2_отриц_ввод"),
                                   RcbArray(),
                                   true);
            end;
        else
            if (m_part.getAttribute("Eq2_2_5").getValue() > 0)
                m_protocolView.PrintLine("Eq2_2_5 > 0");
                setValueAttributes(attribute,
                                   RcbArray().initialize("Eq_112.2.2_данные"),
                                   RcbArray());
            else
                m_protocolView.PrintLine("Eq2_2_5 <= 0");
                setValue(attribute, $0.0);
            end;
        end;
    end;

    macro calculateEq112_2NotImplPositiveDataSum1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = m_dataSources.getDataSource("CbAccount");
        var filter     = m_dataSouceFilters.getFilter("CbAccount");

        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70613");

        setValue(attribute, dataSource.getData(filter, attribute));

        //2
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70613*").op("AND").isReportingCategoryExists("ПФИ: искл. из  10.2");

        minusValue(attribute, dataSource.getData(filter, attribute));

        //3
        setValueAttributes(attribute,
                           RcbArray().initialize("Eq_70613_нер_корр_ввод"),
                           RcbArray().initialize("Eq_112.2.1_данные_Сумма1"));
    end;

    macro calculateEq112_2NotImplPositiveDataSum2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = m_dataSources.getDataSource("CbAccount");
        var filter     = m_dataSouceFilters.getFilter("CbAccount");

        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70614");

        setValue(attribute, dataSource.getData(filter, attribute));

        //2
        setValueAttributes(attribute,
                           RcbArray().initialize("Eq_70614_нер_корр_ввод"),
                           RcbArray().initialize("Eq_112.2.1_данные_Сумма2"));
    end;

    macro calculateEq112_2NotImplPositiveData(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("Eq_112.2.2_нереал_полож_данные_Сумма1"),
                           RcbArray().initialize("Eq_112.2.2_нереал_полож_данные_Сумма2"));

        if (attribute.getValue() > 0)
            m_protocolView.PrintLine("Значение переменной равно " + attribute.getValue() + "/100*60");
            attribute.setValue(attribute.getValue()/*/100*60*/);
        else
            m_protocolView.PrintLine("Полученное значение переменной " + attribute.getValue() + " <= 0, полагаем равным 0");
            attribute.setValue($0.0);
        end;
    end;

    macro calculateEq112_2NotImplPositive(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_112.2.2_полож_ввод"),
                               RcbArray());
        else
            if (m_part.getAttribute("Eq2_2_5").getValue() > 0)
                m_protocolView.PrintLine("Eq2_2_5 > 0");
                setValueAttributes(attribute,
                                   RcbArray().initialize("Eq_112.2.2_нереал_полож_данные"),
                                   RcbArray());
            else
                m_protocolView.PrintLine("Eq2_2_5 <= 0");
                setValue(attribute, $0.0);
            end;
        end;
    end;

    macro calculateEq112_2NotImplNegativeData(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("Eq_112.2.1_данные_Сумма2"),
                           RcbArray().initialize("Eq_112.2.1_данные_Сумма1"));

        if (attribute.getValue() < 0)
            m_protocolView.PrintLine("Полученное значение переменной " + attribute.getValue() + " <= 0, полагаем равным 0");
            attribute.setValue($0.0);
        end;
    end;

    macro calculateEq112_2NotImplNegative(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_112.2.2_отриц_ввод"),
                               RcbArray());
        else
            if (m_part.getAttribute("Eq2_2_5").getValue() > 0)
                m_protocolView.PrintLine("Eq2_2_5 > 0");
                setValueAttributes(attribute,
                                   RcbArray().initialize("Eq_112.2.2_нереал_отриц_данные"),
                                   RcbArray());
            else
                m_protocolView.PrintLine("Eq2_2_5 <= 0");
                setValue(attribute, $0.0);
            end;
        end;
    end;

    macro calculateEq2_2_5RevaluationData(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = null;
        var filter     = null;
        
        dataSource = m_dataSources.getDataSource("CbAccount");
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10605, 70607").op("AND").isReportingCategoryExists("ТСС");

        setValue(attribute, dataSource.getData(filter, attribute));

        //2
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10603, 70602").op("AND").isReportingCategoryExists("ТСС");

        minusValue(attribute, dataSource.getData(filter, attribute));
    end;

    macro calculateEq2_2_5Revaluation(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (m_part.getAttribute("Eq2_2_5").getValue() > 0)
            m_protocolView.PrintLine("Eq2_2_5 > 0");
            setValueAttributes(attribute,
                               RcbArray().initialize("Eq2_2_5переоценка_данные", "Eq2_1_6_переоценка"),
                               RcbArray());
        else
            m_protocolView.PrintLine("Eq2_2_5 <= 0");
            setValue(attribute, $0.0);
        end;
    end;

    macro calculateEq2_2_6(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = null;
        var filter     = null;

        dataSource = m_dataSources.getDataSource("CbAccount");
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        //1
        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("60101").op("AND").op("((").isReportingCategoryExists("ИП").op("AND").isShareInCapital(">20").op(")");
        filter.op("OR").isCodeOkopfEqual(67).op("OR").op("(").op("NOT").isReportingCategoryExists("2.2.6 искл").op("AND").isCodeOkopfEqual(47).op("))");

        setValue(attribute, dataSource.getData(filter, attribute));

        //2
        filter     = m_dataSouceFilters.getFilter("CbAccount");
        
        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("60102, 60103, 60104").op("AND").isReportingCategoryExists("ИП").op("AND").isShareInCapital(">20");

        plusValue(attribute, dataSource.getData(filter, attribute));

        //3
        filter     = m_dataSouceFilters.getFilter("CbAccount");
        
        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("60201");

        plusValue(attribute, dataSource.getData(filter, attribute));

	//3.5                                                                                                           //GSP
	filter     = m_dataSouceFilters.getFilter("CbAccount");
        
        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("60202810000000021377");

        plusValue(attribute, dataSource.getData(filter, attribute));

        //4
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("/*60202, */60203, 60204");                      //GSP
        filter.op("AND").isReportingCategoryExists("ИП").op("AND").isContractorSubsidiary().op("AND").isShareInCapital(">20");

        plusValue(attribute, dataSource.getData(filter, attribute));

        //4.5
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("60202");
//        filter.op("AND").isReportingCategoryExists("ИП").op("AND").isContractorSubsidiary().op("AND").isShareInCapital(">20");
        filter.op("AND").op("(").op("NOT").isReportingCategoryExists("2.2.6 искл").op(")");

        plusValue(attribute, dataSource.getData(filter, attribute));

        //5
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("50605, 50618, 50705, 50718,  50621, 50721");
        filter.op("AND").op("((").isReportingCategoryExists("ИП").op("AND").isContractorSubsidiary().op("AND").isShareInCapital(">20").op(")");
        filter.op("OR").isCodeOkopfEqual(67);
        filter.op("OR").op("(").op("NOT").isReportingCategoryExists("2.2.6 искл").op("AND").isCodeOkopfEqual(47).op("))");

        plusValue(attribute, dataSource.getData(filter, attribute));

        //5.5
        filter     = m_dataSouceFilters.getFilter("CbAccount");
        
        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("60206");                   //GSP вычитаем РВП

        minusValue(attribute, dataSource.getData(filter, attribute));

        //6
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("50620, 50720");
        filter.op("AND").op("((").isReportingCategoryExists("ИП").op("AND").isContractorSubsidiary().op("AND").isShareInCapital(">20").op(")");
        filter.op("OR").isCodeOkopfEqual(67);
        filter.op("OR").op("(").op("NOT").isReportingCategoryExists("2.2.6 искл").op("AND").isCodeOkopfEqual(47).op("))");

        minusValue(attribute, dataSource.getData(filter, attribute));

        m_protocolView.PrintLine("Вычитаем значения фактического резерва:");

        //7
        dataSource = m_dataSources.getDataSource("CbAccountReserve");
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("60101").op("AND").op("((").isReportingCategoryExists("ИП").op("AND").isShareInCapital(">20").op(")");
        filter.op("OR").isCodeOkopfEqual(67).op("OR").op("(").op("NOT").isReportingCategoryExists("2.2.6 искл").op("AND").isCodeOkopfEqual(47).op("))");

        minusValue(attribute, dataSource.getData(filter, attribute));

        //8
        filter     = m_dataSouceFilters.getFilter("CbAccount");
        
        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("60102, 60103, 60104").op("AND").isReportingCategoryExists("ИП").op("AND").isShareInCapital(">20");

        minusValue(attribute, dataSource.getData(filter, attribute));

	//8.5

        filter     = m_dataSouceFilters.getFilter("CbAccount");
        
        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("60206");         //GSP (Вычитаем РВП по счету 60206)

        minusValue(attribute, dataSource.getData(filter, attribute));

        //9
        filter     = m_dataSouceFilters.getFilter("CbAccount");
        
        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("60201");

        minusValue(attribute, dataSource.getData(filter, attribute));

        //9.5                                                                                                           //GSP
        filter     = m_dataSouceFilters.getFilter("CbAccount");
        
        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("60202810000000021377");

        minusValue(attribute, dataSource.getData(filter, attribute));

        //10
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("/*60202, */60203, 60204");
        filter.op("AND").isReportingCategoryExists("ИП").op("AND").isContractorSubsidiary().op("AND").isShareInCapital(">20");         //GSP

        minusValue(attribute, dataSource.getData(filter, attribute));

        //10.5
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("60202");
//        filter.op("AND").isReportingCategoryExists("ИП").op("AND").isContractorSubsidiary().op("AND").isShareInCapital(">20");
        filter.op("AND").op("(").op("NOT").isReportingCategoryExists("2.2.6 искл").op(")");
        minusValue(attribute, dataSource.getData(filter, attribute));


        //11
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("50705, 50718");
        filter.op("AND").op("((").isReportingCategoryExists("ИП").op("AND").isContractorSubsidiary().op("AND").isShareInCapital(">20").op(")");
        filter.op("OR").isCodeOkopfEqual(67);
        filter.op("OR").op("(").op("NOT").isReportingCategoryExists("2.2.6 искл").op("AND").isCodeOkopfEqual(47).op("))");

        minusValue(attribute, dataSource.getData(filter, attribute));

        //12

        setValueAttributes(attribute,
                           RcbArray().initialize("Eq2_2_6ввод"),
                           RcbArray());
    end;

    macro calculateEq2_2_8(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = null;
        var filter     = null;
        
        dataSource = m_dataSources.getDataSource("CbAccount");
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("102*, 10602, 107*, 108*").op("AND").isReportingCategoryExists("2.2.8");

        setValue(attribute, dataSource.getData(filter, attribute));
        //2

        setValueAttributes(attribute,
                           RcbArray().initialize("Eq2_2_8ввод"),
                           RcbArray());
    end;

    macro calculateEq2_2_9(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (m_part.getAttribute("EqИстДоп").getValue() <= 0)
            setValueAttributes(attribute,
                               RcbArray(),
                               RcbArray().initialize("EqИстДоп"));
        else
            m_protocolView.PrintLine("Значение EqИстДоп > 0");
            setValue(attribute, $0.0);
        end;
    end;

    macro calculateEqMain(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("EqИстОсн"),
                           RcbArray().initialize("Eq2_2_1", "Eq2_2_2(2_2_3)", "Eq2_2_4", "Eq2_2_5", "Eq2_2_6", "Eq2_2_8", "Eq2_2_9"));
    end;

    macro calculateEq3_4data(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = null;
        var filter     = null;

        dataSource = m_dataSources.getDataSource("CbAccount");
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10603, 70602,70601, 70603, 70604, 70605, 61301, 61304");

        setValue(attribute, dataSource.getData(filter, attribute));
/*        
        //2
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10603, 70602").op("AND").isReportingCategoryExists("ТСС");

        plusValue(attribute, dataSource.getData(filter, attribute));          //GSP
*/
        //3
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10605, 70607,70606, 70608, 70609, 70610, 70611, 70612, 50905, 61401, 61403");

        minusValue(attribute, dataSource.getData(filter, attribute));
        
/*        //4
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10605, 70607").op("AND").isReportingCategoryExists("ТСС");

        plusValue(attribute, dataSource.getData(filter, attribute));       //GSP
*/
        //5
        setValueAttributes(attribute,
                           RcbArray().initialize("Eq_203.2_данные"),
                           RcbArray());


        //6
        if (isLastDayInMonth(m_report.getPeriod().endDate))
            setValueAttributes(attribute,
                               RcbArray(),
                               RcbArray().initialize("Eq2_2_5ввод"));
        end;
    end;

    macro calculateEq3_1(attributeId : String)                      //GSP
//msgbox("расчет переменной Eq3_1");
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = null;
        var filter     = null;

        dataSource = m_dataSources.getDataSource("CbAccount");
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10601");

        setValue(attribute, dataSource.getData(filter, attribute));         

        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10601810900000120000");

        minusValue(attribute, dataSource.getData(filter, attribute));
        m_protocolView.PrintLine("переменная Eq3_1 = " + attribute.getValue());
    end;

    macro calculateEq3_4(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("Eq3_4данные"),
                           RcbArray().initialize("Eq2_1_6"));

        if (attribute.getValue() < 0)
            m_protocolView.PrintLine("Полученное значение переменной " + attribute.getValue() + " <= 0, полагаем равным 0");
            attribute.setValue($0.0);
        end;
    end;

    macro calculateEq3_4RevaluationData(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = null;
        var filter     = null;

        dataSource = m_dataSources.getDataSource("CbAccount");
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10603, 70602");//.op("AND").isReportingCategoryExists("ТСС");

        setValue(attribute, dataSource.getData(filter, attribute));
        
        //2
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10605, 70607");//.op("AND").isReportingCategoryExists("ТСС");

        minusValue(attribute, dataSource.getData(filter, attribute));
    end;

    macro calculateEq203_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_203.2.1_ввод", "Строка_203.2.2_полож_ввод"),
                               RcbArray().initialize("Строка_203.2.2_отриц_ввод"),
                               true);
        else
            var sum = m_part.getAttribute("Eq3_4").getValue(); 

            if (sum > 0)
                m_protocolView.PrintLine("Eq3_4 (" + sum + ") > 0");

                sum = m_part.getAttribute("Eq_203.2_данные").getValue();

                m_protocolView.PrintLine("Значение переменной равно значению переменной Eq_203.2_данные (" + sum + ")");
                setValue(attribute, sum);
            else
                m_protocolView.PrintLine("Eq3_4 (" + sum + ") <= 0");
                setValue(attribute, $0.0);
            end;
        end;

    end;

    macro calculateEq3_4Revaluation(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (m_part.getAttribute("Eq3_4").getValue() > 0)
            setValueAttributes(attribute,
                               RcbArray().initialize("Eq3_4переоценка_данные"),
                               RcbArray().initialize("Eq2_1_6_переоценка"));
        else
            m_protocolView.PrintLine("Значение Eq3_4 <= 0");
            setValue(attribute, $0.0);
        end;
    end;

    macro calculateEq203_2data(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("Eq_203.2.1_данные", "Eq_203.2.2_нереал_полож_данные"),
                           RcbArray().initialize("Eq_203.2.2_нереал_отриц_данные"),
                           true);
    end;

    macro calculateEq203_2_1DataSum1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        //1
        var dataSource = m_dataSources.getDataSource("CbDocument");
        var filter     = m_dataSouceFilters.getFilter("CbDocument");

        filter.setDateCary(date(1, 1, getYear(global.getRcbReport().context.period.endDate)), global.getRcbReport().context.period.endDate);
        filter.op("AND").isSatisfiesToBalanceMasks("61601*", true).op("AND").isSatisfiesToBalanceMasks("70613*", false).op("AND").isOpuSymbolEqualTo("16101", false);

        setValue(attribute, dataSource.getData(filter, attribute));

        //2
        filter     = m_dataSouceFilters.getFilter("CbDocument");

        filter.setDateCary(date(1, 1, getYear(global.getRcbReport().context.period.endDate)), global.getRcbReport().context.period.endDate);
        filter.op("AND").isSatisfiesToBalanceMasks("70613*", true).op("AND").isSatisfiesToBalanceMasks("61601*", false).op("AND").isOpuSymbolEqualTo("16101", true);

        minusValue(attribute, dataSource.getData(filter, attribute));

        //3
        setValueAttributes(attribute,
                           RcbArray().initialize("Eq_203.2.1_док_суммы_70613_ввод"),
                           RcbArray());
    end;

    macro calculateEq203_2_1DataSum2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        //1
        var dataSource = m_dataSources.getDataSource("CbDocument");
        var filter     = m_dataSouceFilters.getFilter("CbDocument");

        filter.setDateCary(date(1, 1, getYear(global.getRcbReport().context.period.endDate)), global.getRcbReport().context.period.endDate);
        filter.op("AND").isSatisfiesToBalanceMasks("70614*", true).op("AND").isSatisfiesToBalanceMasks("61601*", false).op("AND").isOpuSymbolEqualTo("25101", true);

        setValue(attribute, dataSource.getData(filter, attribute));

        //2
        filter     = m_dataSouceFilters.getFilter("CbDocument");

        filter.setDateCary(date(1, 1, getYear(global.getRcbReport().context.period.endDate)), global.getRcbReport().context.period.endDate);
        filter.op("AND").isSatisfiesToBalanceMasks("61601*", true).op("AND").isSatisfiesToBalanceMasks("70614*", false).op("AND").isOpuSymbolEqualTo("25101", false);

        minusValue(attribute, dataSource.getData(filter, attribute));

        //3
        setValueAttributes(attribute,
                           RcbArray().initialize("Eq_203.2.1_док_суммы_70614_ввод"),
                           RcbArray());
    end;

    macro calculateEq203_2_1Data(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("Eq_203.2.1_данные_Сумма1"),
                           RcbArray().initialize("Eq_203.2.1_данные_Сумма2"));
    end;

    macro calculateEq203_2_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_203.2.1_ввод"),
                               RcbArray(),
                               true);
        else
            if (m_part.getAttribute("Eq3_4").getValue() > 0)
                m_protocolView.PrintLine("Eq3_4 > 0");
                setValueAttributes(attribute,
                                   RcbArray().initialize("Eq_203.2.1_данные"),
                                   RcbArray());
            else
                m_protocolView.PrintLine("Eq3_4 <= 0");
                setValue(attribute, $0.0);
            end;
        end;
    end;

    macro calculateEq203_2_2data(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (m_part.getAttribute("Eq_203.2.2_нереал_полож_данные").getValue() > 0)
            m_protocolView.PrintLine("Eq_203.2.2_нереал_полож_данные > 0");
            setValueAttributes(attribute,
                               RcbArray().initialize("Eq_203.2.2_нереал_полож_данные"),
                               RcbArray());
        elif(m_part.getAttribute("Eq_203.2.2_нереал_полож_данные").getValue() == 0)
            m_protocolView.PrintLine("Eq_203.2.2_нереал_полож_данные == 0");
            setValueAttributes(attribute,
                               RcbArray().initialize("Eq_203.2.2_нереал_отриц_данные"),
                               RcbArray());
        end;
    end;

    macro calculateEq203_2_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            if (m_part.getAttribute("Строка_203.2.2_полож_ввод").getValue() > 0)
                m_protocolView.PrintLine("Строка_203.2.2_полож_ввод > 0");
                setValueAttributes(attribute,
                                   RcbArray().initialize("Строка_203.2.2_полож_ввод"),
                                   RcbArray());
            else
                m_protocolView.PrintLine("Строка_203.2.2_полож_ввод <= 0");
                setValueAttributes(attribute,
                                   RcbArray().initialize("Строка_203.2.2_отриц_ввод"),
                                   RcbArray(),
                                   true);
            end;
        else
            if (m_part.getAttribute("Eq3_4").getValue() > 0)
                m_protocolView.PrintLine("Eq3_4 > 0");
                setValueAttributes(attribute,
                                   RcbArray().initialize("Eq_203.2.2_данные"),
                                   RcbArray());
            else
                m_protocolView.PrintLine("Eq3_4 <= 0");
                setValue(attribute, $0.0);
            end;
        end;
    end;

    macro calculateEq203_2_2NotImplPositiveDataSum1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = null;
        var filter     = null;
        
        dataSource = m_dataSources.getDataSource("CbAccount");
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70613");

        setValue(attribute, dataSource.getData(filter, attribute));

        //2
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70613").op("AND").isReportingCategoryExists("ПФИ: искл. из  10.2");

        minusValue(attribute, dataSource.getData(filter, attribute));

        //3
        setValueAttributes(attribute,
                           RcbArray().initialize("Eq_203.2.2_70613_нер_корр_ввод"),
                           RcbArray().initialize("Eq_203.2.1_данные_Сумма1"));
    end;

    macro calculateEq203_2_2NotImplPositiveDataSum2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = null;
        var filter     = null;
        
        dataSource = m_dataSources.getDataSource("CbAccount");
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("70614");

        setValue(attribute, dataSource.getData(filter, attribute));

        //2
        setValueAttributes(attribute,
                           RcbArray().initialize("Eq_203.2.2_70614_нер_корр_ввод"),
                           RcbArray().initialize("Eq_203.2.1_данные_Сумма2"));
    end;

    macro calculateEq203_2_2NotImplPositiveData(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("Eq_203.2.2_нереал_полож_данные_Сумма1"),
                           RcbArray().initialize("Eq_203.2.2_нереал_полож_данные_Сумма2"));

        if (attribute.getValue() > 0)
            m_protocolView.PrintLine("Значение переменной равно " + attribute.getValue() + "/100*60");
            attribute.setValue(attribute.getValue()/*/100*60*/);
        else
            m_protocolView.PrintLine("Полученное значение переменной " + attribute.getValue() + " <= 0, полагаем равным 0");
            attribute.setValue($0.0);
        end;
    end;

    macro calculateEq203_2_2NotImplPositive(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_203.2.2_полож_ввод"),
                               RcbArray());
        else
            if (m_part.getAttribute("Eq3_4").getValue() > 0)
                m_protocolView.PrintLine("Eq3_4 > 0");
                setValueAttributes(attribute,
                                   RcbArray().initialize("Eq_203.2.2_нереал_полож_данные"),
                                   RcbArray());
            else
                m_protocolView.PrintLine("Eq3_4 <= 0");
                setValue(attribute, $0.0);
            end;
        end;
    end;

    macro calculateEq203_2_2NotImplNegativeData(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("Eq_203.2.2_нереал_полож_данные_Сумма2"),
                           RcbArray().initialize("Eq_203.2.2_нереал_полож_данные_Сумма1"));

        if (attribute.getValue() <= 0)
            m_protocolView.PrintLine("Полученное значение переменной " + attribute.getValue() + " <= 0, полагаем равным 0");
            attribute.setValue($0.0);
        end;
    end;

    macro calculateEq203_2_2NotImplNegative(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.isUserInput)
            setValueAttributes(attribute,
                               RcbArray().initialize("Строка_203.2.2_отриц_ввод"),
                               RcbArray());
        else
            if (m_part.getAttribute("Eq3_4").getValue() > 0)
                m_protocolView.PrintLine("Eq3_4 > 0");
                setValueAttributes(attribute,
                                   RcbArray().initialize("Eq_203.2.2_нереал_отриц_данные"),
                                   RcbArray());
            else
                m_protocolView.PrintLine("Eq3_4 <= 0");
                setValue(attribute, $0.0);
            end;
        end;
    end;

    macro calculateEq3_5data(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        
        printAttributeHead(attributeId);

        var dataSource = null;
        var filter     = null;
        
        dataSource = m_dataSources.getDataSource("CbAccountSubCredit");
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("с 20313, 20314, 31309, 31409, 31509, 31609, 41107, 41207, 41307, 41407, 41507, 41607, 41707, 41807, 41907, 42007, 42107, 42207, 42507, 42807, 42907, 43007, 43107, 43207, 43307, 43407, 43507, 43607, 43707, 43807, 43907, 44007, 52006");
        filter.op("AND").isReportingCategoryExists("СубКредит").op("AND").op("NOT").isReportingCategoryExists("СубКредит на 10 лет");

        setValue(attribute, dataSource.getData(filter, attribute));
    end;

    macro calculateEq3_5data10Years(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        
        printAttributeHead(attributeId);

        var dataSource = null;
        var filter     = null;
        
        dataSource = m_dataSources.getDataSource("CbAccountSubCredit");
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("с 20313, 20314, 31309, 31409, 31509, 31609, 41107, 41207, 41307, 41407, 41507, 41607, 41707, 41807, 41907, 42007, 42107, 42207, 42507, 42807, 42907, 43007, 43107, 43207, 43307, 43407, 43507, 43607, 43707, 43807, 43907, 44007, 52006");
        filter.op("AND").isReportingCategoryExists("СубКредит на 10 лет");

        setValue(attribute, dataSource.getData(filter, attribute));
    end;

    macro calculateEq3_5(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("Eq3_5данные", "Eq3_5данные10лет"),
                           RcbArray());
    end;

    macro calculateEq204_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var sumEq3_5data = m_part.getAttribute("Eq3_5данные").getValue();
        var sumEqMain = m_part.getAttribute("EqОсн").getValue();

        m_protocolView.printLine("Значение переменной равно min(Eq3_5данные(" + sumEq3_5data + "), 0.5*EqОсн(" + sumEqMain + "))");
        setValue(attribute, min(sumEq3_5data,0.5*sumEqMain));
    end;

    macro calculateEq204_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var sumEq3_5data10years = m_part.getAttribute("Eq3_5данные10лет").getValue();
        var sumEqMain = m_part.getAttribute("EqОсн").getValue();
        var sumEq204_1 = m_part.getAttribute("Eq_204.1").getValue();

        m_protocolView.printLine("Значение переменной равно Eq_204.1(" + sumEq204_1 + ") +  min(Eq3_5данные10лет(" + sumEq3_5data10years + "), EqОсн(" + sumEqMain + "))");
        setValue(attribute, sumEq204_1 + min(sumEq3_5data10years,sumEqMain));
    end;

    macro calculateEq3_7(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = null;
        var filter     = null;
        
        dataSource = m_dataSources.getDataSource("CbAccount");
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("10207").op("AND").isReportingCategoryExists("3.7");

        setValue(attribute, dataSource.getData(filter, attribute));
    end;

    macro calculateEq3_9(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        var AcsMon = $215767000;
        printAttributeHead(attributeId);
	f134Parameters.ПрибыльПредшествующихЛетНеПодтверждена = true;
        if (f134Parameters.ПрибыльПредшествующихЛетНеПодтверждена)
        GetMoney (AcsMon, "Неподтвержденн. прибыль, руб.",10);
	setValue(attribute, AcsMon);                                               //GSP
        /*   if (f134Parameters.isEndDateLess0107)
                if (m_part.getAttribute("Eq_Прибыль_пред_лет").getValue() >= 0)
                    setValueAttributes(attribute,
                                       RcbArray().initialize("Eq_Прибыль_пред_лет"),
                                       RcbArray().initialize("Eq2_1_11"));

                    if (attribute.getValue() < 0)
                        m_protocolView.PrintLine("Полученное значение переменной " + attribute.getValue() + " <= 0, полагаем равным 0");
                        attribute.setValue($0.0);
                    end;
                elif (m_part.getAttribute("Eq_Прибыль_прошл_года").getValue() >= 0)
                    setValueAttributes(attribute,
                                       RcbArray().initialize("Eq_Прибыль_прошл_года"),
                                       RcbArray());
                else
                    m_protocolView.PrintLine("Значение переменной равно нулю.");
                    setValue(attribute, $0.0);
                end;
            else
                m_protocolView.PrintLine("Дата окончания о.п. >= 01.07 отчетного года.");
                m_protocolView.PrintLine("Значение переменной равно нулю.");
                setValue(attribute, $0.0);
            end;
        */
        else
            m_protocolView.PrintLine("Прибыль предшествующих лет подтверждена.");
            m_protocolView.PrintLine("Значение переменной равно нулю.");
            setValue(attribute, $0.0);
        end;
    end;

    macro calculateEq207_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.ПрибыльПредшествующихЛетНеПодтверждена)
            if (f134Parameters.isEndDateLess0107)
                if (m_part.getAttribute("Eq_Прибыль_пред_лет").getValue() >= 0)
                    setValueAttributes(attribute,
                                       RcbArray().initialize("Eq_106.1_пред_лет"),
                                       RcbArray().initialize("Eq_106.1"));

                    if (attribute.getValue() < 0)
                        m_protocolView.PrintLine("Полученное значение переменной " + attribute.getValue() + " <= 0, полагаем равным 0");
                        attribute.setValue($0.0);
                    end;
                elif (m_part.getAttribute("Eq_Прибыль_прошл_года").getValue() >= 0)
                    setValueAttributes(attribute,
                                       RcbArray().initialize("Eq_106.1_прошл_года"),
                                       RcbArray());
                else
                    m_protocolView.PrintLine("Значение переменной равно нулю.");
                    setValue(attribute, $0.0);
                end;
            else
                m_protocolView.PrintLine("Дата окончания о.п. >= 01.07 отчетного года.");
                m_protocolView.PrintLine("Значение переменной равно нулю.");
                setValue(attribute, $0.0);
            end;

        else
            m_protocolView.PrintLine("Прибыль предшествующих лет подтверждена.");
            m_protocolView.PrintLine("Значение переменной равно нулю.");
            setValue(attribute, $0.0);
        end;
    end;

    macro calculateEq207_1_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.ПрибыльПредшествующихЛетНеПодтверждена)
            if (f134Parameters.isEndDateLess0107)
                if (m_part.getAttribute("Eq_Прибыль_пред_лет").getValue() >= 0)
                    setValueAttributes(attribute,
                                       RcbArray().initialize("Eq_106.1.1_пред_лет"),
                                       RcbArray().initialize("Eq_106.1.1"));

                    if (attribute.getValue() < 0)
                        m_protocolView.PrintLine("Полученное значение переменной " + attribute.getValue() + " <= 0, полагаем равным 0");
                        attribute.setValue($0.0);
                    end;
                elif (m_part.getAttribute("Eq_Прибыль_прошл_года").getValue() >= 0)
                    setValueAttributes(attribute,
                                       RcbArray().initialize("Eq_106.1.1_прошл_года"),
                                       RcbArray());
                else
                    m_protocolView.PrintLine("Значение переменной равно нулю.");
                    setValue(attribute, $0.0);
                end;
            else
                m_protocolView.PrintLine("Дата окончания о.п. >= 01.07 отчетного года.");
                m_protocolView.PrintLine("Значение переменной равно нулю.");
                setValue(attribute, $0.0);
            end;

        else
            m_protocolView.PrintLine("Прибыль предшествующих лет подтверждена.");
            m_protocolView.PrintLine("Значение переменной равно нулю.");
            setValue(attribute, $0.0);
        end;
    end;

    macro calculateEq207_1_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.ПрибыльПредшествующихЛетНеПодтверждена)
            if (f134Parameters.isEndDateLess0107)
                if (m_part.getAttribute("Eq_Прибыль_пред_лет").getValue() >= 0)
                    setValueAttributes(attribute,
                                       RcbArray().initialize("Eq_106.1.2_пред_лет"),
                                       RcbArray().initialize("Eq_106.1.2"));

                    if (attribute.getValue() < 0)
                        m_protocolView.PrintLine("Полученное значение переменной " + attribute.getValue() + " <= 0, полагаем равным 0");
                        attribute.setValue($0.0);
                    end;
                elif (m_part.getAttribute("Eq_Прибыль_прошл_года").getValue() >= 0)
                    setValueAttributes(attribute,
                                       RcbArray().initialize("Eq_106.1.2_прошл_года"),
                                       RcbArray());
                else
                    m_protocolView.PrintLine("Значение переменной равно нулю.");
                    setValue(attribute, $0.0);
                end;
            else
                m_protocolView.PrintLine("Дата окончания о.п. >= 01.07 отчетного года.");
                m_protocolView.PrintLine("Значение переменной равно нулю.");
                setValue(attribute, $0.0);
            end;

        else
            m_protocolView.PrintLine("Прибыль предшествующих лет подтверждена.");
            m_protocolView.PrintLine("Значение переменной равно нулю.");
            setValue(attribute, $0.0);
        end;
    end;


    macro calculateEq207_1_2NotImplPositive(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.ПрибыльПредшествующихЛетНеПодтверждена)
            if (f134Parameters.isEndDateLess0107)
                if (m_part.getAttribute("Eq_Прибыль_пред_лет").getValue() >= 0)
                    setValueAttributes(attribute,
                                       RcbArray().initialize("Eq_106.1.2_нереал_полож_пред_лет"),
                                       RcbArray().initialize("Eq_106.1.2_нереал_полож"));

                    if (attribute.getValue() < 0)
                        m_protocolView.PrintLine("Полученное значение переменной " + attribute.getValue() + " <= 0, полагаем равным 0");
                        attribute.setValue($0.0);
                    end;
                elif (m_part.getAttribute("Eq_Прибыль_прошл_года").getValue() >= 0)
                    setValueAttributes(attribute,
                                       RcbArray().initialize("Eq_106.1.2_нереал_полож_прошл_года"),
                                       RcbArray());
                else
                    m_protocolView.PrintLine("Значение переменной равно нулю.");
                    setValue(attribute, $0.0);
                end;
            else
                m_protocolView.PrintLine("Дата окончания о.п. >= 01.07 отчетного года.");
                m_protocolView.PrintLine("Значение переменной равно нулю.");
                setValue(attribute, $0.0);
            end;

        else
            m_protocolView.PrintLine("Прибыль предшествующих лет подтверждена.");
            m_protocolView.PrintLine("Значение переменной равно нулю.");
            setValue(attribute, $0.0);
        end;
    end;

    macro calculateEq207_1_2NotImplNegative(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (f134Parameters.ПрибыльПредшествующихЛетНеПодтверждена)
            if (f134Parameters.isEndDateLess0107)
                if (m_part.getAttribute("Eq_Прибыль_пред_лет").getValue() >= 0)
                    setValueAttributes(attribute,
                                       RcbArray().initialize("Eq_106.1.2_нереал_отриц_пред_лет"),
                                       RcbArray().initialize("Eq_106.1.2_нереал_отриц"));

                    if (attribute.getValue() < 0)
                        m_protocolView.PrintLine("Полученное значение переменной " + attribute.getValue() + " <= 0, полагаем равным 0");
                        attribute.setValue($0.0);
                    end;
                elif (m_part.getAttribute("Eq_Прибыль_прошл_года").getValue() >= 0)
                    setValueAttributes(attribute,
                                       RcbArray().initialize("Eq_106.1.2_нереал_отриц_прошл_года"),
                                       RcbArray());
                else
                    m_protocolView.PrintLine("Значение переменной равно нулю.");
                    setValue(attribute, $0.0);
                end;
            else
                m_protocolView.PrintLine("Дата окончания о.п. >= 01.07 отчетного года.");
                m_protocolView.PrintLine("Значение переменной равно нулю.");
                setValue(attribute, $0.0);
            end;

        else
            m_protocolView.PrintLine("Прибыль предшествующих лет подтверждена.");
            m_protocolView.PrintLine("Значение переменной равно нулю.");
            setValue(attribute, $0.0);
        end;
    end;

    macro calculateEq3_10(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = null;
        var filter     = null;
        
        dataSource = m_dataSources.getDataSource("CbAccount");
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10207, 10603, 10801, 61301, 61304, 20313, 20314, 31309, 31409, 31509, 31609, 41107, 41207, 41307, 41407, 41507, 41607, 41707, 41807, 41907, 42007, 42107, 42207, 42507, 42807, 42907, 43007, 43107, 43207, 43307, 43407, 43507, 43607, 43807, 43907, 44007, 52006, 70601, 70602, 70603, 70604, 70605, 70701, 70702, 70703, 70704, 70705, 70801");
        filter.op("AND").isReportingCategoryExists("3.10");

        setValue(attribute, dataSource.getData(filter, attribute));

        //2
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("20321, 30126, 30226, 30410, 30607, 32015, 32115, 32211, 32311, 32403, 32505, 44115, 44215, 44315, 44415, 44515, 44615, 44715, 44815, 44915, 45015, 45115, 45215, 45315, 45415, 45515, 45615, 45715, 45818, 45918, 46008, 46108, 46208, 46308, 46408, 46508, 46608, 46708, 46808, 46908, 47008, 47108, 47208, 47308, 47425, 47425, 47702, 47804, 47902, 50219, 50319, 50507, 50719, 50908, 51210, 51310, 51410, 51510, 51610, 51710, 51810, 51910, 60105, 60206, 60324, 60405");
        filter.op("AND").isReportingCategoryExists("3.10");

        minusValue(attribute, dataSource.getData(filter, attribute));
        //3
        setValueAttributes(attribute,
                           RcbArray().initialize("Eq3_10ввод"),
                           RcbArray());
        
    end;

    macro calculateEqRealAdditional(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("Eq3_1", "Eq3_3", "Eq3_4", "Eq3_5", "Eq3_6", "Eq3_7", "Eq3_9"),
                           RcbArray().initialize("Eq3_10"));
    end;

    macro calculateEqReal(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        if (m_part.getAttribute("EqОсн").getValue() <= $0.0)
            m_protocolView.PrintLine("EqОсн <= 0");

            setValue(attribute, $0.0);
            return;
        end;

        if (m_part.getAttribute("EqИстДоп").getValue() <= $0.0)
            m_protocolView.PrintLine("EqИстДоп <= 0");

            setValue(attribute, $0.0);
            return;
        end;
        if (m_part.getAttribute("EqОсн").getValue() <= m_part.getAttribute("EqИстДоп").getValue())
            m_protocolView.PrintLine("EqОсн <= EqИстДоп");
            setValueAttributes(attribute,
                               RcbArray().initialize("EqОсн"),
                               RcbArray());
        else

            m_protocolView.PrintLine("EqОсн > EqИстДоп");

            setValueAttributes(attribute,
                               RcbArray().initialize("Eq3_1", "Eq3_3", "Eq3_4", "Eq3_6", "Eq3_7", "Eq3_9"),
                               RcbArray().initialize("Eq3_10"));

            var sumEq3_5Data = m_part.getAttribute("Eq3_5данные").getValue();
            var sumEqMain = m_part.getAttribute("EqОсн").getValue();
            var sumEq3_5Data10Years = m_part.getAttribute("Eq3_5данные10лет").getValue();
            
            m_protocolView.PrintLine("+ минимум {минимум {Eq3_5данные(" + sumEq3_5Data + "); 0.5 * EqОсн(" + sumEqMain + ")}+ Eq3_5данные10лет(" + sumEq3_5Data10Years + "); EqОсн(" + sumEqMain + ")}");

            plusValue(attribute, min(min(sumEq3_5Data, 0.5 * sumEqMain) + sumEq3_5Data10Years, sumEqMain));
        end;
    end;

    macro calculateEq4_5(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = null;
        var filter     = null;
        
        dataSource = m_dataSources.getDataSource("CbAccount");
        filter     = m_dataSouceFilters.getFilter("CbAccount");
        //1
        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("474*, 603*").op("AND").isActive().op("AND").isTermDelay(">30");
        filter.op("AND").op("NOT").isSatisfiesToBalanceMasks("47402, 47408, 47423, 47427, 60312, 60314, 60315, 60323, 60337, 60339, 60341, 60343");

        setValue(attribute, dataSource.getData(filter, attribute));

        //2
        dataSource = m_dataSources.getDataSource("CbAccountReserve");

        minusValue(attribute, dataSource.getData(filter, attribute));
    end;

    macro calculateEq4_6(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = null;
        var filter     = null;
        
        dataSource = m_dataSources.getDataSource("CbAccount");
        filter     = m_dataSouceFilters.getFilter("CbAccount");
        //1
        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("32009, 32209, 47802, 50106, 50107, 50110, 50207, 50208, 50211, 50307, 50308, 50311");
        filter.op("AND").isReportingCategoryExists("СубКредит");

        setValue(attribute, dataSource.getData(filter, attribute));

        //2
        dataSource = m_dataSources.getDataSource("CbAccountReserve");

        minusValue(attribute, dataSource.getData(filter, attribute));
    end;

    macro calculateEqSubTotal(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("EqОсн", "EqДоп"),
                           RcbArray().initialize("Eq4_5", "Eq4_6"));
    end;

    macro calculateEq5_2assets(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = null;
        var filter     = null;
        
        dataSource = m_dataSources.getDataSource("CbAccount");
        filter     = m_dataSouceFilters.getFilter("CbAccount");
        //1
        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("60401, 60404, 60406, 60407, 60408, 60409, 60410, 60411");
        filter.op("AND").op("NOT").isReportingCategoryExists("5.2 искл");

        setValue(attribute, dataSource.getData(filter, attribute));
        //2
        filter     = m_dataSouceFilters.getFilter("CbAccount");
        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("61002, 61008, 61009, 610011");

        plusValue(attribute, dataSource.getData(filter, attribute));

        //3
        filter     = m_dataSouceFilters.getFilter("CbAccount");

        filter.isOpened().op("AND").isExistRest().op("AND").isSatisfiesToBalanceMasks("60701, 60702, 60705");
        filter.op("AND").op("NOT").isReportingCategoryExists("НМА");

        plusValue(attribute, dataSource.getData(filter, attribute));

        //4
        filter     = m_dataSouceFilters.getFilter("CbAccount");
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("60601, 60602, 60603");

        minusValue(attribute, dataSource.getData(filter, attribute));
        
        //5
        setValueAttributes(attribute,
                           RcbArray(),
                           RcbArray().initialize("Eq5_2ввод"));
        
    end;

    macro calculateEq5_2MainAdditional(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var dataSource = m_dataSources.getDataSource("CbAccount");
        var filter     = m_dataSouceFilters.getFilter("CbAccount");

        //1
        filter.isExistRest().op("AND").isSatisfiesToBalanceMasks("10601");

        setValue(attribute, dataSource.getData(filter, attribute));

        //2
        setValueAttributes(attribute,
                           RcbArray().initialize("EqОсн", "Eq3_3", "Eq3_4", "Eq3_6", "Eq3_7", "Eq3_9"),
                           RcbArray().initialize("Eq3_10"));
    end;

    macro calculateEq5_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        var sumEqMainAditional = m_part.getAttribute("Eq5_2_ОснДоп").getValue();
        var sumEq5_2assets = m_part.getAttribute("Eq5_2_Имущество").getValue();

        if (sumEqMainAditional <= 0)
            m_protocolView.PrintLine("Eq5_2_ОснДоп <= 0");
            setValueAttributes(attribute,
                               RcbArray().initialize("Eq5_2_Имущество"),
                               RcbArray());
        elif ((sumEqMainAditional > 0) and (sumEqMainAditional < sumEq5_2assets))
            m_protocolView.PrintLine("(Eq5_2_ОснДоп > 0) И (Eq5_2_ОснДоп < Eq5_2_Имущество)");
            setValueAttributes(attribute,
                               RcbArray().initialize("Eq5_2_Имущество"),
                               RcbArray().initialize("Eq5_2_ОснДоп"));
        else
            m_protocolView.PrintLine("Не выполняются условия:");
            m_protocolView.PrintLine("Eq5_2_ОснДоп <= 0");
            m_protocolView.PrintLine("(Eq5_2_ОснДоп > 0) И (Eq5_2_ОснДоп < Eq5_2_Имущество)");
            m_protocolView.PrintLine("Значение переменной равно 0");

            setValue(attribute, $0.0);
        end;
    end;

    macro calculateReserveShortfall(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("Недосозд_резерв_254П_ввод","Недосозд_резерв_283П_ввод","Недосозд_резерв_1584У_ввод","Недосозд_резерв_2732У_ввод"),
                           RcbArray());
    end;

    macro calculateEqK(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        
        printAttributeHead(attributeId);

        setValueAttributes(attribute,
                           RcbArray().initialize("EqПром"),
                           RcbArray().initialize("Eq5_1", "Eq5_2", "Eq5_3"));
    end;

    macro execute()
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq2_1_1(2_1_2)",                 "calculateEq2_1_1__2_1_2", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq2_1_3(2_1_4)",                 "calculateEq2_1_3__2_1_4", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq2_1_5",                        "calculateEq2_1_5", RcbArray().initialize("Eq2_1_7", "Eq3_3")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq2_1_6данные",                  "calculateEq2_1_6_data", RcbArray().initialize("Eq_104.2_данные", "Eq2_1_6ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq2_1_6",                        "calculateEq2_1_6", RcbArray().initialize("Eq2_1_6данные")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq2_1_6ввод",                    "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq2_1_6_переоценка_данные",      "calculateEq2_1_6RevaluationData", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq2_1_6_переоценка",             "calculateEq2_1_6Revaluation", RcbArray().initialize("Eq2_1_6", "Eq2_1_6_переоценка_данные")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_104.2_данные",                "calculateEq104_2data", RcbArray().initialize("Eq_104.2.1_данные", "Eq_104.2.2_нереал_полож_данные", "Eq_104.2.2_нереал_отриц_данные")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_104.2",                       "calculateEq104_2", RcbArray().initialize("Eq2_1_6", "Строка_104.2.1_ввод", "Строка_104.2.2_полож_ввод", "Строка_104.2.2_отриц_ввод")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_104.2.1_данныеСумма1",        "calculateEq104_2_1_dataSum1", RcbArray().initialize("Eq_док_подтв_суммы_70613_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_104.2.1_данныеСумма2",        "calculateEq104_2_1_dataSum2", RcbArray().initialize("Eq_док_подтв_суммы_70614_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_104.2.1_данные",              "calculateEq104_2_1_data", RcbArray().initialize("Eq_104.2.1_данныеСумма1", "Eq_104.2.1_данныеСумма2")));
        
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_док_подтв_суммы_70613_ввод",  "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_док_подтв_суммы_70614_ввод",  "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_104.2.1",                     "calculateEq104_2_1", RcbArray().initialize("Eq2_1_6", "Eq_104.2.1_данные", "Строка_104.2.1_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_104.2.2_данные",              "calculateEq104_2_2data", RcbArray().initialize("Eq_104.2.2_нереал_полож_данные", "Eq_104.2.2_нереал_отриц_данные")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_104.2.2",                     "calculateEq104_2_2", RcbArray().initialize("Строка_104.2.2_полож_ввод", "Строка_104.2.2_отриц_ввод", "Eq2_1_6", "Eq_104.2.2_данные")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_104.2.2_нереал_полож_данныеСумма1", "calculateEq104_2_2NotImplPositiveDataSum1", RcbArray().initialize("Eq_70613_нер_корр_ввод","Eq_104.2.1_данныеСумма1")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_104.2.2_нереал_полож_данныеСумма2", "calculateEq104_2_2NotImplPositiveDataSum2", RcbArray().initialize("Eq_70614_нер_корр_ввод", "Eq_104.2.1_данныеСумма2")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_104.2.2_нереал_полож_данные",       "calculateEq104_2_2NotImplPositiveData", RcbArray().initialize("Eq_104.2.2_нереал_полож_данныеСумма1", "Eq_104.2.2_нереал_полож_данныеСумма2")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_70613_нер_корр_ввод",         "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_70614_нер_корр_ввод",         "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_104.2.2_нереал_полож",        "calculateEq104_2_2NotImplPositive", RcbArray().initialize("Строка_104.2.2_полож_ввод","Eq_104.2.2_нереал_полож_данные","Eq2_1_6")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_104.2.2_нереал_отриц_данные", "calculateEq104_2_2NotImplNegativeData", RcbArray().initialize("Eq_док_подтв_суммы_70613_ввод", "Eq_70613_нер_корр_ввод", "Eq_док_подтв_суммы_70614_ввод", "Eq_70614_нер_корр_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_104.2.2_нереал_отриц",        "calculateEq104_2_2NotImplNegative", RcbArray().initialize("Строка_104.2.2_отриц_ввод", "Eq2_1_6", "Eq_104.2.2_нереал_отриц_данные")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq2_1_7",                        "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_Прибыль_пред_лет",            "calculateEqPriviousProfit", RcbArray().initialize("Eq_10801_без_ПФИ", "Eq_70801_без_ПФИ", "Eq_106.1_пред_лет", "Eq_10901_без_ПФИ", "Eq_70802_без_ПФИ")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_10801_без_ПФИ_Сумма1",        "calculateEq10801withoutPFI_Sum1", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_10801_без_ПФИ_Сумма2",        "calculateEq10801withoutPFI_Sum2", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_10801_без_ПФИ",               "calculateEq10801withoutPFI", RcbArray().initialize("Eq_10801_без_ПФИ_Сумма1", "Eq_10801_без_ПФИ_Сумма2")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_10901_без_ПФИ_Сумма1",        "calculateEq10901withoutPFI_Sum1", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_10901_без_ПФИ_Сумма2",        "calculateEq10901withoutPFI_Sum2", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_10901_без_ПФИ",               "calculateEq10901withoutPFI", RcbArray().initialize("Eq_10901_без_ПФИ_Сумма1", "Eq_10901_без_ПФИ_Сумма2")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_70801_без_ПФИ_Сумма1",        "calculateEq70801withoutPFI_Sum1", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_70801_без_ПФИ_Сумма2",        "calculateEq70801withoutPFI_Sum2", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_70801_без_ПФИ",               "calculateEq70801withoutPFI", RcbArray().initialize("Eq_70801_без_ПФИ_Сумма1", "Eq_70801_без_ПФИ_Сумма2")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_70802_без_ПФИ_Сумма1",        "calculateEq70802withoutPFI_Sum1", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_70802_без_ПФИ_Сумма2",        "calculateEq70802withoutPFI_Sum2", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_70802_без_ПФИ",               "calculateEq70802withoutPFI", RcbArray().initialize("Eq_70802_без_ПФИ_Сумма1", "Eq_70802_без_ПФИ_Сумма2")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_Прибыль_прошл_года",                 "calculateEqPriviousYearProfit", RcbArray().initialize("Eq_70801_без_ПФИ", "Eq_70802_без_ПФИ", "Eq_106.1_прошл_года")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq2_1_11",                              "calculateEq2_1_11", RcbArray().initialize("Eq_Прибыль_пред_лет", "Eq_Прибыль_прошл_года")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_106.1_пред_лет",                     "calculateEq106_1PrevYears", RcbArray().initialize("Eq_106.1.1_пред_лет", "Eq_106.1.2_нереал_полож_пред_лет", "Eq_106.1.2_нереал_отриц_пред_лет")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_106.1_прошл_года",                   "calculateEq106_1PrevYear", RcbArray().initialize("Eq_106.1.1_прошл_года", "Eq_106.1.2_нереал_полож_прошл_года","Eq_106.1.2_нереал_отриц_прошл_года")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_106.1",                              "calculateEq106_1", RcbArray().initialize("Строка_106.1.1_ввод", "Строка_106.1.2_полож_ввод", "Строка_106.1.2_отриц_ввод", "Eq_Прибыль_пред_лет", "Eq_106.1_пред_лет", "Eq_106.1_прошл_года")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_106.1.1_пред_лет_Сумма1",            "calculateEq106_1_1PrevYears_Sum1", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_106.1.1_пред_лет_Сумма2",            "calculateEq106_1_1PrevYears_Sum2", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_106.1.1_пред_лет",                   "calculateEq106_1_1PrevYears", RcbArray().initialize("Eq_106.1.1_пред_лет_Сумма1", "Eq_106.1.1_пред_лет_Сумма2", "Eq_106.1.1_прошл_года")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_106.1.1_прошл_года_Сумма1",          "calculateEq106_1_1PrevYear_Sum1", RcbArray().initialize("Eq_док_подтв_суммы_доход_ПрошлГ_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_106.1.1_прошл_года_Сумма2",          "calculateEq106_1_1PrevYear_Sum2", RcbArray().initialize("Eq_док_подтв_суммы_расход_ПрошлГ_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_106.1.1_прошл_года",                 "calculateEq106_1_1PrevYear", RcbArray().initialize("Eq_106.1.1_прошл_года_Сумма1", "Eq_106.1.1_прошл_года_Сумма2")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_док_подтв_суммы_доход_ПрошлГ_ввод",  "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_док_подтв_суммы_расход_ПрошлГ_ввод", "processUserAttribute", RcbArray()));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_106.1.1",                            "calculateEq106_1_1", RcbArray().initialize("Строка_106.1.1_ввод","Eq_Прибыль_пред_лет","Eq_106.1.1_пред_лет","Eq_106.1.1_прошл_года")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_106.1.2_пред_лет",                   "calculateEq106_1_2prevYears", RcbArray().initialize("Eq_106.1.2_нереал_полож_пред_лет", "Eq_106.1.2_нереал_отриц_пред_лет")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_106.1.2_прошл_года",                 "calculateEq106_1_2prevYear", RcbArray().initialize("Eq_106.1.2_нереал_полож_прошл_года", "Eq_106.1.2_нереал_отриц_прошл_года")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_106.1.2",                            "calculateEq106_1_2", RcbArray().initialize("Строка_106.1.2_полож_ввод","Строка_106.1.2_отриц_ввод","Eq_Прибыль_пред_лет","Eq_106.1.2_прошл_года","Eq_106.1.2_пред_лет")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_106.1.2_нереал_полож_пред_лет_Сумма1", "calculateEq106_1_2NotImplPrevYears_Sum1", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_106.1.2_нереал_полож_пред_лет_Сумма2", "calculateEq106_1_2NotImplPrevYears_Sum2", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_106.1.2_нереал_полож_пред_лет",        "calculateEq106_1_2NotImplPrevYears", RcbArray().initialize("Eq_106.1.2_нереал_полож_пред_лет_Сумма1", "Eq_106.1.2_нереал_полож_пред_лет_Сумма2", "Eq_106.1.2_нереал_полож_прошл_года","Строка_106.1.2_полож_ввод")));
    
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_106.1.2_нереал_полож_прошл_года_Сумма1", "calculateEq106_1_2NotImplPrevYear_Sum1", RcbArray().initialize("Eq_70713_нер_корр_ввод","Eq_106.1.1_прошл_года_Сумма1")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_106.1.2_нереал_полож_прошл_года_Сумма2", "calculateEq106_1_2NotImplPrevYear_Sum2", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_106.1.2_нереал_полож_прошл_года",        "calculateEq106_1_2NotImplPrevYear", RcbArray().initialize("Eq_106.1.2_нереал_полож_прошл_года_Сумма1", "Eq_106.1.2_нереал_полож_прошл_года_Сумма2")));
    
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_70713_нер_корр_ввод",                    "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_70714_нер_корр_ввод",                    "processUserAttribute", RcbArray()));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_106.1.2_нереал_полож",                   "calculateEq106_1_2NotImplPositive", RcbArray().initialize("Eq_Прибыль_пред_лет","Eq_106.1.2_нереал_полож_пред_лет","Eq_106.1.2_нереал_полож_прошл_года")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_106.1.2_нереал_отриц_пред_лет",          "calculateEq106_1_2NotImplNegativePrevYears", RcbArray().initialize("Eq_106.1.2_нереал_полож_пред_лет_Сумма1", "Eq_106.1.2_нереал_полож_пред_лет_Сумма2", "Eq_106.1.2_нереал_отриц_прошл_года", "Строка_106.1.2_отриц_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_106.1.2_нереал_отриц_прошл_года",        "calculateEq106_1_2NotImplNegativePrevYear", RcbArray().initialize("Eq_106.1.2_нереал_полож_прошл_года_Сумма2","Eq_106.1.2_нереал_полож_прошл_года_Сумма1", "Строка_106.1.2_отриц_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_106.1.2_нереал_отриц",                   "calculateEq106_1_2NotImplNegative", RcbArray().initialize("Eq_Прибыль_пред_лет","Eq_106.1.2_нереал_отриц_пред_лет","Eq_106.1.2_нереал_отриц_прошл_года")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq2_1_12данные",                            "calculateEq2_1_12data", RcbArray()));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq2_1_12",                                  "calculateEq2_1_12", RcbArray().initialize("Eq2_1_1(2_1_2)","Eq2_1_3(2_1_4)","Eq2_1_5","Eq2_1_6","Eq2_1_7","Eq2_1_11","Eq2_2_1","Eq2_2_2(2_2_3)","Eq2_2_4","Eq2_2_5","Eq2_2_6","Eq2_2_8","Eq2_2_9","Eq2_1_12данные")));
        
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("EqИстОсн",                                  "calculateEqMainReal", RcbArray().initialize("Eq2_1_1(2_1_2)","Eq2_1_3(2_1_4)","Eq2_1_5","Eq2_1_6","Eq2_1_7","Eq2_1_11", "Eq2_1_12")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq2_2_1",                                   "calculateEq2_2_1", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq2_2_2(2_2_3)",                            "calculateEq2_2_2__2_2_3", RcbArray().initialize("Eq2_2_2(2_2_3)ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq2_2_2(2_2_3)ввод",                        "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq2_2_4",                                   "calculateEq2_2_4", RcbArray().initialize("Eq_Прибыль_пред_лет","Eq_Прибыль_прошл_года")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_111.1",                                  "calculateEq111_1", RcbArray().initialize("Eq_Прибыль_пред_лет","Eq_Прибыль_прошл_года","Eq_106.1_прошл_года","Eq_106.1_пред_лет","Строка_111.1.1_ввод", "Строка_111.1.2_отриц_ввод","Строка_111.1.2_полож_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_111.1.1",                                "calculateEq111_1_1", RcbArray().initialize("Eq_Прибыль_пред_лет","Eq_Прибыль_прошл_года","Eq_106.1.1_прошл_года","Eq_106.1.1_пред_лет","Строка_111.1.1_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_111.1.2",                                "calculateEq111_1_2", RcbArray().initialize("Строка_111.1.2_полож_ввод","Строка_111.1.2_отриц_ввод","Eq_Прибыль_пред_лет","Eq_Прибыль_прошл_года","Eq_106.1.2_прошл_года","Eq_106.1.2_пред_лет")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_111.1.2_нереал_полож",                   "calculateEq111_1_2NotImplPositive", RcbArray().initialize("Строка_111.1.2_полож_ввод","Eq_Прибыль_пред_лет","Eq_Прибыль_прошл_года","Eq_106.1.2_нереал_полож_прошл_года","Eq_106.1.2_нереал_полож_пред_лет")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_111.1.2_нереал_отриц",                   "calculateEq111_1_2NotImplNegative", RcbArray().initialize("Строка_111.1.2_отриц_ввод","Eq_Прибыль_пред_лет","Eq_Прибыль_прошл_года","Eq_106.1.2_нереал_отриц_прошл_года","Eq_106.1.2_нереал_отриц_пред_лет")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq2_2_5данные",                             "calculateEq2_2_5data", RcbArray().initialize("Eq_112.2_данные","Eq2_2_5ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq2_2_5",                                   "calculateEq2_2_5", RcbArray().initialize("Eq2_2_5данные", "Eq2_1_6")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq2_2_5ввод",                               "processUserAttribute", RcbArray()));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_112.2_данные",                           "calculateEq112_2data", RcbArray().initialize("Eq_112.2.1_данные", "Eq_112.2.2_нереал_отриц_данные","Eq_112.2.2_нереал_полож_данные")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_112.2",                                  "calculateEq112_2", RcbArray().initialize("Строка_112.2.1_ввод","Строка_112.2.2_отриц_ввод", "Строка_112.2.2_полож_ввод","Eq2_2_5","Eq_112.2_данные")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_112.2.1_данные_Сумма1",                   "calculateEq112_2_1dataSum1", RcbArray().initialize("Eq_док_подтв_суммы_70614_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_112.2.1_данные_Сумма2",                   "calculateEq112_2_1dataSum2", RcbArray().initialize("Eq_док_подтв_суммы_70613_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_112.2.1_данные",                         "calculateEq112_2_1data", RcbArray().initialize("Eq_112.2.1_данные_Сумма1","Eq_112.2.1_данные_Сумма2")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_112.2.1",                                "calculateEq112_2_1", RcbArray().initialize("Строка_112.2.1_ввод", "Eq2_2_5", "Eq_112.2.1_данные")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_112.2.2_данные",                         "calculateEq112_2_2data", RcbArray().initialize("Eq_112.2.2_нереал_полож_данные", "Eq_112.2.2_нереал_отриц_данные")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_112.2.2",                                "calculateEq112_2_2", RcbArray().initialize("Строка_112.2.2_полож_ввод","Строка_112.2.2_отриц_ввод","Eq2_2_5","Eq_112.2.2_данные")));


        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_112.2.2_нереал_полож_данные_Сумма1",     "calculateEq112_2NotImplPositiveDataSum1", RcbArray().initialize("Eq_70613_нер_корр_ввод","Eq_112.2.1_данные_Сумма1")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_112.2.2_нереал_полож_данные_Сумма2",     "calculateEq112_2NotImplPositiveDataSum2", RcbArray().initialize("Eq_70614_нер_корр_ввод","Eq_112.2.1_данные_Сумма2")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_112.2.2_нереал_полож_данные",            "calculateEq112_2NotImplPositiveData", RcbArray().initialize("Eq_112.2.2_нереал_полож_данные_Сумма1","Eq_112.2.2_нереал_полож_данные_Сумма2")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_112.2.2_нереал_полож",                   "calculateEq112_2NotImplPositive", RcbArray().initialize("Строка_112.2.2_полож_ввод","Eq2_2_5","Eq_112.2.2_нереал_полож_данные")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_112.2.2_нереал_отриц_данные",            "calculateEq112_2NotImplNegativeData", RcbArray().initialize("Eq_112.2.1_данные_Сумма2","Eq_112.2.1_данные_Сумма1")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_112.2.2_нереал_отриц",                   "calculateEq112_2NotImplNegative", RcbArray().initialize("Строка_112.2.2_отриц_ввод","Eq_112.2.2_нереал_отриц_данные","Eq2_2_5")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq2_2_5переоценка_данные",                   "calculateEq2_2_5RevaluationData", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq2_2_5переоценка",                          "calculateEq2_2_5Revaluation", RcbArray().initialize("Eq2_2_5переоценка_данные", "Eq2_1_6_переоценка")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq2_2_6",                                    "calculateEq2_2_6", RcbArray().initialize("Eq2_2_6ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq2_2_6ввод",                                "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq2_2_8",                                    "calculateEq2_2_8", RcbArray().initialize("Eq2_2_8ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq2_2_8ввод",                                "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq2_2_9",                                    "calculateEq2_2_9", RcbArray().initialize("EqИстДоп")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("EqОсн",                                      "calculateEqMain", RcbArray().initialize("EqИстОсн","Eq2_2_1", "Eq2_2_2(2_2_3)", "Eq2_2_4", "Eq2_2_5", "Eq2_2_6", "Eq2_2_8", "Eq2_2_9")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq3_1",                                      "calculateEq3_1", RcbArray()));
//        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq3_1",                                      "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq3_3",                                      "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq3_4данные",                                "calculateEq3_4data", RcbArray().initialize("Eq_203.2_данные","Eq2_2_5ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq3_4",                                      "calculateEq3_4", RcbArray().initialize("Eq3_4данные","Eq2_1_6")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq3_4переоценка_данные",                     "calculateEq3_4RevaluationData", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq3_4переоценка",                            "calculateEq3_4Revaluation", RcbArray().initialize("Eq3_4переоценка_данные","Eq2_1_6_переоценка")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_203.2_данные",                            "calculateEq203_2data", RcbArray().initialize("Eq_203.2.1_данные", "Eq_203.2.2_нереал_полож_данные","Eq_203.2.2_нереал_отриц_данные")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_203.2",                                   "calculateEq203_2", RcbArray().initialize("Строка_203.2.1_ввод", "Строка_203.2.2_полож_ввод","Строка_203.2.2_отриц_ввод","Eq3_4","Eq_203.2_данные")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_203.2.1_данные_Сумма1",        "calculateEq203_2_1DataSum1", RcbArray().initialize("Eq_203.2.1_док_суммы_70613_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_203.2.1_данные_Сумма2",        "calculateEq203_2_1DataSum2", RcbArray().initialize("Eq_203.2.1_док_суммы_70614_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_203.2.1_данные",               "calculateEq203_2_1Data", RcbArray().initialize("Eq_203.2.1_данные_Сумма1","Eq_203.2.1_данные_Сумма2")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_203.2.1_док_суммы_70613_ввод", "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_203.2.1_док_суммы_70614_ввод", "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_203.2.1",                      "calculateEq203_2_1", RcbArray().initialize("Строка_203.2.1_ввод","Eq3_4","Eq_203.2.1_данные")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_203.2.2_данные",               "calculateEq203_2_2data", RcbArray().initialize("Eq_203.2.2_нереал_полож_данные","Eq_203.2.2_нереал_отриц_данные")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_203.2.2",                      "calculateEq203_2_2", RcbArray().initialize("Строка_203.2.2_полож_ввод","Строка_203.2.2_отриц_ввод","Eq3_4","Eq_203.2.2_данные")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_203.2.2_нереал_полож_данные_Сумма1",        "calculateEq203_2_2NotImplPositiveDataSum1", RcbArray().initialize("Eq_203.2.2_70613_нер_корр_ввод","Eq_203.2.1_данные_Сумма1")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_203.2.2_нереал_полож_данные_Сумма2",        "calculateEq203_2_2NotImplPositiveDataSum2", RcbArray().initialize("Eq_203.2.2_70614_нер_корр_ввод","Eq_203.2.1_данные_Сумма2")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_203.2.2_нереал_полож_данные",               "calculateEq203_2_2NotImplPositiveData", RcbArray().initialize("Eq_203.2.2_нереал_полож_данные_Сумма1","Eq_203.2.2_нереал_полож_данные_Сумма2")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_203.2.2_70613_нер_корр_ввод",               "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_203.2.2_70614_нер_корр_ввод",               "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_203.2.2_нереал_полож",                      "calculateEq203_2_2NotImplPositive", RcbArray().initialize("Строка_203.2.2_полож_ввод","Eq3_4","Eq_203.2.2_нереал_полож_данные")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_203.2.2_нереал_отриц_данные",               "calculateEq203_2_2NotImplNegativeData", RcbArray().initialize("Eq_203.2.2_нереал_полож_данные_Сумма2","Eq_203.2.2_нереал_полож_данные_Сумма1")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_203.2.2_нереал_отриц",                      "calculateEq203_2_2NotImplNegative", RcbArray().initialize("Строка_203.2.2_отриц_ввод","Eq_203.2.2_нереал_отриц_данные","Eq3_4")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq3_5данные",                      "calculateEq3_5data", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq3_5данные10лет",                 "calculateEq3_5data10Years", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq3_5",                            "calculateEq3_5", RcbArray().initialize("Eq3_5данные", "Eq3_5данные10лет")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_204.1",                         "calculateEq204_1", RcbArray().initialize("Eq3_5данные","EqОсн")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_204.2",                         "calculateEq204_2", RcbArray().initialize("Eq3_5данные10лет","EqОсн","Eq_204.1")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq3_6",                            "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq3_7",                            "calculateEq3_7", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq3_9",                            "calculateEq3_9", RcbArray().initialize("Eq_Прибыль_пред_лет","Eq2_1_11","Eq_Прибыль_прошл_года")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_207.1",                         "calculateEq207_1", RcbArray().initialize("Eq_Прибыль_пред_лет","Eq_Прибыль_прошл_года","Eq_106.1_пред_лет","Eq_106.1","Eq_106.1_прошл_года")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_207.1.1",                       "calculateEq207_1_1", RcbArray().initialize("Eq_Прибыль_пред_лет","Eq_Прибыль_прошл_года","Eq_106.1.1_пред_лет","Eq_106.1.1","Eq_106.1.1_прошл_года")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_207.1.2",                       "calculateEq207_1_2", RcbArray().initialize("Eq_Прибыль_пред_лет","Eq_Прибыль_прошл_года","Eq_106.1.2_пред_лет","Eq_106.1.2","Eq_106.1.2_прошл_года")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_207.1.2_нереал_полож",          "calculateEq207_1_2NotImplPositive", RcbArray().initialize("Eq_Прибыль_пред_лет","Eq_106.1.2_нереал_полож_пред_лет","Eq_106.1.2_нереал_полож","Eq_Прибыль_прошл_года","Eq_106.1.2_нереал_полож_прошл_года")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_207.1.2_нереал_отриц",          "calculateEq207_1_2NotImplNegative", RcbArray().initialize("Eq_Прибыль_пред_лет","Eq_Прибыль_прошл_года","Eq_106.1.2_нереал_отриц_пред_лет","Eq_106.1.2_нереал_отриц","Eq_106.1.2_нереал_отриц_прошл_года")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq3_10",                           "calculateEq3_10", RcbArray().initialize("Eq3_10ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq3_10ввод",                       "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("EqИстДоп",                         "calculateEqRealAdditional", RcbArray().initialize("Eq3_1", "Eq3_3", "Eq3_4", "Eq3_5", "Eq3_6", "Eq3_7", "Eq3_9","Eq3_10")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("EqДоп",                            "calculateEqReal", RcbArray().initialize("EqОсн","EqИстДоп","Eq3_1", "Eq3_3", "Eq3_4", "Eq3_6", "Eq3_7", "Eq3_9","Eq3_10","Eq3_5данные","Eq3_5данные10лет")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq4_5",                            "calculateEq4_5", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq4_6",                            "calculateEq4_6", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("EqПром",                           "calculateEqSubTotal", RcbArray().initialize("EqОсн","EqДоп","Eq4_5","Eq4_6")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq5_1",                            "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq5_2_Имущество",                  "calculateEq5_2assets", RcbArray().initialize("Eq5_2ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq5_2_ОснДоп",                     "calculateEq5_2MainAdditional", RcbArray().initialize("EqОсн", "Eq3_3", "Eq3_4", "Eq3_6", "Eq3_7", "Eq3_9", "Eq3_10")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq5_2",                            "calculateEq5_2", RcbArray().initialize("Eq5_2_ОснДоп","Eq5_2_Имущество")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq5_2ввод",                        "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq5_3",                            "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_104.2.1_ввод",               "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_104.2.2_полож_ввод",         "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_104.2.2_отриц_ввод",         "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1.1_ввод",               "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1.2_полож_ввод",         "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1.2_отриц_ввод",         "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_111.1.1_ввод",               "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_111.1.2_полож_ввод",         "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_111.1.2_отриц_ввод",         "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112.2.1_ввод",               "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112.2.2_полож_ввод",         "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112.2.2_отриц_ввод",         "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203.2.1_ввод",               "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203.2.2_полож_ввод",         "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203.2.2_отриц_ввод",         "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_207.1.1_ввод",               "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_207.1.2_полож_ввод",         "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_207.1.2_отриц_ввод",         "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Недосозд_резерв_всего",             "calculateReserveShortfall", RcbArray().initialize("Недосозд_резерв_254П_ввод","Недосозд_резерв_283П_ввод","Недосозд_резерв_1584У_ввод","Недосозд_резерв_2732У_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Недосозд_резерв_254П_ввод",         "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Недосозд_резерв_283П_ввод",         "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Недосозд_резерв_1584У_ввод",        "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Недосозд_резерв_2732У_ввод",        "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_недосозд_рез_ввод",          "processUserAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("EqК",                               "calculateEqK", RcbArray().initialize("EqПром","Eq5_1", "Eq5_2", "Eq5_3")));
    end;
end;
/**
 * Класс окончательного расчета отчета
 */
class (F134PartCalculateController) F134Part1FinalCalculateController(reportCalculateController : Object /*TReportCalculateController*/, part1CalculateController : F134Part1CalculateController)
    initF134PartCalculateController(reportCalculateController, "1");

    private var m_part1CalculateController = part1CalculateController;

    macro processCalculatedAttribute(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        m_protocolView.printLine("Атрибут рассчитанный на этапе предварительного расчета: " + attribute.getId());

        if (attribute.getValue() == null)
            m_protocolView.printLine("\nЗначение не заданно, полагаем равным нулю");
            
            attribute.setValue($0.0);
        end;

        m_protocolView.printLine("\n" + attribute.getId + " = " + attribute.getValue());
    end;
    
    macro calculateEq2_1_6data(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        
        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "104")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray(),
                               RcbArray().initialize("Eq_104.3"));
        end;
    end;

    macro calculateEq2_1_6(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        
        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "104")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Eq2_1_6данные"),
                               RcbArray(), 
                               true);
        end;
    end;

    macro calculateEq104_3(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        
        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "104")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_всего"),
                               RcbArray());
        end;
    end;

    macro calculateEq104_3_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        
        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "104")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_254П_ввод"),
                               RcbArray());
        end;
    end;

    macro calculateEq104_3_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        
        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "104")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_283П_ввод"),
                               RcbArray());
        end;
    end;

    macro calculateEq104_3_3(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        
        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "104")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_1584У_ввод"),
                               RcbArray());
        end;
    end;

    macro calculateEq104_3_4(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        
        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "104")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_2732У_ввод"),
                               RcbArray());
        end;
    end;

    macro calculateEqPriviousProfit(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        
        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(),"106","111","207"))
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray(),
                               RcbArray().initialize("Недосозд_резерв_всего"));
        end;
    end;

    macro calculateEqPriviousYearProfit(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        
        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(),"106","111","207"))
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray(),
                               RcbArray().initialize("Недосозд_резерв_всего"));
        end;
    end;

    macro calculateEq2_1_11(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
         
        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(),"106","111"))
            attribute.setValue($0.0);
    
            m_part1CalculateController.calculateEq2_1_11(attributeId);
        end;
    end;

    macro calculateEq106_1_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
         
        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(),"106","111","207"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateEq106_1_1(attributeId);
        end;
    end;

    macro calculateEq106_1_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
         
        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(),"106","111","207"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateEq106_1_2(attributeId);
        end;
    end;

    macro calculateEq106_1_2NotImplPositive(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
         
        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(),"106","111","207"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateEq106_1_2NotImplPositive(attributeId);
        end;
    end;

    macro calculateEq106_1_2NotImplNegative(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
         
        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(),"106","111","207"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateEq106_1_2NotImplNegative(attributeId);
        end;
    end;

    macro calculateEq106_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        
        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "106")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_всего"),
                               RcbArray(), 
                               true);
        end;
    end;

    macro calculateEq106_2_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
                
        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "106")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_254П_ввод"),
                               RcbArray(), 
                               true);
        end;
    end;

    macro calculateEq106_2_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        
        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "106")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_283П_ввод"),
                               RcbArray(), 
                               true);
        end;
    end;

    macro calculateEq106_2_3(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        
        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "106")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_1584У_ввод"),
                               RcbArray(), 
                               true);
        end;
    end;

    macro calculateEq106_2_4(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        
        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "106")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_2732У_ввод"),
                               RcbArray(), 
                               true);
        end;
    end;

    macro calculateEq2_1_12(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
         
        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(),"104", "106", "111", "112", "203", "207"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateEq2_1_12(attributeId);
        end;
    end;

    macro calculateEqMainReal(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
         
        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(),"104", "106", "111", "112", "203", "207"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateEqMainReal(attributeId);
        end;
    end;

    macro calculateEq2_2_4(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
         
        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(),"106", "111"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateEq2_2_4(attributeId);
        end;
    end;

    macro calculateEq111_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
         
        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(),"106", "111"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateEq111_1(attributeId);
        end;
    end;

    macro calculateEq111_1_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
         
        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(),"106", "111"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateEq111_1_1(attributeId);
        end;
    end;

    macro calculateEq111_1_2NotImplPositive(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(),"106", "111"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateEq111_1_2NotImplPositive(attributeId);
        end;
    end;

    macro calculateEq111_1_2NotImplNegative(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
         
        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(),"106", "111"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateEq111_1_2NotImplNegative(attributeId);
        end;
    end;

    macro calculateEq111_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        
        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "111")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_всего"),
                               RcbArray(), 
                               true);
        end;
    end;

    macro calculateEq111_2_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
                
        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "111")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_254П_ввод"),
                               RcbArray(), 
                               true);
        end;
    end;

    macro calculateEq111_2_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        
        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "111")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_283П_ввод"),
                               RcbArray(), 
                               true);
        end;
    end;

    macro calculateEq111_2_3(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        
        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "111")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_1584У_ввод"),
                               RcbArray(), 
                               true);
        end;
    end;

    macro calculateEq111_2_4(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        
        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "111")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_2732У_ввод"),
                               RcbArray(), 
                               true);
        end;
    end;

    macro calculateEq2_2_5data(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        
        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(),"104","112"))
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Eq_112.3"),
                               RcbArray());
        end;
    end;

    macro calculateEq2_2_5(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(),"104","112"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateEq2_2_5(attributeId);
        end;
    end;

    macro calculateEq112_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
         
        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(),"104","112"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateEq112_2(attributeId);
        end;
    end;

    macro calculateEq112_2_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
         
        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(),"104","112"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateEq112_2_1(attributeId);
        end;
    end;

    macro calculateEq112_2_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
         
        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(),"104","112"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateEq112_2_2(attributeId);
        end;
    end;

    macro calculateEq112_2NotImplPositive(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
         
        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(),"104","112"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateEq112_2NotImplPositive(attributeId);
        end;
    end;

    macro calculateEq112_2NotImplNegative(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
         
        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(),"104","112"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateEq112_2NotImplNegative(attributeId);
        end;
    end;

    macro calculateEq112_3(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        
        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "112")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_всего"),
                               RcbArray(), 
                               true);
        end;
    end;

    macro calculateEq112_3_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        
        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "112")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_254П_ввод"),
                               RcbArray(), 
                               true);
        end;
    end;

    macro calculateEq112_3_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        
        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "112")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_283П_ввод"),
                               RcbArray(), 
                               true);
        end;
    end;

    macro calculateEq112_3_3(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        
        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "112")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_1584У_ввод"),
                               RcbArray(), 
                               true);
        end;
    end;

    macro calculateEq112_3_4(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        
        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "112")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_2732У_ввод"),
                               RcbArray(), 
                               true);
        end;
    end;

    macro calculateEq2_2_5Revaluation(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
         
        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(), "112"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateEq2_2_5Revaluation(attributeId);
        end;
    end;

    macro calculateEq2_2_9(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
         
        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(), "203", "207"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateEq2_2_9(attributeId);
        end;
    end;

    macro calculateEqMain(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
         
        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(), "104", "106", "111", "112", "203", "207"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateEqMain(attributeId);
        end;
    end;

    macro calculateEq3_4data(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        
        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "203")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray(),
                               RcbArray().initialize("Недосозд_резерв_всего"));
        end;
    end;

    macro calculateEq3_4(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
         
        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(), "104", "203"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateEq3_4(attributeId);
        end;
    end;

    macro calculateEq3_4Revaluation(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
         
        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(), "104", "203"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateEq3_4Revaluation(attributeId);
        end;
    end;
          
    macro calculateEq203_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
         
        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(), "104", "203"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateEq203_2(attributeId);
        end;
    end;

    macro calculateEq203_2_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
         
        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(), "104", "203"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateEq203_2_1(attributeId);
        end;
    end;

    macro calculateEq203_2_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
         
        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(), "104", "203"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateEq203_2_2(attributeId);
        end;
    end;

    macro calculateEq203_2_2NotImplPositive(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
         
        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(), "104", "203"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateEq203_2_2NotImplPositive(attributeId);
        end;
    end;

    macro calculateEq203_2_2NotImplNegative(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
         
        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(), "104", "203"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateEq203_2_2NotImplNegative(attributeId);
        end;
    end;

    macro calculateEq203_3(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        
        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "203")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_всего"),
                               RcbArray(), 
                               true);
        end;
    end;

    macro calculateEq203_3_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
                
        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "203")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_254П_ввод"),
                               RcbArray(), 
                               true);
        end;
    end;

    macro calculateEq203_3_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        
        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "203")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_283П_ввод"),
                               RcbArray(), 
                               true);
        end;
    end;

    macro calculateEq203_3_3(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        
        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "203")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_1584У_ввод"),
                               RcbArray(), 
                               true);
        end;
    end;

    macro calculateEq203_3_4(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        
        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "203")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_2732У_ввод"),
                               RcbArray(), 
                               true);
        end;
    end;

    macro calculateEq204_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
         
        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(), "104", "106", "111", "112", "203", "207"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateEq204_1(attributeId);
        end;
    end;

    macro calculateEq204_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
         
        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(), "104", "106", "111", "112", "203", "207"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateEq204_2(attributeId);
        end;
    end;

    macro calculateEq3_9(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
         
        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(), "106", "207"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateEq3_9(attributeId);
        end;
    end;

    macro calculateEq207_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
         
        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(), "106", "207"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateEq207_1(attributeId);
        end;
    end;


    macro calculateEq207_1_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
         
        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(), "106", "207"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateEq207_1_1(attributeId);
        end;
    end;

    
    macro calculateEq207_1_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
         
        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(), "106", "207"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateEq207_1_2(attributeId);
        end;
    end;

    
    macro calculateEq207_1_2NotImplPositive(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
         
        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(), "106", "207"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateEq207_1_2NotImplPositive(attributeId);
        end;
    end;

    
    macro calculateEq207_1_2NotImplNegative(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
         
        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(), "106", "207"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateEq207_1_2NotImplNegative(attributeId);
        end;
    end;

    macro calculateEq207_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        
        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "207")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_всего"),
                               RcbArray(), 
                               true);
        end;
    end;

    macro calculateEq207_2_1(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        
        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "207")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_254П_ввод"),
                               RcbArray(), 
                               true);
        end;
    end;

    macro calculateEq207_2_2(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        
        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "207")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_283П_ввод"),
                               RcbArray(), 
                               true);
        end;
    end;

    macro calculateEq207_2_3(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        
        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "207")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_1584У_ввод"),
                               RcbArray(), 
                               true);
        end;
    end;

    macro calculateEq207_2_4(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        
        if (m_part.getAttribute("Строка_недосозд_рез_ввод").getValue() == "207")
            printAttributeHead(attributeId);

            setValueAttributes(attribute,
                               RcbArray().initialize("Недосозд_резерв_2732У_ввод"),
                               RcbArray(), 
                               true);
        end;
    end;

    macro calculateEqRealAdditional(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
         
        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(), "203", "207"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateEqRealAdditional(attributeId);
        end;
    end;

    macro calculateEqReal(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
         
        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(), "104", "106", "111", "112", "203", "207"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateEqReal(attributeId);
        end;
    end;

    macro calculateReserveShortfall(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
         
        attribute.setValue($0.0);

        m_part1CalculateController.calculateReserveShortfall(attributeId);

        if (m_part.getAttribute(attributeId).getValue() == $0.0)
            msgBox("Общая сумма недосозданного резерва равна нулю." + "|" + " Окончательный расчет завершен");
            установитьФлагВозврата(STOP_PROC_FLG);
            exit(1);
        end;
    end;

    macro calculateEqSubTotal(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
         
        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(), "104", "106", "111", "112", "203", "207"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateEqSubTotal(attributeId);
        end;
    end;

    macro calculateEq5_2MainAdditional(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
         
        if (in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(), "104", "106", "111", "112", "203", "207"))
            attribute.setValue($0.0);
            m_part1CalculateController.calculateEq5_2MainAdditional(attributeId);
        end;
    end;

    macro calculateReserveShortfallStringInput(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        printAttributeHead(attributeId);

        m_protocolView.printLine("Атрибут пользователького ввода: " + attribute.getId());

        m_protocolView.printLine("\n" + attribute.getId + " = " + attribute.getValue());

        if (not in(m_part.getAttribute("Строка_недосозд_рез_ввод").getValue(), "104", "106", "111", "112", "203", "207"))
            msgBox("Номер строки, в которой должен отражаться ", "|", 
                    "недосозданный резерв, введен неверно.", "|",
                    "Введите одно из значений:", "|", 
                    "104, 106, 111, 112, 203, 207, ", "|", 
                    "и повторите операцию 'Окончательный расчет'.");
            установитьФлагВозврата(STOP_PROC_FLG);
            exit(1);
        end;
    end;

    macro execute()
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_недосозд_рез_ввод", "calculateReserveShortfallStringInput", RcbArray().initialize("Недосозд_резерв_всего")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq2_1_6данные", "calculateEq2_1_6data", RcbArray().initialize("Строка_недосозд_рез_ввод","Eq_104.3")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq2_1_6",       "calculateEq2_1_6", RcbArray().initialize("Строка_недосозд_рез_ввод","Eq2_1_6данные")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_104.3",         "calculateEq104_3", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_всего")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_104.3.1",       "calculateEq104_3_1", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_254П_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_104.3.2",       "calculateEq104_3_2", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_283П_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_104.3.3",       "calculateEq104_3_3", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_1584У_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_104.3.4",       "calculateEq104_3_4", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_2732У_ввод")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_Прибыль_пред_лет",   "calculateEqPriviousProfit", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_всего")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_Прибыль_прошл_года", "calculateEqPriviousYearProfit", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_всего")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq2_1_11",              "calculateEq2_1_11", RcbArray().initialize("Eq_Прибыль_пред_лет", "Eq_Прибыль_прошл_года")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_106.1.1",            "calculateEq106_1_1", RcbArray().initialize("Строка_106.1.1_ввод","Eq_Прибыль_пред_лет","Eq_106.1.1_пред_лет","Eq_106.1.1_прошл_года")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_106.1.2",            "calculateEq106_1_2", RcbArray().initialize("Строка_106.1.2_полож_ввод","Строка_106.1.2_отриц_ввод","Eq_Прибыль_пред_лет","Eq_106.1.2_прошл_года","Eq_106.1.2_пред_лет")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_106.1.2_нереал_полож",  "calculateEq106_1_2NotImplPositive", RcbArray().initialize("Eq_Прибыль_пред_лет","Eq_106.1.2_нереал_полож_пред_лет","Eq_106.1.2_нереал_полож_прошл_года")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_106.1.2_нереал_отриц",  "calculateEq106_1_2NotImplNegative", RcbArray().initialize("Eq_Прибыль_пред_лет","Eq_106.1.2_нереал_отриц_пред_лет","Eq_106.1.2_нереал_отриц_прошл_года")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_106.2",   "calculateEq106_2", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_всего")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_106.2.1", "calculateEq106_2_1", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_254П_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_106.2.2", "calculateEq106_2_2", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_283П_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_106.2.3", "calculateEq106_2_3", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_1584У_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_106.2.4", "calculateEq106_2_4", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_2732У_ввод")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq2_1_12", "calculateEq2_1_12", RcbArray().initialize("Eq2_1_1(2_1_2)","Eq2_1_3(2_1_4)","Eq2_1_5","Eq2_1_6","Eq2_1_7","Eq2_1_11","Eq2_2_1","Eq2_2_2(2_2_3)","Eq2_2_4","Eq2_2_5","Eq2_2_6","Eq2_2_8","Eq2_2_9","Eq2_1_12данные")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("EqИстОсн", "calculateEqMainReal", RcbArray().initialize("Eq2_1_1(2_1_2)","Eq2_1_3(2_1_4)","Eq2_1_5","Eq2_1_6","Eq2_1_7","Eq2_1_11", "Eq2_1_12")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq2_2_4",  "calculateEq2_2_4", RcbArray().initialize("Eq_Прибыль_пред_лет","Eq_Прибыль_прошл_года")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_111.1", "calculateEq111_1", RcbArray().initialize("Eq_Прибыль_пред_лет","Eq_Прибыль_прошл_года","Eq_106.1_прошл_года","Eq_106.1_пред_лет","Строка_111.1.1_ввод", "Строка_111.1.2_отриц_ввод","Строка_111.1.2_полож_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_111.1.1", "calculateEq111_1_1", RcbArray().initialize("Eq_Прибыль_пред_лет","Eq_Прибыль_прошл_года","Eq_106.1.1_прошл_года","Eq_106.1.1_пред_лет","Строка_111.1.1_ввод")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_111.1.2_нереал_полож", "calculateEq111_1_2NotImplPositive", RcbArray().initialize("Строка_111.1.2_полож_ввод","Eq_Прибыль_пред_лет","Eq_Прибыль_прошл_года","Eq_106.1.2_нереал_полож_прошл_года","Eq_106.1.2_нереал_полож_пред_лет")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_111.1.2_нереал_отриц", "calculateEq111_1_2NotImplNegative", RcbArray().initialize("Строка_111.1.2_отриц_ввод","Eq_Прибыль_пред_лет","Eq_Прибыль_прошл_года","Eq_106.1.2_нереал_отриц_прошл_года","Eq_106.1.2_нереал_отриц_пред_лет")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_111.2",   "calculateEq111_2", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_всего")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_111.2.1", "calculateEq111_2_1", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_254П_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_111.2.2", "calculateEq111_2_2", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_283П_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_111.2.3", "calculateEq111_2_3", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_1584У_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_111.2.4", "calculateEq111_2_4", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_2732У_ввод")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq2_2_5данные", "calculateEq2_2_5data", RcbArray().initialize("Строка_недосозд_рез_ввод", "Eq_112.3")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq2_2_5",       "calculateEq2_2_5", RcbArray().initialize("Eq2_2_5данные", "Eq2_1_6")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_112.2",      "calculateEq112_2", RcbArray().initialize("Строка_112.2.1_ввод","Строка_112.2.2_отриц_ввод", "Строка_112.2.2_полож_ввод","Eq2_2_5","Eq_112.2_данные")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_112.2.1",    "calculateEq112_2_1", RcbArray().initialize("Строка_112.2.1_ввод", "Eq2_2_5", "Eq_112.2.1_данные")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_112.2.2",    "calculateEq112_2_2", RcbArray().initialize("Строка_112.2.2_полож_ввод","Строка_112.2.2_отриц_ввод","Eq2_2_5","Eq_112.2.2_данные")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_112.2.2_нереал_полож", "calculateEq112_2NotImplPositive", RcbArray().initialize("Строка_112.2.2_полож_ввод","Eq2_2_5","Eq_112.2.2_нереал_полож_данные")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_112.2.2_нереал_отриц", "calculateEq112_2NotImplNegative", RcbArray().initialize("Строка_112.2.2_отриц_ввод","Eq_112.2.2_нереал_отриц_данные","Eq2_2_5")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_112.3",   "calculateEq112_3", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_всего")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_112.3.1", "calculateEq112_3_1", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_254П_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_112.3.2", "calculateEq112_3_2", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_283П_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_112.3.3", "calculateEq112_3_3", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_1584У_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_112.3.4", "calculateEq112_3_4", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_2732У_ввод")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq2_2_5переоценка", "calculateEq2_2_5Revaluation", RcbArray().initialize("Eq2_2_5переоценка_данные", "Eq2_1_6_переоценка")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq2_2_9",           "calculateEq2_2_9", RcbArray().initialize("EqИстДоп")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("EqОсн",             "calculateEqMain", RcbArray().initialize("EqИстОсн","Eq2_2_1", "Eq2_2_2(2_2_3)", "Eq2_2_4", "Eq2_2_5", "Eq2_2_6", "Eq2_2_8", "Eq2_2_9")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq3_4данные",       "calculateEq3_4data", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_всего")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq3_4",             "calculateEq3_4", RcbArray().initialize("Eq3_4данные","Eq2_1_6")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq3_4переоценка",   "calculateEq3_4Revaluation", RcbArray().initialize("Eq3_4переоценка_данные","Eq2_1_6_переоценка")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_203.2",          "calculateEq203_2", RcbArray().initialize("Строка_203.2.1_ввод", "Строка_203.2.2_полож_ввод","Строка_203.2.2_отриц_ввод","Eq3_4","Eq_203.2_данные")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_203.2.1",        "calculateEq203_2_1", RcbArray().initialize("Строка_203.2.1_ввод","Eq3_4","Eq_203.2.1_данные")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_203.2.2",        "calculateEq203_2_2", RcbArray().initialize("Строка_203.2.2_полож_ввод","Строка_203.2.2_отриц_ввод","Eq3_4","Eq_203.2.2_данные")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_203.2.2_нереал_полож", "calculateEq203_2_2NotImplPositive", RcbArray().initialize("Строка_203.2.2_полож_ввод","Eq3_4","Eq_203.2.2_нереал_полож_данные")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_203.2.2_нереал_отриц", "calculateEq203_2_2NotImplNegative", RcbArray().initialize("Строка_203.2.2_отриц_ввод","Eq_203.2.2_нереал_отриц_данные","Eq3_4")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_203.3",   "calculateEq203_3", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_всего")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_203.3.1", "calculateEq203_3_1", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_254П_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_203.3.2", "calculateEq203_3_2", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_283П_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_203.3.3", "calculateEq203_3_3", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_1584У_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_203.3.4", "calculateEq203_3_4", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_2732У_ввод")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_204.1",   "calculateEq204_1", RcbArray().initialize("Eq3_5данные","EqОсн")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_204.2",   "calculateEq204_2", RcbArray().initialize("Eq3_5данные10лет","EqОсн","Eq_204.1")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq3_9",      "calculateEq3_9", RcbArray().initialize("Eq_Прибыль_пред_лет","Eq2_1_11","Eq_Прибыль_прошл_года")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_207.1",                         "calculateEq207_1", RcbArray().initialize("Eq_Прибыль_пред_лет","Eq_Прибыль_прошл_года","Eq_106.1_пред_лет","Eq_106.1","Eq_106.1_прошл_года")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_207.1.1",                       "calculateEq207_1_1", RcbArray().initialize("Eq_Прибыль_пред_лет","Eq_Прибыль_прошл_года","Eq_106.1.1_пред_лет","Eq_106.1.1","Eq_106.1.1_прошл_года")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_207.1.2",                       "calculateEq207_1_2", RcbArray().initialize("Eq_Прибыль_пред_лет","Eq_Прибыль_прошл_года","Eq_106.1.2_пред_лет","Eq_106.1.2","Eq_106.1.2_прошл_года")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_207.1.2_нереал_полож",          "calculateEq207_1_2NotImplPositive", RcbArray().initialize("Eq_Прибыль_пред_лет","Eq_106.1.2_нереал_полож_пред_лет","Eq_106.1.2_нереал_полож","Eq_Прибыль_прошл_года","Eq_106.1.2_нереал_полож_прошл_года")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_207.1.2_нереал_отриц",          "calculateEq207_1_2NotImplNegative", RcbArray().initialize("Eq_Прибыль_пред_лет","Eq_Прибыль_прошл_года","Eq_106.1.2_нереал_отриц_пред_лет","Eq_106.1.2_нереал_отриц","Eq_106.1.2_нереал_отриц_прошл_года")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_207.2",   "calculateEq207_2", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_всего")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_207.2.1", "calculateEq207_2_1", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_254П_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_207.2.2", "calculateEq207_2_2", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_283П_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_207.2.3", "calculateEq207_2_3", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_1584У_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_207.2.4", "calculateEq207_2_4", RcbArray().initialize("Строка_недосозд_рез_ввод","Недосозд_резерв_2732У_ввод")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("EqИстДоп",     "calculateEqRealAdditional", RcbArray().initialize("Eq3_1", "Eq3_3", "Eq3_4", "Eq3_5", "Eq3_6", "Eq3_7", "Eq3_9","Eq3_10")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("EqДоп",        "calculateEqReal", RcbArray().initialize("EqОсн","EqИстДоп","Eq3_1", "Eq3_3", "Eq3_4", "Eq3_6", "Eq3_7", "Eq3_9","Eq3_10","Eq3_5данные","Eq3_5данные10лет")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("EqПром",       "calculateEqSubTotal", RcbArray().initialize("EqОсн","EqДоп","Eq4_5","Eq4_6")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq5_2_ОснДоп", "calculateEq5_2MainAdditional", RcbArray().initialize("EqОсн", "Eq3_3", "Eq3_4", "Eq3_6", "Eq3_7", "Eq3_9", "Eq3_10")));

        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Недосозд_резерв_всего",             "calculateReserveShortfall", RcbArray().initialize("Недосозд_резерв_254П_ввод","Недосозд_резерв_283П_ввод","Недосозд_резерв_1584У_ввод","Недосозд_резерв_2732У_ввод")));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Недосозд_резерв_254П_ввод", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Недосозд_резерв_283П_ввод", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Недосозд_резерв_1584У_ввод", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Недосозд_резерв_2732У_ввод", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1.1_ввод", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_106.1.1_пред_лет", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_106.1.1_прошл_года", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1.2_полож_ввод", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_106.1.2_отриц_ввод", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_106.1.2_прошл_года", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_106.1.2_пред_лет", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_106.1.2_нереал_полож_пред_лет", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_106.1.2_нереал_полож_прошл_года", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_106.1.2_нереал_отриц_пред_лет", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_106.1.2_нереал_отриц_прошл_года", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq2_1_1(2_1_2)", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq2_1_3(2_1_4)", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq2_1_5", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq2_1_7", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq2_2_1", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq2_2_2(2_2_3)", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq2_2_6", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq2_2_8", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq3_1", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq3_3", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq3_5", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq3_6", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq3_7", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq3_10", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq2_1_12данные", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_106.1_прошл_года", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_106.1_пред_лет", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_111.1.1_ввод", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_111.1.2_отриц_ввод", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_111.1.2_полож_ввод", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112.2.1_ввод", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112.2.2_отриц_ввод", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_112.2.2_полож_ввод", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_112.2_данные", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_112.2.1_данные", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_112.2.2_данные", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_112.2.2_нереал_полож_данные", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_112.2.2_нереал_отриц_данные", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq2_2_5переоценка_данные", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq2_1_6_переоценка", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq3_4переоценка_данные", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203.2.1_ввод", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203.2.2_полож_ввод", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Строка_203.2.2_отриц_ввод", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_203.2_данные", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_203.2.1_данные", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_203.2.2_данные", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_203.2.2_нереал_полож_данные", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_203.2.2_нереал_отриц_данные", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq3_5данные", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq3_5данные10лет", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq_106.1", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq4_5", "processCalculatedAttribute", RcbArray()));
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttributeData("Eq4_6", "processCalculatedAttribute", RcbArray()));
    end;
end;
