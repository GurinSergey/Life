/*********************************************************************/
/*  Форма 251                                                        */
/*  Коркин Иван                                                                                         */
/*  25.10.2010                                                                                          */
/*  Реализовано по заявке А53261.                                    */
/*  по форме 0409251.                                                */
/*      Вихров  */
/* 23.06.2011 vihrov много разных ТЗ, последнее ТЗ_Ф251_V6_0611.xls  */ 
/*                             */
/* общая                                        */
/*                             */
/*   19.04.2012                */
/* 20.01.2014 Гуцу Е. Адаптация под 2031: миллион упоминаний darhdoc_dbt 
              заменён на dacctrn_dbt, а также daccount$_dbt, darhdoc$_dbt и  
              многое другое.                                                 */
/* 25.09.2014 R-456034-2 DPN - Добавил везде, где не было nvl в запросах. Без него ыводило Undfined */
/*********************************************************************/

import rsbdataset, bankinter, globals, календарь, TAssocArray;
import cb_sql; //исключительно для ternary
debugbreak;
var beginDate, endDate;

var ReportData = TAssocArray;

var disa_temp:string;
var ttruncate:string="";

macro printValue(p_name : String) : String
  return ReportData.GetValue(p_name);
end;


//import p_f251n;

const  KEY_F1      =315;
const  KEY_F2      =316;
const  KEY_F3      =317;
const KEY_ESC      = 27;
const KEY_SPACE    = 32;
const KEY_ENTER    = 13;

var Fulloutputl, outl, outputl="addsymbfor202.lbr";                    
GetRegistryValue("BANK_INI\\ОБЩИЕ ПАРАМЕТРЫ\\ДИРЕКТОРИИ\\LBRDIR",2,outl);
Fulloutputl = FindPath(outputl, outl);
var dlg = TRecHandler("dates", fulloutputl, TRUE); 
//msgbox("редакция от 15.04.2011");


var s1_2_c4eta_m1:string, s1_2_c4eta_rub_:string, s1_2_c4eta_val_:string, s1_2_c4eta_m2:string,  s1_2_c4eta_not_rest:string;
var s1_2_c4eta_m3:string, s1_2_c4eta_rub_rest:string,s1_2_c4eta_val_rest:string;
//var s1_2_m_rub_rest:string="",s1_2_m_val_rest:string="";
var s2_4_1_rub:string="";
var s2_4_1_val:string="";
var s2_4_1_1_rub:string="";
var s2_4_1_1_val:string="";
var s2_4_1_2_rub_z:string="";
var s2_4_1_2_val_z:string="";
var s2_4_1_2_rub_:string="";
var s2_4_1_2_val_:string="";
var s2_4_1_2_1_rub:string="";
var s2_4_1_2_1_val:string="";

var s2_4_2_rub:string="";
var s2_4_2_val:string="";
var s2_4_2_1_rub:string="";
var s2_4_2_1_val:string="";

var s2_4_2_2_rub_:string="";
var s2_4_2_2_val_:string="";
var s2_4_2_2_rub_z:string="";
var s2_4_2_2_val_z:string="";
var s2_4_2_2_1_rub:string="";
var s2_4_2_2_1_val:string="";

var s1_1_c4eta_rub:string="";
var s1_1_c4eta_val:string="";
var s1_1_dataopen:string="";
var s1_1_m_rub:string="";
var s1_1_m_val:string="";
var s1_1_1_rub:string="";
var s1_1_1_val:string="";
var s1_1_1_1_rub:string="";
var s1_1_1_1_val:string="";
var s1_1_1_1_1_rub:string="";
var s1_1_1_1_1_val:string="";

var s1_2_m1:string;
var s1_2_m_rub:string;
var s1_2_m_val:string;
var s1_2_m_rub_rest:string;
var s1_2_m_val_rest:string;
var s1_2_dataopen:string;
var s1_2_c4eta_rub:string;
var s1_2_c4eta_val:string;
//var s1_2_m_rub:string;
//var s1_2_m_val:string;
var s1_2_1_rub:string;
var s1_2_1_val:string;
var s1_2_2_rub:string;
var s1_2_2_val:string;
var s1_2_2_1_rub:string;
var s1_2_2_1_val:string;
var s1_2_2_1_2_rub:string;
var s1_2_2_1_2_val:string;
var s1_3_m_rub:string="";
var s1_3_m_val:string="";
var s1_3_c4eta_rub:string="";
var s1_3_c4eta_val:string="";

var s2_1_1_rub:string="";
var s2_1_1_val:string="";
var s2_1_1_1_rub:string="";
var s2_1_1_1_val:string="";
var s2_1_1_1_1_rub:string="";
var s2_1_1_1_1_val:string="";

var s2_1_2_rub:string="";
var s2_1_2_val:string="";
var s2_1_3_rub:string="";
var s2_1_3_val:string="";
var s2_1_4_rub:string="";
var s2_1_4_val:string="";
var s2_1_5_rub:string="";
var s2_1_5_val:string="";
var s2_1_6_rub:string="";
var s2_1_6_val:string="";
var s2_1_6_1_rub:string="";
var s2_1_6_1_val:string="";

var s2_2_1_rub:string="";
var s2_2_1_val:string="";

var s2_2_1_1_rub:string="";
var s2_2_1_1_val:string="";

var s2_2_1_1_1_rub:string="";
var s2_2_1_1_1_val:string="";

var s2_2_2_rub:string="";
var s2_2_2_val:string="";
var s2_2_3_rub:string="";
var s2_2_3_val:string="";
var s2_2_4_rub:string="";
var s2_2_4_val:string="";
var s2_2_5_rub:string="";
var s2_2_5_val:string="";

var s2_2_6_rub:string="";
var s2_2_6_val:string="";
var s2_2_6_1_rub:string="";
var s2_2_6_1_val:string="";

//var s2_3_1_c4eta_rub:string="";
//var s2_3_1_c4eta_val:string="";

var s2_3_1_rub:string="";
var s2_3_1_val:string="";

var s2_3_3_rub:string="";
var s2_3_3_val:string="";
var s2_3_4_rub:string="";
var s2_3_4_val:string="";
var s2_3_5_rub:string="";
var s2_3_5_val:string="";

var s2_3_6_rub:string="";
var s2_3_6_val:string="";
var s2_spr_rub:string="";

var s3_1_rub:string="";
var s3_1_val:string="";

var s4_1_rub:string="";
var s4_1_val:string="";

var s4_1_1_rub:string="";
var s4_1_1_val:string="";
var s4_1_3_rub:string="";
var s4_1_3_val:string="";

macro day_c4eta231(rubli:bool);
        var s:string=" from daccount_dbt acc, daccblnc_dbt bal1   "+
                " where  acc.t_account=bal1.t_account and acc.t_chapter=bal1.t_chapter and acc.t_chapter=1 and bal1.t_balance0 in "+
                "('30232','30233','47411','47422','47426','52501','60301','60302','60309','60310','60311','60312','60313', "+
                "'60314','60320','60322','60323','70601','70602','70603','70605','70606','70607','70608','70609','70610','70611')  and acc.t_client='"+{ourbank}+"' ";
        if (rubli == true)
                        s=s+" AND (acc.t_type_account NOT LIKE '%П%' AND acc.t_type_account NOT LIKE '%U%' AND acc.t_type_account NOT LIKE '%Н%') ";
                else
                        s=s+" AND (acc.t_type_account  LIKE '%П%' or acc.t_type_account  LIKE '%U%' or acc.t_type_account LIKE '%Н%')   ";
        end;
        return s;
end;

macro day_c4eta41(rubli:bool);
        var s:string=" from daccount_dbt acc, daccblnc_dbt bal1   "+
                " where  acc.t_account=bal1.t_account and acc.t_chapter=bal1.t_chapter and acc.t_chapter=1 and bal1.t_balance0 in "+
                "('30109','30112','30113','30122','30123','30230','30231','30214') ";
        if (rubli == true)
                        s=s+" AND (acc.t_type_account NOT LIKE '%П%' AND acc.t_type_account NOT LIKE '%U%' AND acc.t_type_account NOT LIKE '%Н%') ";
                else
                        s=s+" AND (acc.t_type_account  LIKE '%П%' or acc.t_type_account  LIKE '%U%' or acc.t_type_account LIKE '%Н%')   ";
        end;
        return s;
end;

macro day_c4eta241(rubli:bool);
        var s:string=" from daccount_dbt acc, daccblnc_dbt bal1, dobjcode_dbt do1  "+
                " where  acc.t_account=bal1.t_account and acc.t_chapter=bal1.t_chapter and acc.t_chapter=1 and bal1.t_balance0 in "+
                "('40911','40912','40913') "+
"            AND do1.t_objecttype = 3   "+
"            AND do1.t_codekind = 1     and do1.t_state=0"+
"            AND acc.t_client = do1.t_objectid  "+
"            AND do1.t_code in ('010000060231', '010000060430', '010000002005', '010000060431', '010000060433', '010000060434') "+
"                AND not (do1.t_code = '010000070780' and bal1.t_balance0 = '40911')";

        if (rubli == true)
                        s=s+" AND (acc.t_type_account NOT LIKE '%П%' AND acc.t_type_account NOT LIKE '%U%' AND acc.t_type_account NOT LIKE '%Н%') ";
                else
                        s=s+" AND (acc.t_type_account  LIKE '%П%' or acc.t_type_account  LIKE '%U%' or acc.t_type_account LIKE '%Н%')   ";
        end;
        return s;
end;

macro day_c4eta242(rubli:bool);
        var s:string=" from daccount_dbt acc, daccblnc_dbt bal1, dobjcode_dbt do1  "+
                " where  acc.t_account=bal1.t_account and acc.t_chapter=bal1.t_chapter and acc.t_chapter=1 and bal1.t_balance0 in "+
                "('40911','40912','40913') "+
"            AND do1.t_objecttype = 3   "+
"            AND do1.t_codekind = 1     and do1.t_state=0"+
"            AND acc.t_client = do1.t_objectid  "+
"            AND do1.t_code not in ('010000060231', '010000060430', '010000002005', '010000060431', '010000060433', '010000060434')     "+
"                AND not (do1.t_code = '010000070780' and bal1.t_balance0 = '40911')";

        if (rubli == true)
                        s=s+" AND (acc.t_type_account NOT LIKE '%П%' AND acc.t_type_account NOT LIKE '%U%' AND acc.t_type_account NOT LIKE '%Н%') ";
                else
                        s=s+" AND (acc.t_type_account  LIKE '%П%' or acc.t_type_account  LIKE '%U%' or acc.t_type_account LIKE '%Н%')   ";
        end;
        return s;
end;

macro IfThenElse (a, b, c)
        if (a)
                return b;
        else
                return c;
        end;
        
end;

macro vstavit_c4eta(stroka_vstavki)
        var iinsert;
        //println( stroka_vstavki );
        iinsert=rsdcommand(stroka_vstavki);
        //debugbreak;
        iinsert.execute;
//      iinsert=rsdcommand("commit");  //димон сказал так только лохи пишут
//      iinsert.execute;
end;

/* Расчет строк 
macro createQuery_1_1(currency): string
        var AccountTable, query;
   if (currency == "Rub")
     query=
   else
     query=
   end;
   return query;
end;
*/

private macro line_1_1 ()       
        var data;
//debugbreak;
        macro createQuery_1_1(currency)
                var query;
            if (currency == "Rub")
              query=s1_1_m_rub;
            else
              query=s1_1_m_val;
            end;
        return query;
        end;

   data = TRsbDataset(createQuery_1_1("Rub"));
   if (data.movenext)
        ReportData.set("Ф251__1_1__3", data.value(0):8:1);
        ReportData.set("Ф251__1_1__5", data.value(1));
   end;         

   data = TRsbDataset(createQuery_1_1("Cur"));
   if (data.movenext)
        ReportData.set("Ф251__1_1__4", data.value(0));
        ReportData.set("Ф251__1_1__6", data.value(1));
   end;         
end;


private macro line_1_1_1 ()     
//debugbreak;
        var data;
        macro createQuery_1_1_1(currency): string
          var query;
      if (currency == "Rub")
      query=s1_1_1_rub;

      else
      query=s1_1_1_val;
      end;
                return query;
  end;                                 
  //getstring(createQuery_1_1_1("Rub"));
  data = TRsbDataset(createQuery_1_1_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__1_1_1__3", data.value(0));
        ReportData.set("Ф251__1_1_1__5", data.value(1));
  end;          
        //getstring(createQuery_1_1_1("Cur"));
  data = TRsbDataset(createQuery_1_1_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__1_1_1__4", data.value(0));
        ReportData.set("Ф251__1_1_1__6", data.value(1));
  end;          
end;


private macro line_1_1_1_1 ()   
        var data;
        macro createQuery_1_1_1_1(currency): string
                var query;
      if (currency == "Rub")
      query=s1_1_1_1_rub;

      else
      query=s1_1_1_1_val;
      end;      
  return query
        end;



  data = TRsbDataset(createQuery_1_1_1_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__1_1_1_1__3", data.value(0));
        //ReportData.set("Ф251__1_1_1_1_1__3", data.value(0));
  end;          

  data = TRsbDataset(createQuery_1_1_1_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__1_1_1_1__4", data.value(0));
        //ReportData.set("Ф251__1_1_1_1_1__4", data.value(0));
  end;          
end;

private macro line_1_1_1_1_1 () 
        var data;
        macro createQuery_1_1_1_1_1(currency): string
                var query;
      if (currency == "Rub")
      query=s1_1_1_1_1_rub;

      else
      query=s1_1_1_1_1_val;
      end;      
  return query
        end;



  data = TRsbDataset(createQuery_1_1_1_1_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__1_1_1_1_1__3", data.value(0));
  end;          

  data = TRsbDataset(createQuery_1_1_1_1_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__1_1_1_1_1__4", data.value(0));
  end;          
end;


private macro line_1_2 ()
////debugbreak;
        var data;
        macro createQuery_1_2 (currency): string
              var AccountTable, query, currencyQuery;
              if (currency == "Rub")
                query=s1_2_m_rub;
              elif (currency == "Rub_rest")
                query=s1_2_m_rub_rest;
              elif (currency == "Val")
                query=s1_2_m_val;
              elif (currency == "Val_rest")
                query=s1_2_m_val_rest;
              end;      
        return query;
        end;
/*   getstring(createQuery_1_2("Rub"));*/
   data = TRsbDataset(createQuery_1_2("Rub"));
   if (data.movenext)
        ReportData.set("Ф251__1_2__3", data.value(0));
//      ReportData.set("Ф251__1_2__5", data.value(1));
   end;         
   data = TRsbDataset(createQuery_1_2("Rub_rest"));
   if (data.movenext)
        ReportData.set("Ф251__1_2__5", data.value(0));
   end;         
   data = TRsbDataset(createQuery_1_2("Val"));
   if (data.movenext)
        ReportData.set("Ф251__1_2__4", data.value(0));
//      ReportData.set("Ф251__1_2__6", data.value(1));
   end;         
   data = TRsbDataset(createQuery_1_2("Val_rest"));
   if (data.movenext)
        ReportData.set("Ф251__1_2__6", data.value(0));
   end;         
end;

macro line_1_2_1 ()
debugbreak;
        var data;
   macro createQuery_1_2_1(currency): string
        var AccountTable, query, currencyQuery;
      if (currency == "Rub")
        query=s1_2_1_rub;
      else
        query=s1_2_1_val;

      end;
      return query;
   end;
   data = TRsbDataset(createQuery_1_2_1("Rub"));
   if (data.movenext)
        ReportData.set("Ф251__1_2_1__3", data.value(0));
   end;         
   data = TRsbDataset(createQuery_1_2_1("Cur"));
   if (data.movenext)
        ReportData.set("Ф251__1_2_1__4", data.value(0));
   end;         
end;










macro line_1_2_2 ()
        var data;
   macro createQuery_1_2_2(currency): string
        var AccountTable, query, currencyQuery, Account;
      if (currency == "Rub")
        query=s1_2_2_rub;
      else
        query=s1_2_2_val;
        
      end;
      return query;
   end;
   data = TRsbDataset(createQuery_1_2_2("Rub"));
   if (data.movenext)
        ReportData.set("Ф251__1_2_2__3", data.value(0));
        ReportData.set("Ф251__1_2_2__5", data.value(1));
   end;         
   data = TRsbDataset(createQuery_1_2_2("Cur"));
   if (data.movenext)
        ReportData.set("Ф251__1_2_2__4", data.value(0));
        ReportData.set("Ф251__1_2_2__6", data.value(1));
   end;         
end;

macro line_1_2_2_1 ()
        var data;
        macro createQuery_1_2_2_1 (currency): string
        var  query;
      if (currency == "Rub")
        query=s1_2_2_1_rub;
 
      else
        query=s1_2_2_1_val;

      end;
      return query;
        end;
   data = TRsbDataset(createQuery_1_2_2_1("Rub"));
   if (data.movenext)
        ReportData.set("Ф251__1_2_2_1__3", data.value(0));
        ReportData.set("Ф251__1_2_2_1_1__3", data.value(0));
   end;         
   data = TRsbDataset(createQuery_1_2_2_1("Cur"));
   if (data.movenext)
        ReportData.set("Ф251__1_2_2_1__4", data.value(0));
        ReportData.set("Ф251__1_2_2_1_1__4", data.value(0));
   end;         
end;


macro line_1_2_2_1_2 ()
        ReportData.set("Ф251__1_2_2_1_2__3", 0);
        ReportData.set("Ф251__1_2_2_1_2__4", 0);        
end; 


macro line_1_3 ()
        var data;
        macro createQuery_1_3 (currency): string
      var AccountTable, query, currencyQuery, Account;
      if (currency == "Rub")
        query = s1_3_m_rub;
      else
        query = s1_3_m_val;
      end;
      
      return query;
   end;
   data = TRsbDataset(createQuery_1_3("Rub"));
   if (data.movenext)
        ReportData.set("Ф251__1_3__3", data.value(0));
        ReportData.set("Ф251__1_3__5", data.value(1));
   end;         
   data = TRsbDataset(createQuery_1_3("Cur"));
   if (data.movenext)
        ReportData.set("Ф251__1_3__4", data.value(0));
        ReportData.set("Ф251__1_3__6", data.value(1));
   end;         
end;


/* Раздел 2 */

macro line_2_1_1 ()
        var data;
        macro createQuery_2_1_1 (currency): string
      var query;
      if (currency == "Rub")
        query=s2_1_1_rub;
      else
        query=s2_1_1_val;
      end;
      return query;
   end;

   data = TRsbDataset(createQuery_2_1_1("Rub"));
   if (data.movenext)
        ReportData.set("Ф251__2_1_1__3", data.value(0));
        ReportData.set("Ф251__2_1_1__5", data.value(1));
   end;         
   data = TRsbDataset(createQuery_2_1_1("Cur"));
   if (data.movenext)
        ReportData.set("Ф251__2_1_1__4", data.value(0));
        ReportData.set("Ф251__2_1_1__6", data.value(1));
   end;         
end;

/*
macro line_2_1_1_1 ()
        var data;
        macro createQuery_2_1_1_1 (currency): string
      var AccountTable, query, currencyQuery, Account, resultQuery;
      if (currency == "Rub")
        resultQuery = " SELECT COUNT (*), SUM (pm1.t_amount) ";
        currencyQuery = "\n" + "AND (pm1.t_fiid = 0 and pm1.t_payfiid = 0)";
      else
        resultQuery = " SELECT COUNT (*), SUM (rsb_fiinstr.CONVSUM(pm1.t_amount, pm1.T_FIID, 0, pm1.T_VALUEDATE,0) )";
        currencyQuery = "\n" + "AND (pm1.t_fiid != 0 OR pm1.t_payfiid != 0) ";
      end;
      query = resultQuery
      + "\n" + "  FROM   dpmpaym_dbt pm1, "
      + "\n" + "         dpmrmprop_dbt rm, "
      + "\n" + "         dparty_dbt pt, "
      + "\n" + "         dpspayord_dbt ps "
      + "\n" + " WHERE   (SUBSTR (pm1.t_payeraccount, 1, 3) BETWEEN '401' AND '408' "
      + "\n" + "          AND SUBSTR (pm1.t_payeraccount, 1, 5) NOT IN "
      + "\n" + "                   ('40803', '40810', '40813') "
      + "\n" + "          AND rm.t_paymentid = pm1.t_paymentid "
      + "\n" + "          AND pt.t_partyid = pm1.t_payer "
      + "\n" + "          AND pt.t_legalform = 1 "
      + "\n" + "          AND pm1.t_valuedate BETWEEN TO_DATE ('" + beginDate + "', 'dd.mm.yyyy') "
      + "\n" + "                                  AND  TO_DATE ('" + endDate + "', 'dd.mm.yyyy')) "
      + currencyQuery
      + "\n" + "         AND rm.t_shifroper IN ('01') "
      + "\n" + "         AND (pm1.t_payer != pm1.t_receiver "
      + "\n" + "              OR SUBSTR (pm1.t_payeraccount, 1, 5) != "
      + "\n" + "                   SUBSTR (pm1.t_receiveraccount, 1, 5)) "
      + "\n" + "         AND (PS.T_ORDERID = PM1.T_PAYMENTID AND PS.T_ORIGIN = 2) ";
      return query;
   end;
   data = TRsbDataset(createQuery_2_1_1_1("Rub"));
   if (data.movenext)
        ReportData.set("Ф251__2_1_1_1__3", data.value(0));
        ReportData.set("Ф251__2_1_1_1__5", data.value(1));
   end;         
   data = TRsbDataset(createQuery_2_1_1_1("Cur"));
   if (data.movenext)
        ReportData.set("Ф251__2_1_1_1__4", data.value(0));
        ReportData.set("Ф251__2_1_1_1__6", data.value(1));
   end;         
end;
*/



macro line_2_1_1_1 ()
////debugbreak;
        var data;
        macro createQuery_2_1_1_1 (currency): string
                        var query;
      if (currency == "Rub")
        query=s2_1_1_1_rub;
      else
        query=s2_1_1_1_val;
      end;
                return query;
  end;
//               getstring(createQuery_2_1_1_1("Cur"));
  data = TRsbDataset(createQuery_2_1_1_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_1_1_1__4", data.value(0));
        ReportData.set("Ф251__2_1_1_1__6", data.value(1));
  end;          
               
  data = TRsbDataset(createQuery_2_1_1_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_1_1_1__3", data.value(0));
        ReportData.set("Ф251__2_1_1_1__5", data.value(1));
  end;          

end; //line_2_1_1_1 ()














macro line_2_1_1_1_1 ()
        var data;
        macro createQuery_2_1_1_1_1 (currency): string
                        var query;
      if (currency == "Rub")
        query=s2_1_1_1_1_rub;
      else
        query=s2_1_1_1_1_val;
      end;

                return query;
  end;
//               getstring(createQuery_2_1_1_1("Cur"));
  data = TRsbDataset(createQuery_2_1_1_1_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_1_1_1_1__4", data.value(0));
        ReportData.set("Ф251__2_1_1_1_1__6", data.value(1));
  end;          
               
  data = TRsbDataset(createQuery_2_1_1_1_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_1_1_1_1__3", data.value(0));
        ReportData.set("Ф251__2_1_1_1_1__5", data.value(1));
  end;          

end; //line_2_1_1_1_1 ()










macro line_2_1_2 ()
        var data;
        macro createQuery_2_1_2 (currency): string
      var query;
      if (currency == "Rub")
         query = s2_1_2_rub;
      else
         query = s2_1_2_val;
      end;
      return query;
   end;
   //disa_temp=createQuery_2_1_2("Rub");
   //getstring(disa_temp);

   data = TRsbDataset(createQuery_2_1_2("Rub"));
   if (data.movenext)
        ReportData.set("Ф251__2_1_2__3", data.value(0));
        ReportData.set("Ф251__2_1_2__5", data.value(1));
   end;         
   data = TRsbDataset(createQuery_2_1_2("Cur"));
   if (data.movenext)
        ReportData.set("Ф251__2_1_2__4", data.value(0));
        ReportData.set("Ф251__2_1_2__6", data.value(1));
   end;         
end;


/*
вихров. закаментил потому что здесь фигня какаято

macro line_2_1_3 ()
////debugbreak;
        var data;
        macro createQuery_2_1_3 (currency): string
                        //debugbreak;
      var AccountTable, query, currencyQuery, Account, resultQuery;
      if (currency == "Rub")
        resultQuery = "SELECT COUNT ( 1 ) cnt, nvl(round(SUM (pm.t_amount)/1000),0) SUM";
        currencyQuery = "\n" + "            AND (pm.t_fiid = 0 AND pm.t_payfiid = 0)   ";
      else
        resultQuery = " SELECT COUNT (1) cnt, nvl(round(SUM (rsb_fiinstr.CONVSUM(pm.t_amount, pm.T_FIID, 0, pm.T_VALUEDATE,0) )/1000),0) sum ";
        currencyQuery = "\n" + "            AND (pm.t_fiid != 0 OR pm.t_payfiid != 0) ";
      end;
      query = " SELECT SUM (cnt), nvl(SUM (SUM),0) "
      + "\n" + "FROM ( " + resultQuery
      + "\n" + "      FROM dpmpaym_dbt pm, "
      + "\n" + "           dpspayord_dbt ps, "
      + "\n" + "           dpmrmprop_dbt rm, "
      + "\n" + "           dparty_dbt pt "
      + "\n" + "      WHERE     ps.t_orderid = pm.t_paymentid "
      + "\n" + "            AND rm.t_paymentid = pm.t_paymentid "
      + "\n" + "            AND rm.t_shifroper = '16' "
      + "\n" + "            AND (SUBSTR (pm.t_payeraccount, 1, 3) BETWEEN '401' AND '408' "
      + "\n" + "                 AND SUBSTR (pm.t_payeraccount, 1, 5) NOT IN "
      + "\n" + "                          ('40803', '40810', '40813','40817', '40820') "
      + "\n" + "                 AND rm.t_paymentid = pm.t_paymentid "
      + "\n" + "                 AND pt.t_partyid = pm.t_payer "
      + "\n" + "                 AND pt.t_legalform = 1) "
      + "\n" + "            AND pm.t_valuedate BETWEEN TO_DATE ('" + beginDate + "', 'dd.mm.yyyy') "
      + "\n" + "                                   AND  TO_DATE ('" + endDate + "', 'dd.mm.yyyy')  "
      + currencyQuery
      + "\n" + "            AND EXISTS "
      + "\n" + "                  (SELECT p.t_paymentid "
      + "\n" + "                   FROM dpmrmprop_dbt p, dpmlink_dbt lnk "
      + "\n" + "                   WHERE     lnk.t_purposepayment = pm.t_paymentid "
      + "\n" + "                         AND p.t_paymentid = lnk.t_initialpayment "
      + "\n" + "                         AND p.t_shifroper = '02') "
      + "\n" + "      UNION ALL "
      + "\n" + "  " + resultQuery
      + "\n" + "      FROM dpmpaym_dbt pm, "
      + "\n" + "           dpspayord_dbt ps, "
      + "\n" + "           dpmrmprop_dbt rm, "
      + "\n" + "           dparty_dbt pt "
      + "\n" + "      WHERE     ps.t_orderid = pm.t_paymentid "
      + "\n" + "            AND rm.t_paymentid = pm.t_paymentid "
      + "\n" + "            AND rm.t_shifroper = '16' "
      + "\n" + "            AND (SUBSTR (pm.t_payeraccount, 1, 3) BETWEEN '401' AND '408' "
      + "\n" + "                 AND SUBSTR (pm.t_payeraccount, 1, 5) NOT IN "
      + "\n" + "                          ('40803', '40810', '40813','40817', '40820') "
      + "\n" + "                 AND rm.t_paymentid = pm.t_paymentid "
      + "\n" + "                 AND pt.t_partyid = pm.t_payer "
      + "\n" + "                 AND pt.t_legalform = 1) "
      + "\n" + "            AND pm.t_valuedate BETWEEN TO_DATE ('" + beginDate + "', 'dd.mm.yyyy') "
      + "\n" + "                                   AND  TO_DATE ('" + endDate + "', 'dd.mm.yyyy') "
      + currencyQuery
      + "\n" + "            AND NOT EXISTS "
      + "\n" + "                  (SELECT p.t_paymentid "
      + "\n" + "                   FROM dpmrmprop_dbt p, dpmlink_dbt lnk "
      + "\n" + "                   WHERE lnk.t_purposepayment = pm.t_paymentid "
      + "\n" + "                         AND p.t_paymentid = lnk.t_initialpayment) "
      + "\n" + "      UNION ALL "
      + "\n" + "      " + resultQuery
      + "\n" + "      FROM dpmpaym_dbt pm, "
      + "\n" + "           dpspayord_dbt ps, "
      + "\n" + "           dpmrmprop_dbt rm, "
      + "\n" + "           dparty_dbt pt "
      + "\n" + "      WHERE     ps.t_orderid = pm.t_paymentid "
      + "\n" + "            AND rm.t_paymentid = pm.t_paymentid "
      + "\n" + "            AND rm.t_shifroper = '02' "
      + "\n" + "            AND (SUBSTR (pm.t_payeraccount, 1, 3) BETWEEN '401' AND '408' "
      + "\n" + "                 AND SUBSTR (pm.t_payeraccount, 1, 5) NOT IN "
      + "\n" + "                          ('40803', '40810', '40813','40817', '40820') "
      + "\n" + "                 AND rm.t_paymentid = pm.t_paymentid "
      + "\n" + "                 AND pt.t_partyid = pm.t_payer "
      + "\n" + "                 AND pt.t_legalform = 1) "
      + "\n" + "            AND pm.t_valuedate BETWEEN TO_DATE ('" + beginDate + "', 'dd.mm.yyrr') "
      + "\n" + "                                   AND  TO_DATE ('" + endDate + "', 'dd.mm.yyyy') "
      + "\n" + "            AND (pm.t_fiid = 0 AND pm.t_payfiid = 0))   ";

      
      return query;
   end;

                                        //getstring(createQuery_2_1_3("Cur"));
   data = TRsbDataset(createQuery_2_1_3("Cur"));
   if (data.movenext)
        ReportData.set("Ф251__2_1_3__4", data.value(0));
        ReportData.set("Ф251__2_1_3__6", data.value(1));
   end;         

   data = TRsbDataset(createQuery_2_1_3("Rub"));
   if (data.movenext)
        ReportData.set("Ф251__2_1_3__3", data.value(0));
        ReportData.set("Ф251__2_1_3__5", data.value(1));
   end;         


end;
*/
macro line_2_1_3 ()
        var data;
        macro createQuery_2_1_3 (currency): string
      var query;
      if (currency == "Rub")
        query=s2_1_3_rub;
      else
        query=s2_1_3_val;
      end;
      return query;
   end;

   data = TRsbDataset(createQuery_2_1_3("Rub"));
   if (data.movenext)
        ReportData.set("Ф251__2_1_3__3", data.value(0));
        ReportData.set("Ф251__2_1_3__5", data.value(1));
   end;         
   data = TRsbDataset(createQuery_2_1_3("Cur"));
   if (data.movenext)
        ReportData.set("Ф251__2_1_3__4", data.value(0));
        ReportData.set("Ф251__2_1_3__6", data.value(1));
   end;         
end;

/*

чото не нравицца мне тут. перепишу целиком

macro line_2_1_4 ()
//debugbreak;
        var data;
        macro createQuery_2_1_4 (currency): string
                        debugbreak;
      var AccountTable, query, currencyQuery, Account, resultQuery;
      if (currency == "Rub")

                                query=" select sum ( cnt ), nvl(round(sum ( sum )/1000),0)      "+
"       from ( select count ( * ) cnt, sum ( pm.t_amount ) sum  "+
"              from dpmpaym_dbt pm, dpspayord_dbt ps, dpmrmprop_dbt rm, dparty_dbt pt   "+
"              where ps.t_orderid = pm.t_paymentid and rm.t_paymentid = pm.t_paymentid and rm.t_shifroper = '16'        "+
"                    and (    substr ( pm.t_payeraccount, 1, 3 ) between '401' and '408'        "+
"                         and substr ( pm.t_payeraccount, 1, 5 ) not in ('40803', '40810', '40813','40817', '40820')    "+
"                         and rm.t_paymentid = pm.t_paymentid   "+
"                         and pt.t_partyid = pm.t_payer "+
"                         and pt.t_legalform = 1 )      "+
"                    and pm.t_valuedate between to_date ( '"+begindate+"', 'dd.mm.yyyy' )       "+
"                                           and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )             /*за отчетный период*/     "+
"                    and ( pm.t_fiid = 0 and pm.t_payfiid = 0 )                                 /*отдельно по рублям*/  "+
"                    and exists "+
"                         (select p.t_paymentid "+
"                          from dpmrmprop_dbt p, dpmlink_dbt lnk        "+
"                          where     lnk.t_purposepayment = pm.t_paymentid      "+
"                                and p.t_paymentid = lnk.t_initialpayment       "+
"                                and p.t_shifroper = '06')      "+
"              union all        "+
"              select count ( * ) cnt, nvl(sum ( pm.t_amount ), 0) sum  "+                     //25.09.2014 R-456034-2 DPN
"              from dpmpaym_dbt pm, dpspayord_dbt ps, dpmrmprop_dbt rm, dparty_dbt pt   "+
"              where ps.t_orderid = pm.t_paymentid and rm.t_paymentid = pm.t_paymentid and rm.t_shifroper = '06'        "+
"                    and (    substr ( pm.t_payeraccount, 1, 3 ) between '401' and '408'        "+
"                         and substr ( pm.t_payeraccount, 1, 5 ) not in ('40803', '40810', '40813','40817', '40820')    "+
"                         and rm.t_paymentid = pm.t_paymentid   "+
"                         and pt.t_partyid = pm.t_payer "+
"                         and pt.t_legalform = 1 )      "+
"                    and pm.t_valuedate between to_date ( '"+begindate+"', 'dd.mm.yyyy' )       "+
"                                           and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )            "+
"                    and ( pm.t_fiid = 0 and pm.t_payfiid = 0 )                             "+
"                                                               )       ";

      else
              query ="  SELECT SUM (cnt), nvl(round(SUM (SUM)/1000),0)  "+
"       FROM (SELECT COUNT ( * ) cnt, nvl(SUM (rsb_fiinstr.CONVSUM(pm.t_amount, pm.T_FIID, 0, pm.T_VALUEDATE,0) )  SUM      "+ //25.09.2014 R-456034-2 DPN
"             FROM dpmpaym_dbt pm,      "+
"                  dpspayord_dbt ps,    "+
"                  dpmrmprop_dbt rm,    "+
"                  dparty_dbt pt        "+
"             WHERE     ps.t_orderid = pm.t_paymentid   "+
"                   AND rm.t_paymentid = pm.t_paymentid "+
"                   AND rm.t_shifroper = '16'   "+
"                   AND (SUBSTR (pm.t_payeraccount, 1, 3) BETWEEN '401' AND '408'       "+
"                        AND SUBSTR (pm.t_payeraccount, 1, 5) NOT IN    "+
"                                 ('40803', '40810', '40813','40817', '40820')  "+
"                        AND rm.t_paymentid = pm.t_paymentid    "+
"                        AND pt.t_partyid = pm.t_payer  "+
"                        AND pt.t_legalform = 1)        "+
"                   AND pm.t_valuedate BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy')  "+
"                                          AND  TO_DATE ('"+enddate+"', 'dd.mm.yyyy') /*за отчетный период*/    "+
"                   AND (pm.t_fiid != 0 or pm.t_payfiid != 0)   "+
"                   AND EXISTS  "+
"                         (SELECT p.t_paymentid "+
"                          FROM dpmrmprop_dbt p, dpmlink_dbt lnk        "+
"                          WHERE     lnk.t_purposepayment = pm.t_paymentid      "+
"                                AND p.t_paymentid = lnk.t_initialpayment       "+
"                                AND p.t_shifroper = '06')      "+
"             UNION ALL "+
"             SELECT COUNT ( * ) cnt, nvl(SUM (rsb_fiinstr.CONVSUM(pm.t_amount, pm.T_FIID, 0, pm.T_VALUEDATE,0) ),0)  SUM       "+
"             FROM dpmpaym_dbt pm,      "+
"                  dpspayord_dbt ps,    "+
"                  dpmrmprop_dbt rm,    "+
"                  dparty_dbt pt        "+
"             WHERE     ps.t_orderid = pm.t_paymentid   "+
"                   AND rm.t_paymentid = pm.t_paymentid "+
"                   AND rm.t_shifroper = '06'   "+
"                   AND (SUBSTR (pm.t_payeraccount, 1, 3) BETWEEN '401' AND '408'       "+
"                        AND SUBSTR (pm.t_payeraccount, 1, 5) NOT IN    "+
"                                 ('40803', '40810', '40813','40817', '40820')  "+
"                        AND rm.t_paymentid = pm.t_paymentid    "+
"                        AND pt.t_partyid = pm.t_payer  "+
"                        AND pt.t_legalform = 1)        "+
"                   AND pm.t_valuedate BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy')  "+
"                                          AND  TO_DATE ('"+enddate+"', 'dd.mm.yyyy') /*за отчетный период*/    "+
"                   AND (pm.t_fiid != 0 or pm.t_payfiid != 0))          ";

      end;
                return query;
  end;
                 
  data = TRsbDataset(createQuery_2_1_4("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_1_4__4", data.value(0));
        ReportData.set("Ф251__2_1_4__6", data.value(1));
  end;          
               
  data = TRsbDataset(createQuery_2_1_4("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_1_4__3", data.value(0));
        ReportData.set("Ф251__2_1_4__5", data.value(1));
  end;          

end; //line_2_1_4 ()

*/


macro line_2_1_4 ()
//debugbreak;
        var data;
        macro createQuery_2_1_4 (currency): string
                        debugbreak;
      var AccountTable, query, currencyQuery, Account, resultQuery;
      if (currency == "Rub")
        query=s2_1_4_rub;
      else
        query=s2_1_4_val;
      end;

                return query;
  end;
                 
  data = TRsbDataset(createQuery_2_1_4("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_1_4__4", data.value(0));
        ReportData.set("Ф251__2_1_4__6", data.value(1));
  end;          
               
  data = TRsbDataset(createQuery_2_1_4("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_1_4__3", data.value(0));
        ReportData.set("Ф251__2_1_4__5", data.value(1));
  end;          

end; //line_2_1_4 ()







/*

вихров. перепишу подругому 

macro line_2_1_5 ()
//debugbreak;
        var data;
        macro createQuery_2_1_5 (currency): string
                        var query;
      if (currency == "Rub")
        query=" SELECT COUNT (*), nvl(round(SUM (pm.t_amount)/1000),0)  "+
"         FROM dpmpaym_dbt pm,  "+
"              dpmrmprop_dbt rm,        "+
"              dparty_dbt pt,   "+
"              daccount_dbt acc,        "+
"              dpscshdoc_dbt ps "+
"        WHERE (    SUBSTR (pm.t_payeraccount, 1, 3) BETWEEN '401' AND '408'    "+
"               AND SUBSTR (pm.t_payeraccount, 1, 5) NOT IN     "+
"                                                         ('40803', '40810', '40813','40817', '40820')  "+
"               /*AND (   SUBSTR (pm.t_receiveraccount, 1, 5) IN ('40901', '40902')     "+
"                    OR SUBSTR (pm.t_receiveraccount, 1, 3) = '301')*/) "+
"          AND rm.t_paymentid = pm.t_paymentid  "+
"          AND pt.t_partyid = pm.t_payer        "+
"          AND pt.t_legalform = 1       "+
"          AND pm.t_valuedate BETWEEN TO_DATE ('"+enddate+"', 'dd.mm.yyyy')     "+
"                                 AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy')     "+
"       /*количество и сумма платежей за отчетный период ПО СЧЕТАМ ЮР. ЛИЦ (ИЗ П. 1.1.1)*/      "+
"          AND (pm.t_fiid = 0 AND pm.t_payfiid = 0)             /*отдельно по рублям*/  "+
"          AND (    acc.t_account = pm.t_payeraccount   "+
"               AND acc.t_chapter = 1   "+
"               AND acc.t_close_date BETWEEN TO_DATE ('"+enddate+"', 'dd.mm.yyyy')      "+
"                                        AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy'))     "+
"          AND (ps.t_autokey = pm.t_paymentid )         "+
"          and pm.T_DOCKIND = 420       ";

      else
        query=" SELECT COUNT (*), round(nvl(SUM (rsb_fiinstr.CONVSUM(pm.t_amount, pm.T_FIID, 0, pm.T_VALUEDATE,0) ),0)/1000)    "+
"         FROM dpmpaym_dbt pm,  "+
"              dpmrmprop_dbt rm,        "+
"              dparty_dbt pt,   "+
"              daccount_dbt acc,        "+
"              dpscshdoc_dbt ps "+
"        WHERE (    SUBSTR (pm.t_payeraccount, 1, 3) BETWEEN '401' AND '408'    "+
"               AND SUBSTR (pm.t_payeraccount, 1, 5) NOT IN     "+
"                                                         ('40803', '40810', '40813','40817', '40820')) "+
"          AND rm.t_paymentid = pm.t_paymentid  "+
"          AND pt.t_partyid = pm.t_payer        "+
"          AND pt.t_legalform = 1       "+
"          AND pm.t_valuedate BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy')   "+
"                                 AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy')     "+
"       /*количество и сумма платежей за отчетный период ПО СЧЕТАМ ЮР. ЛИЦ (ИЗ П. 1.1.1)*/      "+
"          AND (pm.t_fiid != 0 or pm.t_payfiid != 0)             /*отдельно по рублям*/ "+
"          AND (    acc.t_account = pm.t_payeraccount   "+
"               AND acc.t_chapter = 1   "+
"               AND acc.t_close_date BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy')    "+
"                                        AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy'))     "+
"          AND (ps.t_autokey = pm.t_paymentid )         "+
"         -- and pm.T_DOCKIND = 420     ";

      end;
                return query;
  end;
                 
  data = TRsbDataset(createQuery_2_1_5("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_1_5__4", data.value(0));
        ReportData.set("Ф251__2_1_5__6", data.value(1));
  end;          
               
  data = TRsbDataset(createQuery_2_1_5("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_1_5__3", data.value(0));
        ReportData.set("Ф251__2_1_5__5", data.value(1));
  end;          

end; //line_2_1_5 ()
*/



macro line_2_1_5 ()
//debugbreak;
        var data;
        macro createQuery_2_1_5 (currency): string
                        //debugbreak;
      var AccountTable, query, currencyQuery, Account, resultQuery;
      if (currency == "Rub")
        query=s2_1_5_rub;
      else
        query=s2_1_5_val;
      end;

                return query;
  end;
                 
  data = TRsbDataset(createQuery_2_1_5("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_1_5__4", data.value(0));
        ReportData.set("Ф251__2_1_5__6", data.value(1));
  end;          
               
  data = TRsbDataset(createQuery_2_1_5("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_1_5__3", data.value(0));
        ReportData.set("Ф251__2_1_5__5", data.value(1));
  end;          

end; //line_2_1_5 ()

macro line_2_1_6 ()
//debugbreak;
        var data;
        macro createQuery_2_1_6 (currency): string
                        //debugbreak;
              var AccountTable, query, currencyQuery, Account, resultQuery;
              if (currency == "Rub")
                query=s2_1_6_rub;
              else
                query=s2_1_6_val;
              end;

        return query;
        end;
                 
  data = TRsbDataset(createQuery_2_1_6("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_1_6__4", data.value(0));
        ReportData.set("Ф251__2_1_6__6", data.value(1));
  end;          
               
  data = TRsbDataset(createQuery_2_1_6("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_1_6__3", data.value(0));
        ReportData.set("Ф251__2_1_6__5", data.value(1));
  end;          

end; //line_2_1_6 ()



macro line_2_1_6_1 ()
//debugbreak;
        var data;
        macro createQuery_2_1_6_1 (currency): string
                        //debugbreak;
              var AccountTable, query, currencyQuery, Account, resultQuery;
              if (currency == "Rub")
                query=s2_1_6_1_rub;
              else
                query=s2_1_6_1_val;
              end;

        return query;
        end;
                 
  data = TRsbDataset(createQuery_2_1_6_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_1_6_1__4", data.value(0));
        ReportData.set("Ф251__2_1_6_1__6", data.value(1));
  end;          
               
  data = TRsbDataset(createQuery_2_1_6_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_1_6_1__3", data.value(0));
        ReportData.set("Ф251__2_1_6_1__5", data.value(1));
  end;          

end; //line_2_1_6_1 ()
















macro line_2_2_1 ()
//debugbreak;
        var data;
        macro createQuery_2_2_1 (currency): string
                        var query;
      if (currency == "Rub")
        query=s2_2_1_rub;
      else
        query=s2_2_1_val;
      end;
                return query;
  end;
                 
  data = TRsbDataset(createQuery_2_2_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_2_1__4", data.value(0));
        ReportData.set("Ф251__2_2_1__6", data.value(1));
  end;          
               
  data = TRsbDataset(createQuery_2_2_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_2_1__3", data.value(0));
        ReportData.set("Ф251__2_2_1__5", data.value(1));
  end;          

end; //line_2_2_1 ()





macro line_2_2_1_1 ()
//debugbreak;
        var data;
        macro createQuery_2_2_1_1 (currency): string
                        var query;
      if (currency == "Rub")
        query=s2_2_1_1_rub;
      else
        query=s2_2_1_1_val;
      end;
                return query;
  end;
                 
  data = TRsbDataset(createQuery_2_2_1_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_2_1_1__4", data.value(0));
        ReportData.set("Ф251__2_2_1_1__6", data.value(1));
  end;          
               
  data = TRsbDataset(createQuery_2_2_1_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_2_1_1__3", data.value(0));
        ReportData.set("Ф251__2_2_1_1__5", data.value(1));
  end;          

end; //line_2_2_1_1 ()


macro line_2_2_1_1_1 ()
//debugbreak;
        var data;
        macro createQuery_2_2_1_1_1 (currency): string
                        var query;
      if (currency == "Rub")
        query=s2_2_1_1_1_rub;
      else
        query=s2_2_1_1_1_val;
      end;
                return query;
  end;
                 
  data = TRsbDataset(createQuery_2_2_1_1_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_2_1_1_1__4", data.value(0));
        ReportData.set("Ф251__2_2_1_1_1__6", data.value(1));
  end;          
               
  data = TRsbDataset(createQuery_2_2_1_1_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_2_1_1_1__3", data.value(0));
        ReportData.set("Ф251__2_2_1_1_1__5", data.value(1));
  end;          

end; //line_2_2_1_1_1 ()








macro line_2_2_2 ()
//debugbreak;
        var data;
        macro createQuery_2_2_2 (currency): string
                        var query;
      if (currency == "Rub")
        query=s2_2_2_rub;
      else
        query=s2_2_2_val;

      end;
                return query;
  end;
                 
  data = TRsbDataset(createQuery_2_2_2("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_2_2__4", data.value(0));
        ReportData.set("Ф251__2_2_2__6", data.value(1));
  end;          
               
  data = TRsbDataset(createQuery_2_2_2("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_2_2__3", data.value(0));
        ReportData.set("Ф251__2_2_2__5", data.value(1));
  end;          

end; //line_2_2_2 ()















macro line_2_2_3 ()
//debugbreak;
        var data;
        macro createQuery_2_2_3 (currency): string
                        var query;
          return ternary (currency == "Rub", s2_2_3_rub, s2_2_3_val);

/*      if (currency == "Rub")
        query=s2_2_3_rub;
      else
        query=s2_2_3_val;
      end;*/
//              return query;
  end;
                 
  data = TRsbDataset(createQuery_2_2_3("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_2_3__4", data.value(0));
        ReportData.set("Ф251__2_2_3__6", data.value(1));
  end;          
               
  data = TRsbDataset(createQuery_2_2_3("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_2_3__3", data.value(0));
        ReportData.set("Ф251__2_2_3__5", data.value(1));
  end;          

end; //line_2_2_3 ()







macro line_2_2_4 ()
//debugbreak;
        var data;

        macro createQuery_2_2_4 (currency): string
          return ternary (currency == "Rub", s2_2_4_rub, s2_2_4_val);
  end;
                 
  data = TRsbDataset(createQuery_2_2_4("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_2_4__4", data.value(0));
        ReportData.set("Ф251__2_2_4__6", data.value(1));
  end;          
               
  data = TRsbDataset(createQuery_2_2_4("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_2_4__3", data.value(0));
        ReportData.set("Ф251__2_2_4__5", data.value(1));
  end;          

end; //line_2_2_4 ()







macro line_2_2_5 ()
//debugbreak;
        var data;

        macro createQuery_2_2_5 (currency): string
          return ternary (currency == "Rub", s2_2_5_rub, s2_2_5_val);
  end;
                 
  data = TRsbDataset(createQuery_2_2_5("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_2_5__4", data.value(0));
        ReportData.set("Ф251__2_2_5__6", data.value(1));
  end;          
               
  data = TRsbDataset(createQuery_2_2_5("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_2_5__3", data.value(0));
        ReportData.set("Ф251__2_2_5__5", data.value(1));
  end;          

end; //line_2_2_5 ()


macro line_2_2_6 ()
//debugbreak;
        var data;
        macro createQuery_2_2_6 (currency): string
                        var query;
      if (currency == "Rub")
        query=s2_2_6_rub;
      else
        query=s2_2_6_val;
      end;
        return query;
  end;
                 
  data = TRsbDataset(createQuery_2_2_6("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_2_6__4", data.value(0));
        ReportData.set("Ф251__2_2_6__6", data.value(1));
  end;          
               
  data = TRsbDataset(createQuery_2_2_6("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_2_6__3", data.value(0));
        ReportData.set("Ф251__2_2_6__5", data.value(1));
  end;          

end; //line_2_2_6 ()

macro line_2_2_6_1 ()
//debugbreak;
        var data;
        macro createQuery_2_2_6_1 (currency): string
                        var query;
      if (currency == "Rub")
        query=s2_2_6_1_rub;
      else
        query=s2_2_6_1_val;
      end;
        return query;
  end;
                 
  data = TRsbDataset(createQuery_2_2_6_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_2_6_1__4", data.value(0));
        ReportData.set("Ф251__2_2_6_1__6", data.value(1));
  end;          
               
  data = TRsbDataset(createQuery_2_2_6_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_2_6_1__3", data.value(0));
        ReportData.set("Ф251__2_2_6_1__5", data.value(1));
  end;          

end; //line_2_2_6_1 ()



  

macro line_2_3_1 ()
//debugbreak;
        var data;
        macro createQuery_2_3_1 (currency): string
                        var query;
      if (currency == "Rub")
        query=s2_3_1_rub;
/*"     select sum ( cn1 ), round(nvl ( sum ( s1 ), 0 )/1000)   "+
"       from ( select count ( 1 ) cn1, sum ( arh.t_sum ) s1     "+
"              from darhdoc_dbt arh, daccount_dbt acc   "+
"              where regexp_like ( t_account,   "+
"                                 '^30232|^30233|^47411|^47422|^47426|^52501|^60301|^60302|^60309|^60310|^6031[1-4]|^60320|^60322|^60323|^706'  "+
"                    )  "+
"                    and arh.t_account_payer = acc.t_account    "+
"                    and acc.t_chapter = 1      "+
"                    and acc.t_client = 3045    "+
"                    and ( arh.t_shifr_oper = '01' or arh.t_shifr_oper = '16' or arh.t_shifr_oper = '13' )      "+
"                    and ( trim ( arh.t_kind_oper ) = '1' or trim ( arh.t_kind_oper ) = '6' )   "+
"                    and arh.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )     "+
"                                             and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )      "+
"                    and arh.t_chapter = 1      "+
"                    and (    acc.t_type_account not like '%П%' "+
"                         and acc.t_type_account not like '%U%' "+
"                         and acc.t_type_account not like '%Н%' )       "+
"              union    "+
"              select count ( 1 ) cn1, sum ( arh.t_sum ) s1     "+
"              from darhdoc_dbt arh, daccount$_dbt acc  "+
"              where     regexp_like ( t_account, '^47416' )    "+
"                    and regexp_like ( arh.t_account_receiver, '^30102' )       "+
"                    and arh.t_account_payer = acc.t_account    "+
"                    and acc.t_chapter = 1      "+
"                    and ( arh.t_shifr_oper = '01' or arh.t_shifr_oper = '13' ) "+
"                    and ( trim ( arh.t_kind_oper ) = '1' or trim ( arh.t_kind_oper ) = '6' )   "+
"                    and arh.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )     "+
"                                             and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )      "+
"                    and arh.t_chapter = 1      "+
"                    and (    acc.t_type_account not like '%П%' "+
"                         and acc.t_type_account not like '%U%' "+
"                         and acc.t_type_account not like '%Н%' ) )     ";*/
      else
        query=s2_3_1_val;
/*
"       select sum ( cn1 ), round(nvl(sum ( s1 ),0)/1000)       "+
"       from ( select count ( 1 ) cn1, sum ( arh.t_sum ) s1     "+
"              from darhdoc_dbt arh, daccount$_dbt acc  "+
"              where regexp_like ( t_account,   "+
"                                 '^30232|^30233|^47411|^47422|^47426|^52501|^  "+
"        60301|^60302|^60309|^60310|^6031[1-4]|^60320|^60322|^60323|^706'       "+
"                    )  "+
"                    and arh.t_account_payer = acc.t_account    "+
"                    and acc.t_chapter = 1      "+
"                    and acc.t_client = 3045    "+
"                    and ( ( arh.t_shifr_oper = '09' ) and ( trim ( arh.t_kind_oper ) = '1' )   "+
"                         or ( arh.t_shifr_oper = '01' or arh.t_shifr_oper = '13' )     "+
"                           and ( trim ( arh.t_kind_oper ) = '1' or trim ( arh.t_kind_oper ) = '6' ) )  "+
"                    and arh.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )     "+
"                                             and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )      "+
"                    and arh.t_chapter = 1      "+
"                    and (   acc.t_type_account like '%П%'      "+
"                         or acc.t_type_account like '%U%'      "+
"                         or acc.t_type_account like '%Н%' )    "+
"              union    "+
"              select count ( 1 ) cn1, sum ( arh.t_sum ) s1     "+
"              from darhdoc_dbt arh, daccount$_dbt acc  "+
"              where     regexp_like ( t_account, '^47416' )    "+
"                    and regexp_like ( arh.t_account_receiver, '^30102' )       "+
"                    and arh.t_account_payer = acc.t_account    "+
"                    and acc.t_chapter = 1      "+
"                    and ( ( arh.t_shifr_oper = '09' ) and ( trim ( arh.t_kind_oper ) = '1' )   "+
"                         or ( arh.t_shifr_oper = '01' or arh.t_shifr_oper = '13' )     "+
"                           and ( trim ( arh.t_kind_oper ) = '1' or trim ( arh.t_kind_oper ) = '6' ) )  "+
"                    and arh.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )     "+
"                                             and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )      "+
"                    and arh.t_chapter = 1      "+
"                    and (   acc.t_type_account like '%П%'      "+
"                         or acc.t_type_account like '%U%'      "+
"                         or acc.t_type_account like '%Н%' ) )  ";
*/
      end;
                return query;
  end;
                 
  data = TRsbDataset(createQuery_2_3_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_3_1__4", data.value(0));
        ReportData.set("Ф251__2_3_1__6", data.value(1));
  end;          
               
  data = TRsbDataset(createQuery_2_3_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_3_1__3", data.value(0));
        ReportData.set("Ф251__2_3_1__5", data.value(1));
  end;          

end; //line_2_3_1 ()





macro line_2_3_3 ()
//debugbreak;
        var data;
        macro createQuery_2_3_3 (currency): string
                        var query;
      if (currency == "Rub")
        query=s2_3_3_rub;
      else
        query=s2_3_3_val;

      end;
                return query;
  end;
                 
  data = TRsbDataset(createQuery_2_3_3("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_3_3__4", data.value(0));
        ReportData.set("Ф251__2_3_3__6", data.value(1));
  end;          
               
  data = TRsbDataset(createQuery_2_3_3("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_3_3__3", data.value(0));
        ReportData.set("Ф251__2_3_3__5", data.value(1));
  end;          

end; //line_2_3_3 ()




macro line_2_3_4 ()
//debugbreak;
        var data;
        macro createQuery_2_3_4 (currency): string
                        var query;
      if (currency == "Rub")
        query=s2_3_4_rub;
              else
        query=s2_3_4_val;
      end;
                return query;
  end;
                 
  data = TRsbDataset(createQuery_2_3_4("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_3_4__4", data.value(0));
        ReportData.set("Ф251__2_3_4__6", data.value(1));
  end;          
               
  data = TRsbDataset(createQuery_2_3_4("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_3_4__3", data.value(0));
        ReportData.set("Ф251__2_3_4__5", data.value(1));
  end;          

end; //line_2_3_4 ()





macro line_2_3_5 ()
//debugbreak;
        var data;
        macro createQuery_2_3_5 (currency): string
                        var query;
      if (currency == "Rub")
        query=s2_3_5_rub;
              else
        query=s2_3_5_val;
      end;
                return query;
  end;
                 
  data = TRsbDataset(createQuery_2_3_5("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_3_5__4", data.value(0));
        ReportData.set("Ф251__2_3_5__6", data.value(1));
  end;          
               
  data = TRsbDataset(createQuery_2_3_5("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_3_5__3", data.value(0));
        ReportData.set("Ф251__2_3_5__5", data.value(1));
  end;          

end; //line_2_3_5 ()








macro line_2_3_6 ()
//debugbreak;
        var data;
        macro createQuery_2_3_6 (currency): string
                        var query;
      if (currency == "Rub")
        query=s2_3_6_rub;

      else
        query=s2_3_6_val;
      end;
                return query;
  end;
                 
  data = TRsbDataset(createQuery_2_3_6("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_3_6__4", data.value(0));
        ReportData.set("Ф251__2_3_6__6", data.value(1));
  end;          
               
  data = TRsbDataset(createQuery_2_3_6("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_3_6__3", data.value(0));
        ReportData.set("Ф251__2_3_6__5", data.value(1));
  end;          

end; //line_2_3_6 ()











































/*
macro line_2_4 ()
//debugbreak;
        var data;
        macro createQuery_2_4 (currency): string
                        var query;
      if (currency == "Rub")
        query=" select sum ( cnt ), round(nvl(sum ( ss ),0)/1000)       "+
"       from ( select sum ( arh.t_sum ) ss, count ( 1 ) cnt     "+
"              from darhdoc_dbt arh, daccount_dbt acc, daccount_dbt acc1        "+
"              where arh.t_date_carry between to_date ( '"+begindate+"', 'DD.MM.YYYY' ) "+
"                                         and  to_date ( '"+enddate+"', 'DD.MM.YYYY' )  "+
"                    and arh.t_shifr_oper = '01'        "+
"                    and acc.t_account = arh.t_account_payer    "+
"                    and acc1.t_account = arh.t_account_receiver        "+
"                    and ( trim ( arh.t_kind_oper ) = '1' or trim ( arh.t_kind_oper ) = '6' )   "+
"                    and ( ( (   arh.t_account_payer like '40911%'      "+
"                             or arh.t_account_payer like '40912%'      "+
"                             or arh.t_account_payer like '40913%' )    "+
"                           and (    acc.t_type_account not like '%П%'  "+
"                                and acc.t_type_account not like '%U%'  "+
"                                and acc.t_type_account not like '%Н%' )        "+
"                           and arh.t_account_receiver not like '706%' )        "+
"                         or ( (   arh.t_account_receiver like '40911%' "+
"                               or arh.t_account_receiver like '40912%' "+
"                               or arh.t_account_receiver like '40913%' )       "+
"                             and (    acc1.t_type_account not like '%П%'       "+
"                                  and acc1.t_type_account not like '%U%'       "+
"                                  and acc1.t_type_account not like '%Н%' )     "+
"                             and arh.t_account_payer not like '706%' ) )       "+
"              union    "+
"              select sum ( arh.t_sum ) ss, count ( 1 ) cnt     "+
"              from darhdoc_dbt arh, daccount_dbt acc, daccount_dbt acc1        "+
"              where arh.t_date_carry between to_date ( '"+begindate+"', 'DD.MM.YYYY' ) "+
"                                         and  to_date ( '"+enddate+"', 'DD.MM.YYYY' )  "+
"                    and arh.t_shifr_oper = '09'        "+
"                    and acc.t_account = arh.t_account_payer    "+
"                    and acc1.t_account = arh.t_account_receiver        "+
"                    and ( trim ( arh.t_kind_oper ) = '6' )     "+
"                    and ( ( (   arh.t_account_payer like '40911%'      "+
"                             or arh.t_account_payer like '40912%'      "+
"                             or arh.t_account_payer like '40913%' )    "+
"                           and (    acc.t_type_account not like '%П%'  "+
"                                and acc.t_type_account not like '%U%'  "+
"                                and acc.t_type_account not like '%Н%' )        "+
"                           and arh.t_account_receiver like '47422%' )  "+
"                         or ( (   arh.t_account_receiver like '40911%' "+
"                               or arh.t_account_receiver like '40912%' "+
"                               or arh.t_account_receiver like '40913%' )       "+
"                             and (    acc1.t_type_account not like '%П%'       "+
"                                  and acc1.t_type_account not like '%U%'       "+
"                                  and acc1.t_type_account not like '%Н%' )     "+
"                             and arh.t_account_payer like '47422%' ) ) )       ";

      else
        query=" select sum ( cnt ), round(nvl(sum ( ss ),0)/1000)       "+
"       from ( select sum ( arh.t_sum ) ss, count ( 1 ) cnt     "+
"              from darhdoc_dbt arh, daccount_dbt acc, daccount_dbt acc1        "+
"              where arh.t_date_carry between to_date ( '"+begindate+"', 'DD.MM.YYYY' ) "+
"                                         and  to_date ( '"+enddate+"', 'DD.MM.YYYY' )  "+
"                    and arh.t_shifr_oper = '01'        "+
"                    and acc.t_account = arh.t_account_payer    "+
"                    and acc1.t_account = arh.t_account_receiver        "+
"                    and ( trim ( arh.t_kind_oper ) = '1' or trim ( arh.t_kind_oper ) = '6' )   "+
"                    and ( ( (   arh.t_account_payer like '40911%'      "+
"                             or arh.t_account_payer like '40912%'      "+
"                             or arh.t_account_payer like '40913%' )    "+
"                           and (   acc.t_type_account like '%П%'       "+
"                                or acc.t_type_account like '%U%'       "+
"                                or acc.t_type_account like '%Н%' )     "+
"                           and arh.t_account_receiver not like '706%' )        "+
"                         or ( (   arh.t_account_receiver like '40911%' "+
"                               or arh.t_account_receiver like '40912%' "+
"                               or arh.t_account_receiver like '40913%' )       "+
"                             and (   acc1.t_type_account like '%П%'    "+
"                                  or acc1.t_type_account like '%U%'    "+
"                                  or acc1.t_type_account like '%Н%' )  "+
"                             and arh.t_account_payer not like '706%' ) )       "+
"              union    "+
"              select nvl ( sum ( arh.t_sum ), 0 ) ss, count ( 1 ) cnt  "+
"              from darhdoc_dbt arh, daccount_dbt acc, daccount_dbt acc1        "+
"              where arh.t_date_carry between to_date ( '"+begindate+"', 'DD.MM.YYYY' ) "+
"                                         and  to_date ( '"+enddate+"', 'DD.MM.YYYY' )  "+
"                    and arh.t_shifr_oper = '09'        "+
"                    and acc.t_account = arh.t_account_payer    "+
"                    and acc1.t_account = arh.t_account_receiver        "+
"                    and ( trim ( arh.t_kind_oper ) = '6' )     "+
"                    and ( ( (   arh.t_account_payer like '40911%'      "+
"                             or arh.t_account_payer like '40912%'      "+
"                             or arh.t_account_payer like '40913%' )    "+
"                           and (   acc.t_type_account like '%П%'       "+
"                                or acc.t_type_account like '%U%'       "+
"                                or acc.t_type_account like '%Н%' )     "+
"                           and arh.t_account_receiver like '47422%' )  "+
"                         or ( (   arh.t_account_receiver like '40911%' "+
"                               or arh.t_account_receiver like '40912%' "+
"                               or arh.t_account_receiver like '40913%' )       "+
"                             and (   acc1.t_type_account like '%П%'    "+
"                                  or acc1.t_type_account like '%U%'    "+
"                                  or acc1.t_type_account like '%Н%' )  "+
"                             and arh.t_account_payer like '47422%' ) ) )       ";

      end;
                return query;
  end;
                 
  data = TRsbDataset(createQuery_2_4("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_4__4", data.value(0));
        ReportData.set("Ф251__2_4__6", data.value(1));
  end;          
               
  data = TRsbDataset(createQuery_2_4("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_4__3", data.value(0));
        ReportData.set("Ф251__2_4__5", data.value(1));
  end;          

end; //line_2_4 ()
*/
macro line_2_4 ()
        var val_2_4__3, val_2_4__4, val_2_4__5, val_2_4__6;
 val_2_4__3 =    double(ReportData.GetValue("Ф251__2_4_1__3")) + double(ReportData.GetValue("Ф251__2_4_2__3"));
 val_2_4__4 =    double(ReportData.GetValue("Ф251__2_4_1__4")) + double(ReportData.GetValue("Ф251__2_4_2__4"));
 val_2_4__5 =    double(ReportData.GetValue("Ф251__2_4_1__5")) + double(ReportData.GetValue("Ф251__2_4_2__5"));
 val_2_4__6 =    double(ReportData.GetValue("Ф251__2_4_1__6")) + double(ReportData.GetValue("Ф251__2_4_2__6")); 

        ReportData.set("Ф251__2_4__3", val_2_4__3);
        ReportData.set("Ф251__2_4__4", val_2_4__4);
        ReportData.set("Ф251__2_4__5", val_2_4__5);
        ReportData.set("Ф251__2_4__6", val_2_4__6);
end;



macro line_2_4_1 ()
//debugbreak;
        var data;
        macro createQuery_2_4_1 (currency): string
                        var query;
      if (currency == "Rub")
        query=s2_4_1_rub;
      else
        query=s2_4_1_val;

      end;
                return query;
  end;
                 
  data = TRsbDataset(createQuery_2_4_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_4_1__4", data.value(0));
        ReportData.set("Ф251__2_4_1__6", data.value(1));
  end;          
               
  data = TRsbDataset(createQuery_2_4_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_4_1__3", data.value(0));
        ReportData.set("Ф251__2_4_1__5", data.value(1));
  end;          

end; //line_2_4_1 ()



macro line_2_4_1_1 ()
//debugbreak;
        var data;
        macro createQuery_2_4_1_1 (currency): string
                        var query;
      if (currency == "Rub")
        query=s2_4_1_1_rub;

      else          
        query=s2_4_1_1_val;
      end;
                return query;
  end;
                 
  data = TRsbDataset(createQuery_2_4_1_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_4_1_1__4", data.value(0));
        ReportData.set("Ф251__2_4_1_1__6", data.value(1));
  end;          
               
  data = TRsbDataset(createQuery_2_4_1_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_4_1_1__3", data.value(0));
        ReportData.set("Ф251__2_4_1_1__5", data.value(1));
  end;          

end; //line_2_4_1_1 ()




macro line_2_4_1_2 ()
//debugbreak;
        var data;
        macro createQuery_2_4_1_2 (currency): string
                        var query;
      if (currency == "Rub")
        query=s2_4_1_2_rub_;

      else          
        query=s2_4_1_2_val_;

      end;
                return query;
  end;
                 
  data = TRsbDataset(createQuery_2_4_1_2("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_4_1_2__4",double(double(ReportData.GetValue("Ф251__2_4_1__4")) - double(data.value(0))));
        ReportData.set("Ф251__2_4_1_2__6",double(double(ReportData.GetValue("Ф251__2_4_1__6")) - double(data.value(1))));
  end;          
               
  data = TRsbDataset(createQuery_2_4_1_2("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_4_1_2__3",double(double(ReportData.GetValue("Ф251__2_4_1__3")) - double(data.value(0))));
        ReportData.set("Ф251__2_4_1_2__5",double(double(ReportData.GetValue("Ф251__2_4_1__5")) - double(data.value(1))));
  end;          

end; //line_2_4_1_2 ()





macro line_2_4_1_2_1 ()
//debugbreak;
        var data;
        macro createQuery_2_4_1_2_1 (currency): string
                        var query;
      if (currency == "Rub")
        query=s2_4_1_2_1_rub;
      else          
        query=s2_4_1_2_1_val;
      end;
                return query;
  end;
                 
  data = TRsbDataset(createQuery_2_4_1_2_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_4_1_2_1__4", data.value(0));
        ReportData.set("Ф251__2_4_1_2_1__6", data.value(1));
  end;          
               
  data = TRsbDataset(createQuery_2_4_1_2_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_4_1_2_1__3", data.value(0));
        ReportData.set("Ф251__2_4_1_2_1__5", data.value(1));
  end;          

end; //line_2_4_1_2_1 ()




macro line_2_4_2 ()
//debugbreak;
        var data;
        macro createQuery_2_4_2 (currency): string
                        var query;
      if (currency == "Rub")
        query=s2_4_2_rub;

      else          
        query=s2_4_2_val;

      end;
                return query;
  end;
                 
  data = TRsbDataset(createQuery_2_4_2("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_4_2__4", data.value(0));
        ReportData.set("Ф251__2_4_2__6", data.value(1));
  end;          
               
  data = TRsbDataset(createQuery_2_4_2("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_4_2__3", data.value(0));
        ReportData.set("Ф251__2_4_2__5", data.value(1));
  end;          

end; //line_2_4_2 ()



macro line_2_4_2_1 ()
//debugbreak;
        var data;
        macro createQuery_2_4_2_1 (currency): string
                        var query;
      if (currency == "Rub")
        query=s2_4_2_1_rub;

      else          
        query=s2_4_2_1_val;

      end;
                return query;
  end;
                 
  data = TRsbDataset(createQuery_2_4_2_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_4_2_1__4", data.value(0));
        ReportData.set("Ф251__2_4_2_1__6", data.value(1));
  end;          
               
  data = TRsbDataset(createQuery_2_4_2_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_4_2_1__3", data.value(0));
        ReportData.set("Ф251__2_4_2_1__5", data.value(1));
  end;          

end; //line_2_4_2_1 ()


macro line_2_4_2_2 ()
//debugbreak;  qqqq
        var data;
        macro createQuery_2_4_2_2 (currency): string
                        var query;
      if (currency == "Rub")
        query=s2_4_2_2_rub_;
      else          
        query=s2_4_2_2_val_;
      end;
                return query;
  end;

  data = TRsbDataset(createQuery_2_4_2_2("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_4_2_2__4",double(double(ReportData.GetValue("Ф251__2_4_2__4")) - double(data.value(0))));
        ReportData.set("Ф251__2_4_2_2__6",double(double(ReportData.GetValue("Ф251__2_4_2__6")) - double(data.value(1))));
  end;          
               
  data = TRsbDataset(createQuery_2_4_2_2("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_4_2_2__3",double(double(ReportData.GetValue("Ф251__2_4_2__3")) - double(data.value(0))));
        ReportData.set("Ф251__2_4_2_2__5",double(double(ReportData.GetValue("Ф251__2_4_2__5")) - double(data.value(1))));
  end;          

end; //line_2_4_2_2 ()


macro line_2_4_2_2_1 ()
//debugbreak;
        var data;
        macro createQuery_2_4_2_2_1 (currency): string
                        var query;
      if (currency == "Rub")
        query=s2_4_2_2_1_rub;

      else          
        query=s2_4_2_2_1_val;
      end;
                return query;
  end;
                 
  data = TRsbDataset(createQuery_2_4_2_2_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_4_2_2_1__4", data.value(0));
        ReportData.set("Ф251__2_4_2_2_1__6", data.value(1));
  end;          
               
  data = TRsbDataset(createQuery_2_4_2_2_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_4_2_2_1__3", data.value(0));
        ReportData.set("Ф251__2_4_2_2_1__5", data.value(1));
  end;          

end; //line_2_4_2_2 ()


macro line_2_5 ()
//debugbreak;
        var data;
        macro createQuery_2_5 (currency): string
                        var query;
      if (currency == "Rub")
        query= "        select sum ( cn ), nvl ( round ( sum ( sm ) / 1000 ), 0 )       "+
"       from ( select count ( 1 ) cn, nvl(sum ( t_sum_payer ), 0) sm  "+ //25.09.2014 R-456034-2 DPN
"              from ( select acc.t_account      "+
"                     from daccount_dbt acc,   dparty_dbt party   left join  dpersn_dbt persn   on ( party.t_partyid = persn.t_personid )       "+
"                     where     substr ( acc.t_account, 1, 3 ) between '401' and '408'  "+
"                           and substr ( acc.t_account, 1, 5 ) not in ('40803', '40810', '40813', '40817', '40820')     "+
"                           and (    acc.t_type_account not like '%П%'  "+
"                                and acc.t_type_account not like '%U%'  "+
"                                and acc.t_type_account not like '%Н%' )        "+
"                           and acc.t_client = party.t_partyid  "+
"                           and ( ( persn.t_isemployer = 'X' and party.t_legalform = 2 ) or ( party.t_legalform = 1 ) ) "+
"                           and acc.t_chapter = 1       "+
"                           and acc.t_code_currency = 0 "+
"                     union     "+
"                     select acc.t_account      "+
"                     from daccount_dbt acc, dparty_dbt party   "+
"                     where ( substr ( t_account, 1, 5 ) between '42309' and '42315'    "+
"                            or substr ( t_account, 1, 5 ) between '42609' and '42615'  "+
"                            or substr ( t_account, 1, 5 ) in   "+
"                                  ( '40803', '40810', '40811', '40813', '47603', '47605','47608', '47609', '40806', '40809',   "+
"                                   '40812', '40814', '40815', '40818', '40819', '40817', '40820' ) )   "+
"                           and (    acc.t_type_account not like '%П%'  "+
"                                and acc.t_type_account not like '%U%'  "+
"                                and acc.t_type_account not like '%Н%' )        "+
"                           and acc.t_code_currency = 0 "+
"                           and acc.t_chapter = 1       "+
"                           and acc.t_client = party.t_partyid  "+
"                           and ( party.t_partyid < 22291 or party.t_partyid > 22291 )  "+
"                           and party.t_legalform = 2   "+
"                     union     "+
"                     select acc.t_account      "+
"                     from daccount_dbt acc     "+
"                     where regexp_like ( acc.t_account, '^30109|^30112|^30113|^30122|^30123|^30230|^30231|^30214' )    "+
"                           and (    acc.t_type_account not like '%П%'  "+
"                                and acc.t_type_account not like '%U%'  "+
"                                and acc.t_type_account not like '%Н%' )        "+
"                           and acc.t_chapter = 1 ) t1, "+
"                   dacctrn_dbt prov    "+
"              where ( ( t1.t_account = prov.t_account_payer and prov.t_account_receiver like '70601%' )        "+
"                     or ( t1.t_account = prov.t_account_receiver and prov.t_account_payer like '70606%' ) )    "+
"                    and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )      "+
"                    and prov.t_shifr_oper = '09'       "+
"                    and trim ( prov.t_kind_oper ) = '6'        "+
"                    and prov.t_chapter = 1     "+
"              union    "+
"              select count ( 1 ) cn, nvl(sum ( t_sum_payer ),0) sm  "+ //25.09.2014 R-456034-2 DPN
"              from dacctrn_dbt prov    "+
"              where prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )    and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )        "+
"                    and ( ( prov.t_shifr_oper = '17' and trim ( prov.t_kind_oper ) = '6' )     "+
"                         or ( prov.t_shifr_oper = '17' and trim ( prov.t_kind_oper ) = '9' ) ) "+
"                    and prov.t_chapter = 1 )   ";

      else  query=" "+
"       select sum ( cn ), nvl ( round ( sum ( sm ) / 1000 ), 0 )       "+
"       from ( select count ( 1 ) cn, nvl(sum ( t_sum_payer ),0) sm  "+    //25.09.2014 R-456034-2 DPN
"              from ( select acc.t_account      "+
"                     from daccount_dbt acc,   dparty_dbt party   left join  dpersn_dbt persn   on ( party.t_partyid = persn.t_personid )      "+
"                     where     substr ( acc.t_account, 1, 3 ) between '401' and '408'  "+
"                           and substr ( acc.t_account, 1, 5 ) not in ('40803', '40810', '40813', '40817', '40820')     "+
"                           and acc.t_client = party.t_partyid  "+
"                           and ( ( persn.t_isemployer = 'X' and party.t_legalform = 2 ) or ( party.t_legalform = 1 ) ) "+
"                           and acc.t_chapter = 1       "+
"                           and acc.t_code_currency > 0 "+
"                     union     "+
"                     select acc.t_account      "+
"                     from daccount_dbt acc, dparty_dbt party  "+
"                     where ( substr ( t_account, 1, 5 ) between '42309' and '42315'    "+
"                            or substr ( t_account, 1, 5 ) between '42609' and '42615'  "+
"                            or substr ( t_account, 1, 5 ) in   "+
"                                  ( '40803', '40810', '40811', '40813', '47603', '47605','47608', '47609', '40806', '40809',   "+
"                                   '40812', '40814', '40815', '40818', '40819', '40817', '40820' ) )   "+
"                           and acc.t_code_currency > 0 "+
"                           and acc.t_chapter = 1       "+
"                           and acc.t_client = party.t_partyid  "+
"                           and ( party.t_partyid < 22291 or party.t_partyid > 22291 )  "+
"                           and party.t_legalform = 2   "+
"                     union     "+
"                     select acc.t_account      "+
"                     from daccount_dbt acc    "+
"                     where regexp_like ( acc.t_account, '^30109|^30112|^30113|^30122|^30123|^30230|^30231|^30214' )    "+
"                           and (    acc.t_type_account like '%П%'      "+
"                                or acc.t_type_account like '%U%'       "+
"                                or acc.t_type_account like '%Н%' )     "+
"                           and acc.t_chapter = 1   ) t1,   dacctrn_dbt prov   "+
"              where ( ( t1.t_account = prov.t_account_payer and prov.t_account_receiver like '70601%' )        "+
"                     or ( t1.t_account = prov.t_account_receiver and prov.t_account_payer like '70606%' ) )    "+
"                    and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )      "+
"                    and prov.t_shifr_oper = '09'       "+
"                    and trim ( prov.t_kind_oper ) = '6'        "+
"                    and prov.t_chapter = 1     "+
"              union    "+
"              select count ( 1 ) cn, nvl(sum ( t_sum_payer ),0) sm  "+ //25.09.2014 R-456034-2 DPN
"              from dacctrn_dbt prov   "+
"              where prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )    and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )        "+
"                    and ( ( prov.t_shifr_oper = '17' and trim ( prov.t_kind_oper ) = '6' )     "+
"                         or ( prov.t_shifr_oper = '17' and trim ( prov.t_kind_oper ) = '9' ) ) "+
"                    and prov.t_chapter = 1 )   ";

      end;
                return query;
  end;
           //getstring(createQuery_2_5("Cur"));
  data = TRsbDataset(createQuery_2_5("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_5__4", data.value(0));
        ReportData.set("Ф251__2_5__6", data.value(1));
  end;          
               
  data = TRsbDataset(createQuery_2_5("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_5__3", data.value(0));
        ReportData.set("Ф251__2_5__5", data.value(1));
  end;          

end; //line_2_5 ()




macro line_2_5_1 ()
//debugbreak;
        var data;
        macro createQuery_2_5_1 (currency): string
                        var query;
      if (currency == "Rub")
        query= "        select sum ( cn ), nvl ( round ( sum ( sm ) / 1000 ), 0 )       "+
"       from ( select count ( 1 ) cn, nvl(sum ( t_sum_payer ),0) sm  "+ //25.09.2014 R-456034-2 DPN
"              from ( select acc.t_account      "+
"                     from daccount_dbt acc,   dparty_dbt party   left join  dpersn_dbt persn   on ( party.t_partyid = persn.t_personid )       "+
"                     where     substr ( acc.t_account, 1, 3 ) between '401' and '408'  "+
"                           and substr ( acc.t_account, 1, 5 ) not in ('40803', '40810', '40813', '40817', '40820')     "+
"                           and (    acc.t_type_account not like '%П%'  "+
"                                and acc.t_type_account not like '%U%'  "+
"                                and acc.t_type_account not like '%Н%' )        "+
"                           and acc.t_client = party.t_partyid  "+
"                           and ( ( persn.t_isemployer = 'X' and party.t_legalform = 2 ) or ( party.t_legalform = 1 ) ) "+
"                           and acc.t_chapter = 1       "+
"                           and acc.t_code_currency = 0 "+
"                     union     "+
"                     select acc.t_account      "+
"                     from daccount_dbt acc, dparty_dbt party   "+
"                     where ( substr ( t_account, 1, 5 ) between '42309' and '42315'    "+
"                            or substr ( t_account, 1, 5 ) between '42609' and '42615'  "+
"                            or substr ( t_account, 1, 5 ) in   "+
"                                  ( '40803', '40810', '40811', '40813', '47603', '47605','47608', '47609', '40806', '40809',   "+
"                                   '40812', '40814', '40815', '40818', '40819', '40817', '40820' ) )   "+
"                           and (    acc.t_type_account not like '%П%'  "+
"                                and acc.t_type_account not like '%U%'  "+
"                                and acc.t_type_account not like '%Н%' )        "+
"                           and acc.t_code_currency = 0 "+
"                           and acc.t_chapter = 1       "+
"                           and acc.t_client = party.t_partyid  "+
"                           and ( party.t_partyid < 22291 or party.t_partyid > 22291 )  "+
"                           and party.t_legalform = 2   "+
"                     union     "+
"                     select acc.t_account      "+
"                     from daccount_dbt acc     "+
"                     where regexp_like ( acc.t_account, '^30109|^30112|^30113|^30122|^30123|^30230|^30231|^30214' )    "+
"                           and (    acc.t_type_account not like '%П%'  "+
"                                and acc.t_type_account not like '%U%'  "+
"                                and acc.t_type_account not like '%Н%' )        "+
"                           and acc.t_chapter = 1 ) t1, "+
"                   dacctrn_dbt prov    "+
"              where ( ( t1.t_account = prov.t_account_payer and prov.t_account_receiver like '70601%' )        "+
"                     or ( t1.t_account = prov.t_account_receiver and prov.t_account_payer like '70606%' ) )    "+
"                    and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )      "+
"                    and prov.t_shifr_oper = '09'       "+
"                    and trim ( prov.t_kind_oper ) = '6'        "+
"                    and prov.t_chapter = 1     "+
"              union    "+
"              select count ( 1 ) cn, nvl(sum ( t_sum_payer ),0) sm  "+ //25.09.2014 R-456034-2 DPN
"              from dacctrn_dbt prov    "+
"              where prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )    and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )        "+
"                    and ( ( prov.t_shifr_oper = '17' and trim ( prov.t_kind_oper ) = '6' )     "+
"                         or ( prov.t_shifr_oper = '17' and trim ( prov.t_kind_oper ) = '9' ) ) "+
"                    and prov.t_chapter = 1     "+
"                                                  and (substr(prov.t_account_payer,1,5)='70606' or substr(prov.t_account_receiver,1,5)='70601')        )       ";

      else  query=" "+
"       select sum ( cn ), nvl ( round ( sum ( sm ) / 1000 ), 0 )       "+
"       from ( select count ( 1 ) cn, nvl(sum ( t_sum_payer ),0) sm  "+ //25.09.2014 R-456034-2 DPN
"              from ( select acc.t_account      "+
"                     from daccount_dbt acc,   dparty_dbt party   left join  dpersn_dbt persn   on ( party.t_partyid = persn.t_personid )      "+
"                     where     substr ( acc.t_account, 1, 3 ) between '401' and '408'  "+
"                           and substr ( acc.t_account, 1, 5 ) not in ('40803', '40810', '40813', '40817', '40820')     "+
"                           and acc.t_client = party.t_partyid  "+
"                           and ( ( persn.t_isemployer = 'X' and party.t_legalform = 2 ) or ( party.t_legalform = 1 ) ) "+
"                           and acc.t_chapter = 1       "+
"                           and acc.t_code_currency > 0 "+
"                     union     "+
"                     select acc.t_account      "+
"                     from daccount_dbt acc, dparty_dbt party  "+
"                     where ( substr ( t_account, 1, 5 ) between '42309' and '42315'    "+
"                            or substr ( t_account, 1, 5 ) between '42609' and '42615'  "+
"                            or substr ( t_account, 1, 5 ) in   "+
"                                  ( '40803', '40810', '40811', '40813', '47603', '47605','47608', '47609', '40806', '40809',   "+
"                                   '40812', '40814', '40815', '40818', '40819', '40817', '40820' ) )   "+
"                           and acc.t_code_currency > 0 "+
"                           and acc.t_chapter = 1       "+
"                           and acc.t_client = party.t_partyid  "+
"                           and ( party.t_partyid < 22291 or party.t_partyid > 22291 )  "+
"                           and party.t_legalform = 2   "+
"                     union     "+
"                     select acc.t_account      "+
"                     from daccount_dbt acc    "+
"                     where regexp_like ( acc.t_account, '^30109|^30112|^30113|^30122|^30123|^30230|^30231|^30214' )    "+
"                           and (    acc.t_type_account like '%П%'      "+
"                                or acc.t_type_account like '%U%'       "+
"                                or acc.t_type_account like '%Н%' )     "+
"                           and acc.t_chapter = 1   ) t1,   dacctrn_dbt prov   "+
"              where ( ( t1.t_account = prov.t_account_payer and prov.t_account_receiver like '70601%' )        "+
"                     or ( t1.t_account = prov.t_account_receiver and prov.t_account_payer like '70606%' ) )    "+
"                    and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )      "+
"                    and prov.t_shifr_oper = '09'       "+
"                    and trim ( prov.t_kind_oper ) = '6'        "+
"                    and prov.t_chapter = 1     "+
"              union    "+
"              select count ( 1 ) cn, nvl(sum ( t_sum_payer ),0) sm  "+  //25.09.2014 R-456034-2 DPN
"              from dacctrn_dbt prov   "+
"              where prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )    and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )        "+
"                    and ( ( prov.t_shifr_oper = '17' and trim ( prov.t_kind_oper ) = '6' )     "+
"                         or ( prov.t_shifr_oper = '17' and trim ( prov.t_kind_oper ) = '9' ) ) "+
"                    and prov.t_chapter = 1     "+
"                                                  and (substr(prov.t_account_payer,1,5)='70606' or substr(prov.t_account_receiver,1,5)='70601')        )       ";

      end;
                return query;
  end;
           //getstring(createQuery_2_5("Cur"));
  data = TRsbDataset(createQuery_2_5_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__2_5_1__4", data.value(0));
        ReportData.set("Ф251__2_5_1__6", data.value(1));
  end;          
               
  data = TRsbDataset(createQuery_2_5_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__2_5_1__3", data.value(0));
        ReportData.set("Ф251__2_5_1__5", data.value(1));
  end;          

end; //line_2_5 ()




macro line_2_spr(); //03.04.2012 vihrov C-9859-6
    var data;
        data = TRsbDataset(s2_spr_rub);
   if (data.movenext)
         ReportData.set("Ф251__2_spr_kolwo", data.value(0));
         ReportData.set("Ф251__2_spr_summa", data.value(1));
   end;         

end; //line_2_spr();


macro line_3_1 ()
//debugbreak;
        var data;
        macro createQuery_3_1 (currency): string
          return ternary (currency == "Rub", s3_1_rub, s3_1_val);  
        end;
  data = TRsbDataset(createQuery_3_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__3_1__4", data.value(0));
        ReportData.set("Ф251__3_1__6", data.value(1));
  end;          
               
  data = TRsbDataset(createQuery_3_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__3_1__3", data.value(0));
        ReportData.set("Ф251__3_1__5", data.value(1));
  end;          

end; //line_3_1 ()




macro line_3_1_1 ()
//debugbreak;
        var data;
        macro createQuery_3_1_1 (currency): string
                        var query;
      if (currency == "Rub")
              query=    
"       /* Formatted on 14.10.2010 18:20:39 (QP5 v5.115.810.9015) */    "+
"       select count ( 1 ), nvl ( round ( sum ( t_sum_payer ) / 1000 ), 0 )   "+
"       from ( select acc.t_account     "+
"              from daccount_dbt acc,   dparty_dbt party        "+
"                                     left join "+
"                                       dpersn_dbt persn        "+
"                                     on ( party.t_partyid = persn.t_personid ) "+
"              where substr ( acc.t_account, 1, 3 ) between '401' and '408'     "+
"                    and substr ( acc.t_account, 1, 5 ) not in ('40803', '40810', '40813', '40817', '40820')    "+
"                    and (    acc.t_type_account not like '%П%' "+
"                         and acc.t_type_account not like '%U%' "+
"                         and acc.t_type_account not like '%Н%' )       "+
"                    and acc.t_client = party.t_partyid "+
"                    and ( ( persn.t_isemployer = 'X' and party.t_legalform = 2 ) or ( party.t_legalform = 1 ) )        "+
"                    and acc.t_chapter = 1      "+
"                    and acc.t_code_currency = 0        "+
"              and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' )    "+
"              union    "+
"              select acc.t_account     "+
"              from daccount_dbt acc, dparty_dbt party  "+
"              where ( substr ( t_account, 1, 5 ) between '42309' and '42315'   "+
"                     or substr ( t_account, 1, 5 ) between '42609' and '42615' "+
"                     or substr ( t_account, 1, 5 ) in  "+
"                           ( '40803', '40810', '40811', '40813','47603', '47605', '47608', '47609', '40806','40809',   "+
"                            '40812', '40814',  '40815', '40818','40819', '40817','40820' ) )   "+
"                    and (    acc.t_type_account not like '%П%'  and acc.t_type_account not like '%U%'  and acc.t_type_account not like '%Н%' ) "+
"                    and acc.t_code_currency = 0        "+
"                    and acc.t_chapter = 1      "+
"                    and acc.t_client = party.t_partyid "+
"                    and ( party.t_partyid < 22291 or party.t_partyid > 22291 ) "+
"                    and party.t_legalform = 2  "+
"              and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' )    "+
"              union    "+
"              select t_account acc"+
"              from daccount_dbt        acc"+
"              where ( substr ( t_account, 1, 5 ) in    "+
"                         ( '30232', '30233','47411','47416','47422','47426', '52501', '60301', '60302','60309','60310',        "+
"                          '60311', '60312','60314', '60320', '60322', '60323' )        "+
"                     or substr ( t_account, 1, 3 ) = '706' )   "+
"                    and t_client = 3045        "+
"              and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' )    "+
"              union    "+
"              select t_account "+
"              from daccount_dbt        acc"+
"              where substr ( t_account, 1, 5 ) in ('40911', '40912', '40913') "+
"              and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' )  "+
"                    and acc.t_chapter = 1              ) t1,   "+
"            dacctrn_dbt prov   "+
"       where t1.t_account = prov.t_account_payer       "+
"             and substr(prov.t_account_receiver,1,5) in        "+
"                    ( '30109', '30112', '30113', '30122', '30123', '30230', '30231', '30214', '30110', '30114', '30115', '30213' )     "+
"             and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )   "+
"                                       and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )    ";
        
        else
        query=" "+
"       /* Formatted on 14.10.2010 18:20:39 (QP5 v5.115.810.9015) */    "+
"       select count ( 1 ), nvl ( round ( sum ( t_sum_payer ) / 1000 ), 0 )   "+
"       from ( select acc.t_account     "+
"              from daccount_dbt acc,   dparty_dbt party        "+
"                                     left join "+
"                                       dpersn_dbt persn        "+
"                                     on ( party.t_partyid = persn.t_personid ) "+
"              where substr ( acc.t_account, 1, 3 ) between '401' and '408'     "+
"                    and substr ( acc.t_account, 1, 5 ) not in ('40803', '40810', '40813', '40817', '40820')    "+
"                    and (    acc.t_type_account like '%П%'  or acc.t_type_account like '%U%' or acc.t_type_account like '%Н%' )        "+
"                    and acc.t_client = party.t_partyid "+
"                    and ( ( persn.t_isemployer = 'X' and party.t_legalform = 2 ) or ( party.t_legalform = 1 ) )        "+
"                    and acc.t_chapter = 1      "+
"                    and acc.t_code_currency = 0        "+
"                    and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' )        "+
"       union   "+
"              select acc.t_account     "+
"              from daccount_dbt acc, dparty_dbt party  "+
"              where ( substr ( t_account, 1, 5 ) between '42309' and '42315'   "+
"                     or substr ( t_account, 1, 5 ) between '42609' and '42615' "+
"                     or substr ( t_account, 1, 5 ) in  "+
"                           ( '40803', '40810', '40811', '40813','47603', '47605', '47608', '47609', '40806','40809',   "+
"                            '40812', '40814',  '40815', '40818','40819', '40817','40820' ) )   "+
"                    and (    acc.t_type_account like '%П%'  or acc.t_type_account like '%U%' or acc.t_type_account like '%Н%' )        "+
"                    and acc.t_code_currency = 0        "+
"                    and acc.t_chapter = 1      "+
"                    and acc.t_client = party.t_partyid "+
"                    and ( party.t_partyid < 22291 or party.t_partyid > 22291 ) "+
"                    and party.t_legalform = 2  "+
"                    and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' )        "+
"              union    "+
"              select t_account "+
"              from daccount_dbt acc    "+
"              where ( substr ( t_account, 1, 5 ) in    "+
"                         ( '30232', '30233','47411','47416','47422','47426', '52501', '60301', '60302','60309','60310',        "+
"                          '60311', '60312','60314', '60320', '60322', '60323' )        "+
"                     or substr ( t_account, 1, 3 ) = '706' )   "+
"                    and (    acc.t_type_account like '%П%'  or acc.t_type_account like '%U%' or acc.t_type_account like '%Н%' )                "+
"                    and t_client = 3045        "+
"                    and acc.t_code_currency = 0        "+
"                    and t_chapter=1    "+
"                    and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' )        "+
"              union    "+
"              select t_account         "+
"              from daccount_dbt acc    "+
"              where substr ( t_account, 1, 5 ) in ('40911', '40912', '40913')  "+
"                  and (    acc.t_type_account like '%П%'  or acc.t_type_account like '%U%' or acc.t_type_account like '%Н%' )          "+
"                  and acc.t_code_currency = 0          "+
"                  and t_chapter=1      "+
"                                and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' )            "+
"        ) t1,  "+
"            dacctrn_dbt prov   "+
"       where t1.t_account = prov.t_account_payer       "+
"             and substr(prov.t_account_receiver,1,5) in        "+
"                    ( '30109', '30112', '30113', '30122', '30123', '30230', '30231', '30214', '30110', '30114', '30115', '30213' )     "+
"             and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )   "+
"                                       and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )    "+
"             and prov.t_chapter=1      ";

      end;
      //getstring(query);
                return query;
  end;
//  debugbreak;
  data = TRsbDataset(createQuery_3_1_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__3_1_1__4", data.value(0));
        ReportData.set("Ф251__3_1_1__6", data.value(1));
  end;          
//getstring(createQuery_3_1_1("Rub"));                 
               
  data = TRsbDataset(createQuery_3_1_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__3_1_1__3", data.value(0));
        ReportData.set("Ф251__3_1_1__5", data.value(1));
  end;          

end; //line_3_1_1 ()



/*
macro line_3_3_1 ()
//debugbreak;
        var data;
        macro createQuery_3_3_1 (currency): string
                        var query;
      if (currency == "Rub")
        query=" SELECT   COUNT (1), nvl(SUM (arh.t_sum),0)      "+
"         FROM   darhdoc_dbt arh        "+
"        WHERE                                                          "+
"             ARH.T_CHAPTER = 1 "+
"                AND arh.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'DD.MM.YYYY')   "+
"                                         AND  TO_DATE ('"+enddate+"', 'DD.MM.YYYY')    "+
"                AND SUBSTR (arh.t_account_payer, 6, 3) = '810'         "+
"                and ARH.T_ACCOUNT_PAYER in (select t_account from daccount_dbt "+
"                                            where (t_client < 22659 or t_client > 22659)       "+
"                                            and t_chapter = 1)                         "+
"                AND ( (SUBSTR (arh.t_account_payer, 1, 5) IN   "+
"                             ('40911', '40912', '40913')       "+
"                       AND arh.t_shifr_oper = '01'     "+
"                       AND TRIM (arh.t_kind_oper) IN ('1', '6')        "+
"                       AND SUBSTR (arh.t_account_receiver, 1, 3) != '706')     "+
"                     OR (SUBSTR (arh.t_account_payer, 1, 5) IN "+
"                               ('40911', '40912', '40913')     "+
"                         AND arh.t_shifr_oper = '09'   "+
"                         AND TRIM (arh.t_kind_oper) = '6'      "+
"                         AND SUBSTR (arh.t_account_receiver, 1, 5) = '47422')) ";

      else          
        query=" select count ( 1 ), nvl ( sum ( arh.t_sum ), 0 )        "+
"       from darhdoc_dbt arh    "+
"       where arh.t_chapter = 1 "+
"             and arh.t_date_carry between to_date ( '"+begindate+"', 'DD.MM.YYYY' )    "+
"                                      and  to_date ( '"+enddate+"', 'DD.MM.YYYY' )     "+
"             and substr ( arh.t_account_payer, 6, 3 ) <> '810' "+
"             and arh.t_account_payer in (select t_account      "+
"                                         from daccount$_dbt    "+
"                                         where ( t_client < 22659 or t_client > 22659 ) and t_chapter = 1)     "+
"             and ( (    substr ( arh.t_account_payer, 1, 5 ) in ('40911', '40912', '40913')    "+
"                    and arh.t_shifr_oper = '01'        "+
"                    and trim ( arh.t_kind_oper ) in ('1', '6') "+
"                    and substr ( arh.t_account_receiver, 1, 3 ) != '706' )     "+
"                  or (    substr ( arh.t_account_payer, 1, 5 ) in ('40911', '40912', '40913')  "+
"                      and arh.t_shifr_oper = '09'      "+
"                      and trim ( arh.t_kind_oper ) = '6'       "+
"                      and substr ( arh.t_account_receiver, 1, 5 ) = '47422' ) )        ";

      end;
                return query;
  end;
                 
  data = TRsbDataset(createQuery_3_3_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__3_3_1__4", data.value(0));
        ReportData.set("Ф251__3_3_1__6", data.value(1));
  end;          
               
  data = TRsbDataset(createQuery_3_3_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__3_3_1__3", data.value(0));
        ReportData.set("Ф251__3_3_1__5", data.value(1));
  end;          

end; //line_3_3_1 ()
*/
macro line_3_4 ()
//debugbreak;
        var data;
        macro createQuery_3_4 (currency): string
                        var query;
      if (currency == "Rub")
        query=" "+
"       /* Formatted on 14.10.2010 18:20:39 (QP5 v5.115.810.9015) */    "+
"       select count ( 1 ), nvl ( round ( sum ( t_sum_payer ) / 1000 ), 0 )   "+
"       from ( select acc.t_account     "+
"              from daccount_dbt acc,   dparty_dbt party        "+
"                                     left join "+
"                                       dpersn_dbt persn        "+
"                                     on ( party.t_partyid = persn.t_personid ) "+
"              where substr ( acc.t_account, 1, 3 ) between '401' and '408'     "+
"                    and substr ( acc.t_account, 1, 5 ) not in ('40803', '40810', '40813', '40817', '40820')    "+
"                           and (    acc.t_type_account not like '%П%'  and acc.t_type_account not like '%U%'   and acc.t_type_account not like '%Н%' ) "+
"                    and acc.t_client = party.t_partyid "+
"                    and ( ( persn.t_isemployer = 'X' and party.t_legalform = 2 ) or ( party.t_legalform = 1 ) )        "+
"                    and acc.t_chapter = 1      "+
"                    and acc.t_code_currency = 0        "+
"                   /* and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' ) */           "+
"       union   "+
"              select acc.t_account     "+
"              from daccount_dbt acc, dparty_dbt party  "+
"              where ( substr ( t_account, 1, 5 ) between '42309' and '42315'   "+
"                     or substr ( t_account, 1, 5 ) between '42609' and '42615' "+
"                     or substr ( t_account, 1, 5 ) in  "+
"                           ( '40803', '40810', '40811', '40813','47603', '47605', '47608', '47609', '40806','40809',   "+
"                            '40812', '40814',  '40815', '40818','40819', '40817','40820' ) )   "+
"                           and (    acc.t_type_account not like '%П%'  and acc.t_type_account not like '%U%'   and acc.t_type_account not like '%Н%' ) "+
"                    and acc.t_code_currency = 0        "+
"                    and acc.t_chapter = 1      "+
"                    and acc.t_client = party.t_partyid "+
"                    and ( party.t_partyid < 22291 or party.t_partyid > 22291 ) "+
"                    and party.t_legalform = 2  "+
"                   /* and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' ) */           "+
"              union    "+
"              select t_account "+
"              from daccount_dbt acc    "+
"              where ( substr ( t_account, 1, 5 ) in    "+
"                         ( '30232', '30233','47411','47416','47422','47426', '52501', '60301', '60302','60309','60310',        "+
"                          '60311', '60312','60314', '60320', '60322', '60323' )        "+
"                     or substr ( t_account, 1, 3 ) = '706' )   "+
"                           and (    acc.t_type_account not like '%П%'  and acc.t_type_account not like '%U%'   and acc.t_type_account not like '%Н%' ) "+
"                    and t_client = 3045        "+
"                    and acc.t_code_currency = 0        "+
"                    and t_chapter=1    "+
"           /*         and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' ) */           "+
"              union    "+
"              select t_account         "+
"              from daccount_dbt acc    "+
"              where substr ( t_account, 1, 5 ) in ('40911', '40912', '40913')  "+
"                           and (    acc.t_type_account not like '%П%'  and acc.t_type_account not like '%U%'   and acc.t_type_account not like '%Н%' ) "+
"                  and acc.t_code_currency = 0          "+
"                  and t_chapter=1      "+
"            /*  and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' )*/          "+
"        ) t1,  "+
"            dacctrn_dbt prov   "+
"       where t1.t_account = prov.t_account_payer       "+
"             and substr(prov.t_account_receiver,1,5) ='30102'  "+
"             and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )   "+
"                                       and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )    "+
"             and prov.t_chapter=1      ";

      else          
        query=" /* Formatted on 14.10.2010 18:20:39 (QP5 v5.115.810.9015) */    "+
"       select count ( 1 ), nvl ( round ( sum ( t_sum_payer ) / 1000 ), 0 )   "+
"       from ( select acc.t_account     "+
"              from daccount_dbt acc,   dparty_dbt party        "+
"                                     left join "+
"                                       dpersn_dbt persn        "+
"                                     on ( party.t_partyid = persn.t_personid ) "+
"              where substr ( acc.t_account, 1, 3 ) between '401' and '408'     "+
"                    and substr ( acc.t_account, 1, 5 ) not in ('40803', '40810', '40813', '40817', '40820')    "+
"                    and (    acc.t_type_account like '%П%'  or acc.t_type_account like '%U%' or acc.t_type_account like '%Н%' )        "+
"                    and acc.t_client = party.t_partyid "+
"                    and ( ( persn.t_isemployer = 'X' and party.t_legalform = 2 ) or ( party.t_legalform = 1 ) )        "+
"                    and acc.t_chapter = 1      "+
"                    and acc.t_code_currency = 0        "+
"                   /* and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' ) */           "+
"       union   "+
"              select acc.t_account     "+
"              from daccount_dbt acc, dparty_dbt party  "+
"              where ( substr ( t_account, 1, 5 ) between '42309' and '42315'   "+
"                     or substr ( t_account, 1, 5 ) between '42609' and '42615' "+
"                     or substr ( t_account, 1, 5 ) in  "+
"                           ( '40803', '40810', '40811', '40813','47603', '47605', '47608', '47609', '40806','40809',   "+
"                            '40812', '40814',  '40815', '40818','40819', '40817','40820' ) )   "+
"                    and (    acc.t_type_account like '%П%'  or acc.t_type_account like '%U%' or acc.t_type_account like '%Н%' )        "+
"                    and acc.t_code_currency = 0        "+
"                    and acc.t_chapter = 1      "+
"                    and acc.t_client = party.t_partyid "+
"                    and ( party.t_partyid < 22291 or party.t_partyid > 22291 ) "+
"                    and party.t_legalform = 2  "+
"                   /* and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' ) */           "+
"              union    "+
"              select t_account "+
"              from daccount_dbt acc    "+
"              where ( substr ( t_account, 1, 5 ) in    "+
"                         ( '30232', '30233','47411','47416','47422','47426', '52501', '60301', '60302','60309','60310',        "+
"                          '60311', '60312','60314', '60320', '60322', '60323' )        "+
"                     or substr ( t_account, 1, 3 ) = '706' )   "+
"                    and (    acc.t_type_account like '%П%'  or acc.t_type_account like '%U%' or acc.t_type_account like '%Н%' )                "+
"                    and t_client = 3045        "+
"                    and acc.t_code_currency = 0        "+
"                    and t_chapter=1    "+
"           /*         and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' ) */           "+
"              union    "+
"              select t_account         "+
"              from daccount_dbt acc    "+
"              where substr ( t_account, 1, 5 ) in ('40911', '40912', '40913')  "+
"                  and (    acc.t_type_account like '%П%'  or acc.t_type_account like '%U%' or acc.t_type_account like '%Н%' )          "+
"                  and acc.t_code_currency = 0          "+
"                  and t_chapter=1      "+
"            /*  and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' )*/          "+
"        ) t1,  "+
"            dacctrn_dbt prov   "+
"       where t1.t_account = prov.t_account_payer       "+
"             and substr(prov.t_account_receiver,1,5) ='30102'  "+
"             and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )   "+
"                                       and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )    "+
"             and prov.t_chapter=1      ";
      end;
                return query;
  end;
                 
  data = TRsbDataset(createQuery_3_4("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__3_4__4", data.value(0));
        ReportData.set("Ф251__3_4__6", data.value(1));
  end;          
               
  data = TRsbDataset(createQuery_3_4("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__3_4__3", data.value(0));
        ReportData.set("Ф251__3_4__5", data.value(1));
  end;          

end; //line_3_4 ()






macro line_3_4_1 ()
//debugbreak;
        var data;
        macro createQuery_3_4_1 (currency): string
                        var query;
      if (currency == "Rub")
        query=" "+
"       /* Formatted on 14.10.2010 18:20:39 (QP5 v5.115.810.9015) */    "+
"       select count ( 1 ), nvl ( round ( sum ( t_sum_payer ) / 1000 ), 0 )   "+
"       from ( select acc.t_account     "+
"              from daccount_dbt acc,   dparty_dbt party        "+
"                                     left join "+
"                                       dpersn_dbt persn        "+
"                                     on ( party.t_partyid = persn.t_personid ) "+
"              where substr ( acc.t_account, 1, 3 ) between '401' and '408'     "+
"                    and substr ( acc.t_account, 1, 5 ) not in ('40803', '40810', '40813', '40817', '40820')    "+
"                           and (    acc.t_type_account not like '%П%'  and acc.t_type_account not like '%U%'   and acc.t_type_account not like '%Н%' ) "+
"                    and acc.t_client = party.t_partyid "+
"                    and ( ( persn.t_isemployer = 'X' and party.t_legalform = 2 ) or ( party.t_legalform = 1 ) )        "+
"                    and acc.t_chapter = 1      "+
"                    and acc.t_code_currency = 0        "+
"                    and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' )        "+
"       union   "+
"              select acc.t_account     "+
"              from daccount_dbt acc, dparty_dbt party  "+
"              where ( substr ( t_account, 1, 5 ) between '42309' and '42315'   "+
"                     or substr ( t_account, 1, 5 ) between '42609' and '42615' "+
"                     or substr ( t_account, 1, 5 ) in  "+
"                           ( '40803', '40810', '40811', '40813','47603', '47605', '47608', '47609', '40806','40809',   "+
"                            '40812', '40814',  '40815', '40818','40819', '40817','40820' ) )   "+
"                           and (    acc.t_type_account not like '%П%'  and acc.t_type_account not like '%U%'   and acc.t_type_account not like '%Н%' ) "+
"                    and acc.t_code_currency = 0        "+
"                    and acc.t_chapter = 1      "+
"                    and acc.t_client = party.t_partyid "+
"                    and ( party.t_partyid < 22291 or party.t_partyid > 22291 ) "+
"                    and party.t_legalform = 2  "+
"                    and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' )        "+
"              union    "+
"              select t_account "+
"              from daccount_dbt acc    "+
"              where ( substr ( t_account, 1, 5 ) in    "+
"                         ( '30232', '30233','47411','47416','47422','47426', '52501', '60301', '60302','60309','60310',        "+
"                          '60311', '60312','60314', '60320', '60322', '60323' )        "+
"                     or substr ( t_account, 1, 3 ) = '706' )   "+
"                           and (    acc.t_type_account not like '%П%'  and acc.t_type_account not like '%U%'   and acc.t_type_account not like '%Н%' ) "+
"                    and t_client = 3045        "+
"                    and acc.t_code_currency = 0        "+
"                    and t_chapter=1    "+
"                    and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' )        "+
"              union    "+
"              select t_account         "+
"              from daccount_dbt acc    "+
"              where substr ( t_account, 1, 5 ) in ('40911', '40912', '40913')  "+
"                           and (    acc.t_type_account not like '%П%'  and acc.t_type_account not like '%U%'   and acc.t_type_account not like '%Н%' ) "+
"                  and acc.t_code_currency = 0          "+
"                  and t_chapter=1      "+
"              and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' )      "+
"        ) t1,  "+
"            dacctrn_dbt prov   "+
"       where t1.t_account = prov.t_account_payer       "+
"             and substr(prov.t_account_receiver,1,5) ='30102'  "+
"             and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )   "+
"                                       and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )    "+
"             and prov.t_chapter=1      ";


      else          
        query=" "+
"       /* Formatted on 14.10.2010 18:20:39 (QP5 v5.115.810.9015) */    "+
"       select count ( 1 ), nvl ( round ( sum ( t_sum_payer ) / 1000 ), 0 )   "+
"       from ( select acc.t_account     "+
"              from daccount_dbt acc,   dparty_dbt party        "+
"                                     left join "+
"                                       dpersn_dbt persn        "+
"                                     on ( party.t_partyid = persn.t_personid ) "+
"              where substr ( acc.t_account, 1, 3 ) between '401' and '408'     "+
"                    and substr ( acc.t_account, 1, 5 ) not in ('40803', '40810', '40813', '40817', '40820')    "+
"                    and (    acc.t_type_account like '%П%'  or acc.t_type_account like '%U%' or acc.t_type_account like '%Н%' )        "+
"                    and acc.t_client = party.t_partyid "+
"                    and ( ( persn.t_isemployer = 'X' and party.t_legalform = 2 ) or ( party.t_legalform = 1 ) )        "+
"                    and acc.t_chapter = 1      "+
"                    and acc.t_code_currency = 0        "+
"                    and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' )        "+
"       union   "+
"              select acc.t_account     "+
"              from daccount_dbt acc, dparty_dbt party  "+
"              where ( substr ( t_account, 1, 5 ) between '42309' and '42315'   "+
"                     or substr ( t_account, 1, 5 ) between '42609' and '42615' "+
"                     or substr ( t_account, 1, 5 ) in  "+
"                           ( '40803', '40810', '40811', '40813','47603', '47605', '47608', '47609', '40806','40809',   "+
"                            '40812', '40814',  '40815', '40818','40819', '40817','40820' ) )   "+
"                    and (    acc.t_type_account like '%П%'  or acc.t_type_account like '%U%' or acc.t_type_account like '%Н%' )        "+
"                    and acc.t_code_currency = 0        "+
"                    and acc.t_chapter = 1      "+
"                    and acc.t_client = party.t_partyid "+
"                    and ( party.t_partyid < 22291 or party.t_partyid > 22291 ) "+
"                    and party.t_legalform = 2  "+
"                    and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' )        "+
"              union    "+
"              select t_account "+
"              from daccount_dbt acc    "+
"              where ( substr ( t_account, 1, 5 ) in    "+
"                         ( '30232', '30233','47411','47416','47422','47426', '52501', '60301', '60302','60309','60310',        "+
"                          '60311', '60312','60314', '60320', '60322', '60323' )        "+
"                     or substr ( t_account, 1, 3 ) = '706' )   "+
"                    and (    acc.t_type_account like '%П%'  or acc.t_type_account like '%U%' or acc.t_type_account like '%Н%' )                "+
"                    and t_client = 3045        "+
"                    and acc.t_code_currency = 0        "+
"                    and t_chapter=1    "+
"                    and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' )        "+
"              union    "+
"              select t_account         "+
"              from daccount_dbt acc    "+
"              where substr ( t_account, 1, 5 ) in ('40911', '40912', '40913')  "+
"                  and (    acc.t_type_account like '%П%'  or acc.t_type_account like '%U%' or acc.t_type_account like '%Н%' )          "+
"                  and acc.t_code_currency = 0          "+
"                  and t_chapter=1      "+
"             and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' )       "+
"        ) t1,  "+
"            dacctrn_dbt prov   "+
"       where t1.t_account = prov.t_account_payer       "+
"             and substr(prov.t_account_receiver,1,5) ='30102'  "+
"             and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )   "+
"                                       and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )    "+
"             and prov.t_chapter=1      ";

      end;
                return query;
  end;
  //debugbreak;               
  data = TRsbDataset(createQuery_3_4_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__3_4_1__4", data.value(0));
        ReportData.set("Ф251__3_4_1__6", data.value(1));
  end;          
               
  data = TRsbDataset(createQuery_3_4_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__3_4_1__3", data.value(0));
        ReportData.set("Ф251__3_4_1__5", data.value(1));
  end;          

end; //line_3_4_1 ()


/* Расчет строки арифметически */
/*
2.1.1 + 2.1.2 + 2.1.3 + 
2.1.4 + 2.2.1 + 2.2.2 + 
2.2.3 + 2.2.4 + 2.3.1 + 
2.3.2 + 2.3.3 + 2.3.4 + 
2.4   + 2.5   - 3.1   - 
3.2 - 3.4*/
macro line_3_3 ()
        var val_3_3__3, val_3_3__4, val_3_3__5, val_3_3__6;

        //debugbreak;
        val_3_3__3 = double(ReportData.GetValue("Ф251__2_1_1__3")) + double(ReportData.GetValue("Ф251__2_1_2__3")) +double(ReportData.GetValue("Ф251__2_1_3__3")) +
                double(ReportData.GetValue("Ф251__2_1_4__3"))+double(ReportData.GetValue("Ф251__2_1_5__3"))+double(ReportData.GetValue("Ф251__2_1_6__3"))+
                double(ReportData.GetValue("Ф251__2_2_1__3"))+double(ReportData.GetValue("Ф251__2_2_2__3"))+double(ReportData.GetValue("Ф251__2_2_3__3"))+
                double(ReportData.GetValue("Ф251__2_2_4__3"))+double(ReportData.GetValue("Ф251__2_2_5__3"))+double(ReportData.GetValue("Ф251__2_2_6__3"))+
                double(ReportData.GetValue("Ф251__2_3_1__3"))+/*double(ReportData.GetValue("Ф251__2_3_2__3"))+*/double(ReportData.GetValue("Ф251__2_3_3__3"))+
                double(ReportData.GetValue("Ф251__2_3_4__3"))+double(ReportData.GetValue("Ф251__2_3_5__3"))+double(ReportData.GetValue("Ф251__2_3_6__3"))+
                double(ReportData.GetValue("Ф251__2_4__3"))-double(ReportData.GetValue("Ф251__3_1__3"))-/*double(ReportData.GetValue("Ф251__3_2__3"))-*/
                double(ReportData.GetValue("Ф251__3_4__3"))-double(ReportData.GetValue("Ф251__2_4_1_2_1__3"))-double(ReportData.GetValue("Ф251__2_4_2_2_1__3"));

        val_3_3__4 = double(ReportData.GetValue("Ф251__2_1_1__4")) + double(ReportData.GetValue("Ф251__2_1_2__4")) +double(ReportData.GetValue("Ф251__2_1_3__4")) +
                double(ReportData.GetValue("Ф251__2_1_4__4"))+double(ReportData.GetValue("Ф251__2_1_5__4"))+double(ReportData.GetValue("Ф251__2_1_6__4"))+
                double(ReportData.GetValue("Ф251__2_2_1__4"))+double(ReportData.GetValue("Ф251__2_2_2__4"))+double(ReportData.GetValue("Ф251__2_2_3__4"))+
                double(ReportData.GetValue("Ф251__2_2_4__4"))+double(ReportData.GetValue("Ф251__2_2_5__4"))+double(ReportData.GetValue("Ф251__2_2_6__4"))+
                double(ReportData.GetValue("Ф251__2_3_1__4"))+/*double(ReportData.GetValue("Ф251__2_3_2__4"))+*/double(ReportData.GetValue("Ф251__2_3_3__4"))+
                double(ReportData.GetValue("Ф251__2_3_4__4"))+double(ReportData.GetValue("Ф251__2_3_5__4"))+double(ReportData.GetValue("Ф251__2_3_6__4"))+
                double(ReportData.GetValue("Ф251__2_4__4"))-double(ReportData.GetValue("Ф251__3_1__4"))-/*double(ReportData.GetValue("Ф251__3_2__4"))-*/
                double(ReportData.GetValue("Ф251__3_4__4"))-double(ReportData.GetValue("Ф251__2_4_1_2_1__4"))-double(ReportData.GetValue("Ф251__2_4_2_2_1__4"));

        val_3_3__5 = double(ReportData.GetValue("Ф251__2_1_1__5")) + double(ReportData.GetValue("Ф251__2_1_2__5")) +double(ReportData.GetValue("Ф251__2_1_3__5")) +
                double(ReportData.GetValue("Ф251__2_1_4__5"))+double(ReportData.GetValue("Ф251__2_1_5__5"))+double(ReportData.GetValue("Ф251__2_1_6__5"))+
                double(ReportData.GetValue("Ф251__2_2_1__5"))+double(ReportData.GetValue("Ф251__2_2_2__5"))+double(ReportData.GetValue("Ф251__2_2_3__5"))+
                double(ReportData.GetValue("Ф251__2_2_4__5"))+double(ReportData.GetValue("Ф251__2_2_5__5"))+double(ReportData.GetValue("Ф251__2_2_6__5"))+
                double(ReportData.GetValue("Ф251__2_3_1__5"))+/*double(ReportData.GetValue("Ф251__2_3_2__5"))+*/double(ReportData.GetValue("Ф251__2_3_3__5"))+
                double(ReportData.GetValue("Ф251__2_3_4__5"))+double(ReportData.GetValue("Ф251__2_3_5__5"))+double(ReportData.GetValue("Ф251__2_3_6__5"))+
                double(ReportData.GetValue("Ф251__2_4__5"))-double(ReportData.GetValue("Ф251__3_1__5"))-/*double(ReportData.GetValue("Ф251__3_2__5"))-     */
                double(ReportData.GetValue("Ф251__3_4__5"))-double(ReportData.GetValue("Ф251__2_4_1_2_1__5"))-double(ReportData.GetValue("Ф251__2_4_2_2_1__5"));

        val_3_3__6 = double(ReportData.GetValue("Ф251__2_1_1__6")) + double(ReportData.GetValue("Ф251__2_1_2__6")) +double(ReportData.GetValue("Ф251__2_1_3__6")) +
                double(ReportData.GetValue("Ф251__2_1_4__6"))+double(ReportData.GetValue("Ф251__2_1_5__6"))+double(ReportData.GetValue("Ф251__2_1_6__6"))+
                double(ReportData.GetValue("Ф251__2_2_1__6"))+double(ReportData.GetValue("Ф251__2_2_2__6"))+double(ReportData.GetValue("Ф251__2_2_3__6"))+
                double(ReportData.GetValue("Ф251__2_2_4__6"))+double(ReportData.GetValue("Ф251__2_2_5__6"))+double(ReportData.GetValue("Ф251__2_2_6__6"))+
                double(ReportData.GetValue("Ф251__2_3_1__6"))+/*double(ReportData.GetValue("Ф251__2_3_2__6"))+*/double(ReportData.GetValue("Ф251__2_3_3__6"))+
                double(ReportData.GetValue("Ф251__2_3_4__6"))+double(ReportData.GetValue("Ф251__2_3_5__6"))+double(ReportData.GetValue("Ф251__2_3_6__6"))+
                double(ReportData.GetValue("Ф251__2_4__6"))-double(ReportData.GetValue("Ф251__3_1__6"))-/*double(ReportData.GetValue("Ф251__3_2__6")) -*/
                double(ReportData.GetValue("Ф251__3_4__6"))-double(ReportData.GetValue("Ф251__2_4_1_2_1__6"))-double(ReportData.GetValue("Ф251__2_4_2_2_1__6"));

        ReportData.set("Ф251__3_3__3", val_3_3__3);
        ReportData.set("Ф251__3_3__4", val_3_3__4);
        ReportData.set("Ф251__3_3__5", val_3_3__5);
        ReportData.set("Ф251__3_3__6", val_3_3__6);
end;

/* Расчет строки арифметически */ 
/*
2.1.1.1 + 2.2.1.1 - 3.1.1 - 
3.2.1   - 3.4.1*/
macro line_3_3_1 ()
        var val_3_3_1__3, val_3_3_1__4, val_3_3_1__5, val_3_3_1__6;
        val_3_3_1__3 =   double(ReportData.GetValue("Ф251__2_1_1_1__3")) + double(ReportData.GetValue("Ф251__2_2_1_1__3")) -     double(ReportData.GetValue("Ф251__3_1_1__3")) - 
                                                                 /*double(ReportData.GetValue("Ф251__3_2_1__3"))         -*/ double(ReportData.GetValue("Ф251__3_4_1__3"));

        val_3_3_1__4 = double(ReportData.GetValue("Ф251__2_1_1_1__4")) + double(ReportData.GetValue("Ф251__2_2_1_1__4")) - double(ReportData.GetValue("Ф251__3_1_1__4")) -
                                                                 /*double(ReportData.GetValue("Ф251__3_2_1__4"))   - */double(ReportData.GetValue("Ф251__3_4_1__4"));

        val_3_3_1__5 = double(ReportData.GetValue("Ф251__2_1_1_1__5")) + double(ReportData.GetValue("Ф251__2_2_1_1__5")) - double(ReportData.GetValue("Ф251__3_1_1__5")) -
                                                                 /*double(ReportData.GetValue("Ф251__3_2_1__5"))   - */double(ReportData.GetValue("Ф251__3_4_1__5"));

        val_3_3_1__6 = double(ReportData.GetValue("Ф251__2_1_1_1__6")) + double(ReportData.GetValue("Ф251__2_2_1_1__6")) - double(ReportData.GetValue("Ф251__3_1_1__6")) -
                                                                 /*double(ReportData.GetValue("Ф251__3_2_1__6"))   - */double(ReportData.GetValue("Ф251__3_4_1__6"));


        ReportData.set("Ф251__3_3_1__3", val_3_3_1__3);
        ReportData.set("Ф251__3_3_1__4", val_3_3_1__4);
        ReportData.set("Ф251__3_3_1__5", val_3_3_1__5);
        ReportData.set("Ф251__3_3_1__6", val_3_3_1__6);
end;









        


macro line_4_1 ()
//debugbreak;
        var data;
        macro createQuery_4_1 (currency): string
                        var query;
      if (currency == "Rub")
        query=s4_1_rub;
      else          
        query=s4_1_val;

      end;
                return query;
  end;
                 
  data = TRsbDataset(createQuery_4_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__4_1__4", data.value(0));
        ReportData.set("Ф251__4_1__6", data.value(1));
  end;          
               
  data = TRsbDataset(createQuery_4_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__4_1__3", data.value(0));
        ReportData.set("Ф251__4_1__5", data.value(1));
  end;          

end; //line_4_1 ()






macro line_4_1_1 ()
//debugbreak;
        var data;
        macro createQuery_4_1_1 (currency): string
        var query;
              if (currency == "Rub")
                query=s4_1_1_rub;
              else          
                query=s4_1_1_val;
              end;
        return query;
        end;
                 
  data = TRsbDataset(createQuery_4_1_1("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__4_1_1__4", data.value(0));
        ReportData.set("Ф251__4_1_1__6", data.value(1));
  end;          
               
  data = TRsbDataset(createQuery_4_1_1("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__4_1_1__3", data.value(0));
        ReportData.set("Ф251__4_1_1__5", data.value(1));
  end;          
end; //line_4_1_1 ()

macro line_4_1_3 ()
//debugbreak;
        var data;
        macro createQuery_4_1_3 (currency): string
        var query;
              if (currency == "Rub")
                query=s4_1_3_rub;
              else          
                query=s4_1_3_val;
              end;
        return query;
        end;
                 
  data = TRsbDataset(createQuery_4_1_3("Cur"));
  if (data.movenext)
        ReportData.set("Ф251__4_1_3__4", data.value(0));
        ReportData.set("Ф251__4_1_3__6", data.value(1));
  end;          
               
  data = TRsbDataset(createQuery_4_1_3("Rub"));
  if (data.movenext)
        ReportData.set("Ф251__4_1_3__3", data.value(0));
        ReportData.set("Ф251__4_1_3__5", data.value(1));
  end;          
end; //line_4_1_3 ()




/*
macro EvProc (rsrec, cmd, id, key)
    if(( cmd == DLG_KEY ) and ( key == 13 ))
      return CM_SELECT;
    end;
end;
     */
 /*Обработчик диалоговой панели ввода исходных данных для печати*/
MACRO Event (dlg, cmd, id, key) 

   var const_mess = " ~F3~ Выбор значения из списка ~F2~ Продолжить ~ESC~ Выход ",
   SQLQuery, SQLQuery1, rsrec, cmd1;

   /*Первоначальная инициализация полей*/
   if(cmd == DLG_INIT)
      var m_den:integer = 0, m_mes:integer = 0, m_god:integer = 0;
      DateSplit({curDate}, m_den, m_mes, m_god);
      if        ((m_mes >= 4) and (m_mes <= 6)) 
        dlg.rec.BeginDate = date(1,1,m_god);
        dlg.rec.EndDate = date(31,3,m_god);
      elif ((m_mes >= 7) and (m_mes <= 9))
        dlg.rec.BeginDate = date(1,4,m_god);
        dlg.rec.EndDate = date(30,6,m_god);
      elif ((m_mes >= 10) and (m_mes <= 12))
        dlg.rec.BeginDate = date(1,9,m_god);
        dlg.rec.EndDate = date(31,12,m_god);
      elif ((m_mes >= 1) and (m_mes <= 3))
        dlg.rec.BeginDate = date(1,9,m_god-1);
        dlg.rec.EndDate = date(31,12,m_god-1);
      else
        dlg.rec.BeginDate = {curDate};
        dlg.rec.EndDate = {curDate};
      end;

      BeginDate  = dlg.rec.BeginDate;
      EndDate  = dlg.rec.EndDate;
      UpdateFields(dlg); 
   end;
   
   /*Установка подсказок в строке состояния*/
   if (cmd==DLG_SETFOCUS)
       message(const_mess);
   end;
   
   if (cmd == DLG_REMFOCUS)
     /*Проверка корректности дат отчета*/
      UpdateFields(dlg); 
   end;

   if (cmd == DLG_KEY)
     /*Выход из диалогового окна формирования отчета*/
     if (KEY == KEY_ESC)
       return exit(1);//CM_CANCEL;
     elif (KEY == KEY_ENTER)
       return CM_IGNORE;
     /*Выбор данных из списка*/
     elif ( KEY == KEY_F3)
        if (FldName(dlg,id) == "BeginDate")
          dlg.rec.BeginDate = GetDateByCalendar ({curDate}-1);
        end;
        if (FldName(dlg,id) == "EndDate")
          dlg.rec.EndDate = GetDateByCalendar ({curDate}-1);
        end;
     elif (( KEY == KEY_F2 ) )         //Проверки при вводе
        if ( dlg.rec.BeginDate > dlg.rec.EndDate )
                MsgBox("Дата начала периода должна быть меньше даты окончания");
                return CM_IGNORE;
        end;
/*        if (GetTrue(TRUE,"Сейчас будет выполнено проставление забалансовых символов. Вы уверены?"))
           BeginDate  = dlg.rec.BeginDate;
           EndDate  = dlg.rec.EndDate;
           Return CM_SAVE;
        else
          return  CM_IGNORE;    
        end;    */

        BeginDate  = dlg.rec.BeginDate;
        EndDate  = dlg.rec.EndDate;
        Return CM_SAVE;
     end;
      else
           Return CM_IGNORE;
   end;
        
END;

macro printReport()
   [                                                                                                                  БАНКОВСКАЯ ОТЧЕТНОСТЬ];
   [                                                                   ┌──────────┬───────────────────────────────────────────────────────┐];
   [                                                                   │Код терри-│Код кредитной организации (филиала)                    │];
   [                                                                   │тории     ├──────────┬───────────────┬───────────────┬────────────┤];
   [                                                                   │по ОКАТО  │ по ОКПО  │   основной    │регистрационный│    БИК     │];
   [                                                                   │          │          │государственный│     номер     │            │];
   [                                                                   │          │          │регистрационный│(/порядковый   │            │];
   [                                                                   │          │          │    номер      │   номер)      │            │];
   [                                                                   ├──────────┼──────────┼───────────────┼───────────────┼────────────┤];  
//   [                                                                   │##########│##########│###############│###############│############│]
//                                                                       ( Код_СОАТО:c, Код_ОКПО:c, ОГРН:c,   РегНомерБанка:c, {MFO_Bank}:c);
   [                                                                   └──────────┴──────────┴───────────────┴───────────────┴────────────┘];
   [ ];
   [                     СВЕДЕНИЯ О СЧЕТАХ КЛИЕНТОВ И ПЛАТЕЖАХ, ПРОВЕДЕННЫХ ЧЕРЕЗ КРЕДИТНУЮ ОРГАНТИЗАЦИЮ (ЕЁ ФИЛИАЛ)                       ];
   [ ];
   /* 24.08.2007 Malakhova 111238*/
//   [                                                                 # ](string("ЗА ",RcbDatePrintPeriod()):c);
   [ ];
   [Наименование кредитной организации (ее филиала)];
   [##############################################################################################################]( {Name_Bank}:l:w);
   [ ];
   [Почтовый адрес___# ]({Post_Addr}:l:w); 
   [ ];
   [                                                                                                                      Код формы 0409251];
   [                                                                                                                            Квартальная];
   [                                                                                                                              тыс. руб.];
   [┌──────────┬──────────────────────────────────────────────┬─────────────────────────────────────┬─────────────────────────────────────┐];
   [│ Номер    │ Наименование показателя                      │ Количество,  единиц                 │ Сумма,                              │];
   [│ строки   │                                              │                                     │ тыс. руб.                           │];
   [│          │                                              ├──────────────────┬──────────────────┼──────────────────┬──────────────────┤];
   [│          │                                              │ в валюте         │ в иностранной    │ в валюте         │ в иностранной    │];
   [│          │                                              │ Российской       │ валюте           │ Российской       │ валюте           │];
   [│          │                                              │ Федерации        │                  │ Федерации        │                  │];
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│    1     │                    2                         │        3         │        4         │         5        │        6         │];
   [└──────────┴──────────────────────────────────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┘]; 
   [          ];
   [ Раздел 1.];
   [          ];
   [┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐];
   [│ 1. Сведения о количестве счетов клиентов кредитной организации (ее филиала)                                                         │];
   [├──────────┬──────────────────────────────────────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────┤];
   [│          │ Счета, открытые клиентам - юридическим лицам,│ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__1_1__3") : r, printValue("Ф251__1_1__4") : r,printValue("Ф251__1_1__5") : r, printValue("Ф251__1_1__6") : r); 
   [│          │ не являющимся кредитными организациями,      │                  │                  │                  │                  │];
   [│ 1.1      │ и индивидуальным предпринимателям, которые   │                  │                  │                  │                  │];
   [│          │ могут использоваться для проведения платежей,│                  │                  │                  │                  │];
   [│          │ всего                                        │                  │                  │                  │                  │]; 
   [│          │ Из них:                                      │                  │                  │                  │                  │];
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 1.1.1    │ Счета, по которым с начала отчетного года    │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__1_1_1__3") : r, printValue("Ф251__1_1_1__4") : r, printValue("Ф251__1_1_1__5") : r, printValue("Ф251__1_1_1__6") : r);
   [│          │ проводились операции по списанию денежных    │                  │                  │                  │                  │];
   [│          │ средств                                      │                  │                  │                  │                  │];
   [│          │ Из них:                                      │                  │                  │                  │                  │];                                             
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 1.1.1.1  │ Доступ к которым предоставлен дистанционным  │ ################ │ ################ │  X               │ X                │](printValue("Ф251__1_1_1_1__3") : r, printValue("Ф251__1_1_1_1__4") : r);
   [│          │ способом                                     │                  │                  │                  │                  │];
   [│          │ Из них:                                      │                  │                  │                  │                  │];                                             
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 1.1.1.1.1│ Доступ к которым предоставлен через сеть     │ ################ │ ################ │  X               │ X                │](printValue("Ф251__1_1_1_1_1__3") : r, printValue("Ф251__1_1_1_1_1__4") : r);
   [│          │ Интернет                                     │                  │                  │                  │                  │];                                             
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 1.2      │ Счета, открытые клиентам-физическим лицам на │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__1_2__3") : r, printValue("Ф251__1_2__4") : r, printValue("Ф251__1_2__5") : r, printValue("Ф251__1_2__6") : r);
   [│          │ основании договора банковского счета и       │                  │                  │                  │                  │];
   [│          │ договора банковского вклада, которые могут   │                  │                  │                  │                  │];
   [│          │ использоваться для проведения платежей, всего│                  │                  │                  │                  │];
   [│          │ Из них:                                      │                  │                  │                  │                  │]; 
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 1.2.1    │ Счета, открытые на основании договора        │ ################ │ ################ │  X               │ X                │](printValue("Ф251__1_2_1__3") : r, printValue("Ф251__1_2_1__4") : r);
   [│          │ банковского счета                            │                  │                  │                  │                  │];
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 1.2.2    │ Счета, по которым с начала отчетного года    │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__1_2_2__3") : r, printValue("Ф251__1_2_2__4") : r, printValue("Ф251__1_2_2__5") : r, printValue("Ф251__1_2_2__6") : r);
   [│          │ проводились операции по списанию денежных    │                  │                  │                  │                  │];                                             
   [│          │ средств                                      │                  │                  │                  │                  │];                                             
   [│          │ Из них:                                      │                  │                  │                  │                  │];                                             
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 1.2.2.1  │ Доступ к которым предоставлен дистанционным  │ ################ │ ################ │  X               │ X                │](printValue("Ф251__1_2_2_1__3") : r, printValue("Ф251__1_2_2_1__4") : r);
   [│          │ способом                                     │                  │                  │                  │                  │];                                             
   [│          │ Из них:                                      │                  │                  │                  │                  │];                                             
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 1.2.2.1.1│ Доступ к которым предоставлен через сеть     │ ################ │ ################ │  X               │ X                │](printValue("Ф251__1_2_2_1_1__3") : r, printValue("Ф251__1_2_2_1_1__4") : r);
   [│          │ Интернет                                     │                  │                  │                  │                  │];                                             
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 1.2.2.1.2│ Доступ к которым предоставлен с              │ ################ │ ################ │  X               │ X                │](printValue("Ф251__1_2_2_1_2__3") : r, printValue("Ф251__1_2_2_1_2__4") : r);
   [│          │ использованием мобильных телефонов           │                  │                  │                  │                  │];                                             
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 1.3      │ Корреспондентские счета, счета участников    │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__1_3__3") : r, printValue("Ф251__1_3__4") : r,printValue("Ф251__1_3__5") : r, printValue("Ф251__1_3__6") : r);
   [│          │ расчетов,  открытые кредитным организациям   │                  │                  │                  │                  │];                                             
   [│          │ (их филиалам)                                │                  │                  │                  │                  │];                                             
   [└──────────┴──────────────────────────────────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┘]; 
   [          ];
   [ Раздел 2.];
   [          ];
   [┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐];
   [│ 2.1. Сведения о платежах клиентов - юридических лиц, не являющихся кредитными организациями,  с использованием:                     │];
   [├──────────┬──────────────────────────────────────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────┤];
   [│ 2.1.1    │ Платежных поручений                          │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_1_1__3") : r, printValue("Ф251__2_1_1__4") : r, printValue("Ф251__2_1_1__5") : r, printValue("Ф251__2_1_1__6") : r);
   [│          │ Из них:                                      │                  │                  │                  │                  │];                                             
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.1.1.1  │ Представленных в кредитную организацию       │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_1_1_1__3") : r, printValue("Ф251__2_1_1_1__4") : r, printValue("Ф251__2_1_1_1__5") : r, printValue("Ф251__2_1_1_1__6") : r);
   [│          │ электронно                                   │                  │                  │                  │                  │];                                             
   [│          │ Из них:                                      │                  │                  │                  │                  │];                                             
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.1.1.1.1│ Через сеть Интернет                          │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_1_1_1_1__3") : r, printValue("Ф251__2_1_1_1_1__4") : r, printValue("Ф251__2_1_1_1_1__5") : r, printValue("Ф251__2_1_1_1_1__6") : r);
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.1.2    │ Аккредитивов                                 │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_1_2__3") : r, printValue("Ф251__2_1_2__4") : r, printValue("Ф251__2_1_2__5") : r, printValue("Ф251__2_1_2__6") : r);
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.1.3    │ Платежных требований                         │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_1_3__3") : r, printValue("Ф251__2_1_3__4") : r, printValue("Ф251__2_1_3__5") : r, printValue("Ф251__2_1_3__6") : r);
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.1.4    │ Инкассовых поручений                         │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_1_4__3") : r, printValue("Ф251__2_1_4__4") : r, printValue("Ф251__2_1_4__5") : r, printValue("Ф251__2_1_4__6") : r);
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.1.5    │ Чеков                                        │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_1_5__3") : r, printValue("Ф251__2_1_5__4") : r, printValue("Ф251__2_1_5__5") : r, printValue("Ф251__2_1_5__6") : r);
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.1.6    │ Банковских ордеров - всего, из них:          │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_1_6__3") : r, printValue("Ф251__2_1_6__4") : r, printValue("Ф251__2_1_6__5") : r, printValue("Ф251__2_1_6__6") : r);
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.1.6.1  │ в целях уплаты процентов и комиссий          │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_1_6_1__3") : r, printValue("Ф251__2_1_6_1__4") : r, printValue("Ф251__2_1_6_1__5") : r, printValue("Ф251__2_1_6_1__6") : r);
   [├──────────┴──────────────────────────────────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┤];
   [│ 2.2. Сведения о платежах клиентов - физических лиц, с использованием:                                                               │];
   [├──────────┬──────────────────────────────────────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────┤];
   [│ 2.2.1    │ Платежных поручений                          │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_2_1__3") : r, printValue("Ф251__2_2_1__4") : r, printValue("Ф251__2_2_1__5" ) : r, printValue("Ф251__2_2_1__6") : r);
   [│          │ Из них:                                      │                  │                  │                  │                  │];                                             
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.2.1.1  │ Представленных в кредитную организацию       │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_2_1_1__3" ) : r, printValue("Ф251__2_2_1_1__4") : r, printValue("Ф251__2_2_1_1__5") : r, printValue("Ф251__2_2_1_1__6") : r);
   [│          │ электронно                                   │                  │                  │                  │                  │];                                             
   [│          │ Из них:                                      │                  │                  │                  │                  │];                                             
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.2.1.1.1│ Через сеть Интернет                          │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_2_1_1__3") : r, printValue("Ф251__2_2_1_1_1__4") : r, printValue("Ф251__2_2_1_1_1__5") : r, printValue("Ф251__2_2_1_1_1__6") : r);
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.2.1.1.2│ С использованием мобильныых телефонов        │                  │                  │                  │                  │];//(printValue("Ф251__2_2_1_1_2__3") : r, printValue("Ф251__2_2_1_1_2__4") : r, printValue("Ф251__2_2_1_1_2__5") : r, printValue("Ф251__2_2_1_1_2__6") : r);
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.2.2    │ Аккредитивов                                 │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_2_2__3") : r, printValue("Ф251__2_2_2__4") : r, printValue("Ф251__2_2_2__5") : r, printValue("Ф251__2_2_2__6") : r);
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.2.3    │ Платежных требований                         │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_2_3__3") : r, printValue("Ф251__2_2_3__4") : r, printValue("Ф251__2_2_3__5") : r, printValue("Ф251__2_2_3__6") : r);
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.2.4    │ Инкассовых поручений                         │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_2_4__3") : r, printValue("Ф251__2_2_4__4") : r, printValue("Ф251__2_2_4__5") : r, printValue("Ф251__2_2_4__6") : r);
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.2.5    │ Чеков                                        │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_2_5__3") : r, printValue("Ф251__2_2_5__4") : r, printValue("Ф251__2_2_5__5") : r, printValue("Ф251__2_2_5__6") : r);
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.2.6    │ Банковских ордеров - всего, из них:          │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_2_6__3") : r, printValue("Ф251__2_2_6__4") : r, printValue("Ф251__2_2_6__5") : r, printValue("Ф251__2_2_6__6") : r);
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.2.6.1  │ в целях уплаты процентов и комиссий          │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_2_6_1__3") : r, printValue("Ф251__2_2_6_1__4") : r, printValue("Ф251__2_2_6_1__5") : r, printValue("Ф251__2_2_6_1__6") : r);
   [├──────────┴──────────────────────────────────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┤];
   [│ 2.3. Сведения о платежах самой кредитной организации (ее филиала),  с использованием:                                               │];
   [├──────────┬──────────────────────────────────────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────┤];
   [│ 2.3.1    │ Платежных поручений                          │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_3_1__3") : r, printValue("Ф251__2_3_1__4") : r, printValue("Ф251__2_3_1__5") : r, printValue("Ф251__2_3_1__6") : r);
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.3.2    │ Аккредитивов                                 │                  │                  │                  │                  │];//(printValue("Ф251__2_3_2__3") : r, printValue("Ф251__2_3_2__4") : r, printValue("Ф251__2_3_2__5") : r, printValue("Ф251__2_3_2__6") : r);
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.3.3    │ Платежных требований                         │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_3_3__3") : r, printValue("Ф251__2_3_3__4") : r, printValue("Ф251__2_3_3__5") : r, printValue("Ф251__2_3_3__6") : r);
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.3.4    │ Инкассовых поручений                         │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_3_4__3") : r, printValue("Ф251__2_3_4__4") : r, printValue("Ф251__2_3_4__5") : r, printValue("Ф251__2_3_4__6") : r);
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.3.5    │ Чеков                                        │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_3_5__3") : r, printValue("Ф251__2_3_5__4") : r, printValue("Ф251__2_3_5__5") : r, printValue("Ф251__2_3_5__6") : r);
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.3.6    │ Банковских ордеров                           │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_3_6__3") : r, printValue("Ф251__2_3_6__4") : r, printValue("Ф251__2_3_6__5") : r, printValue("Ф251__2_3_6__6") : r);
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.4      │ Сведения о переводах  физических лиц без     │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_4__3") : r, printValue("Ф251__2_4__4") : r, printValue("Ф251__2_4__5") : r, printValue("Ф251__2_4__6") : r);
   [│          │ открытия банковского счета, всего, в том     │                  │                  │                  │                  │];                                             
   [│          │ числе проведенных:                           │                  │                  │                  │                  │];                                             
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.4.1    │ Через системы денежных переводов из них:     │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_4_1__3") : r, printValue("Ф251__2_4_1__4") : r, printValue("Ф251__2_4_1__5") : r, printValue("Ф251__2_4_1__6") : r);
   [│          │                                              │                  │                  │                  │                  │];                                             
   [│          │                                              │                  │                  │                  │                  │];                                             
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.4.1.1  │ осуществленные в пределах Российской         │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_4_1_1__3") : r, printValue("Ф251__2_4_1_1__4") : r, printValue("Ф251__2_4_1_1__5") : r, printValue("Ф251__2_4_1_1__6") : r);
   [│          │                           Федерации          │                  │                  │                  │                  │];                                             
   [│          │                                              │                  │                  │                  │                  │];                                             
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.4.1.2  │ в пользу юридических лич, из них:            │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_4_1_2__3") : r, printValue("Ф251__2_4_1_2__4") : r, printValue("Ф251__2_4_1_2__5") : r, printValue("Ф251__2_4_1_2__6") : r);
   [│          │                                              │                  │                  │                  │                  │];                                             
   [│          │                                              │                  │                  │                  │                  │];                                             
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.4.1.2.1│ в погашение кредитов                         │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_4_1_2_1__3") : r, printValue("Ф251__2_4_1_2_1__4") : r, printValue("Ф251__2_4_1_2_1__5") : r, printValue("Ф251__2_4_1_2_1__6") : r);
   [│          │                                              │                  │                  │                  │                  │];                                             
   [│          │                                              │                  │                  │                  │                  │];                                             
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.4.2    │ без использования систем денежных переоводов,│ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_4_2__3") : r, printValue("Ф251__2_4_2__4") : r, printValue("Ф251__2_4_2__5") : r, printValue("Ф251__2_4_2__6") : r);
   [│          │ из них:                                      │                  │                  │                  │                  │];                                             
   [│          │                                              │                  │                  │                  │                  │];                                             
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.4.2.1  │ осуществленные в пределах Российской         │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_4_2_1__3") : r, printValue("Ф251__2_4_2_1__4") : r, printValue("Ф251__2_4_2_1__5") : r, printValue("Ф251__2_4_2_1__6") : r);
   [│          │                           Федерации          │                  │                  │                  │                  │];                                             
   [│          │                                              │                  │                  │                  │                  │];                                             
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.4.2.2  │ в пользу юридических лиц, из них:            │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_4_2_2__3") : r, printValue("Ф251__2_4_2_2__4") : r, printValue("Ф251__2_4_2_2__5") : r, printValue("Ф251__2_4_2_2__6") : r);
   [│          │                                              │                  │                  │                  │                  │];                                             
   [│          │                                              │                  │                  │                  │                  │];                                             
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 2.4.2.2.1│ в погашение кредитов                         │                  │                  │                  │                  │];
   [│          │                                              │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_4_2_2_1__3") : r, printValue("Ф251__2_4_2_2_1__4") : r, printValue("Ф251__2_4_2_2_1__5") : r, printValue("Ф251__2_4_2_2_1__6") : r);
   [│          │                                              │                  │                  │                  │                  │];                                             
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ справочно│ Платежи юридических лиц в рамках             │ ################ │  X               │ ################ │  X               │](printValue("Ф251__2_spr_kolwo") : r, printValue("Ф251__2_spr_summa") : r);
   [│          │ выполнения ими функций платежного агента     │                  │                  │                  │                  │];                                             
   [│          │ (банковского платежного агента)              │                  │                  │                  │                  │];                                             
// [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
// [│ 2.5      │ Платежи с использованием банковских          │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_5__3") : r, printValue("Ф251__2_5__4") : r, printValue("Ф251__2_5__5") : r, printValue("Ф251__2_5__6") : r);
// [│          │ ордеров, всего, из них:                      │                  │                  │                  │                  │];                                             
// [└──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤]; 
// [│ 2.5.1    │ по уплате (списанию) процентов по привлечен- │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__2_5_1__3") : r, printValue("Ф251__2_5_1__4") : r, printValue("Ф251__2_5_1__5") : r, printValue("Ф251__2_5_1__6") : r);
// [│          │ным и размещенным денежным средствам, комиссии│                  │                  │                  │                  │];                                             
   [└──────────┴──────────────────────────────────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┘]; 
   [          ];
   [ Раздел 3.];
   [          ];
   [┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐];
   [│ 3. Сведения о платежах проведенных                                                                                                  │];
   [├──────────┬──────────────────────────────────────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────┤];
   [│ 3.1      │ Через корреспондентские счета кредитных      │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__3_1__3" ) : r, printValue("Ф251__3_1__4") : r, printValue("Ф251__3_1__5") : r, printValue("Ф251__3_1__6") : r);
   [│          │ организаций (их филиалов), кроме открытых в  │                  │                  │                  │                  │];
   [│          │ Банке России, и счета участников расчетов    │                  │                  │                  │                  │];
   [│          │ в расчетных небанковских кредитных           │                  │                  │                  │                  │];
   [│          │ организациях, всего. Из них:                 │                  │                  │                  │                  │];
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 3.1.1    │ Электронным пособом                          │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__3_1_1__3") : r, printValue("Ф251__3_1_1__4") : r, printValue("Ф251__3_1_1__5") : r, printValue("Ф251__3_1_1__6") : r);
   [│          │                                              │                  │                  │                  │                  │];
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 3.2      │ Через счета межфилиальны расчетов, всего     │                  │                  │                  │                  │];//(printValue("Ф251__3_2__3") : r, printValue("Ф251__3_2__4") : r, printValue("Ф251__3_2__5") : r, printValue("Ф251__3_2__6") : r);
   [│          │ из них:                                      │                  │                  │                  │                  │];
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 3.2.1    │ Электронным пособом                          │                  │                  │                  │                  │];//(printValue("Ф251__3_2_1__3") : r, printValue("Ф251__3_2_1__4") : r, printValue("Ф251__3_2_1__5") : r, printValue("Ф251__3_2_1__6") : r);
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 3.3      │ В пределах одного подразделения кредитной    │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__3_3__3") : r, printValue("Ф251__3_3__4") : r, printValue("Ф251__3_3__5") : r, printValue("Ф251__3_3__6") : r);
   [│          │ организации, всего, из них                   │                  │                  │                  │                  │];
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 3.3.1    │ Электронным способом                         │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__3_3_1__3") : r, printValue("Ф251__3_3_1__4") : r, printValue("Ф251__3_3_1__5") : r, printValue("Ф251__3_3_1__6") : r);
   [│          │                                              │                  │                  │                  │                  │];
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 3.4      │ Через платежную систему Банка России, из них:│ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__3_4__3") : r, printValue("Ф251__3_4__4") : r, printValue("Ф251__3_4__5") : r, printValue("Ф251__3_4__6") : r);
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 3.4.1    │ Электронным способом                         │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__3_4_1__3") : r, printValue("Ф251__3_4_1__4") : r, printValue("Ф251__3_4_1__5") : r, printValue("Ф251__3_4_1__6") : r);
   [│          │                                              │                  │                  │                  │                  │];
   [└──────────┴──────────────────────────────────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┘]; 
   [ Раздел 4.];
   [          ];
   [┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐];
   [│ 4. Сведения о межбанковских переводах и осуществлениях                                                                              │];
   [├──────────┬──────────────────────────────────────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────┤];
   [│ 4.1      │ Межбанковские переводы, проведенные          │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__4_1__3" ) : r, printValue("Ф251__4_1__4") : r, printValue("Ф251__4_1__5") : r, printValue("Ф251__4_1__6") : r);
   [│          │ кредитной организацией (ее филиалом)         │                  │                  │                  │                  │];
   [│          │ со счетов клиентов - кредитных организаций   │                  │                  │                  │                  │];
   [│          │ (филиалов),всего.                            │                  │                  │                  │                  │];
   [│          │ из них:                                      │                  │                  │                  │                  │];
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 4.1.1    │ на корреспондентские счета других кредитных  │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__4_1_1__3") : r, printValue("Ф251__4_1_1__4") : r, printValue("Ф251__4_1_1__5") : r, printValue("Ф251__4_1_1__6") : r);
   [│          │ организаций (филиалов), открытые в одном     │                  │                  │                  │                  │];
   [│          │ подразделении кредитной организации          │                  │                  │                  │                  │];
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
   [│ 4.1.2    │ на корреспондентские счета, открытые другим  │                  │                  │                  │                  │];
   [│          │ кредитным организациям (филиалам), через     │                  │                  │                  │                  │];
   [│          │ счета межфилиальных расчетов                 │                  │                  │                  │                  │];
   [├──────────┼──────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤]; 
   [│ 4.1.3    │ через платежную систему Банка России         │ ################ │ ################ │ ################ │ ################ │](printValue("Ф251__4_1_3__3") : r, printValue("Ф251__4_1_3__4") : r, printValue("Ф251__4_1_3__5") : r, printValue("Ф251__4_1_3__6") : r);
   [└──────────┴──────────────────────────────────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┘]; 
   [ ];
   /* 24.08.2007 Malakhova 111238*/
   [#                                    #]( {Name_Boss}:l, {FIO_Boss}:l );
   [#                                    #]( {Name_Book}:l, {FIO_Book}:l );
   [М.П.];
/*   [Исполнитель                          #](getExecutorName():l);
   [телефон:                             #](ТелефонИсполнителя:l );
  */ [#](trim(string({curdate}:m)));
end;


macro calculate()
   var query, data, query_count, datacount, branch_sql, first, iinsert;
                initprogress(49,"начало расчета","Идет расчет строк отчета");

   var qwas;
//qwas={selfid};
//getstring(qwas);

ttruncate = "TRUNCATE TABLE USR_251_c4eta; " ;
iinsert = rsdcommand(ttruncate);  
iinsert.execute;
ttruncate = "TRUNCATE TABLE USR_251_prov; " ;
iinsert = rsdcommand(ttruncate);  
iinsert.execute;
//ttruncate = "commit" ;     iinsert = rsdcommand(ttruncate);  iinsert.execute;

s1_1_dataopen=" "+
"             and ( ( acc.t_close_date > to_date ( '"+enddate+"', 'dd.mm.yyyy' )        "+
"                    and t_open_date <= to_date ( '"+enddate+"', 'dd.mm.yyyy' ) )       "+
"                  or ( acc.t_close_date = to_date ( '01.01.0001', 'dd.mm.yyyy' )       "+
"                      and t_open_date <= to_date ( '"+enddate+"', 'dd.mm.yyyy' ) ) )   ";

s1_1_c4eta_rub=" "+
"         FROM   daccount_dbt acc, daccblnc_dbt bal,dparty_dbt party LEFT JOIN dpersn_dbt persn ON (party.t_partyid = persn.t_personid) "+
"        WHERE   acc.t_account = bal.t_account and acc.t_chapter=bal.t_chapter  "+
"            AND substr(acc.t_account,1,3) BETWEEN '401' AND '408'      "+
"            AND bal.t_balance0 NOT IN ('40803', '40810', '40813', '40817', '40820')    "+
"            AND (acc.t_type_account NOT LIKE '%П%' AND acc.t_type_account NOT LIKE '%U%' AND acc.t_type_account NOT LIKE '%Н%')        "+
"            AND acc.t_client = party.t_partyid "+
"            AND ( (persn.t_isemployer = 'X' AND party.t_legalform = 2) OR (party.t_legalform = 1))     "+
"            AND acc.t_chapter = 1      "+
"            AND acc.t_code_currency = 0        ";

s1_1_c4eta_val=" "+
"         FROM   daccount_dbt acc, daccblnc_dbt bal,dparty_dbt party LEFT JOIN dpersn_dbt persn ON (party.t_partyid = persn.t_personid) "+
"        WHERE   acc.t_account = bal.t_account and acc.t_chapter=bal.t_chapter  "+
"            AND substr(acc.t_account,1,3) BETWEEN '401' AND '408'      "+
"            AND bal.t_balance0 NOT IN ('40803', '40810', '40813', '40817', '40820')    "+
"            AND (acc.t_type_account  LIKE '%П%' or acc.t_type_account  LIKE '%U%' or acc.t_type_account  LIKE '%Н%')   "+
"            AND acc.t_client = party.t_partyid "+
"            AND ( (persn.t_isemployer = 'X' AND party.t_legalform = 2) OR (party.t_legalform = 1))     "+
"            AND acc.t_chapter = 1      "+
"            AND acc.t_code_currency = 0        ";


s1_1_m_rub= "insert into usr_251_c4eta select 11, acc.t_account,1 "+s1_1_c4eta_rub+s1_1_dataopen;
vstavit_c4eta(s1_1_m_rub);
s1_1_m_rub="            "+
" select count ( 1 ), nvl(round(sum ( rsb_account.resta ( c4et, to_date ( '"+enddate+"', 'DD-MM-YYYY' ), 1, null ) ) / 1000),0) from usr_251_c4eta where stroka=11 and rubli=1"; //25.09.2014 R-456034-2 DPN

s1_1_1_rub="insert into usr_251_c4eta select 111, c4et,1  from usr_251_c4eta where stroka=11 and rubli=1 "+
"             and exists        "+
"                  (select 1    "+
"                   from dacctrn_dbt prov       "+
"                   where prov.t_account_payer = c4et   "+
"                         and prov.t_date_carry between to_date ( '01.01."+substr(string(begindate),7)+"', 'dd.mm.yyyy' )       "+
"                                              and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )     "+
"                         and prov.t_chapter = 1        "+
"                         and prov.t_fiid_payer = 0) ";
vstavit_c4eta(s1_1_1_rub);
s1_1_1_rub=" select count ( 1 ), nvl(round(sum ( rsb_account.resta ( c4et, to_date ( '"+enddate+"', 'DD-MM-YYYY' ), 1, null ) ) / 1000) ,0) from usr_251_c4eta where stroka=111 and rubli=1";   //25.09.2014 R-456034-2 DPN


s1_1_1_1_rub="insert into usr_251_c4eta select 1111, c4et,1 from usr_251_c4eta, daccount_dbt acc where c4et=acc.t_account and stroka=111 and rubli=1 "+
"             and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' )       and acc.t_chapter=1";
vstavit_c4eta(s1_1_1_1_rub);
s1_1_1_1_rub="select count ( 1 ), nvl(round(sum ( rsb_account.resta ( c4et, to_date ( '"+enddate+"', 'DD-MM-YYYY' ), 1, null ) ) / 1000),0) from usr_251_c4eta where stroka=1111 and rubli=1"; //25.09.2014 R-456034-2 DPN


s1_1_1_1_1_rub="insert into usr_251_c4eta select 11111, c4et,1 from usr_251_c4eta, daccount_dbt acc where c4et=acc.t_account and stroka=1111 and rubli=1"+
"             and (acc.t_usertypeaccount like '%Ё%'  )  and acc.t_chapter=1";
vstavit_c4eta(s1_1_1_1_1_rub);
s1_1_1_1_1_rub="select count ( 1 ), nvl(round(sum ( rsb_account.resta ( c4et, to_date ( '"+enddate+"', 'DD-MM-YYYY' ), 1, null ) ) / 1000),0) from usr_251_c4eta where stroka=11111 and rubli=1"; //25.09.2014 R-456034-2 DPN



s1_1_m_val= "insert into usr_251_c4eta select 11, acc.t_account,0 "+s1_1_c4eta_val+s1_1_dataopen;
vstavit_c4eta(s1_1_m_val);
s1_1_m_val=" select count ( 1 ), nvl(round(sum ( rsb_account.resta ( c4et, to_date ( '"+enddate+"', 'DD-MM-YYYY' ), 1, null ) ) / 1000),0) from usr_251_c4eta where stroka=11 and rubli=0"; //25.09.2014 R-456034-2 DPN

s1_1_1_val="insert into usr_251_c4eta select 111, c4et,0  from usr_251_c4eta where stroka=11 and rubli=0 "+
"             and exists        "+
"                  (select 1    "+
"                   from dacctrn_dbt prov       "+
"                   where prov.t_account_payer = c4et   "+
"                         and prov.t_date_carry between to_date ( '01.01."+substr(string(begindate),7)+"', 'dd.mm.yyyy' )       "+
"                                              and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )     "+
"                         and prov.t_chapter = 1        "+
"                         and prov.t_fiid_payer = 0) ";
vstavit_c4eta(s1_1_1_val);
s1_1_1_val=" select count ( 1 ), nvl(round(sum ( rsb_account.resta ( c4et, to_date ( '"+enddate+"', 'DD-MM-YYYY' ), 1, null ) ) / 1000),0) from usr_251_c4eta where stroka=111 and rubli=0"; //25.09.2014 R-456034-2 DPN


s1_1_1_1_val="insert into usr_251_c4eta select 1111, c4et,0 from usr_251_c4eta, daccount_dbt acc where c4et=acc.t_account and stroka=111 and rubli=0"+
"             and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' )       and acc.t_chapter=1";
vstavit_c4eta(s1_1_1_1_val);
s1_1_1_1_val="select count ( 1 ), nvl(round(sum ( rsb_account.resta ( c4et, to_date ( '"+enddate+"', 'DD-MM-YYYY' ), 1, null ) ) / 1000),0) from usr_251_c4eta where stroka=1111 and rubli=0"; //25.09.2014 R-456034-2 DPN


s1_1_1_1_1_val="insert into usr_251_c4eta select 11111, c4et,0 from usr_251_c4eta, daccount_dbt acc where c4et=acc.t_account and stroka=1111 and rubli=0"+
"             and (acc.t_usertypeaccount like '%Ё%'  )  and acc.t_chapter=1";
vstavit_c4eta(s1_1_1_1_1_val);
s1_1_1_1_1_val="select count ( 1 ), nvl(round(sum ( rsb_account.resta ( c4et, to_date ( '"+enddate+"', 'DD-MM-YYYY' ), 1, null ) ) / 1000),0) from usr_251_c4eta where stroka=11111 and rubli=0"; //25.09.2014 R-456034-2 DPN



s1_2_c4eta_m1=
"       /* Formatted on 30.06.2011 18:34:20 (QP5 v5.115.810.9015) disa */       "+
"         FROM   daccount_dbt acc, daccblnc_dbt bal1,dparty_dbt party LEFT JOIN dpersn_dbt ip ON (ip.t_personid = party.t_partyid)      "+
"        WHERE   acc.t_account = bal1.t_account "+
"            AND bal1.t_chapter = 1     "+
"            AND acc.t_chapter = 1      "+
"            AND acc.t_client = party.t_partyid ";

s1_2_c4eta_rub_=
"            AND (acc.t_type_account NOT LIKE '%П%' AND acc.t_type_account NOT LIKE '%U%' AND acc.t_type_account NOT LIKE '%Н%')        ";

s1_2_c4eta_val_=
"            AND (acc.t_type_account  LIKE '%П%' or acc.t_type_account  LIKE '%U%' or acc.t_type_account NOT LIKE '%Н%')        ";

s1_2_c4eta_m2=
"            AND ( (bal1.t_balance0 BETWEEN '42309' AND '42315' "+
"                OR bal1.t_balance0 BETWEEN '42609' AND '42615' "+
"                OR bal1.t_balance0 IN ('40803', '40810', '40811', '40813', '47603', '47605', '47608', '47609') "+
"                OR ( (bal1.t_balance0 = '40817' OR bal1.t_balance0 = '40820') ";

s1_2_c4eta_not_rest=" AND party.t_partyid <> 22291 ";

s1_2_c4eta_m3="))       "+
"              OR (bal1.t_balance0 IN ('40806', '40809', '40812', '40814', '40815', '40818', '40819')   "+
"              AND party.t_legalform = 2        "+
"              AND ip.t_isemployer <> 'X'))     "+
"       /*       берем физиков двумя частями: первая это просто счета на определенных балансовых и все. безо всяких признаков, там только откинем       "+
"              те счета, которые на балансовых 40817 или 40820 и с кодом клиента 22291 (пластиковые карты)      "+
"              вторая часть это физики на определенных счетах, берем как легалформ=2 и НЕ стоит признак ИП       */     ";

s1_2_dataopen=" "+
"                      AND acc.t_open_date <= TO_DATE ('"+enddate+"', 'dd.mm.yyyy')     "+
"                      AND (acc.t_close_date > TO_DATE ('"+enddate+"', 'dd.mm.yyyy') OR acc.t_close_date = TO_DATE ('01.01.0001', 'dd.mm.yyyy'))        ";


s1_2_c4eta_rub     =s1_2_c4eta_m1+s1_2_c4eta_rub_+s1_2_c4eta_m2+s1_2_c4eta_not_rest+s1_2_c4eta_m3;
s1_2_c4eta_rub_rest=s1_2_c4eta_m1+s1_2_c4eta_rub_+s1_2_c4eta_m2+s1_2_c4eta_m3;

s1_2_c4eta_val     =s1_2_c4eta_m1+s1_2_c4eta_val_+s1_2_c4eta_m2+s1_2_c4eta_not_rest+s1_2_c4eta_m3;
s1_2_c4eta_val_rest=s1_2_c4eta_m1+s1_2_c4eta_val_+s1_2_c4eta_m2+s1_2_c4eta_m3;


// 129- счета, 120 - остатки
s1_2_m_rub="insert into usr_251_c4eta select 129, acc.t_account,1 "+s1_2_c4eta_rub+s1_2_dataopen;
vstavit_c4eta(s1_2_m_rub);
s1_2_m_rub="insert into usr_251_c4eta select 120, acc.t_account,1 "+s1_2_c4eta_rub_rest+s1_2_dataopen;
vstavit_c4eta(s1_2_m_rub);
s1_2_m_rub="insert into usr_251_c4eta select 129, acc.t_account,0 "+s1_2_c4eta_val+s1_2_dataopen;
vstavit_c4eta(s1_2_m_rub);
s1_2_m_rub="insert into usr_251_c4eta select 120, acc.t_account,0 "+s1_2_c4eta_val_rest+s1_2_dataopen;
vstavit_c4eta(s1_2_m_rub);

s1_2_m_rub=" select count ( 1 ) from usr_251_c4eta where stroka=129 and rubli=1";
s1_2_m_rub_rest=" select nvl(round(sum ( rsb_account.resta ( c4et, to_date ( '"+enddate+"', 'DD-MM-YYYY' ), 1, null ) ) / 1000),0) from usr_251_c4eta where stroka=120 and rubli=1";
//s1_2_m_rub=" select count ( 1 ), nvl(round(sum ( rsb_account.resta ( c4et, to_date ( '"+enddate+"', 'DD-MM-YYYY' ), 1, null ) ) / 1000),0) from usr_251_c4eta where stroka=12 and rubli=1";
s1_2_m_val=" select count ( 1 ) from usr_251_c4eta where stroka=129 and rubli=0";
s1_2_m_val_rest=" select nvl(round(sum ( rsb_account.resta ( c4et, to_date ( '"+enddate+"', 'DD-MM-YYYY' ), 1, null ) ) / 1000),0) from usr_251_c4eta where stroka=120 and rubli=0";





s1_2_1_rub="insert into usr_251_c4eta select 121, c4et,1 from usr_251_c4eta, daccblnc_dbt bal,daccount_dbt acc "+
" where c4et=bal.t_account and c4et=acc.t_account and ( (bal.t_balance0 = '40817' OR bal.t_balance0 = '40820') AND acc.t_client <> 22291) "+
" and stroka=129 and rubli=1 and bal.t_chapter=acc.t_chapter and bal.t_chapter=1 ";
vstavit_c4eta(s1_2_1_rub);
s1_2_1_rub=" select count ( 1 ), nvl(round(sum ( rsb_account.resta ( c4et, to_date ( '"+enddate+"', 'DD-MM-YYYY' ), 1, null ) ) / 1000),0) from usr_251_c4eta where stroka=121 and rubli=1";


s1_2_2_rub="insert into usr_251_c4eta select 122, c4et,1 from usr_251_c4eta where stroka=129 and rubli=1 "+  //здесь может быть так же надо как и для 1.2 - отдельно по счетам для кол-ва, отдельно по счетам для остатков
"             and exists        "+
"                  (select 1    "+
"                   from dacctrn_dbt    "+
"                   where t_account_payer = c4et        "+
"                         and t_date_carry between to_date ( '01.01."+substr(string(begindate),7)+"', 'dd.mm.yyyy' )    "+
"                                              and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )     "+
"                         and t_chapter = 1     "+
"                         and t_fiid_payer = 0                       "+
"                         and substr ( t_account_receiver, 1, 3 ) <> '202')     ";
vstavit_c4eta(s1_2_2_rub);
s1_2_2_rub=" select count ( 1 ), nvl(round(sum ( rsb_account.resta ( c4et, to_date ( '"+enddate+"', 'DD-MM-YYYY' ), 1, null ) ) / 1000),0) from usr_251_c4eta where stroka=122 and rubli=1";

s1_2_2_1_rub="insert into usr_251_c4eta select 1221, c4et,1 from usr_251_c4eta,daccount_dbt acc where stroka=122 and rubli=1 "+
"and acc.t_account=c4et and ( acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' ) and acc.t_chapter=1";
vstavit_c4eta(s1_2_2_1_rub);
s1_2_2_1_rub=" select count ( 1 ), nvl(round(sum ( rsb_account.resta ( c4et, to_date ( '"+enddate+"', 'DD-MM-YYYY' ), 1, null ) ) / 1000),0) from usr_251_c4eta where stroka=1221 and rubli=1"; //25.09.2014 R-456034-2 DPN


s1_2_1_val="insert into usr_251_c4eta select 121, c4et,0 from usr_251_c4eta, daccblnc_dbt bal,daccount_dbt acc "+
" where c4et=bal.t_account and c4et=acc.t_account and ( (bal.t_balance0 = '40817' OR bal.t_balance0 = '40820') AND acc.t_client <> 22291) "+
" and stroka=129 and rubli=0 and bal.t_chapter=acc.t_chapter and bal.t_chapter=1 ";
vstavit_c4eta(s1_2_1_val);
s1_2_1_val=" select count ( 1 ), nvl(round(sum ( rsb_account.resta ( c4et, to_date ( '"+enddate+"', 'DD-MM-YYYY' ), 1, null ) ) / 1000),0) from usr_251_c4eta where stroka=121 and rubli=0";

s1_2_2_val="insert into usr_251_c4eta select 122, c4et,0 from usr_251_c4eta where stroka=12 and rubli=0 "+
"             and exists        "+
"                  (select 1    "+
"                   from dacctrn_dbt    "+
"                   where t_account_payer = c4et        "+
"                         and t_date_carry between to_date ( '01.01."+substr(string(begindate),7)+"', 'dd.mm.yyyy' )    "+
"                                              and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )     "+
"                         and t_chapter = 1     "+
"                         and t_fiid_payer = 0                       "+
"                         and substr ( t_account_receiver, 1, 3 ) <> '202')     ";
vstavit_c4eta(s1_2_2_val);
s1_2_2_val=" select count ( 1 ), nvl(round(sum ( rsb_account.resta ( c4et, to_date ( '"+enddate+"', 'DD-MM-YYYY' ), 1, null ) ) / 1000),0) from usr_251_c4eta where stroka=122 and rubli=0";

s1_2_2_1_val="insert into usr_251_c4eta select 1221, c4et,0 from usr_251_c4eta,daccount_dbt acc where stroka=122 and rubli=0 "+
"and acc.t_account=c4et and ( acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' ) and acc.t_chapter=1";
vstavit_c4eta(s1_2_2_1_val);
s1_2_2_1_val=" select count ( 1 ), nvl(round(sum ( rsb_account.resta ( c4et, to_date ( '"+enddate+"', 'DD-MM-YYYY' ), 1, null ) ) / 1000),0) from usr_251_c4eta where stroka=1221 and rubli=0"; //25.09.2014 R-456034-2 DPN


var s1_3_c4eta_rub:string=" "+
"         FROM   daccount_dbt acc, daccblnc_dbt bal     "+
"        WHERE   acc.t_account = bal.t_account  "+
"            AND (acc.t_type_account NOT LIKE '%П%' AND acc.t_type_account NOT LIKE '%U%' AND acc.t_type_account NOT LIKE '%Н%')        "+
"            AND acc.t_chapter = 1      "+
"            AND bal.t_chapter = acc.t_chapter  "+
"            AND bal.t_balance0 IN ('30109', '30111', '30112', '30113', '30122', '30123', '30214', '30230', '30231')    "+s1_2_dataopen;

s1_3_m_rub="insert into usr_251_c4eta select 13,acc.t_account,1 "+s1_3_c4eta_rub;
vstavit_c4eta(s1_3_m_rub);
s1_3_m_rub=" select COUNT (1), nvl (ROUND (SUM (rsb_account.resta (c4et, TO_DATE ('"+enddate+"', 'DD-MM-YYYY'), 1, NULL)) / 1000), 0)   from usr_251_c4eta where stroka=13 and rubli=1";

var s1_3_c4eta_val:string=" "+
"         FROM   daccount_dbt acc, daccblnc_dbt bal     "+
"        WHERE   acc.t_account = bal.t_account  "+
"            AND (acc.t_type_account  LIKE '%П%' or acc.t_type_account  LIKE '%U%' or acc.t_type_account  LIKE '%Н%')   "+
"            AND acc.t_chapter = 1      "+
"            AND bal.t_chapter = acc.t_chapter  "+
"            AND bal.t_balance0 IN ('30109', '30111', '30112', '30113', '30122', '30123', '30214', '30230', '30231')    "+s1_2_dataopen;

s1_3_m_val="insert into usr_251_c4eta select 13,acc.t_account,0 "+s1_3_c4eta_val;
vstavit_c4eta(s1_3_m_val);
s1_3_m_val=" select COUNT (1), nvl (ROUND (SUM (rsb_account.resta (c4et, TO_DATE ('"+enddate+"', 'DD-MM-YYYY'), 1, NULL)) / 1000), 0)   from usr_251_c4eta where stroka=13 and rubli=0";


s2_1_1_rub="insert into usr_251_c4eta select 211, acc.t_account,1 "+s1_1_c4eta_rub;
vstavit_c4eta(s2_1_1_rub);
s2_1_1_rub="insert into usr_251_prov  select 211, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper "+
"  from usr_251_c4eta, dacctrn_dbt prov, daccount_dbt acc,  daccount_dbt acc2, daccblnc_dbt bal1        "+
"  where acc.t_account = prov.t_account_payer and acc2.t_account = prov.t_account_receiver and c4et=prov.t_account_payer "+
"    and acc.t_account = bal1.t_account and acc.t_chapter = bal1.t_chapter "+
"        and  stroka=211 and rubli=1"+
"        and ( ( acc.t_client > acc2.t_client ) or ( acc.t_client < acc2.t_client ) )   "+
"        and ( prov.t_shifr_oper = '01' or prov.t_shifr_oper = '16' )   "+
"        and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )  "+
"        and prov.t_chapter=1 and acc.t_chapter=acc2.t_chapter and acc.t_chapter=prov.t_chapter "+
"        and bal1.t_balance0 <> '40821' ";
vstavit_c4eta(s2_1_1_rub);
s2_1_1_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=211 and rubli=1 ";


s2_1_1_val="insert into usr_251_c4eta select 211, acc.t_account,0 "+s1_1_c4eta_val;
vstavit_c4eta(s2_1_1_val);
s2_1_1_val="insert into usr_251_prov  select 211, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
"  from usr_251_c4eta, dacctrn_dbt prov, daccount_dbt acc,  daccount_dbt acc2, daccblnc_dbt bal1        "+
"  where acc.t_account = prov.t_account_payer and acc2.t_account = prov.t_account_receiver and c4et=prov.t_account_payer "+
"    and acc.t_account = bal1.t_account and acc.t_chapter = bal1.t_chapter "+
"        and  stroka=211 and rubli=0"+
"        and ( ( acc.t_client > acc2.t_client ) or ( acc.t_client < acc2.t_client ) )   "+
"        and ( prov.t_shifr_oper = '01' or prov.t_shifr_oper = '16' )   "+
"        and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )  "+
"        and prov.t_chapter=1 and acc.t_chapter=acc2.t_chapter and acc.t_chapter=prov.t_chapter  "+
"        and bal1.t_balance0 <> '40821' ";

vstavit_c4eta(s2_1_1_val);
s2_1_1_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=211 and rubli=0 ";

s2_1_1_1_rub="insert into usr_251_c4eta select 2111, acc.t_account,1 "+s1_1_c4eta_rub+" and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' )";
vstavit_c4eta(s2_1_1_1_rub);

s2_1_1_1_rub=" "+
"  insert into usr_251_prov  select 2111, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
"  from usr_251_c4eta, dacctrn_dbt prov, daccount_dbt acc,  daccount_dbt acc2   "+
"  where acc.t_account = prov.t_account_payer and acc2.t_account = prov.t_account_receiver and c4et=prov.t_account_payer "+
"        and  stroka=2111 and rubli=1"+
"        and ( ( acc.t_client > acc2.t_client ) or ( acc.t_client < acc2.t_client ) )   "+
"        and ( prov.t_shifr_oper = '01' or prov.t_shifr_oper = '1' )    "+
"        and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )  "+
"        and prov.t_chapter=1 and acc.t_chapter=acc2.t_chapter and acc.t_chapter=prov.t_chapter ";
vstavit_c4eta(s2_1_1_1_rub);
s2_1_1_1_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2111 and rubli=1 ";

s2_1_1_1_val="insert into usr_251_c4eta select 2111, acc.t_account,0 "+s1_1_c4eta_val+" and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' )";
vstavit_c4eta(s2_1_1_1_val);
s2_1_1_1_val=" "+
"  insert into usr_251_prov  select 2111, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
"  from usr_251_c4eta, dacctrn_dbt prov, daccount_dbt acc,  daccount_dbt acc2   "+
"  where acc.t_account = prov.t_account_payer and acc2.t_account = prov.t_account_receiver and c4et=prov.t_account_payer "+
"        and  stroka=2111 and rubli=0"+
"        and ( ( acc.t_client > acc2.t_client ) or ( acc.t_client < acc2.t_client ) )   "+
"        and ( prov.t_shifr_oper = '01' or prov.t_shifr_oper = '1' )    "+
"        and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )  "+
"        and prov.t_chapter=1 and acc.t_chapter=acc2.t_chapter and acc.t_chapter=prov.t_chapter  ";
vstavit_c4eta(s2_1_1_1_val);
s2_1_1_1_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2111 and rubli=0 ";




s2_1_1_1_1_rub="insert into usr_251_c4eta select 21111, acc.t_account,1 "+s1_1_c4eta_rub+" and (acc.t_usertypeaccount like '%Ё%'  )";
vstavit_c4eta(s2_1_1_1_1_rub);
s2_1_1_1_1_rub=" "+
"  insert into usr_251_prov  select 21111, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
"  from usr_251_c4eta, dacctrn_dbt prov, daccount_dbt acc,  daccount_dbt acc2   "+
"  where acc.t_account = prov.t_account_payer and acc2.t_account = prov.t_account_receiver and c4et=prov.t_account_payer "+
"        and  stroka=21111 and rubli=1"+
"        and ( ( acc.t_client > acc2.t_client ) or ( acc.t_client < acc2.t_client ) )   "+
"        and ( prov.t_shifr_oper = '01' or prov.t_shifr_oper = '1' )    "+
"        and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )  "+
"        and prov.t_chapter=1 and acc.t_chapter=acc2.t_chapter and acc.t_chapter=prov.t_chapter ";
vstavit_c4eta(s2_1_1_1_1_rub);
s2_1_1_1_1_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=21111 and rubli=1 ";

s2_1_1_1_1_val="insert into usr_251_c4eta select 21111, acc.t_account,0 "+s1_1_c4eta_val+" and (acc.t_usertypeaccount like '%Ё%'  )";
vstavit_c4eta(s2_1_1_1_1_val);
s2_1_1_1_1_val=" "+
"  insert into usr_251_prov  select 21111, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
"  from usr_251_c4eta, dacctrn_dbt prov, daccount_dbt acc,  daccount_dbt acc2   "+
"  where acc.t_account = prov.t_account_payer and acc2.t_account = prov.t_account_receiver and c4et=prov.t_account_payer "+
"        and  stroka=21111 and rubli=0"+
"        and ( ( acc.t_client > acc2.t_client ) or ( acc.t_client < acc2.t_client ) )   "+
"        and ( prov.t_shifr_oper = '01' or prov.t_shifr_oper = '1' )    "+
"        and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )  "+
"        and prov.t_chapter=1 and acc.t_chapter=acc2.t_chapter and acc.t_chapter=prov.t_chapter  ";
vstavit_c4eta(s2_1_1_1_1_val);
s2_1_1_1_1_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=21111 and rubli=0 ";


s2_1_2_rub="insert into usr_251_c4eta select 212, acc.t_account,1 "+s1_1_c4eta_rub;
s2_1_2_val="insert into usr_251_c4eta select 212, acc.t_account,0 "+s1_1_c4eta_val;
vstavit_c4eta(s2_1_2_rub);
vstavit_c4eta(s2_1_2_val);
s2_1_2_rub=" "+
"  insert into usr_251_prov  select 212, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 1,prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
"  from usr_251_c4eta, dacctrn_dbt prov, daccblnc_dbt bal2 "+
"where stroka=212 and rubli=1 and c4et=prov.t_account_payer  "+
"      and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )    "+
"      and substr ( prov.t_account_payer, 6, 3 ) = '810' "+
"      and t_account_receiver=bal2.t_account "+
"      and (bal2.t_balance0='90907' or bal2.t_balance0='90908') "+
"      and prov.t_chapter=3 ";
vstavit_c4eta(s2_1_2_rub);
s2_1_2_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=212 and rubli=1 ";

s2_1_2_val=" "+
"  insert into usr_251_prov  select 212, prov.t_account_payer, prov.t_account_receiver, prov.t_date_carry, prov.t_sum_payer, 0,prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
"  from usr_251_c4eta, dacctrn_dbt prov, daccblnc_dbt bal2 "+
"where  stroka=212 and rubli=0 and c4et=prov.t_account_payer"+
"      and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )    "+
"      and substr ( prov.t_account_payer, 6, 3 ) != '810' "+
"      and t_account_receiver=bal2.t_account "+
"      and (bal2.t_balance0='90907' or bal2.t_balance0='90908') "+
"      and prov.t_chapter=3 ";
vstavit_c4eta(s2_1_2_val);
s2_1_2_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=212 and rubli=0 ";


s2_1_3_rub="insert into usr_251_c4eta select 213, c4et,1 from usr_251_c4eta where stroka=212 and rubli=1";
s2_1_3_val="insert into usr_251_c4eta select 213, c4et,0 from usr_251_c4eta where stroka=212 and rubli=0";
vstavit_c4eta(s2_1_3_rub);
vstavit_c4eta(s2_1_3_val);

s2_1_3_rub=" "+
" insert into usr_251_prov  select 213, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
" from usr_251_c4eta, dacctrn_dbt prov "+
"where stroka=213 and rubli=1 and c4et=prov.t_account_payer and (trim(prov.t_shifr_oper) = '02' or trim(prov.t_shifr_oper) = '16')"
"      and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )    "+
"      and substr ( prov.t_account_payer, 6, 3 ) = '810' "+
"      and prov.t_chapter=1 ";
vstavit_c4eta(s2_1_3_rub);
s2_1_3_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=213 and rubli=1 ";
s2_1_3_val=" "+
" insert into usr_251_prov  select 213, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
" from usr_251_c4eta, dacctrn_dbt prov "+
"where stroka=213 and rubli=0 and c4et=prov.t_account_payer and (trim(prov.t_shifr_oper) = '02' or trim(prov.t_shifr_oper) = '16') " +
"      and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )    "+
"      and substr ( prov.t_account_payer, 6, 3 ) != '810' "+
"      and prov.t_chapter=1 ";
vstavit_c4eta(s2_1_3_val);
s2_1_3_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=213 and rubli=0 ";



s2_1_4_rub="insert into usr_251_c4eta select 214, c4et,1 from usr_251_c4eta where stroka=212 and rubli=1";
s2_1_4_val="insert into usr_251_c4eta select 214, c4et,0 from usr_251_c4eta where stroka=212 and rubli=0";
vstavit_c4eta(s2_1_4_rub);
vstavit_c4eta(s2_1_4_val);

s2_1_4_rub=" insert into usr_251_prov  select 214, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
" from usr_251_c4eta, dacctrn_dbt prov "+
"where stroka=214 and rubli=1 and c4et=prov.t_account_payer and (trim(prov.t_shifr_oper) = '06' or trim(prov.t_shifr_oper) = '16')" +
"      and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )    "+
"      and substr ( prov.t_account_payer, 6, 3 ) = '810' "+
"      and prov.t_chapter=1 ";
vstavit_c4eta(s2_1_4_rub);
s2_1_4_rub=" select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=214 and rubli=1 ";

s2_1_4_val=" insert into usr_251_prov  select 214, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
" from usr_251_c4eta, dacctrn_dbt prov "+
"where stroka=214 and rubli=0 and c4et=prov.t_account_payer and (trim(prov.t_shifr_oper) = '06' or trim(prov.t_shifr_oper) = '16')" +
"      and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )    "+
"      and substr ( prov.t_account_payer, 6, 3 ) != '810' "+
"      and prov.t_chapter=1 ";
vstavit_c4eta(s2_1_4_val);
s2_1_4_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=214 and rubli=0 ";



s2_1_5_rub="insert into usr_251_c4eta select 215, c4et,1 from usr_251_c4eta where stroka=212 and rubli=1";
s2_1_5_val="insert into usr_251_c4eta select 215, c4et,0 from usr_251_c4eta where stroka=212 and rubli=0";
vstavit_c4eta(s2_1_5_rub);
vstavit_c4eta(s2_1_5_val);

s2_1_5_rub=" insert into usr_251_prov  select 215, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
" from usr_251_c4eta, dacctrn_dbt prov "+
"where stroka=215 and rubli=1 and c4et=prov.t_account_payer and (trim(prov.t_shifr_oper) = '07' ) "+
"      and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )    "+
"      and substr ( prov.t_account_payer, 6, 3 ) = '810' "+
"      and prov.t_chapter=1 ";
vstavit_c4eta(s2_1_5_rub);
s2_1_5_rub=" select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=215 and rubli=1 ";

s2_1_5_val=" insert into usr_251_prov  select 215, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
" from usr_251_c4eta, dacctrn_dbt prov "+
"where stroka=215 and rubli=0 and c4et=prov.t_account_payer and (trim(prov.t_shifr_oper) = '07' ) "+
"      and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )    "+
"      and substr ( prov.t_account_payer, 6, 3 ) != '810' "+
"      and prov.t_chapter=1 ";
vstavit_c4eta(s2_1_5_val);
s2_1_5_val=" select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=215 and rubli=0 ";


s2_1_6_rub="insert into usr_251_c4eta select 216, c4et,1 from usr_251_c4eta where stroka=212 and rubli=1";
s2_1_6_val="insert into usr_251_c4eta select 216, c4et,0 from usr_251_c4eta where stroka=212 and rubli=0";
vstavit_c4eta(s2_1_6_rub);
vstavit_c4eta(s2_1_6_val);


s2_1_6_rub=" insert into usr_251_prov  "+
" select 216, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper   from usr_251_c4eta, dacctrn_dbt prov, daccblnc_dbt bal1 "+
" where stroka=216 and rubli=1 AND ((c4et = prov.t_account_payer) or (t_balance0 ='70606' and t_account_receiver = c4et)) "+
"      and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )    "+
"      and substr ( prov.t_account_payer, 6, 3 ) = '810' AND bal1.t_account = prov.t_account_payer AND bal1.t_chapter = 1 "+
"      AND TRIM (prov.t_shifr_oper) = '17'   "+
"      AND  (TRIM (t_kind_oper) = '1' OR TRIM (t_kind_oper) = '6')      "+
"      and prov.t_chapter=1 and not to_number(substr(prov.t_account_receiver,1,3)) between 441 and 458 "+
"       UNION   "+
" select 216, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper    from usr_251_c4eta, dacctrn_dbt prov, daccblnc_dbt bal1,  daccblnc_dbt bal2"+
" where t_account_payer=bal1.t_account and t_account_receiver=bal2.t_account "+
" and prov.t_shifr_oper = '09' and  TRIM (t_kind_oper) = '6' "+
" and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
" and prov.t_chapter=1 and bal1.t_chapter=1 "+
" and stroka=216 and rubli=1 "+
" and ((c4et=prov.t_account_payer and bal2.t_balance0='70601') or (c4et=prov.t_account_receiver and bal1.t_balance0='70606')) and not to_number(substr(prov.t_account_receiver,1,3)) between 441 and 458 ";
vstavit_c4eta(s2_1_6_rub);
s2_1_6_rub=" select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=216 and rubli=1 ";

s2_1_6_val=" insert into usr_251_prov  "+
" select 216, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper   from usr_251_c4eta, dacctrn_dbt prov, daccblnc_dbt bal1 "+
" where stroka=216 and rubli=0 AND ((c4et = prov.t_account_payer) or (t_balance0 ='70606' and t_account_receiver = c4et)) "+
"      and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )    "+
"      and substr ( prov.t_account_payer, 6, 3 ) = '810' AND bal1.t_account = prov.t_account_payer AND bal1.t_chapter = 1 "+
"      AND TRIM (prov.t_shifr_oper) = '17'   "+
"      AND  (TRIM (t_kind_oper) = '1' OR TRIM (t_kind_oper) = '6')      "+
"      and prov.t_chapter=1  and not to_number(substr(prov.t_account_receiver,1,3)) between 441 and 458 "+
"       UNION   "+
" select 216, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper   from usr_251_c4eta, dacctrn_dbt prov, daccblnc_dbt bal1,  daccblnc_dbt bal2"+
" where t_account_payer=bal1.t_account and t_account_receiver=bal2.t_account "+
" and prov.t_shifr_oper = '09' and  TRIM (t_kind_oper) = '6' "+
" and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
" and prov.t_chapter=1 and bal1.t_chapter=1 "+
" and stroka=216 and rubli=0 "+
" and ((c4et=prov.t_account_payer and bal2.t_balance0='70601') or (c4et=prov.t_account_receiver and bal1.t_balance0='70606'))  and not to_number(substr(prov.t_account_receiver,1,3)) between 441 and 458 ";
vstavit_c4eta(s2_1_6_val);
s2_1_6_val=" select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=216 and rubli=0 ";



s2_1_6_1_rub=
" select count ( 1 ) cc, round(nvl(sum ( t_sum_payer ),0)/1000) ss from usr_251_c4eta, dacctrn_dbt prov, daccblnc_dbt bal1,  daccblnc_dbt bal2"+
" where t_account_payer=bal1.t_account and t_account_receiver=bal2.t_account "+
" and ( (prov.t_shifr_oper = '09' and  TRIM (t_kind_oper) = '6' ) or "+
"         ( TRIM (prov.t_shifr_oper) = '17'    AND  (TRIM (t_kind_oper) = '1' OR TRIM (t_kind_oper) = '6') )    "+
"     ) "+
" and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
" and prov.t_chapter=1 and bal1.t_chapter=1  and bal2.t_chapter=1 "+
" and stroka=216 and rubli=1 "+
" and ((c4et=prov.t_account_payer and bal2.t_balance0='70601') or (c4et=prov.t_account_receiver and bal1.t_balance0='70606')) ";

s2_1_6_1_val=
" select count ( 1 ) cc, round(nvl(sum ( t_sum_payer ),0)/1000) ss from usr_251_c4eta, dacctrn_dbt prov, daccblnc_dbt bal1,  daccblnc_dbt bal2"+
" where t_account_payer=bal1.t_account and t_account_receiver=bal2.t_account "+
" and ( (prov.t_shifr_oper = '09' and  TRIM (t_kind_oper) = '6' ) or "+
"         (  TRIM (prov.t_shifr_oper) = '17'    AND  (TRIM (t_kind_oper) = '1' OR TRIM (t_kind_oper) = '6') )   "+
"     ) "+
" and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
" and prov.t_chapter=1 and bal1.t_chapter=1  and bal2.t_chapter=1 "+
" and stroka=216 and rubli=0 "+
" and ((c4et=prov.t_account_payer and bal2.t_balance0='70601') or (c4et=prov.t_account_receiver and bal1.t_balance0='70606')) ";








s2_2_1_rub="insert into usr_251_c4eta select 221, acc.t_account,1 "+s1_2_c4eta_rub;
s2_2_1_val="insert into usr_251_c4eta select 221, acc.t_account,0 "+s1_2_c4eta_val;
vstavit_c4eta(s2_2_1_rub);
vstavit_c4eta(s2_2_1_val);

s2_2_1_rub=" insert into usr_251_prov  select 221, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
" from usr_251_c4eta, dacctrn_dbt prov "+
" where stroka=221 and rubli=1 and c4et=prov.t_account_payer "+
" and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
" and (TRIM (prov.t_shifr_oper) = '01' or TRIM (prov.t_shifr_oper) = '16') "+
" and prov.t_chapter=1 ";
vstavit_c4eta(s2_2_1_rub);
s2_2_1_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=221 and rubli=1 ";

s2_2_1_val=" insert into usr_251_prov  select 221, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
" from usr_251_c4eta, dacctrn_dbt prov "+
" where stroka=221 and rubli=0 and c4et=prov.t_account_payer "+
" and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
" and (TRIM (prov.t_shifr_oper) = '01' or TRIM (prov.t_shifr_oper) = '16') "+
" and prov.t_chapter=1 ";
vstavit_c4eta(s2_2_1_val);
s2_2_1_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=221 and rubli=0 ";

s2_2_1_1_rub="select count ( 1 ) cc, round(nvl(sum ( t_sum_payer ),0)/1000) ss from usr_251_c4eta, dacctrn_dbt prov, daccount_dbt acc "+
" where stroka=221 and rubli=1 and c4et=prov.t_account_payer "+
" and c4et=acc.t_account and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' ) "+
" and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
" and TRIM (prov.t_shifr_oper) = '01' "+
" and prov.t_chapter=1 ";

s2_2_1_1_val="select count ( 1 ) cc, round(nvl(sum ( t_sum_payer ),0)/1000) ss from usr_251_c4eta, dacctrn_dbt prov, daccount_dbt acc "+
" where stroka=221 and rubli=0 and c4et=prov.t_account_payer "+
" and c4et=acc.t_account and (acc.t_usertypeaccount like '%Ё%' or acc.t_usertypeaccount like '%О%' ) "+
" and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
" and TRIM (prov.t_shifr_oper) = '01' "+
" and prov.t_chapter=1 ";


s2_2_1_1_1_rub="select count ( 1 ) cc, round(nvl(sum ( t_sum_payer ),0)/1000) ss from usr_251_c4eta, dacctrn_dbt prov, daccount_dbt acc "+
" where stroka=221 and rubli=1 and c4et=prov.t_account_payer "+
" and c4et=acc.t_account and (acc.t_usertypeaccount like '%Ё%'  ) "+
" and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
" and TRIM (prov.t_shifr_oper) = '01' "+
" and prov.t_chapter=1 ";

s2_2_1_1_1_val="select count ( 1 ) cc, round(nvl(sum ( t_sum_payer ),0)/1000) ss from usr_251_c4eta, dacctrn_dbt prov, daccount_dbt acc "+
" where stroka=221 and rubli=0 and c4et=prov.t_account_payer "+
" and c4et=acc.t_account and (acc.t_usertypeaccount like '%Ё%'  ) "+
" and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
" and TRIM (prov.t_shifr_oper) = '01' "+
" and prov.t_chapter=1 ";

s2_2_2_rub="insert into usr_251_c4eta select 222, c4et, 1 from usr_251_c4eta where stroka=221 and rubli=1 ";
vstavit_c4eta(s2_2_2_rub);
s2_2_2_rub="  insert into usr_251_prov  select 222, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 1,prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
"  from usr_251_c4eta, dacctrn_dbt prov, daccblnc_dbt bal2 "+
" where stroka=222 and rubli=1 and c4et=prov.t_account_payer "+
" and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
"      and t_account_receiver=bal2.t_account "+
"      and (bal2.t_balance0='90907' or bal2.t_balance0='90908') "+
"      and prov.t_chapter=3 ";
vstavit_c4eta(s2_2_2_rub);
s2_2_2_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=222 and rubli=1 ";

s2_2_2_val="insert into usr_251_c4eta select 222, c4et, 0 from usr_251_c4eta where stroka=221 and rubli=0 ";
vstavit_c4eta(s2_2_2_val);
s2_2_2_val="  insert into usr_251_prov  select 222, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 0,prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
"from usr_251_c4eta, dacctrn_dbt prov, daccblnc_dbt bal2 "+
" where stroka=222 and rubli=0 and c4et=prov.t_account_payer "+
" and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
"      and t_account_receiver=bal2.t_account "+
"      and (bal2.t_balance0='90907' or bal2.t_balance0='90908') "+
"      and prov.t_chapter=3 ";
vstavit_c4eta(s2_2_2_val);
s2_2_2_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=222 and rubli=0 ";

s2_2_3_rub="insert into usr_251_c4eta select 223, c4et, 1 from usr_251_c4eta where stroka=122 and rubli=1 ";
vstavit_c4eta(s2_2_3_rub);
s2_2_3_rub="  insert into usr_251_prov  select 223, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
" from usr_251_c4eta, dacctrn_dbt prov, daccblnc_dbt bal1, daccount_dbt acc "+
" where stroka=223 and rubli=1 and c4et=prov.t_account_payer "+
" and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
"      and t_account_payer=bal1.t_account "+
"      and t_account_payer=acc.t_account "+
"      and prov.t_chapter=1 and acc.t_chapter=1 and bal1.t_chapter=1 "+
"          and not((bal1.t_balance0='40817' or bal1.t_balance0='40820')  and t_client=22291) "+
"          and (prov.t_shifr_oper='02' or prov.t_shifr_oper='16') ";
vstavit_c4eta(s2_2_3_rub);
s2_2_3_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=223 and rubli=1 ";

s2_2_3_val="insert into usr_251_c4eta select 223, c4et, 0 from usr_251_c4eta where stroka=122 and rubli=0 ";
vstavit_c4eta(s2_2_3_val);
s2_2_3_val="  insert into usr_251_prov  select 223, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
" from usr_251_c4eta, dacctrn_dbt prov, daccblnc_dbt bal1, daccount_dbt acc "+
" where stroka=223 and rubli=0 and c4et=prov.t_account_payer "+
" and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
"      and t_account_payer=bal1.t_account "+
"      and t_account_payer=acc.t_account "+
"      and prov.t_chapter=1 and acc.t_chapter=1 and bal1.t_chapter=1 "+
"          and not((bal1.t_balance0='40817' or bal1.t_balance0='40820')  and t_client=22291) "+
"          and (prov.t_shifr_oper='02' or prov.t_shifr_oper='16') ";
vstavit_c4eta(s2_2_3_val);
s2_2_3_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=223 and rubli=0 ";


s2_2_4_rub="insert into usr_251_c4eta select 224, c4et, 1 from usr_251_c4eta where stroka=122 and rubli=1 ";
vstavit_c4eta(s2_2_4_rub);
s2_2_4_rub="  insert into usr_251_prov  select 224, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
" from usr_251_c4eta, dacctrn_dbt prov, daccblnc_dbt bal1, daccount_dbt acc "+
" where stroka=224 and rubli=1 and c4et=prov.t_account_payer "+
"      and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )    "+
"      and t_account_payer=bal1.t_account "+
"      and t_account_payer=acc.t_account "+
"      and prov.t_chapter=1 and acc.t_chapter=1 and bal1.t_chapter=1 "+
"          and not((bal1.t_balance0='40817' or bal1.t_balance0='40820')  and t_client=22291) "+
"          and (prov.t_shifr_oper='06' or prov.t_shifr_oper='16') ";
vstavit_c4eta(s2_2_4_rub);
s2_2_4_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=224 and rubli=1 ";

s2_2_4_val="insert into usr_251_c4eta select 224, c4et, 0 from usr_251_c4eta where stroka=122 and rubli=0 ";
vstavit_c4eta(s2_2_4_val);
s2_2_4_val="  insert into usr_251_prov  select 224, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
" from usr_251_c4eta, dacctrn_dbt prov, daccblnc_dbt bal1, daccount_dbt acc "+
" where stroka=224 and rubli=0 and c4et=prov.t_account_payer "+
"  and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )        "+
"      and t_account_payer=bal1.t_account "+
"      and t_account_payer=acc.t_account "+
"      and prov.t_chapter=1 and acc.t_chapter=1 and bal1.t_chapter=1 "+
"          and not((bal1.t_balance0='40817' or bal1.t_balance0='40820')  and t_client=22291) "+
"          and (prov.t_shifr_oper='06' or prov.t_shifr_oper='16') ";
vstavit_c4eta(s2_2_4_val);
s2_2_4_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=224 and rubli=0 ";


s2_2_5_rub="insert into usr_251_c4eta select 225, c4et, 1 from usr_251_c4eta where stroka=122 and rubli=1 ";
vstavit_c4eta(s2_2_5_rub);
s2_2_5_rub="  insert into usr_251_prov  select 225, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
" from usr_251_c4eta, dacctrn_dbt prov, daccblnc_dbt bal1, daccount_dbt acc "+
" where stroka=225 and rubli=1 and c4et=prov.t_account_payer "+
"      and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' )    "+
"      and t_account_payer=bal1.t_account "+
"      and t_account_payer=acc.t_account "+
"      and prov.t_chapter=1 and acc.t_chapter=1 and bal1.t_chapter=1 "+
"          and not((bal1.t_balance0='40817' or bal1.t_balance0='40820')  and t_client=22291) "+
"          and (prov.t_shifr_oper='07') ";
vstavit_c4eta(s2_2_5_rub);
s2_2_5_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=225 and rubli=1 ";

s2_2_5_val="insert into usr_251_c4eta select 225, c4et, 1 from usr_251_c4eta where stroka=122 and rubli=0 ";
vstavit_c4eta(s2_2_5_val);
s2_2_5_val="  insert into usr_251_prov  select 225, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  "+
" from usr_251_c4eta, dacctrn_dbt prov, daccblnc_dbt bal1, daccount_dbt acc "+
" where stroka=225 and rubli=0 and c4et=prov.t_account_payer "+
" and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
"      and t_account_payer=bal1.t_account "+
"      and t_account_payer=acc.t_account "+
"      and prov.t_chapter=1 and acc.t_chapter=1 and bal1.t_chapter=1 "+
"          and not((bal1.t_balance0='40817' or bal1.t_balance0='40820')  and t_client=22291) "+
"          and (prov.t_shifr_oper='07') ";
vstavit_c4eta(s2_2_5_val);
s2_2_5_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=225 and rubli=0 ";




s2_2_6_rub="insert into usr_251_c4eta select 226, c4et, 1 from usr_251_c4eta where stroka=122 and rubli=1 ";
s2_2_6_val="insert into usr_251_c4eta select 226, c4et, 1 from usr_251_c4eta where stroka=122 and rubli=0 ";
vstavit_c4eta(s2_2_6_rub);
vstavit_c4eta(s2_2_6_val);


s2_2_6_rub = "/* Formatted on 16.04.2012 16:03:45 (QP5 v5.115.810.9015) disa */ " + 
      "INSERT INTO usr_251_prov " +
      " SELECT  226, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "   FROM  usr_251_c4eta, dacctrn_dbt prov " +
      "  WHERE  (stroka = 226 AND rubli = 1 AND c4et = prov.t_account_payer) " +
      "           AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " +
      "           AND SUBSTR (prov.t_account_payer, 6, 3) = '810' " +
      "           AND ( (TRIM (prov.t_shifr_oper) = '17' AND (TRIM (t_kind_oper) = '1' OR TRIM (t_kind_oper) = '6')) " +
      "                  OR (SUBSTR (t_account_receiver, 1, 5) = '70601' AND TRIM (prov.t_shifr_oper) = '09' AND TRIM (t_kind_oper) = '6')) " +
      "           AND prov.t_chapter = 1 " +
"       UNION   "+
      " SELECT  226, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "   FROM  usr_251_c4eta, dacctrn_dbt prov, daccblnc_dbt bal " +
      "  WHERE  (stroka = 226 AND rubli = 1 AND c4et = prov.t_account_receiver AND t_account_payer = bal.t_account) " +
      "           AND bal.t_balance0 = '70606' " +
      "           AND TRIM (prov.t_shifr_oper) = '09' " +
      "           AND TRIM (t_kind_oper) = '6' " +
      "           AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " +
      "           AND prov.t_chapter = 1 " +
      "           AND bal.t_chapter = 1 " ;
vstavit_c4eta(s2_2_6_rub);
s2_2_6_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=226 and rubli=1 ";

s2_2_6_val = "/* Formatted on 16.04.2012 16:03:45 (QP5 v5.115.810.9015) disa */ " + 
      "INSERT INTO usr_251_prov " +
      " SELECT  226, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "   FROM  usr_251_c4eta, dacctrn_dbt prov " +
      "  WHERE  (stroka = 226 AND rubli = 0 AND c4et = prov.t_account_payer) " +
      "           AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " +
      "           AND SUBSTR (prov.t_account_payer, 6, 3) = '810' " +
      "           AND ( (TRIM (prov.t_shifr_oper) = '17' AND (TRIM (t_kind_oper) = '1' OR TRIM (t_kind_oper) = '6')) " +
      "                  OR (SUBSTR (t_account_receiver, 1, 5) = '70601' AND TRIM (prov.t_shifr_oper) = '09' AND TRIM (t_kind_oper) = '6')) " +
      "           AND prov.t_chapter = 1 " +
"       UNION   "+
      " SELECT  226, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "   FROM  usr_251_c4eta, dacctrn_dbt prov, daccblnc_dbt bal " +
      "  WHERE  (stroka = 226 AND rubli = 0 AND c4et = prov.t_account_receiver AND t_account_payer = bal.t_account) " +
      "           AND bal.t_balance0 = '70606' " +
      "           AND TRIM (prov.t_shifr_oper) = '09' " +
      "           AND TRIM (t_kind_oper) = '6' " +
      "           AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " +
      "           AND prov.t_chapter = 1 " +
      "           AND bal.t_chapter = 1 " ;
vstavit_c4eta(s2_2_6_val);
s2_2_6_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=226 and rubli=0 ";



s2_2_6_1_rub = "/* Formatted on 16.04.2012 17:37:08 (QP5 v5.115.810.9015) disa */ " + 
      "INSERT INTO usr_251_prov " +
      " SELECT  2261, payer, receiver, ddata, summa, 1, osnov, prov.shifr, prov.vid " +
      "   FROM  usr_251_prov prov, usr_251_c4eta acc1, daccblnc_dbt bal2 " +
      "  WHERE  (prov.payer = acc1.c4et AND prov.receiver = bal2.t_account) " +
      "           AND (prov.stroka = 226 AND prov.rubli = 1 AND acc1.stroka = 226 AND acc1.rubli = 1) " +
      "           AND (bal2.t_balance0 = '70601' AND bal2.t_chapter = 1) " +
      " UNION " +
      " SELECT  2261, payer, receiver, ddata, summa, 1, osnov, prov.shifr, prov.vid " +
      "   FROM  usr_251_prov prov, usr_251_c4eta acc2, daccblnc_dbt bal1 " +
      "  WHERE  (prov.receiver = acc2.c4et AND prov.payer = bal1.t_account) " +
      "           AND (prov.stroka = 226 AND prov.rubli = 1 AND acc2.stroka = 226 AND acc2.rubli = 1) " +
      "           AND (bal1.t_balance0 = '70606' AND bal1.t_chapter = 1) " ;
vstavit_c4eta(s2_2_6_1_rub);
s2_2_6_1_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2261 and rubli=1 ";

s2_2_6_1_val = "/* Formatted on 16.04.2012 17:37:08 (QP5 v5.115.810.9015) disa */ " + 
      "INSERT INTO usr_251_prov " +
      " SELECT  2261, payer, receiver, ddata, summa, 0, osnov, prov.shifr, prov.vid " +
      "   FROM  usr_251_prov prov, usr_251_c4eta acc1, daccblnc_dbt bal2 " +
      "  WHERE  (prov.payer = acc1.c4et AND prov.receiver = bal2.t_account) " +
      "           AND (prov.stroka = 226 AND prov.rubli = 0 AND acc1.stroka = 226 AND acc1.rubli = 0) " +
      "           AND (bal2.t_balance0 = '70601' AND bal2.t_chapter = 1) " +
      " UNION " +
      " SELECT  2261, payer, receiver, ddata, summa, 0, osnov, prov.shifr, prov.vid " +
      "   FROM  usr_251_prov prov, usr_251_c4eta acc2, daccblnc_dbt bal1 " +
      "  WHERE  (prov.receiver = acc2.c4et AND prov.payer = bal1.t_account) " +
      "           AND (prov.stroka = 226 AND prov.rubli = 0 AND acc2.stroka = 226 AND acc2.rubli = 0) " +
      "           AND (bal1.t_balance0 = '70606' AND bal1.t_chapter = 1) " ;
vstavit_c4eta(s2_2_6_1_val);
s2_2_6_1_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2261 and rubli=0 ";



s2_3_1_rub="insert into usr_251_c4eta select 231, acc.t_account,1 "+ day_c4eta231(true);
//getstring(s2_3_1_rub);
s2_3_1_val="insert into usr_251_c4eta select 231, acc.t_account,0 "+ day_c4eta231(false);
vstavit_c4eta(s2_3_1_rub);
vstavit_c4eta(s2_3_1_val);

s2_3_1_rub = "/* Formatted on 16.04.2012 18:29:59 (QP5 v5.115.810.9015) disa */ " + 
      "INSERT INTO usr_251_prov " +
      " SELECT  231, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "   FROM  usr_251_c4eta, dacctrn_dbt prov " +
      "  WHERE  stroka = 231 " +
      "           AND rubli = 1 " +
      "           AND c4et = prov.t_account_payer " +
      "           AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " +
      "           AND ( (prov.t_shifr_oper = '01' AND TRIM (t_kind_oper) = '1') " +
      "                  OR (prov.t_shifr_oper = '01' AND TRIM (t_kind_oper) = '6') " +
      "                  OR (prov.t_shifr_oper = '13' AND TRIM (t_kind_oper) = '1') " +
      "                  OR (prov.t_shifr_oper = '13' AND TRIM (t_kind_oper) = '6') " +
      "                  OR (prov.t_shifr_oper = '16' AND TRIM (t_kind_oper) = '1') " +
      "                  OR (prov.t_shifr_oper = '16' AND TRIM (t_kind_oper) = '6')) " +
      "           AND NOT (t_account_payer LIKE '47416%' AND t_account_receiver NOT LIKE '30102%') " +
      "           AND prov.t_chapter = 1 " ;
vstavit_c4eta(s2_3_1_rub);
s2_3_1_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=231 and rubli=1 ";

s2_3_1_val = "/* Formatted on 16.04.2012 18:39:40 (QP5 v5.115.810.9015) disa */ " + 
      "INSERT INTO usr_251_prov " +
      " SELECT  231, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "   FROM  usr_251_c4eta, dacctrn_dbt prov " +
      "  WHERE  stroka = 231 " +
      "           AND rubli = 0 " +
      "           AND c4et = prov.t_account_payer " +
      "           AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " +
      "           AND ( (prov.t_shifr_oper = '01' AND TRIM (t_kind_oper) = '1') " +
      "                  OR (prov.t_shifr_oper = '01' AND TRIM (t_kind_oper) = '6') " +
      "                  OR (prov.t_shifr_oper = '13' AND TRIM (t_kind_oper) = '1') " +
      "                  OR (prov.t_shifr_oper = '13' AND TRIM (t_kind_oper) = '6') " +
      "                  OR (prov.t_shifr_oper = '16' AND TRIM (t_kind_oper) = '1') " +
      "                  OR (prov.t_shifr_oper = '16' AND TRIM (t_kind_oper) = '6')) " +
      "           AND NOT (t_account_payer LIKE '47416%' AND t_account_receiver NOT LIKE '30102%') " +
      "           AND prov.t_chapter = 1 " +
      " UNION " +
      " SELECT  231, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "   FROM  dacctrn_dbt prov " +
      "  WHERE  prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " +
      "           AND TRIM (prov.t_shifr_oper) = '09' " +
      "           AND TRIM (t_kind_oper) = '1' " +
      "           AND prov.t_chapter = 1 " ;
vstavit_c4eta(s2_3_1_val);
s2_3_1_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=231 and rubli=0 ";






/*

s2_1_6_rub=" "+
"       /* Formatted on 24.01.2011 17:19:46 (QP5 v5.115.810.9015) disa */       "+
"  select count(cc), nvl(sum(ss),0) from ( "+                                        //25.09.2014 R-456034-2 DPN
"       SELECT   COUNT (1) cc, ROUND (NVL (SUM (t_sum), 0) / 1000)      ss"+
"         FROM   darhdoc_dbt prov,      "+
"                (SELECT   acc.t_account, acc.t_chapter "+
"                   FROM   daccount_dbt acc, daccblnc_dbt bal,dparty_dbt party LEFT JOIN dpersn_dbt persn ON (party.t_partyid = persn.t_personid)       "+
"                  WHERE   acc.t_account = bal.t_account        "+
"                      AND acc.t_chapter = bal.t_chapter        "+
"                      AND SUBSTR (acc.t_account, 1, 3) BETWEEN '401' AND '408' "+
"                      AND bal.t_balance0 NOT IN ('40803', '40810', '40813', '40817', '40820')  "+
"                      AND (acc.t_type_account NOT LIKE '%П%' AND acc.t_type_account NOT LIKE '%U%' AND acc.t_type_account NOT LIKE '%Н%')      "+
"                      AND acc.t_client = party.t_partyid       "+
"                      AND ( (persn.t_isemployer = 'X' AND party.t_legalform = 2) OR (party.t_legalform = 1))   "+
"                      AND acc.t_chapter = 1    "+
"                      AND acc.t_code_currency = 0) t1  "+
"        WHERE   prov.t_date_carry BETWEEN TO_DATE (' "+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy')   "+
"            AND prov.t_chapter = 1     "+
"            AND t1.t_chapter = prov.t_chapter  "+
"            AND t1.t_account = prov.t_account_payer    "+
"            AND TRIM (prov.t_shifr_oper) = '17'        "+
"            AND (TRIM (t_kind_oper) = '01' OR TRIM (t_kind_oper) = '06')       "+
"       UNION   "+
"       SELECT   COUNT (1) cc, ROUND (NVL (SUM (t_sum), 0) / 1000)      ss"+
"         FROM   darhdoc_dbt prov,      "+
"                (SELECT   acc.t_account, acc.t_chapter "+
"                   FROM   daccount_dbt acc, daccblnc_dbt bal,dparty_dbt party LEFT JOIN dpersn_dbt persn ON (party.t_partyid = persn.t_personid)       "+
"                  WHERE   acc.t_account = bal.t_account        "+
"                      AND acc.t_chapter = bal.t_chapter        "+
"                      AND SUBSTR (acc.t_account, 1, 3) BETWEEN '401' AND '408' "+
"                      AND bal.t_balance0 NOT IN ('40803', '40810', '40813', '40817', '40820')  "+
"                      AND (acc.t_type_account NOT LIKE '%П%' AND acc.t_type_account NOT LIKE '%U%' AND acc.t_type_account NOT LIKE '%Н%')      "+
"                      AND acc.t_client = party.t_partyid       "+
"                      AND ( (persn.t_isemployer = 'X' AND party.t_legalform = 2) OR (party.t_legalform = 1))   "+
"                      AND acc.t_chapter = 1    "+
"                      AND acc.t_code_currency = 0) t1  "+
"        WHERE   prov.t_date_carry BETWEEN TO_DATE (' "+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy')   "+
"            AND prov.t_chapter = 1     "+
"            AND t1.t_chapter = prov.t_chapter  "+
"            AND t1.t_account = prov.t_account_payer    "+
"            AND prov.t_account_receiver LIKE '70601%'  "+
"            AND TRIM (prov.t_shifr_oper) = '19'        "+
"            AND TRIM (t_kind_oper) = '06'      "+
"       UNION   "+
"       SELECT   COUNT (1) cc, ROUND (NVL (SUM (t_sum), 0) / 1000)      ss"+
"         FROM   darhdoc_dbt prov,      "+
"                (SELECT   acc.t_account, acc.t_chapter "+
"                   FROM   daccount_dbt acc, daccblnc_dbt bal,dparty_dbt party LEFT JOIN dpersn_dbt persn ON (party.t_partyid = persn.t_personid)       "+
"                  WHERE   acc.t_account = bal.t_account        "+
"                      AND acc.t_chapter = bal.t_chapter        "+
"                      AND SUBSTR (acc.t_account, 1, 3) BETWEEN '401' AND '408' "+
"                      AND bal.t_balance0 NOT IN ('40803', '40810', '40813', '40817', '40820')  "+
"                      AND (acc.t_type_account NOT LIKE '%П%' AND acc.t_type_account NOT LIKE '%U%' AND acc.t_type_account NOT LIKE '%Н%')      "+
"                      AND acc.t_client = party.t_partyid       "+
"                      AND ( (persn.t_isemployer = 'X' AND party.t_legalform = 2) OR (party.t_legalform = 1))   "+
"                      AND acc.t_chapter = 1    "+
"                      AND acc.t_code_currency = 0) t2  "+
"        WHERE   prov.t_date_carry BETWEEN TO_DATE (' "+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy')   "+
"            AND prov.t_chapter = 1     "+
"            AND t2.t_chapter = prov.t_chapter  "+
"            AND t2.t_account = prov.t_account_receiver "+
"            AND prov.t_account_payer LIKE '70601%'     "+
"            AND TRIM (prov.t_shifr_oper) = '19'        "+
"            AND TRIM (t_kind_oper) = '06')     ";


s2_1_6_val=" "+
"       /* Formatted on 24.01.2011 17:19:46 (QP5 v5.115.810.9015) disa */       "+
"  select count(cc), nvl(sum(ss),0) from ( "+          //25.09.2014 R-456034-2 DPN
"       SELECT   COUNT (1) cc, ROUND (NVL (SUM (t_sum), 0) / 1000) ss   "+
"         FROM   darhdoc_dbt prov,      "+
"                (SELECT   acc.t_account, acc.t_chapter "+
"                   FROM   daccount_dbt acc, daccblnc_dbt bal,dparty_dbt party LEFT JOIN dpersn_dbt persn ON (party.t_partyid = persn.t_personid)       "+
"                  WHERE   acc.t_account = bal.t_account        "+
"                      AND acc.t_chapter = bal.t_chapter        "+
"                      AND SUBSTR (acc.t_account, 1, 3) BETWEEN '401' AND '408' "+
"                      AND bal.t_balance0 NOT IN ('40803', '40810', '40813', '40817', '40820')  "+
"                      AND (acc.t_type_account LIKE '%П%' or acc.t_type_account  LIKE '%U%' or acc.t_type_account  LIKE '%Н%')  "+
"                      AND acc.t_client = party.t_partyid       "+
"                      AND ( (persn.t_isemployer = 'X' AND party.t_legalform = 2) OR (party.t_legalform = 1))   "+
"                      AND acc.t_chapter = 1    "+
"                      AND acc.t_code_currency = 0) t1  "+
"        WHERE   prov.t_date_carry BETWEEN TO_DATE (' "+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy')   "+
"            AND prov.t_chapter = 1     "+
"            AND t1.t_chapter = prov.t_chapter  "+
"            AND t1.t_account = prov.t_account_payer    "+
"            AND TRIM (prov.t_shifr_oper) = '17'        "+
"            AND (TRIM (t_kind_oper) = '01' OR TRIM (t_kind_oper) = '06')       "+
"       UNION   "+
"       SELECT   COUNT (1) cc , ROUND (NVL (SUM (t_sum), 0) / 1000)     ss "+
"         FROM   darhdoc_dbt prov,      "+
"                (SELECT   acc.t_account, acc.t_chapter "+
"                   FROM   daccount_dbt acc, daccblnc_dbt bal,dparty_dbt party LEFT JOIN dpersn_dbt persn ON (party.t_partyid = persn.t_personid)       "+
"                  WHERE   acc.t_account = bal.t_account        "+
"                      AND acc.t_chapter = bal.t_chapter        "+
"                      AND SUBSTR (acc.t_account, 1, 3) BETWEEN '401' AND '408' "+
"                      AND bal.t_balance0 NOT IN ('40803', '40810', '40813', '40817', '40820')  "+
"                      AND (acc.t_type_account  LIKE '%П%' or acc.t_type_account  LIKE '%U%' or acc.t_type_account  LIKE '%Н%') "+
"                      AND acc.t_client = party.t_partyid       "+
"                      AND ( (persn.t_isemployer = 'X' AND party.t_legalform = 2) OR (party.t_legalform = 1))   "+
"                      AND acc.t_chapter = 1    "+
"                      AND acc.t_code_currency = 0) t1  "+
"        WHERE   prov.t_date_carry BETWEEN TO_DATE (' "+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy')   "+
"            AND prov.t_chapter = 1     "+
"            AND t1.t_chapter = prov.t_chapter  "+
"            AND t1.t_account = prov.t_account_payer    "+
"            AND prov.t_account_receiver LIKE '70601%'  "+
"            AND TRIM (prov.t_shifr_oper) = '19'        "+
"            AND TRIM (t_kind_oper) = '06'      "+
"       UNION   "+
"       SELECT   COUNT (1) cc, ROUND (NVL (SUM (t_sum), 0) / 1000)      ss"+
"         FROM   darhdoc_dbt prov,      "+
"                (SELECT   acc.t_account, acc.t_chapter "+
"                   FROM   daccount_dbt acc, daccblnc_dbt bal,dparty_dbt party LEFT JOIN dpersn_dbt persn ON (party.t_partyid = persn.t_personid)       "+
"                  WHERE   acc.t_account = bal.t_account        "+
"                      AND acc.t_chapter = bal.t_chapter        "+
"                      AND SUBSTR (acc.t_account, 1, 3) BETWEEN '401' AND '408' "+
"                      AND bal.t_balance0 NOT IN ('40803', '40810', '40813', '40817', '40820')  "+
"                      AND (acc.t_type_account  LIKE '%П%' or acc.t_type_account  LIKE '%U%' or acc.t_type_account  LIKE '%Н%') "+
"                      AND acc.t_client = party.t_partyid       "+
"                      AND ( (persn.t_isemployer = 'X' AND party.t_legalform = 2) OR (party.t_legalform = 1))   "+
"                      AND acc.t_chapter = 1    "+
"                      AND acc.t_code_currency = 0) t2  "+
"        WHERE   prov.t_date_carry BETWEEN TO_DATE (' "+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy')   "+
"            AND prov.t_chapter = 1     "+
"            AND t2.t_chapter = prov.t_chapter  "+
"            AND t2.t_account = prov.t_account_receiver "+
"            AND prov.t_account_payer LIKE '70601%'     "+
"            AND TRIM (prov.t_shifr_oper) = '19'        "+
"            AND TRIM (t_kind_oper) = '06')     ";
*/


vstavit_c4eta("insert into usr_251_c4eta select 41, acc.t_account,1 "+ day_c4eta41(true));
vstavit_c4eta("insert into usr_251_c4eta select 41, acc.t_account,0 "+ day_c4eta41(false));
s4_1_rub=" "+
" select count ( 1 ) cc, round(nvl(sum ( t_sum_payer ),0)/1000) ss from usr_251_c4eta, dacctrn_dbt prov "+
" where stroka=41 and rubli=1 and c4et=prov.t_account_payer "+
" and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
" and prov.t_account_payer not like '202%' "+
" and prov.t_account_payer not like '30233%' "+
" and prov.t_account_payer not like '313%' "+
" and prov.t_account_payer not like '320%' "+
" and prov.t_account_payer not like '47408%' "+
" and prov.t_account_payer not like '47422%' ";

s4_1_val=" "+
" select count ( 1 ) cc, round(nvl(sum ( t_sum_payer ),0)/1000) ss from usr_251_c4eta, dacctrn_dbt prov "+
" where stroka=41 and rubli=0 and c4et=prov.t_account_payer "+
" and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
" and prov.t_account_payer not like '202%' "+
" and prov.t_account_payer not like '30233%' "+
" and prov.t_account_payer not like '313%' "+
" and prov.t_account_payer not like '320%' "+
" and prov.t_account_payer not like '47408%' "+
" and prov.t_account_payer not like '47422%' "+
" and prov.t_account_payer not like '70603%' ";


s4_1_1_rub=" select count ( 1 ) cc, round(nvl(sum ( t_sum_payer ),0)/1000) ss from usr_251_c4eta, dacctrn_dbt prov, daccount_dbt acc1, daccount_dbt acc2 "+
" where stroka=41 and rubli=1 and c4et=prov.t_account_payer and t_account_payer=acc1.t_account and acc2.t_account=t_account_receiver "+
" and acc1.t_chapter=acc2.t_chapter and acc1.t_chapter=prov.t_chapter and prov.t_chapter=1 and acc1.t_client<>acc2.t_client  "+
" and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
" and acc2.t_account in (select c4et from usr_251_c4eta where stroka=41 and rubli=1) ";

s4_1_1_val=" select count ( 1 ) cc, round(nvl(sum ( t_sum_payer ),0)/1000) ss from usr_251_c4eta, dacctrn_dbt prov, daccount_dbt acc1, daccount_dbt acc2 "+
" where stroka=41 and rubli=0 and c4et=prov.t_account_payer and t_account_payer=acc1.t_account and acc2.t_account=t_account_receiver "+
" and acc1.t_chapter=acc2.t_chapter and acc1.t_chapter=prov.t_chapter and prov.t_chapter=1 and acc1.t_client<>acc2.t_client "+
" and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
" and acc2.t_account in (select c4et from usr_251_c4eta where stroka=41 and rubli=0) ";

s4_1_3_rub=" select count ( 1 ) cc, round(nvl(sum ( t_sum_payer ),0)/1000) ss from usr_251_c4eta, dacctrn_dbt prov, daccblnc_dbt bal2 "+
" where stroka=41 and rubli=1 and c4et=prov.t_account_payer and t_account_receiver=bal2.t_account  and bal2.t_balance0='30102' "+
" and bal2.t_chapter=prov.t_chapter and prov.t_chapter=1 "+
" and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) ";

s4_1_3_val=" select count ( 1 ) cc, round(nvl(sum ( t_sum_payer ),0)/1000) ss from usr_251_c4eta, dacctrn_dbt prov, daccblnc_dbt bal2 "+
" where stroka=41 and rubli=0 and c4et=prov.t_account_payer and t_account_receiver=bal2.t_account  and bal2.t_balance0='30102' "+
" and bal2.t_chapter=prov.t_chapter and prov.t_chapter=1 "+
" and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) ";




s2_3_6_rub = "/* Formatted on 17.04.2012 13:34:07 (QP5 v5.115.810.9015) disa */ " + 
      "INSERT INTO usr_251_prov " +
      " SELECT  236, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "   FROM  usr_251_c4eta c4_payer, dacctrn_dbt prov, usr_251_c4eta c4_receiver " +
      "  WHERE  c4_payer.stroka = 231 " +
      "           AND c4_payer.rubli = 1 " +
      "           AND c4_payer.c4et = prov.t_account_payer " +
      "           AND (c4_receiver.stroka = 211 OR c4_receiver.stroka = 221 OR c4_receiver.stroka = 41) " +
      "           AND c4_receiver.rubli = 1 " +
      "           AND c4_receiver.c4et = prov.t_account_receiver " +
      "           AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " +
      "           AND (TRIM (prov.t_shifr_oper) = '17' AND (TRIM (t_kind_oper) = '1' OR TRIM (t_kind_oper) = '6')) " +
      "           AND prov.t_chapter = 1 " ;
vstavit_c4eta(s2_3_6_rub);
s2_3_6_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=236 and rubli=1 ";

s2_3_6_val = "/* Formatted on 17.04.2012 13:34:07 (QP5 v5.115.810.9015) disa */ " + 
      "INSERT INTO usr_251_prov " +
      " SELECT  236, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "   FROM  usr_251_c4eta c4_payer, dacctrn_dbt prov, usr_251_c4eta c4_receiver " +
      "  WHERE  c4_payer.stroka = 231 " +
      "           AND c4_payer.rubli = 0 " +
      "           AND c4_payer.c4et = prov.t_account_payer " +
      "           AND (c4_receiver.stroka = 211 OR c4_receiver.stroka = 221 OR c4_receiver.stroka = 41) " +
      "           AND c4_receiver.rubli = 0 " +
      "           AND c4_receiver.c4et = prov.t_account_receiver " +
      "           AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " +
      "           AND (TRIM (prov.t_shifr_oper) = '17' AND (TRIM (t_kind_oper) = '1' OR TRIM (t_kind_oper) = '6')) " +
      "           AND prov.t_chapter = 1 " ;
vstavit_c4eta(s2_3_6_val);
s2_3_6_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=236 and rubli=0 ";


s2_3_3_rub = "/* Formatted on 17.04.2012 13:13:36 (QP5 v5.115.810.9015) disa */ " + 
      "INSERT INTO usr_251_prov " +
      " SELECT  233, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "   FROM  usr_251_c4eta, dacctrn_dbt prov " +
      "  WHERE  stroka = 231 " +
      "           AND rubli = 1 " +
      "           AND c4et = prov.t_account_payer " +
      "           AND prov.t_chapter = 1 " +
      "           AND (TRIM (prov.t_shifr_oper) = '02' OR TRIM (prov.t_shifr_oper) = '16' OR TRIM (prov.t_shifr_oper) = '2') " +
      "           AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " ;
vstavit_c4eta(s2_3_3_rub);
s2_3_3_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=233 and rubli=1 ";

s2_3_3_val = "/* Formatted on 17.04.2012 13:13:36 (QP5 v5.115.810.9015) disa */ " + 
      "INSERT INTO usr_251_prov " +
      " SELECT  233, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "   FROM  usr_251_c4eta, dacctrn_dbt prov " +
      "  WHERE  stroka = 231 " +
      "           AND rubli = 0 " +
      "           AND c4et = prov.t_account_payer " +
      "           AND prov.t_chapter = 1 " +
      "           AND (TRIM (prov.t_shifr_oper) = '02' OR TRIM (prov.t_shifr_oper) = '16' OR TRIM (prov.t_shifr_oper) = '2') " +
      "           AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " ;
vstavit_c4eta(s2_3_3_val);
s2_3_3_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=233 and rubli=0 ";


s2_3_4_rub = "/* Formatted on 17.04.2012 13:18:26 (QP5 v5.115.810.9015) disa */ " + 
      "INSERT INTO usr_251_prov " +
      " SELECT  234, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "   FROM  usr_251_c4eta, dacctrn_dbt prov " +
      "  WHERE  stroka = 231 " +
      "           AND rubli = 1 " +
      "           AND c4et = prov.t_account_payer " +
      "           AND prov.t_chapter = 1 " +
      "           AND (TRIM (prov.t_shifr_oper) = '06' OR TRIM (prov.t_shifr_oper) = '16' OR TRIM (prov.t_shifr_oper) = '6') " +
      "           AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " ;
vstavit_c4eta(s2_3_4_rub);
s2_3_4_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=234 and rubli=1 ";

s2_3_4_val = "/* Formatted on 17.04.2012 13:18:26 (QP5 v5.115.810.9015) disa */ " + 
      "INSERT INTO usr_251_prov " +
      " SELECT  234, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "   FROM  usr_251_c4eta, dacctrn_dbt prov " +
      "  WHERE  stroka = 231 " +
      "           AND rubli = 0 " +
      "           AND c4et = prov.t_account_payer " +
      "           AND prov.t_chapter = 1 " +
      "           AND (TRIM (prov.t_shifr_oper) = '06' OR TRIM (prov.t_shifr_oper) = '16' OR TRIM (prov.t_shifr_oper) = '6') " +
      "           AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " ;
vstavit_c4eta(s2_3_4_val);
s2_3_4_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=234 and rubli=0 ";


s2_3_5_rub = "/* Formatted on 17.04.2012 13:22:27 (QP5 v5.115.810.9015) disa */ " + 
      "INSERT INTO usr_251_prov " +
      " SELECT  235, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "   FROM  usr_251_c4eta, dacctrn_dbt prov " +
      "  WHERE  stroka = 231 " +
      "           AND rubli = 1 " +
      "           AND c4et = prov.t_account_payer " +
      "           AND prov.t_chapter = 1 " +
      "           AND (TRIM (prov.t_shifr_oper) = '07' OR TRIM (prov.t_shifr_oper) = '7') " +
      "           AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " ;
vstavit_c4eta(s2_3_5_rub);
s2_3_5_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=234 and rubli=1 ";

s2_3_5_val = "/* Formatted on 17.04.2012 13:22:27 (QP5 v5.115.810.9015) disa */ " + 
      "INSERT INTO usr_251_prov " +
      " SELECT  235, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "   FROM  usr_251_c4eta, dacctrn_dbt prov " +
      "  WHERE  stroka = 231 " +
      "           AND rubli = 0 " +
      "           AND c4et = prov.t_account_payer " +
      "           AND prov.t_chapter = 1 " +
      "           AND (TRIM (prov.t_shifr_oper) = '07' OR TRIM (prov.t_shifr_oper) = '7') " +
      "           AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " ;
vstavit_c4eta(s2_3_5_val);
s2_3_5_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=235 and rubli=0 ";



/*
s2_4_1_m_rub=" "+
"       /* Formatted on 23.01.2011 19:28:38 (QP5 v5.115.810.9015) disa */       "+
"       SELECT   COUNT (1), NVL (ROUND (SUM (t_sum) / 1000), 0) "+
"         FROM   darhdoc_dbt prov, daccount_dbt acc1, daccount_dbt acc2, daccblnc_dbt bal1, daccblnc_dbt bal2, dobjcode_dbt do1 "+
"        WHERE   prov.t_chapter = 1     "+
"            AND t_account_payer = acc1.t_account       "+
"            AND t_account_receiver = acc2.t_account    "+
"            AND t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.rrrr') AND TO_DATE ('"+enddate+"', 'dd.mm.rrrr') "+
"            AND (acc1.t_type_account NOT LIKE '%П%' AND acc1.t_type_account NOT LIKE '%U%' AND acc1.t_type_account NOT LIKE '%Н%')     "+
"            AND acc1.t_chapter = acc2.t_chapter        "+
"            AND prov.t_chapter = acc1.t_chapter        "+
"            AND t_account_payer = bal1.t_account       "+
"            AND t_account_receiver = bal2.t_account    "+
"            AND bal1.t_chapter = bal2.t_chapter        "+
"            AND bal1.t_chapter = prov.t_chapter        "+
"            AND do1.t_objecttype = 3   "+
"            AND do1.t_codekind = 1     "+
"            AND acc1.t_client = do1.t_objectid "+
"            AND (bal1.t_balance0 = '40911' OR bal1.t_balance0 = '40912' OR bal1.t_balance0 = '40913')  "+
"            AND (do1.t_code = '010000060231' OR do1.t_code = '010000060430' OR do1.t_code = '010000060431')    "+
"            AND bal2.t_balance0 <> '20202'     "+
"            AND bal2.t_balance0 <> '40817'     "+
"            AND bal2.t_balance0 <> '42301'     "+
"            AND bal2.t_balance0 <> '70601'     ";

s2_4_1_1_rub=s2_4_1_m_rub+" and bal1.t_balance0='40911' ";
 */
vstavit_c4eta("insert into usr_251_c4eta select 241, acc.t_account,1 "+ day_c4eta241(true));
vstavit_c4eta("insert into usr_251_c4eta select 241, acc.t_account,0 "+ day_c4eta241(false));
s2_4_1_rub = "/* Formatted on 17.04.2012 13:43:14 (QP5 v5.115.810.9015) disa */ " + 
      "INSERT INTO usr_251_prov " +
      " SELECT  241, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "   FROM  usr_251_c4eta, dacctrn_dbt prov, daccblnc_dbt bal2 " +
      "  WHERE  stroka = 241 " +
      "           AND rubli = 1 " +
      "           AND c4et = t_account_payer and bal2.t_account = prov.t_account_receiver " +
      "           AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " +
      "           AND prov.t_chapter = 1 and  bal2.t_chapter = 1 and bal2.t_account = prov.t_account_receiver and bal2.t_balance0 not in ('20202','40817','42301','70601')" ;
vstavit_c4eta(s2_4_1_rub);
s2_4_1_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=241 and rubli=1 ";

s2_4_1_val = "/* Formatted on 17.04.2012 13:43:14 (QP5 v5.115.810.9015) disa */ " + 
      "INSERT INTO usr_251_prov " +
      " SELECT  241, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "   FROM  usr_251_c4eta, dacctrn_dbt prov, daccblnc_dbt bal2 " +
      "  WHERE  stroka = 241 " +
      "           AND rubli = 0 " +
      "           AND c4et = t_account_payer and bal2.t_chapter = 1 and bal2.t_account = prov.t_account_receiver " +
      "           AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " +
      "           AND prov.t_chapter = 1 and bal2.t_balance0 not in ('20202','40817','42301','70601')" ;
vstavit_c4eta(s2_4_1_val);
s2_4_1_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=241 and rubli=0 ";


vstavit_c4eta("insert into usr_251_c4eta select 2411, acc.t_account,1 "+ day_c4eta241(true) + " and bal1.t_balance0 = '40911' " );
vstavit_c4eta("insert into usr_251_c4eta select 2411, acc.t_account,0 "+ day_c4eta241(false)+ " and bal1.t_balance0 = '40911' " );

s2_4_1_1_rub = "/* Formatted on 17.04.2012 13:43:14 (QP5 v5.115.810.9015) disa */ " + 
      "INSERT INTO usr_251_prov " +
      " SELECT  2411, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "   FROM  usr_251_c4eta, dacctrn_dbt prov, daccblnc_dbt bal2 " +
      "  WHERE  stroka = 2411 " +
      "           AND rubli = 1 " +
      "           AND c4et = t_account_payer and bal2.t_account = prov.t_account_receiver and bal2.t_chapter = 1 " +
      "           AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " +
      "           AND prov.t_chapter = 1 and bal2.t_balance0 not in ('20202','40817','42301','70601')" ;
vstavit_c4eta(s2_4_1_1_rub);
s2_4_1_1_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2411 and rubli=1 ";

s2_4_1_1_val = "/* Formatted on 17.04.2012 13:43:14 (QP5 v5.115.810.9015) disa */ " + 
      "INSERT INTO usr_251_prov " +
      " SELECT  2411, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "   FROM  usr_251_c4eta, dacctrn_dbt prov, daccblnc_dbt bal2 " +
      "  WHERE  stroka = 2411 " +
      "           AND rubli = 0 " +
      "           AND c4et = t_account_payer  and bal2.t_account = prov.t_account_receiver and bal2.t_chapter = 1 " +
      "           AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " +
      "           AND prov.t_chapter = 1 and bal2.t_balance0 not in ('20202','40817','42301','70601')" ;
vstavit_c4eta(s2_4_1_1_val);
s2_4_1_1_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2411 and rubli=0 ";



/*

s2_4_1_m_val=""+
"       /* Formatted on 23.01.2011 19:28:38 (QP5 v5.115.810.9015) disa */       "+
"       SELECT   COUNT (1), NVL (ROUND (SUM (t_sum) / 1000), 0) "+
"         FROM   darhdoc_dbt prov, daccount_dbt acc1, daccount_dbt acc2, daccblnc_dbt bal1, daccblnc_dbt bal2, dobjcode_dbt do1 "+
"        WHERE   prov.t_chapter = 1     "+
"            AND t_account_payer = acc1.t_account       "+
"            AND t_account_receiver = acc2.t_account    "+
"            AND t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.rrrr') AND TO_DATE ('"+enddate+"', 'dd.mm.rrrr') "+
"            AND (acc1.t_type_account  LIKE '%П%' or acc1.t_type_account LIKE '%U%' or acc1.t_type_account  LIKE '%Н%') "+
"            AND acc1.t_chapter = acc2.t_chapter        "+
"            AND prov.t_chapter = acc1.t_chapter        "+
"            AND t_account_payer = bal1.t_account       "+
"            AND t_account_receiver = bal2.t_account    "+
"            AND bal1.t_chapter = bal2.t_chapter        "+
"            AND bal1.t_chapter = prov.t_chapter        "+
"            AND do1.t_objecttype = 3   "+
"            AND do1.t_codekind = 1     "+
"            AND acc1.t_client = do1.t_objectid "+
"            AND (bal1.t_balance0 = '40911' OR bal1.t_balance0 = '40912' OR bal1.t_balance0 = '40913')  "+
"            AND (do1.t_code = '010000060231' OR do1.t_code = '010000060430' OR do1.t_code = '010000060431')    "+
"            AND bal2.t_balance0 <> '20202'     "+
"            AND bal2.t_balance0 <> '40817'     "+
"            AND bal2.t_balance0 <> '42301'     "+
"            AND bal2.t_balance0 <> '70601'     ";

s2_4_1_1_val=s2_4_1_m_val+" and bal1.t_balance0='40911' ";

*/
                                                                                                                     

var s2_4_1_2_pref = "INSERT INTO usr_251_prov SELECT ";
s2_4_1_2_rub_z=" "+
            " prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
                " from usr_251_c4eta, dacctrn_dbt prov, daccblnc_dbt bal1, dsymbcash_dbt symb   "+
                " where stroka=241 and rubli=1 and t_account_receiver=c4et and bal1.t_account=t_account_payer  "+
                " AND symb.t_acctrnid = prov.t_acctrnid     "+
                " and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
                " and bal1.t_chapter=prov.t_chapter and prov.t_chapter=1 "+
                " AND bal1.t_balance0 = '20202' ";

s2_4_1_2_val_z=" "+
                " prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
                " from usr_251_c4eta, dacctrn_dbt prov, daccblnc_dbt bal1, dsymbcash_dbt symb   "+
                " where stroka=241 and rubli=0 and t_account_receiver=c4et and bal1.t_account=t_account_payer  "+
                " AND symb.t_acctrnid = prov.t_acctrnid     "+
                " and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
                " and bal1.t_chapter=prov.t_chapter and prov.t_chapter=1 "+
                " AND bal1.t_balance0 = '20202' ";

s2_4_1_2_rub_ = s2_4_1_2_pref + "2412," + s2_4_1_2_rub_z+
                " AND (TRIM (symb.t_symbol) = '13' OR TRIM (symb.t_symbol) = '16' OR TRIM (symb.t_symbol) = '23' OR TRIM (symb.t_symbol) = '31') ";
vstavit_c4eta(s2_4_1_2_rub_);
s2_4_1_2_rub_ = "select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2412 and rubli=1 ";

//getstring(s2_4_1_2_rub_);
s2_4_1_2_val_ = s2_4_1_2_pref + "2412," + s2_4_1_2_val_z+
                " AND (TRIM (symb.t_symbol) = '13' OR TRIM (symb.t_symbol) = '16' OR TRIM (symb.t_symbol) = '23' OR TRIM (symb.t_symbol) = '31') ";
vstavit_c4eta(s2_4_1_2_val_);
s2_4_1_2_val_ = "select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2412 and rubli=0 ";

// qqqqqqqqq
s2_4_1_2_1_rub = s2_4_1_2_pref + " 24121, " + s2_4_1_2_rub_z + "  AND TRIM (symb.t_symbol) = '14'  ";
vstavit_c4eta(s2_4_1_2_1_rub);
s2_4_1_2_1_rub = "select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=24121 and rubli=1 ";

s2_4_1_2_1_val = s2_4_1_2_pref + " 24121, " + s2_4_1_2_val_z + "  AND TRIM (symb.t_symbol) = '14'  ";
vstavit_c4eta(s2_4_1_2_1_val);
s2_4_1_2_1_val = "select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=24121 and rubli=1 ";

/*
s2_4_1_2_m_rub="        /* Formatted on 23.01.2011 21:17:19 (QP5 v5.115.810.9015) disa */       "+
"       SELECT   COUNT (1), NVL (ROUND (SUM (prov.t_sum) / 1000), 0)    "+
"         FROM   dacctrn_dbt prov, daccount_dbt acc1, daccount_dbt acc2, daccblnc_dbt bal1, daccblnc_dbt bal2, dobjcode_dbt do2, dsymbcash_dbt symb     "+
"        WHERE   prov.t_chapter = 1     "+
"            AND t_account_payer = acc1.t_account       "+
"            AND t_account_receiver = acc2.t_account    "+
"            AND t_date_carry BETWEEN TO_DATE ('01.12.2010', 'dd.mm.rrrr') AND TO_DATE ('01.01.2011', 'dd.mm.rrrr')     "+
"            AND (acc1.t_type_account NOT LIKE '%П%' AND acc1.t_type_account NOT LIKE '%U%' AND acc1.t_type_account NOT LIKE '%Н%')     "+
"            AND acc1.t_chapter = acc2.t_chapter        "+
"            AND prov.t_chapter = acc1.t_chapter        "+
"            AND t_account_payer = bal1.t_account       "+
"            AND t_account_receiver = bal2.t_account    "+
"            AND bal1.t_chapter = bal2.t_chapter        "+
"            AND bal1.t_chapter = prov.t_chapter        "+
"            AND do2.t_objecttype = 3   "+
"            AND do2.t_codekind = 1     "+
"            AND acc2.t_client = do2.t_objectid "+
"            AND symb.t_applicationkey = TO_CHAR (prov.t_iapplicationkind, 'fm09999') || prov.t_applicationkey  "+
"            AND bal1.t_balance0 = '20202'      "+
"            AND (do2.t_code = '010000060231' OR do2.t_code = '010000060430' OR do2.t_code = '010000060431')    "+
"            AND (bal2.t_balance0 = '40911' OR bal2.t_balance0 = '40912' OR bal2.t_balance0 = '40913')  ";

s2_4_1_2_rub=s2_4_1_2_m_rub+"  AND TRIM (symb.t_symbol) = '14'  ";

" AND (TRIM (symb.t_symbol) = '13' OR TRIM (symb.t_symbol) = '16' OR TRIM (symb.t_symbol) = '23' OR TRIM (symb.t_symbol) = '31') ";



s2_4_1_2_m_val="        /* Formatted on 23.01.2011 21:17:19 (QP5 v5.115.810.9015) disa */       "+
"       SELECT   COUNT (1), NVL (ROUND (SUM (prov.t_sum) / 1000), 0)    "+
"         FROM   darhdoc_dbt prov, daccount_dbt acc1, daccount_dbt acc2, daccblnc_dbt bal1, daccblnc_dbt bal2, dobjcode_dbt do2, dsymbcash_dbt symb     "+
"        WHERE   prov.t_chapter = 1     "+
"            AND t_account_payer = acc1.t_account       "+
"            AND t_account_receiver = acc2.t_account    "+
"            AND t_date_carry BETWEEN TO_DATE ('01.12.2010', 'dd.mm.rrrr') AND TO_DATE ('01.01.2011', 'dd.mm.rrrr')     "+
"            AND (acc1.t_type_account LIKE '%П%' or acc1.t_type_account  LIKE '%U%' or acc1.t_type_account  LIKE '%Н%') "+
"            AND acc1.t_chapter = acc2.t_chapter        "+
"            AND prov.t_chapter = acc1.t_chapter        "+
"            AND t_account_payer = bal1.t_account       "+
"            AND t_account_receiver = bal2.t_account    "+
"            AND bal1.t_chapter = bal2.t_chapter        "+
"            AND bal1.t_chapter = prov.t_chapter        "+
"            AND do2.t_objecttype = 3   "+
"            AND do2.t_codekind = 1     "+
"            AND acc2.t_client = do2.t_objectid "+
"            AND symb.t_applicationkey = TO_CHAR (prov.t_iapplicationkind, 'fm09999') || prov.t_applicationkey  "+
"            AND bal1.t_balance0 = '20202'      "+
"            AND (do2.t_code = '010000060231' OR do2.t_code = '010000060430' OR do2.t_code = '010000060431')    "+
"            AND (bal2.t_balance0 = '40911' OR bal2.t_balance0 = '40912' OR bal2.t_balance0 = '40913')  ";

s2_4_1_2_val=s2_4_1_2_m_val+" "+
" AND (TRIM (symb.t_symbol) = '13' OR TRIM (symb.t_symbol) = '16' OR TRIM (symb.t_symbol) = '23' OR TRIM (symb.t_symbol) = '31') ";

s2_4_1_2_1_rub=s2_4_1_2_m_rub+"  AND TRIM (symb.t_symbol) = '14'  ";
s2_4_1_2_1_val=s2_4_1_2_m_val+"  AND TRIM (symb.t_symbol) = '14'  ";
*/

vstavit_c4eta("insert into usr_251_c4eta select 242, acc.t_account,1 "+ day_c4eta242(true));
vstavit_c4eta("insert into usr_251_c4eta select 242, acc.t_account,0 "+ day_c4eta242(false));
s2_4_2_rub = "/* Formatted on 17.04.2012 13:54:53 (QP5 v5.115.810.9015) disa */ " + 
      "INSERT INTO usr_251_prov " +
      " SELECT  242, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "   FROM  usr_251_c4eta, dacctrn_dbt prov, daccblnc_dbt bal2 " +
      "  WHERE  stroka = 242 " +
      "           AND rubli = 1 " +
      "           AND c4et = t_account_payer " +
      "           AND t_account_receiver = bal2.t_account " +
      "           AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " +
      "           AND bal2.t_balance0 NOT IN ('20202', '40817', '42301', '70601') " +
      "           AND prov.t_chapter = 1 " +
      "           AND prov.t_chapter = bal2.t_chapter " ;
vstavit_c4eta(s2_4_2_rub);
s2_4_2_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=242 and rubli=1 ";

s2_4_2_val = "/* Formatted on 17.04.2012 13:54:53 (QP5 v5.115.810.9015) disa */ " + 
      "INSERT INTO usr_251_prov " +
      " SELECT  242, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
      "   FROM  usr_251_c4eta, dacctrn_dbt prov, daccblnc_dbt bal2 " +
      "  WHERE  stroka = 242 " +
      "           AND rubli = 0 " +
      "           AND c4et = t_account_payer " +
      "           AND t_account_receiver = bal2.t_account " +
      "           AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " +
      "           AND bal2.t_balance0 NOT IN ('20202', '40817', '42301', '70601') " +
      "           AND prov.t_chapter = 1 " +
      "           AND prov.t_chapter = bal2.t_chapter " ;
vstavit_c4eta(s2_4_2_val);
s2_4_2_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=242 and rubli=0 ";





vstavit_c4eta("insert into usr_251_c4eta select 2421, acc.t_account,1 "+ day_c4eta242(true) + " and bal1.t_balance0 = '40911' " );
vstavit_c4eta("insert into usr_251_c4eta select 2421, acc.t_account,0 "+ day_c4eta242(false)+ " and bal1.t_balance0 = '40911' " );




s2_4_2_1_rub = "/* Formatted on 17.04.2012 14:24:08 (QP5 v5.115.810.9015) disa */ " + 
      "INSERT INTO usr_251_prov " +
      " SELECT  2421, pr.payer, pr.receiver, pr.ddata, pr.summa, 1, pr.osnov, pr.shifr, pr.vid " +
      "   FROM  usr_251_prov pr, usr_251_c4eta c4 " +
      "  WHERE  (pr.stroka = 242 AND pr.rubli = 1) AND (c4.stroka = 2421 AND c4.rubli = 1) AND pr.payer = c4.c4et " ;
vstavit_c4eta(s2_4_2_1_rub);
s2_4_2_1_rub="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2421 and rubli=1 ";

s2_4_2_1_val = "/* Formatted on 17.04.2012 14:24:08 (QP5 v5.115.810.9015) disa */ " + 
      "INSERT INTO usr_251_prov " +
      " SELECT  2421, pr.payer, pr.receiver, pr.ddata, pr.summa, 0, pr.osnov, pr.shifr, pr.vid " +
      "   FROM  usr_251_prov pr, usr_251_c4eta c4 " +
      "  WHERE  (pr.stroka = 242 AND pr.rubli = 0) AND (c4.stroka = 2421 AND c4.rubli = 0) AND pr.payer = c4.c4et " ;
vstavit_c4eta(s2_4_2_1_val);
s2_4_2_1_val="select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2421 and rubli=0 ";







var s2_4_2_2_pref = "INSERT INTO usr_251_prov SELECT ";
s2_4_2_2_rub_z=" "+
            " prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
                " from usr_251_c4eta, dacctrn_dbt prov, daccblnc_dbt bal1, dsymbcash_dbt symb   "+
                " where stroka=242 and rubli=1 and t_account_receiver=c4et and bal1.t_account=t_account_payer  "+
                " AND symb.t_acctrnid = prov.t_acctrnid     "+
                " and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
                " and bal1.t_chapter=prov.t_chapter and prov.t_chapter=1 "+
                " AND bal1.t_balance0 = '20202' ";

s2_4_2_2_val_z=" "+
            " prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 0, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper  " +
                " from usr_251_c4eta, dacctrn_dbt prov, daccblnc_dbt bal1, dsymbcash_dbt symb   "+
                " where stroka=242 and rubli=0 and t_account_receiver=c4et and bal1.t_account=t_account_payer  "+
                " AND symb.t_acctrnid = prov.t_acctrnid     "+
                " and prov.t_date_carry between to_date ( '"+begindate+"', 'dd.mm.yyyy' )  and  to_date ( '"+enddate+"', 'dd.mm.yyyy' ) "+
                " and bal1.t_chapter=prov.t_chapter and prov.t_chapter=1 "+
                " AND bal1.t_balance0 = '20202' ";

s2_4_2_2_rub_ = s2_4_2_2_pref + "2422," + s2_4_2_2_rub_z+
                " AND (TRIM (symb.t_symbol) = '13' OR TRIM (symb.t_symbol) = '16' OR TRIM (symb.t_symbol) = '23' OR TRIM (symb.t_symbol) = '31') ";
vstavit_c4eta(s2_4_2_2_rub_);
s2_4_2_2_rub_ = "select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2422 and rubli=1 ";

s2_4_2_2_val_ = s2_4_2_2_pref + "2422," + s2_4_2_2_val_z+
                " AND (TRIM (symb.t_symbol) = '13' OR TRIM (symb.t_symbol) = '16' OR TRIM (symb.t_symbol) = '23' OR TRIM (symb.t_symbol) = '31') ";
vstavit_c4eta(s2_4_2_2_val_);
s2_4_2_2_val_ = "select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=2422 and rubli=0 ";

// qqqqqqqqq
s2_4_2_2_1_rub = s2_4_2_2_pref + " 24221, " + s2_4_2_2_rub_z + "  AND TRIM (symb.t_symbol) = '14'  ";
vstavit_c4eta(s2_4_2_2_1_rub);
s2_4_2_2_1_rub = "select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=24221 and rubli=1 ";

s2_4_2_2_1_val = s2_4_2_2_pref + " 24221, " + s2_4_2_2_val_z + "  AND TRIM (symb.t_symbol) = '14'  ";
vstavit_c4eta(s2_4_2_2_1_val);
s2_4_2_2_1_val = "select count ( 1 ), round(nvl(sum ( summa ),0)/1000) from usr_251_prov where stroka=24221 and rubli=0 ";





s2_spr_rub = "INSERT INTO usr_251_prov " + 
      " SELECT  200, prov.t_account_payer, NVL( prov.t_account_receiver, chr(1) ), prov.t_date_carry, prov.t_sum_payer, 1, prov.t_ground, prov.t_shifr_oper, prov.t_kind_oper   " +
      "   FROM  dacctrn_dbt prov, daccblnc_dbt bal1, daccount_dbt acc1, daccount_dbt acc2 " +
      "  WHERE  prov.t_account_payer = bal1.t_account " +
      "           AND (acc1.t_account = prov.t_account_payer AND acc2.t_account = prov.t_account_receiver) " +
      "           AND (prov.t_chapter = bal1.t_chapter " +
      "                 AND acc1.t_chapter = acc2.t_chapter " +
      "                 AND acc1.t_chapter = prov.t_chapter " +
      "                 AND prov.t_chapter = 1) " +
      "           AND bal1.t_balance0 = '40821' " +
      "           AND (TRIM (prov.t_shifr_oper) = '01' OR TRIM (prov.t_shifr_oper) = '1' OR TRIM (prov.t_shifr_oper) = '16') " +
      "           AND prov.t_date_carry BETWEEN TO_DATE ('"+begindate+"', 'dd.mm.yyyy') AND TO_DATE ('"+enddate+"', 'dd.mm.yyyy') " +
      "           AND (acc1.t_type_account NOT LIKE '%П%' AND acc1.t_type_account NOT LIKE '%U%' AND acc1.t_type_account NOT LIKE '%Н%') " +
      "           AND (acc2.t_type_account NOT LIKE '%П%' AND acc2.t_type_account NOT LIKE '%U%' AND acc2.t_type_account NOT LIKE '%Н%') " ;
vstavit_c4eta(s2_spr_rub);
s2_spr_rub = "SELECT    COUNT (1), NVL (ROUND (SUM (summa) / 1000), 0) FROM     usr_251_prov WHERE      stroka = 200 AND rubli = 1 " ; 






s3_1_rub = "/* Formatted on 17.04.2012 14:43:24 (QP5 v5.115.810.9015) disa */ " + 
      "INSERT INTO usr_251_prov " +
      " SELECT  31, pr.payer, pr.receiver, pr.ddata, pr.summa, 1, pr.osnov, pr.shifr, pr.vid " +
      "   FROM  usr_251_prov pr, daccblnc_dbt bal2 " +
      "  WHERE  (pr.stroka IN (211, 212, 213, 214, 215, 216, 221, 222, 223, 224, 225, 226, 231, 232, 233, 234, 235, 236, 241, 242) " +
      "                 AND pr.rubli = 1) " +
      "           AND pr.receiver = bal2.t_account " +
      "           AND bal2.t_balance0 IN " +
      "                                         ('30109', '30112', '30113', '30122', '30123', '30230', '30231', '30214', '30110', '30114', '30115', '30213') " ;
vstavit_c4eta(s3_1_rub);
s3_1_rub = "SELECT      COUNT (1), NVL (ROUND (SUM (summa) / 1000), 0) FROM     usr_251_prov WHERE      stroka = 31 AND rubli = 1 " ; 

s3_1_val = "/* Formatted on 17.04.2012 14:43:24 (QP5 v5.115.810.9015) disa */ " + 
      "INSERT INTO usr_251_prov " +
      " SELECT  31, pr.payer, pr.receiver, pr.ddata, pr.summa, 0, pr.osnov, pr.shifr, pr.vid " +
      "   FROM  usr_251_prov pr, daccblnc_dbt bal2 " +
      "  WHERE  (pr.stroka IN (211, 212, 213, 214, 215, 216, 221, 222, 223, 224, 225, 226, 231, 232, 233, 234, 235, 236, 241, 242) " +
      "                 AND pr.rubli = 0) " +
      "           AND pr.receiver = bal2.t_account " +
      "           AND bal2.t_balance0 IN " +
      "                                         ('30109', '30112', '30113', '30122', '30123', '30230', '30231', '30214', '30110', '30114', '30115', '30213') " ;
vstavit_c4eta(s3_1_val);
s3_1_val = "SELECT      COUNT (1), NVL (ROUND (SUM (summa) / 1000), 0) FROM     usr_251_prov WHERE      stroka = 31 AND rubli = 0 " ; 



 /*


s2_4_2_2_rub=s2_4_2_2_m_rub+" "+
" AND (TRIM (symb.t_symbol) = '13' OR TRIM (symb.t_symbol) = '16' OR TRIM (symb.t_symbol) = '23' OR TRIM (symb.t_symbol) = '31') ";



s2_4_2_2_m_val="        /* Formatted on 23.01.2011 21:17:19 (QP5 v5.115.810.9015) disa */       "+
"       SELECT   COUNT (1), NVL (ROUND (SUM (prov.t_sum) / 1000), 0)    "+
"         FROM   darhdoc_dbt prov, daccount_dbt acc1, daccount_dbt acc2, daccblnc_dbt bal1, daccblnc_dbt bal2, dobjcode_dbt do2, dsymbcash_dbt symb     "+
"        WHERE   prov.t_chapter = 1     "+
"            AND t_account_payer = acc1.t_account       "+
"            AND t_account_receiver = acc2.t_account    "+
"            AND t_date_carry BETWEEN TO_DATE ('01.12.2010', 'dd.mm.rrrr') AND TO_DATE ('01.01.2011', 'dd.mm.rrrr')     "+
"            AND (acc1.t_type_account LIKE '%П%' or acc1.t_type_account  LIKE '%U%' or acc1.t_type_account  LIKE '%Н%') "+
"            AND acc1.t_chapter = acc2.t_chapter        "+
"            AND prov.t_chapter = acc1.t_chapter        "+
"            AND t_account_payer = bal1.t_account       "+
"            AND t_account_receiver = bal2.t_account    "+
"            AND bal1.t_chapter = bal2.t_chapter        "+
"            AND bal1.t_chapter = prov.t_chapter        "+
"            AND do2.t_objecttype = 3   "+
"            AND do2.t_codekind = 1     "+
"            AND acc2.t_client = do2.t_objectid "+
"            AND symb.t_applicationkey = TO_CHAR (prov.t_iapplicationkind, 'fm09999') || prov.t_applicationkey  "+
"            AND bal1.t_balance0 = '20202'      "+
"            AND not (do2.t_code = '010000060231' OR do2.t_code = '010000060430' OR do2.t_code = '010000060431')        "+
"            AND (bal2.t_balance0 = '40911' OR bal2.t_balance0 = '40912' OR bal2.t_balance0 = '40913')  ";

s2_4_2_2_val=s2_4_2_2_m_val+" "+
" AND (TRIM (symb.t_symbol) = '13' OR TRIM (symb.t_symbol) = '16' OR TRIM (symb.t_symbol) = '23' OR TRIM (symb.t_symbol) = '31') ";

s2_4_2_2_1_rub=s2_4_2_2_m_rub+" AND TRIM (symb.t_symbol) = '14' and not (do2.t_code = '010000060295' )";
s2_4_2_2_1_val=s2_4_2_2_m_val+" AND TRIM (symb.t_symbol) = '14' and not (do2.t_code = '010000060295' )";
*/
//s2_1_1_rub=" ";


         
/*        msgbox(begindate);
          msgbox(string(begindate));
          msgbox(           substr(string(begindate),7)                 );*/
/*
line_2_1_1(); 
line_2_1_1_1(); 
line_2_1_1_1_1(); 
line_2_1_3(); 
line_2_1_4(); 
line_2_1_5(); 

   */ 
  
message("----------------------- считается пункт 1.1-----------");
   line_1_1();
   useprogress(1);

message("----------------------- считается пункт 1.1.1-----------");
   line_1_1_1();
   useprogress(2);


message("----------------------- считается пункт 1.1.1.1-----------");
   line_1_1_1_1();
   useprogress(3);

message("----------------------- считается пункт 1.1.1.1.1-----------");
   line_1_1_1_1_1();
   useprogress(4);


message("----------------------- считается пункт 1.2-----------");
   line_1_2();
   useprogress(5);


message("----------------------- считается пункт 1.2.1-----------");
   line_1_2_1();
   useprogress(6);

message("----------------------- считается пункт 1.2.2-----------");
   line_1_2_2();    
   useprogress(7);


message("----------------------- считается пункт 1.2.2.1-----------");
   line_1_2_2_1();
   useprogress(8);

message("----------------------- считается пункт 1.2.2.1.2-----------");
   line_1_2_2_1_2();
   useprogress(9);

message("----------------------- считается пункт 1.3-----------");
   line_1_3();
   useprogress(10);

message("----------------------- считается пункт 2.1.1-----------");
                
   line_2_1_1();
   useprogress(11);

message("----------------------- считается пункт 2.1.1.1-----------");
   line_2_1_1_1();
   useprogress(12);


message("----------------------- считается пункт 2.1.1.1.1-----------");
   line_2_1_1_1_1();
   useprogress(13);


message("----------------------- считается пункт 2.1.2-----------");
   line_2_1_2(); 
   useprogress(14);

message("----------------------- считается пункт 2.1.3-----------");
   line_2_1_3();
   useprogress(15);

message("----------------------- считается пункт 2.1.4-----------");
 line_2_1_4();
   useprogress(16);

message("----------------------- считается пункт 2.1.5-----------");
                line_2_1_5();
   useprogress(17);
  
message("----------------------- считается пункт 2.1.6-----------");
                line_2_1_6();
   useprogress(18); 
message("----------------------- считается пункт 2.1.6.1---------");
                line_2_1_6_1();
   useprogress(18);  
  
message("----------------------- считается пункт 2.2.1-----------");
        line_2_2_1();  
   useprogress(19);

message("----------------------- считается пункт 2.2.1.1-----------");
        line_2_2_1_1();  
   useprogress(20);

message("----------------------- считается пункт 2.2.1.1.1-----------");
        line_2_2_1_1_1();  
   useprogress(21);


message("----------------------- считается пункт 2.2.2-----------");
        line_2_2_2();  
   useprogress(22);

message("----------------------- считается пункт 2.2.3-----------");
        line_2_2_3();  
   useprogress(23);
                 
message("----------------------- считается пункт 2.2.4-----------");
        line_2_2_4();  
   useprogress(24);

message("----------------------- считается пункт 2.2.5-----------");
        line_2_2_5();  
   useprogress(25);

message("----------------------- считается пункт 2.2.6-----------");
        line_2_2_6();  
   useprogress(26);

message("----------------------- считается пункт 2.2.6.1-----------");
        line_2_2_6_1();  
   useprogress(26);


message("----------------------- считается пункт 2.3.1-----------");
        line_2_3_1();  
   useprogress(27);


message("----------------------- считается пункт 2.3.3-----------");
        line_2_3_3();  
   useprogress(28);
                

message("----------------------- считается пункт 2.3.4-----------");
        line_2_3_4();  
   useprogress(29);



message("----------------------- считается пункт 2.3.5-----------");
        line_2_3_5();  
   useprogress(30);

message("----------------------- считается пункт 2.3.6-----------");
        line_2_3_6();  
   useprogress(31);



message("----------------------- считается пункт 2.4.1-----------");
    line_2_4_1();
   useprogress(32);

message("----------------------- считается пункт 2.4.1.1-----------");
    line_2_4_1_1();
   useprogress(33);

message("----------------------- считается пункт 2.4.1.2-----------");
    line_2_4_1_2();
   useprogress(34);


message("----------------------- считается пункт 2.4.1.2.1-----------");
    line_2_4_1_2_1(); 
   useprogress(35);

message("----------------------- считается пункт 2.4.2-----------");
    line_2_4_2();
   useprogress(36);

message("----------------------- считается пункт 2.4-----------");
    line_2_4();
   useprogress(37);


message("----------------------- считается пункт 2.4.2.1-----------");
    line_2_4_2_1();
   useprogress(38);


message("----------------------- считается пункт 2.4.2.2-----------");
    line_2_4_2_2();
   useprogress(39);
   

message("----------------------- считается пункт 2.4.2.2.1-----------");
    line_2_4_2_2_1();
   useprogress(40);

message("----------------------- считается пункт 'справочно' для раздела 2 ----------"); //03.04.2012 vihrov C-9859-6
    line_2_spr();
   useprogress(40);


      
//message("----------------------- считается пункт 2.5-----------");
//    line_2_5();
//   useprogress(35);

//message("----------------------- считается пункт 2.5.1-----------");
//    line_2_5_1();
//   useprogress(35);

    
message("----------------------- считается пункт 3.1-----------");
    line_3_1();
   useprogress(41);


message("----------------------- считается пункт 3.1.1-----------");
//    debugbreak;
    line_3_1_1(); 
   useprogress(42);


message("----------------------- считается пункт 3.4-----------");
    line_3_4();
   useprogress(43);

message("----------------------- считается пункт 3.4.1-----------");
    line_3_4_1();
   useprogress(44);



message("----------------------- считается пункт 4.1-----------");
    line_4_1();
   useprogress(45);


message("----------------------- считается пункт 4.1.1-----------");
    line_4_1_1();
   useprogress(46);
                  
message("----------------------- считается пункт 4.1.3-----------");
    line_4_1_3();
   useprogress(47);


message("----------------------- считается пункт 3.3-----------");
    line_3_3(); //расчитывается арифметически
   useprogress(48);

message("----------------------- считается пункт 3.3.1-----------");
    line_3_3_1(); // расчитывается арифметически
   useprogress(49);
                   
remprogress();  
  
   printReport();
end;


/*Точка входа в макрос*/
if (RunDialog(dlg, "Event"))                  
  calculate();
end; 


