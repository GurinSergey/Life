import iborwp, globals;

Macro Prn (Value,Currency_str,Value_str, Account_num, paymentid, doc_date, reply_date)
var ap = "\"";
var oBorwp = BORWPGetInterface();
var bImpl  = oBorwp.GetImplementationOrientedInterface();

var oMessForm,oMess,oClient,oCurBank,oCl;
var obj,Client,strtxt;

oMessForm=bImpl.GetMessageForm("4 1007");     /*Берем из БОУРМ нужную форму - письмо*/

oCurBank=oBorwp.GetCurrentBank();   //Берем банк

oClient=oCurBank.GetClient("1004965");

oMess=bImpl.CreateMessageOut(oClient,oMessForm);

oMess.mailDate = Date();
oMess.mailTime = Time();

oMess.number = string(paymentid);

oMess.GetField("subj").value="Извещение";

oMess.GetField("text").value=string("Банк     ",{NAME_BANK},"\n",
   "Клиент   ",oClient.Name,"\n",                                                           
   "\n",
   "                            УВЕДОМЛЕНИЕ № ",paymentid, " от ",{curdate},"\n",                                                                 
   "\n",
   "В пользу Вашего предприятия поступили средства в сумме ",Value," ",Currency_str,"\n",
   "(",Value_str,")," ,"\n",
   "которые зачислены на Ваш транзитный валютный  счет ", Account_num," ",Doc_date, " г." ,"\n",
   "Просим  в  срок до ",Reply_date," г. представить в банк Распоряжение по транзитному валютному счету и справку," ,"\n",
   "идентифицирующую поступившие средства.","\n",      
   "\n",
   "Ответственный  исполнитель   _____________________  (подпись)","\n",
   "уполномоченного  банка"    ,"\n",
   "","\n",
   "\n",
   "Банк     ",{NAME_BANK},"\n",
   "Клиент   ",oClient.Name,"\n",                                                           
   "\n",
   "                            УВЕДОМЛЕНИЕ № ",paymentid, " от ",{curdate},"\n",                                                                 
   "\n",
   "В пользу Вашего предприятия поступили средства в сумме ",Value," ",Currency_str,"\n",
   "(",Value_str,"),","\n", 
   "которые зачислены на Ваш транзитный валютный  счет ", Account_num," ",Doc_date, " г.","\n", 
   "Просим  в  срок до ",Reply_date," г. представить в банк Распоряжение по транзитному валютному счету и справку," ,"\n",
   "идентифицирующую поступившие средства.","\n",      
   "\n",
   "Ответственный  исполнитель   _____________________  (подпись)","\n",
   "уполномоченного  банка"    ,"\n",
   "");



//oMess.GetField("text").value="Днепр чемпион!";

oMess.state=0;
oMess.mode=1;

/*var fileList = oMess.GetAttachmentList();

fileList.insert("C:\\Databases\\Зобр026.jpg","RS");

oMess.insert;*/

println(oMess.GetField("text").value);

End;



Macro Prn1 (Value,Currency_str,Value_str, Account_num, paymentid)
var ap = "\"";
var oBorwp = BORWPGetInterface();
var bImpl  = oBorwp.GetImplementationOrientedInterface();

var oMessForm,oMess,oClient,oCurBank,oCl;
var obj,Client,strtxt;

oMessForm=bImpl.GetMessageForm("4 1007");     /*Берем из БОУРМ нужную форму - письмо*/

oCurBank=oBorwp.GetCurrentBank();   //Берем банк

oClient=oCurBank.GetClient("1004965");

oMess=bImpl.CreateMessageOut(oClient,oMessForm);

oMess.mailDate = Date();
oMess.mailTime = Time();

oMess.number = string(paymentid);

oMess.GetField("subj").value="Извещение";

oMess.GetField("text").value=string("   ","\n",
   "     "+{NAME_BANK},"\n",
   "\n",
   "     ",oClient.name ,"\n",
   "   ","\n",
   "                               Извещение № ",paymentid,"\n",
   "   ","\n",
   "                               от  ",{curdate},"\n",
   "   ","\n",
   "     В пользу Вашего предприятия поступила валюта Российской Федерации   ","\n",
   "     " ,Value," ",Currency_str," ",Value_str,"),","\n", 
   "     которая зачислена на ваш счет № ", Account_num,".   ","\n",
   "   ","\n",
   "     Просим Вас предоставить необходимые документы, идентифицирующие   ","\n",
   "     поступившие средства   ","\n",
   "     -   Договор/контракт/счет, предусматривающие осуществление расчетов   ","\n",
   "     в рублях РФ.Если операция по поступившим средствам не связана с   ","\n",
   "     оформлением паспорта сделки, то обосновывающие документы   ","\n",
   "     договор/контракт/счет) или иную информацию необходимо предоставить   ","\n",
   "     в срок, не позднее 15 календарных дней, следующих за месяцем, в   ","\n",
   "     течение которого поступила валюта РФ.Если операция связана с   ","\n",
   "     оформлением или уже оформленным  паспортом сделки,то представляется   ","\n",
   "     также   ","\n",
   "     - * Справка о поступлении валюты РФ в 2 экз.)   ","\n",
   "     -   Справка о подтверждающих документах и сами  документы,   ","\n",
   "     подтверждающие ввоз/вывоз товаров с таможенной территории РФ; а также   ","\n",
   "     выполнение работ,оказание услуг и результатов интеллектуальной   ","\n",
   "     деятельности.   ","\n",
   "   ","\n",
   "   ","\n",
   "   ","\n",
   "       Ответственное лицо банка     ____________________________   ","\n",
   "   ","\n",
   "   ","\n",
   "   ","\n",
   "   ","\n",
   "   ","\n",
   "     Паспорт сделки оформляется при ввозе/вывозе товаров, за выполняемые   ","\n",
   "     работы, оказываемые услуги, передаваемую информацию и результаты   ","\n",
   "     интеллектуальной деятельности, в том числе исключительные права на   ","\n",
   "     них, по контрактам, заключенным между резидентами и нерезидентами,   ","\n",
   "     если общая сумма контракта превышает в эквиваленте 5000 долларов США,   ","\n",
   "     а также при предоставлении займов между резидентами и нерезидентами   ","\n",
   "     в иностранной валюте и в валюте РФ.   ","\n",
   "     *  Справка о поступлении валюты РФ должна быть предоставлена в срок,   ","\n",
   "     не превышающий 15 календарных дней, следующих за месяцем, в течение   ","\n",
   "     которого были осуществлены валютные операции.");


//oMess.GetField("text").value="Днепр чемпион!";

oMess.state=0;
oMess.mode=1;

/*var fileList = oMess.GetAttachmentList();

fileList.insert("C:\\Databases\\Зобр026.jpg","RS");

oMess.insert;*/

println(oMess.GetField("text").value);

End;

prn (500, 0, 84, 5, 11);




