/****************************************************************************/
/*                   R-Style SoftWare Lab, RS-Bank 6.0                      */
/****************************************************************************/
/*                  Подсистема "Межбанковские расчеты"                      */
/*  Макроса формирования имени файла экспорта по транспорту УФЭБС           */
/*  для ФЗАО АКБ "Экспресс-Волга" г.Волгоград                               */
/*  Имя файла: ufGenRef.mac                                                 */
/*  Создан:  14.09.11                                         Гуцу Е.       */
/****************************************************************************/

import globals, "wlmfr_lib.mac";

macro GetFileName( SeqValue, ObjKind, ObjAddr )
    var refer, error;
    var Дата, День, Месяц, Год;

    Дата = {curdate};
    DateSplit(Дата, День, Месяц, Год);

  /*АЛГОРИТМ ФОРМИРОВАНИЯ ФАЙЛА МФР  
    Файл переименовывается по виду: a1DNN20k.z07, где
    D - день месяца (цирфры от 1 до 9, далее 10 - A, 11 - B, 12 - C... 31 - V), то есть дата это один символ.
    NN - порядковый номер отправляемого рейса (два символа), каждый день номер рейса начинается с 00 (то есть первый 00, второй 01 и т.д.)

    Пример, отправка второго рейса 30 мая 2011: a1U0220K.z07
            отправка первого рейса 7 июля 2011: a170020k.z07
  */
    
    refer = string( "a1", strUpr(_36(День)), (SeqValue-1):2, "20k",".z07");
    refer = strsubst( refer, " ", "0" );

    return refer;
end;
