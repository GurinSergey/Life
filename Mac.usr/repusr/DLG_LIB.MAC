/**************************************************************************/
/* Библиотека процедур работы с окнами диалога                            */
/**************************************************************************/
Array aFldHead,aaFldList,aaFldData;

/******************/
Macro ClearRecMenu
/******************/
/* Очистка массивов меню, вызываемого по F3 в диалоговой панели */

  asize(aFldHead,0);
  asize(aaFldList,0);
  asize(aaFldData,0);

End; /* ClearRecMenu */


/*************************************/
Macro InsRecMenu(id,sHead,aData,aList)
/*************************************/
/* Инициализация массивов меню, вызываемого по F3 в диалоговой панели */
/* id - номер поля в диалоговой панели                                */

  aFldHead(id)  = sHead; /* заголовок меню */
  aaFldData(id) = aData; /* массив выбираемых значений */
  If (ValType(aList) != 0)
  /* массив пунктов меню */
     aaFldList(id) = aList; /* в массив записывается ссылка на другой массив */
  Else
  /* массив пунктов не задан, и потому совпадает с массивом */
  /* выбираемых значений                                    */
     aaFldList(id) = aData;
  End;

End; /* InsRecMenu */


/************************/
Macro VibNum(field,aName)
/************************/

/* Определение номера выбранного пункта меню */
/* field - значения поля диалоговой панели   */
/* aName - имя массива выбираемых значений   */
/* Серихин Л.В. 09.07.1998                   */

Var i;

   i = 0;
   While ( ValType(aName(i))!=V_UNDEF )
     If ( field==aName(i) )
       Return i;
     End;
     i = i+1;
   End;

   Return -1;

End;
