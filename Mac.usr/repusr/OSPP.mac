/*¯¨áì á¢®¤­®£® ¯« â¥¦­®£® ¯®àãç¥­¨ï                                  */
/*                                                                     */
/*                                                                     */
/*’¨å®¬¨à®¢ €.. 05.08.2009                    ‚¥àá¨ï 1.0              */

var i, m, k, p, n, packet, pos, inter, reportdate, year, month, day, depart, sum, priority, shifroper, numberpack;
var Fulloutput,  out,  output="\\spp";                    
array strings;
import RSD, Š «¥­¤ àì, payminter, globals;

const  KEY_F2      =316;
const  KEY_F3      =317;
const KEY_ESC      = 27;
const KEY_ENTER    = 13;

var Fulloutputl, outl, outputl="ospp.lbr";                    

GetRegistryValue("BANK_INI\\™ˆ… €€Œ…’›\\„ˆ…Š’ˆˆ\\LBRDIR",2,outl);
Fulloutputl = FindPath(outputl, outl);
var dlg = TRecHandler("spp", fulloutputl, TRUE); 

private macro Sess()
var      qwery = rsdcommand(" Select  ses.t_number , mes.t_MESID "+ 
              "  From DWlPm_dbt wlp, DWlMesLnk_dbt lnk, DWlMes_dbt mes, dwlsess_dbt ses "+ 
              "  Where wlp.t_PaymentID in (SELECT   pm.t_paymentid "+
    "FROM dpmpaym_dbt pm, dwlpm_dbt wl, dpmrmprop_dbt rm, dpmprop_dbt pr "+
   "WHERE pm.t_paymentid = wl.t_paymentid "+
   "AND pm.t_paymentid = pr.t_paymentid "  +
   "and pr.t_group=1 " +
   "and pr.t_issender=chr(0) "  +
     "AND pm.t_paymentid = rm.t_paymentid "+
     "AND pm.t_fiid = 0 "+
     "AND pm.t_valuedate =  ? "+
     "AND rm.t_shifroper IN ('02') "+
     "AND wl.t_propstatus >3000 ) "+
              "    and lnk.t_ObjKind   = '501' "+
              "    and lnk.t_ObjID     = wlp.t_WlPmID "+ 
              "    and mes.t_MesID     = lnk.t_MesID "+
              "    and ses.t_SessionID = mes.t_SessionID");
qwery.addparam("date", RSDBP_IN,reportdate);
var      rs1 = rsdRecordSet(qwery);
var date1, mon;
datesplit(reportdate,date1,mon,null);
var str = "986"+string(date1)+string(mon);
//if (rs1.movenext())
//str = str+rs1.value(0);
//str = str +rs1.value(1);
//end;
/*      while (rs1.MoveNext())

         str = str +rs1.value(1);
      end;*/

      return str;

end;


private macro sumf(áã¬¬ )
if (substr(áã¬¬ ,index(áã¬¬ )) == "00")
return string(substr(áã¬¬ ,(strlen(áã¬¬ )-3)),"=");
else
return (strsubst(áã¬¬ ,".","-"));
end;
end;



private macro rcc(id)

var  sl=rsdcommand("select t_name from dparty_dbt where t_partyid=(select t_objectid from dobjcode_dbt where t_codekind=3 and t_code=(select bank.t_bic_rcc "+
 "from dbankdprt_dbt bank, ddp_dep_dbt dep where dep.t_code=? and dep.t_partyid=bank.t_partyid)) ");

sl.addparam("dep",RSDBP_IN,id);
sl.execute();
var  DataS=rsdrecordset(sl);

  if( DataS.moveNext())
    return DataS.value("t_name");
  else
    msgbox("‘ã¡ê¥ªâ ­¥ ­ ©¤¥­ ¢ party.dbt");
    return 0;
  end;

END;

private macro bicb(id)

var  sl= rsdcommand("select obj.t_code from dobjcode_dbt obj where "+
 "obj.t_objectid=? and obj.t_codekind=3 ");

sl.addparam("dep",RSDBP_IN,id);
sl.execute();
var  DataS=rsdrecordset(sl);

  if( DataS.moveNext())
    return DataS.value("t_code");
  else
    msgbox("‘ã¡ê¥ªâ ­¥ ­ ©¤¥­ ¢ party.dbt");
    return 0;
  end;

END;

private macro bicrcc(id)

var  sl= rsdcommand("select bank.t_bic_rcc from dbankdprt_dbt bank, ddp_dep_dbt dep where dep.t_code=? and dep.t_partyid=bank.t_partyid");

sl.addparam("dep",RSDBP_IN,id);
sl.execute();
var  DataS=rsdrecordset(sl);

  if( DataS.moveNext())
    return DataS.value("t_bic_rcc");
  else
    msgbox("‘ã¡ê¥ªâ ­¥ ­ ©¤¥­ ¢ party.dbt");
    return 0;
  end;

END;

/* ©¤¥¬ ¨¬ï ¯® Partyid*/
private macro GetClientName(id)

var  sl=rsdcommand(" select part.t_name from dparty_dbt part, ddp_dep_dbt dep where dep.t_code="+id+" and dep.t_partyid=part.t_partyid");

sl.addparam("dep",RSDBP_IN,id);
sl.execute();
var  DataS=rsdrecordset(sl);

  if( DataS.moveNext())
    return DataS.value("t_name");
  else
    if (id !=0)
       msgbox("‘ã¡ê¥ªâ ­¥ ­ ©¤¥­ ¢ party.dbt");
       return 0;
    else
      return "€ €Š à®¡¨§­¥á¡ ­ª";
    end;
  end;

END;

private macro outall
var cmd, rsd;
 var sql = rsdcommand("SELECT   rm.t_shifroper, rm.t_number, pm.t_numberpack, pm.t_valuedate, "+
       "  pm.t_amount, pm.t_payeraccount, pm.t_receiverbankid, "+
       "  pm.t_receiveraccount, rm.t_receivercorraccnostro, rm.t_priority "+
    "FROM dpmpaym_dbt pm, dwlpm_dbt wl, dpmrmprop_dbt rm, dpmprop_dbt pr "+
   "WHERE pm.t_paymentid = wl.t_paymentid "+
   "AND pm.t_paymentid = pr.t_paymentid "  +
   "and pr.t_group=1 " +
   "and pr.t_issender=chr(0) "  +
     "AND pm.t_paymentid = rm.t_paymentid "+
     "AND pm.t_fiid = 0 "+
     "AND pr.t_transferdate =  ? "+
     "AND rm.t_shifroper NOT IN ('02') "+ //à®â¨¢®à¥ç¨â «®£¨ª¥, ­® § ï¢ª  I-012981 ˆ¬¥­­® â ª®¢ . Tikh
     "AND rm.t_shifroper in ('02') "+
     "AND wl.t_propstatus >3000 "+
     "ORDER BY rm.t_shifroper, pm.t_numberpack, pm.t_amount, rm.t_priority ");
 sql.addparam("date",RSDBP_IN,reportdate);
 sql.execute();
 var dataset = RSDRECORDSET(sql);
 i=0;
 n=0;
 GetRegistryValue("BANK_INI\\™ˆ… €€Œ…’›\\„ˆ…Š’ˆˆ\\TEXTDIR",2,out);
 Fulloutput = out + output;
// GetTxtFileName("ospp");                    
 setoutput(fulloutput,false);                                                                                         
 sum=0;
 if (dataset.movenext())

cmd = rsdcommand("SELECT   sum(pm.t_amount) as amount, count(*) as cnt "+
    "FROM dpmpaym_dbt pm, dwlpm_dbt wl, dpmrmprop_dbt rm, dpmprop_dbt pr "+
   "WHERE pm.t_paymentid = wl.t_paymentid "+
   "AND pm.t_paymentid = pr.t_paymentid "  +
   "and pr.t_group=1 " +
   "and pr.t_issender=chr(0) "  +
     "AND pm.t_paymentid = rm.t_paymentid "+
     "AND pm.t_fiid = 0 "+
     "AND pr.t_transferdate =  ? "+
     " AND pr.t_bankcode like ('044%')"+
     "AND rm.t_shifroper IN ('02') "+
     "AND rm.t_shifroper NOT IN ('02') "+ //à®â¨¢®à¥ç¨â «®£¨ª¥, ­® § ï¢ª  I-012981 ˆ¬¥­­® â ª®¢ 
     "AND wl.t_propstatus >3000 ");
//     "AND rm.t_shifroper = ? "+
//     "AND pm.t_numberpack = ? "+
//     "AND rm.t_priority = ? ");
 cmd.addparam("date",RSDBP_IN, reportdate);
// cmd.addparam("shifr",RSDBP_IN,dataset.value("t_shifroper"));
// cmd.addparam("pack",RSDBP_IN,dataset.value("t_numberpack"));
// cmd.addparam("pr",RSDBP_IN,dataset.value("t_priority"));
 cmd.execute();
 rsd = RSDRECORDSET(cmd);
 if (rsd.movenext())
debugbreak;
  strings[asize(strings)] = "(3R(s0p13.50h8.5v0s0b20T&l1X&l8D&l0O&a7L&l2E                                             &l8D";
  strings[asize(strings)] = "";
  strings[asize(strings)] = "                                                                                  ÚÄÄÄÄÄÄÄ¿";
  strings[asize(strings)] = "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ    ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ                                          ³0401060³";
  strings[asize(strings)] = "®áâã¯.¢ ¡ ­ª ¯« â.   ‘¯¨á ­® á® áç.¯« â.                                         ÀÄÄÄÄÄÄÄÙ";
  strings[asize(strings)] = "";
  strings[asize(strings)] = "";
  strings[asize(strings)] = "‘‚„…                                                                            ÚÄÄÄÄ¿       &l8D";
  strings[asize(strings)] = "‹€’…†… “—…ˆ… ü " + substr(strsubst(string(reportdate),".",""),1,4) + "                  " + Date(Reportdate) + "                             ³    ³       &l3.45C";
  strings[asize(strings)] = "                                       ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ   ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ   ÀÄÄÄÄÙ       &l3.45C";
  strings[asize(strings)] = "                                              „ â                ‚¨¤ ¯« â¥¦                     &l3.45C";
  strings[asize(strings)] = "          ³                                                                                     &l3.45C";
  strings[asize(strings)] = "‘ã¬¬      ³  " + RubToStr(string(rsd.value("amount")),true)+" &l3.45C";
  strings[asize(strings)] = "          ³                                                                                     &l8D";
  strings[asize(strings)] = "¯à®¯¨áìî  ³                                                                                     &l3.45C";
  strings[asize(strings)] = "          ³                                                                                     &l8D";
  strings[asize(strings)] = "          ³                                                                                     &l3.45C";
  strings[asize(strings)] = "ÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ&l8D";
  var StrInn, StrKPP;
/*  if (SplitFullInn(GetPartyINN({SelfId}, 1), StrInn, StrKPP)==0)
   strings[asize(strings)] = "ˆ "+string(StrINN:15)+"       ³ Š "+string(StrKPP:15)+"      ³ ‘ã¬¬  ³ "+money((rsd.value("amount")):f)+" &l3.45C";
  else*/
   strings[asize(strings)] = "ˆ                       ³ Š                      ³ ‘ã¬¬  ³ "+sumf(string(money(rsd.value("amount")):f))+" &l3.45C";
/*  end;*/
  strings[asize(strings)] = "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´       ³                                  &l8D";
  strings[asize(strings)] = " € €Š \"ˆ‡…‘€Š\" £. Œ®áª¢                    ³       ³                                  &l3.45C";
  strings[asize(strings)] = "                                                     ³       ³                                  &l8D";
  strings[asize(strings)] = "                                                     ³       ³                                  &l3.45C";
  strings[asize(strings)] = "                                                     ÃÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ&l8D";
  strings[asize(strings)] = "                                                     ³ ‘ç. ü ³ "+{CORAC_Bank}+"             &l3.45C";
  strings[asize(strings)] = "                                                     ³       ³                                  &l8D";
  strings[asize(strings)] = "                                                     ³       ³                                  &l3.45C";
  strings[asize(strings)] = "                                                     ³       ³                                  &l8D";
  strings[asize(strings)] = "« â¥«ìé¨ª                                           ³       ³                                  &l3.45C";
  strings[asize(strings)] = "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄ´                                  &l8D";
  strings[asize(strings)] = " …“ Œ‘Š‚‘Šƒ ƒ’“ €Š€ ‘‘ˆˆ, ƒ. Œ‘Š‚€ 35    ³ ˆŠ   ³ "+string("044525000")+" &l3.45C";
  strings[asize(strings)] = "                                                     ÃÄÄÄÄÄÄÄ´                                  &l8D";
  strings[asize(strings)] = "                                                     ³ ‘ç. ü ³                                  &l3.45C";
  strings[asize(strings)] = "                                                     ³       ³                                  &l8D";
  strings[asize(strings)] = " ­ª ¯« â¥«ìé¨ª                                      ³       ³                                  &l3.45C";
  strings[asize(strings)] = "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ&l8D";
  strings[asize(strings)] = "  §­ë¥                                              ³ ˆŠ   ³                                  &l3.45C";
  strings[asize(strings)] = "                                                     ÃÄÄÄÄÄÄÄ´                                  &l8D";
  strings[asize(strings)] = "                                                     ³ ‘ç. ü ³                                  &l3.45C";
  strings[asize(strings)] = "                                                     ³       ³                                  &l8D";
  strings[asize(strings)] = " ­ª ¯®«ãç â¥«ï                                      ³       ³                                  &l3.45C";
  strings[asize(strings)] = "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄ´                                  &l8D";
  strings[asize(strings)] = "ˆ                       ³ Š                      ³ ‘ç. ü ³                                  &l3.45C";
  strings[asize(strings)] = "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´       ³                                  &l8D";
  strings[asize(strings)] = "  §­ë¥                                              ³       ³                                  &l3.45C";
  strings[asize(strings)] = "                                                     ³       ³                                  &l8D";
  strings[asize(strings)] = "                                                     ³       ³                                  &l3.45C";
  strings[asize(strings)] = "                                                     ÃÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄ&l8D";
  strings[asize(strings)] = "                                                     ³‚¨¤.®¯.³          ³‘à®ª.¯« â.³            &l3.45C";
  strings[asize(strings)] = "                                                     ÃÄÄÄÄÄÄÄ´          ÃÄÄÄÄÄÄÄÄÄÄ´            &l8D";
  strings[asize(strings)] = "                                                     ³ §.¯«.³          ³ç¥à.¯« â.³  &l3.45C";
  strings[asize(strings)] = "                                                     ÃÄÄÄÄÄÄÄ´          ÃÄÄÄÄÄÄÄÄÄÄ´            &l8D";
  strings[asize(strings)] = "®«ãç â¥«ì                                           ³Š®¤    ³          ³¥§. ¯®«¥ ³            &l3.45C";
  strings[asize(strings)] = "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÂÄÄÄÄÄÄÄÄÁÄÄÄÂÄÄÄÁÄÄÄÄÄÄÄÄÄÄÁÄÄÄÂÄÄÄÄÄÄÁÄÄÄÄÄÂÄÄÄÄÄÄ&l8D";
  strings[asize(strings)] = "                       ³               ³    ³            ³                  ³            ³      &l3.45C";
  strings[asize(strings)] = "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄ&l8D";
  strings[asize(strings)] = "                                                                                                &l3.45C";
//  strings[asize(strings)] = " Š®«-¢® ¤®ª-â®¢ - "+int(rsd.value("cnt"))+" &l3.45C";
  strings[asize(strings)] = " « â¥¦¨ ¢ á®®â¢¥âáâ¢¨¨ á à¥¥áâà ¬¨ ¯à®¢¥¤¥­­ëå ¯« â¥¦¥©, ¯¥à¥¤ ­­ëå ¯® ª ­ « ¬ á¢ï§¨           &l3.45C";
  strings[asize(strings)] = " " + Date(reportdate) + ". “­¨ª «ì­ë¥ ­®¬¥à  à¥¥áâà®¢ ü"+sess+"                    &l8D";
  strings[asize(strings)] = "                                                                                                &l3.45C";
  strings[asize(strings)] = "                                                                                                &l8D";
  strings[asize(strings)] = "                                                                                                &l3.45C";
  strings[asize(strings)] = "                                                                                                &l8D";
  strings[asize(strings)] = "                                                                                                &l8D";
  strings[asize(strings)] = "                                                                                                &l3.45C";
  strings[asize(strings)] = "                                                                                                &l8D";
  strings[asize(strings)] = " §­ ç¥­¨¥ ¯« â¥¦                                                                               &l3.45C";
  strings[asize(strings)] = "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ&l8D";
  strings[asize(strings)] = "                           ®¤¯¨á¨                                â¬¥âª¨ ¡ ­ª                  &l3.45C";
  strings[asize(strings)] = "                                                                                                &l8D";
  strings[asize(strings)] = "                                                                                                &l3.45C";
  strings[asize(strings)] = "                                                                                                &l8D";
  strings[asize(strings)] = "                                                                                                &l3.45C";
  strings[asize(strings)] = "                    ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ                                            &l8D";
  strings[asize(strings)] = "      Œ..                                                                                      &l3.45C";
  strings[asize(strings)] = "                                                                                                &l8D";
  strings[asize(strings)] = "                                                                                                &l3.45C";
  strings[asize(strings)] = "                                                                                                &l8D";
  strings[asize(strings)] = "                                                                                                &l3.45C";
  strings[asize(strings)] = "                    ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ                                            &l8D";
  strings[asize(strings)] = "                                                                                                &l8D";
  strings[asize(strings)] = "                                                                                                &l3.45C";
  strings[asize(strings)] = "                                                                                                &l8D";
  strings[asize(strings)] = "                                                                                                &l3.45C";
  strings[asize(strings)] = "                                                                                                &l8D";

 end;

  else
 debugbreak;
  strings[asize(strings)] = "(3R(s0p13.50h8.5v0s0b20T&l1X&l8D&l0O&a7L&l2E                                             &l8D";
  strings[asize(strings)] = "";
  strings[asize(strings)] = "                                                                                  ÚÄÄÄÄÄÄÄ¿";
  strings[asize(strings)] = "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ    ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ                                          ³0401060³";
  strings[asize(strings)] = "®áâã¯.¢ ¡ ­ª ¯« â.   ‘¯¨á ­® á® áç.¯« â.                                         ÀÄÄÄÄÄÄÄÙ";
  strings[asize(strings)] = "";
  strings[asize(strings)] = "";
  strings[asize(strings)] = "‘‚„…                                                                            ÚÄÄÄÄ¿       &l8D";
  strings[asize(strings)] = "‹€’…†… “—…ˆ… ü " + substr(strsubst(string(reportdate),".",""),1,4) + "                  " + Date(Reportdate) + "                             ³    ³       &l3.45C";
  strings[asize(strings)] = "                                       ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ   ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ   ÀÄÄÄÄÙ       &l3.45C";
  strings[asize(strings)] = "                                              „ â                ‚¨¤ ¯« â¥¦                     &l3.45C";
  strings[asize(strings)] = "          ³                                                                                     &l3.45C";
  strings[asize(strings)] = "‘ã¬¬      ³  " + RubToStr(string(0),true)+" &l3.45C";
  strings[asize(strings)] = "          ³                                                                                     &l8D";
  strings[asize(strings)] = "¯à®¯¨áìî  ³                                                                                     &l3.45C";
  strings[asize(strings)] = "          ³                                                                                     &l8D";
  strings[asize(strings)] = "          ³                                                                                     &l3.45C";
  strings[asize(strings)] = "ÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ&l8D";
/*  if (SplitFullInn(GetPartyINN({SelfId}, 1), StrInn, StrKPP)==0)
   strings[asize(strings)] = "ˆ "+string(StrINN:15)+"       ³ Š "+string(StrKPP:15)+"      ³ ‘ã¬¬  ³ "+money((rsd.value("amount")):f)+" &l3.45C";
  else*/
   strings[asize(strings)] = "ˆ                       ³ Š                      ³ ‘ã¬¬  ³ 0= &l3.45C";
/*  end;*/
  strings[asize(strings)] = "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´       ³                                  &l8D";
  strings[asize(strings)] = " € €Š \"ˆ‡…‘€Š\" £. Œ®áª¢                    ³       ³                                  &l3.45C";
  strings[asize(strings)] = "                                                     ³       ³                                  &l8D";
  strings[asize(strings)] = "                                                     ³       ³                                  &l3.45C";
  strings[asize(strings)] = "                                                     ÃÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ&l8D";
  strings[asize(strings)] = "                                                     ³ ‘ç. ü ³ "+{CORAC_Bank}+"             &l3.45C";
  strings[asize(strings)] = "                                                     ³       ³                                  &l8D";
  strings[asize(strings)] = "                                                     ³       ³                                  &l3.45C";
  strings[asize(strings)] = "                                                     ³       ³                                  &l8D";
  strings[asize(strings)] = "« â¥«ìé¨ª                                           ³       ³                                  &l3.45C";
  strings[asize(strings)] = "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄ´                                  &l8D";
  strings[asize(strings)] = " …“ Œ‘Š‚‘Šƒ ƒ’“ €Š€ ‘‘ˆˆ, ƒ. Œ‘Š‚€ 35    ³ ˆŠ   ³ "+string("044525000")+" &l3.45C";
  strings[asize(strings)] = "                                                     ÃÄÄÄÄÄÄÄ´                                  &l8D";
  strings[asize(strings)] = "                                                     ³ ‘ç. ü ³                                  &l3.45C";
  strings[asize(strings)] = "                                                     ³       ³                                  &l8D";
  strings[asize(strings)] = " ­ª ¯« â¥«ìé¨ª                                      ³       ³                                  &l3.45C";
  strings[asize(strings)] = "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ&l8D";
  strings[asize(strings)] = "  §­ë¥                                              ³ ˆŠ   ³                                  &l3.45C";
  strings[asize(strings)] = "                                                     ÃÄÄÄÄÄÄÄ´                                  &l8D";
  strings[asize(strings)] = "                                                     ³ ‘ç. ü ³                                  &l3.45C";
  strings[asize(strings)] = "                                                     ³       ³                                  &l8D";
  strings[asize(strings)] = " ­ª ¯®«ãç â¥«ï                                      ³       ³                                  &l3.45C";
  strings[asize(strings)] = "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄ´                                  &l8D";
  strings[asize(strings)] = "ˆ                       ³ Š                      ³ ‘ç. ü ³                                  &l3.45C";
  strings[asize(strings)] = "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´       ³                                  &l8D";
  strings[asize(strings)] = "  §­ë¥                                              ³       ³                                  &l3.45C";
  strings[asize(strings)] = "                                                     ³       ³                                  &l8D";
  strings[asize(strings)] = "                                                     ³       ³                                  &l3.45C";
  strings[asize(strings)] = "                                                     ÃÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄ&l8D";
  strings[asize(strings)] = "                                                     ³‚¨¤.®¯.³          ³‘à®ª.¯« â.³            &l3.45C";
  strings[asize(strings)] = "                                                     ÃÄÄÄÄÄÄÄ´          ÃÄÄÄÄÄÄÄÄÄÄ´            &l8D";
  strings[asize(strings)] = "                                                     ³ §.¯«.³          ³ç¥à.¯« â.³  &l3.45C";
  strings[asize(strings)] = "                                                     ÃÄÄÄÄÄÄÄ´          ÃÄÄÄÄÄÄÄÄÄÄ´            &l8D";
  strings[asize(strings)] = "®«ãç â¥«ì                                           ³Š®¤    ³          ³¥§. ¯®«¥ ³            &l3.45C";
  strings[asize(strings)] = "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÂÄÄÄÄÄÄÄÄÁÄÄÄÂÄÄÄÁÄÄÄÄÄÄÄÄÄÄÁÄÄÄÂÄÄÄÄÄÄÁÄÄÄÄÄÂÄÄÄÄÄÄ&l8D";
  strings[asize(strings)] = "                       ³               ³    ³            ³                  ³            ³      &l3.45C";
  strings[asize(strings)] = "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄ&l8D";
  strings[asize(strings)] = "                                                                                                &l3.45C";
//  strings[asize(strings)] = " Š®«-¢® ¤®ª-â®¢ - "+int(rsd.value("cnt"))+" &l3.45C";
  strings[asize(strings)] = " « â¥¦¨ ¢ á®®â¢¥âáâ¢¨¨ á à¥¥áâà ¬¨ ¯à®¢¥¤¥­­ëå ¯« â¥¦¥©, ¯¥à¥¤ ­­ëå ¯® ª ­ « ¬ á¢ï§¨           &l3.45C";
  strings[asize(strings)] = " " + Date(reportdate) + ". “­¨ª «ì­ë¥ ­®¬¥à  à¥¥áâà®¢ ü 0";
  strings[asize(strings)] = "                                                                                                &l3.45C";
  strings[asize(strings)] = "                                                                                                &l8D";
  strings[asize(strings)] = "                                                                                                &l3.45C";
  strings[asize(strings)] = "                                                                                                &l8D";
  strings[asize(strings)] = "                                                                                                &l8D";
  strings[asize(strings)] = "                                                                                                &l3.45C";
  strings[asize(strings)] = "                                                                                                &l8D";
  strings[asize(strings)] = " §­ ç¥­¨¥ ¯« â¥¦                                                                               &l3.45C";
  strings[asize(strings)] = "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ&l8D";
  strings[asize(strings)] = "                           ®¤¯¨á¨                                â¬¥âª¨ ¡ ­ª                  &l3.45C";
  strings[asize(strings)] = "                                                                                                &l8D";
  strings[asize(strings)] = "                                                                                                &l3.45C";
  strings[asize(strings)] = "                                                                                                &l8D";
  strings[asize(strings)] = "                                                                                                &l3.45C";
  strings[asize(strings)] = "                    ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ                                            &l8D";
  strings[asize(strings)] = "      Œ..                                                                                      &l3.45C";
  strings[asize(strings)] = "                                                                                                &l8D";
  strings[asize(strings)] = "                                                                                                &l3.45C";
  strings[asize(strings)] = "                                                                                                &l8D";
  strings[asize(strings)] = "                                                                                                &l3.45C";
  strings[asize(strings)] = "                    ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ                                            &l8D";
  strings[asize(strings)] = "                                                                                                &l8D";
  strings[asize(strings)] = "                                                                                                &l3.45C";
  strings[asize(strings)] = "                                                                                                &l8D";
  strings[asize(strings)] = "                                                                                                &l3.45C";
  strings[asize(strings)] = "                                                                                                &l8D";

 end;

/*  strings[asize(strings)] = "";

  strings[asize(strings)] = "(3R(s0p13.5h8.5v0s0b0T&l1X&l8D&l0O&a5L";
  strings[asize(strings)] = string( {Name_Bank}:43:l )+" &l16D";
  strings[asize(strings)] = "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ &l8D";
  strings[asize(strings)] = "ˆŠ " + string({MFO_Bank}:9:l)+" &l16D";
  strings[asize(strings)] = "    ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ &l8D";
  strings[asize(strings)] = "Š/c " + {CORAC_Bank}+" &l16D";
  strings[asize(strings)] = "    ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ &l8D";
  strings[asize(strings)] = "ƒŠ–/Š– " + string( rcc({operdprt}):50:l)+" &l16D";
  strings[asize(strings)] = "         ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ &l8D";
  strings[asize(strings)] = "ˆŠ " + string(bicrcc({operdprt}):9)+" &l16D";
  strings[asize(strings)] = "    ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ &l8D";
  strings[asize(strings)] = Date( reportdate )+" &l16D";
  strings[asize(strings)] = " ÄÄ  ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ                      &l8D";
  strings[asize(strings)] = "";
  strings[asize(strings)] = "";
  strings[asize(strings)] = "                                      ˆ‘œ €‘—…’›• „Š“Œ…’‚";
  strings[asize(strings)] = "";
  strings[asize(strings)] = "                                    ü       ®â " + Date( {curdate} )+" &l16D";
  strings[asize(strings)] = "                                      ÄÄÄÄ     ÄÄ  ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ  &l8D";
  strings[asize(strings)] = "(3R(s0p16.67h8.5v0s0b0T&l1X&l8D&l0O&a5L";
  strings[asize(strings)] = "ÚÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄ¿";
  strings[asize(strings)] = "³ ü   ³‚¨¤   ³ü    ³„ â       ³ ‘ã¬¬        ³ ®¬¥à              ³ ˆŠ     ³ ®¬¥à              ³ ®¬¥à              ³â- ³";
  strings[asize(strings)] = "³¯/¯  ³®¯¥-  ³¤®ªã-³¤®ªã¬¥­â  ³ ¤®ªã¬¥­â    ³ «¨æ¥¢®£®           ³ ¡ ­ª    ³ ª®àà¥á¯®­¤¥­âáª®£® ³ «¨æ¥¢®£®           ³¬¥â-³";
  strings[asize(strings)] = "³     ³à æ¨¨ ³¬¥­â ³          ³             ³ áç¥â               ³ ¯®«ãç - ³ áç¥â               ³ áç¥â               ³ª¨  ³";
  strings[asize(strings)] = "³     ³(è¨äà ³     ³          ³             ³ ¯« â¥«ìé¨ª         ³ â¥«ï    ³ ¡ ­ª               ³ ¯®«ãç â¥«ï         ³¡ ­-³";
  strings[asize(strings)] = "³     ³¤®ª.) ³     ³          ³             ³                    ³         ³ ¯®«ãç â¥«ï         ³                    ³ª   ³";
  strings[asize(strings)] = "ÃÄÄÄÄÄÅÄÄÄÄÄÄÅÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄ´";
  strings[asize(strings)] = "³  1  ³   2  ³  3  ³    4     ³      5      ³          6         ³    7    ³          8         ³          9         ³ 10 ³";
  strings[asize(strings)] = "ÃÄÄÄÄÄÅÄÄÄÄÄÄÅÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄ´";


     strings[asize(strings)] = string( "³", (i):5, "³", dataset.value("t_shifroper"):6:r, "³",
                               dataset.value("t_number"):5:r, "³", date(dataset.value("t_valuedate")), "³",  dataset.value("t_amount"):13:f, "³", dataset.value("t_payeraccount"):20, "³",
                               bicb(dataset.value("t_receiverbankid")):9, "³", dataset.value("t_receivercorraccnostro"):20, "³", dataset.value("t_receiveraccount"):20, "³    ³" );
sum=sum+dataset.value("t_amount");
shifroper=dataset.value("t_shifroper");
numberpack=dataset.value("t_numberpack");
priority=dataset.value("t_priority");
else
  return 0;
end;

while (dataset.movenext())
i=i+1;
//if ((dataset.value("t_shifroper")!=shifroper) or (dataset.value("t_numberpack")!=numberpack) or (dataset.value("t_priority")!=priority))
//if (shifroper)
i=1;
n=n+1;
  strings[asize(strings)] = "³     ³      ³     ³          ³             ³                    ³         ³                    ³                    ³    ³";
  strings[asize(strings)] = "³ˆ’ƒ³      ³     ³          ³" + string(sum:13:f) + "³                    ³         ³                    ³                    ³    ³";
  strings[asize(strings)] = "ÀÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÙ";
  strings[asize(strings)] = "";
  strings[asize(strings)] = "";
  strings[asize(strings)] = "";
  strings[asize(strings)] = "";
  strings[asize(strings)] = "";
  strings[asize(strings)] = "                                                                            ®¤¯¨á¨";
  strings[asize(strings)] = "";
  strings[asize(strings)] = "";
  strings[asize(strings)] = "      Œ..                                                             _________________________";
  strings[asize(strings)] = "";
  strings[asize(strings)] = "";
  strings[asize(strings)] = "                                                                       _________________________";
 sum=0;
*/
 i = 0;
while (i<asize(strings))
println (strings(i));
i=i+1;
end;
/*
asize(strings,0);
i=1;
// setoutput(null,true);
// viewfile(fulloutput);
 if (strlen(string(n+1))==1)
  Fulloutput = out + output+"00"+string(n+1)+".txt";                    
 elif (strlen(string(n+1))==2)
  Fulloutput = out + output+"0"+string(n+1)+".txt";                    
 elif (strlen(string(n+1))==3)
  Fulloutput = out + output+string(n+1)+".txt";                    
 end;
 setoutput(fulloutput,false);

cmd = rsdcommand("SELECT   sum(pm.t_amount) as amount, count(*) as cnt "+
    "FROM dpmpaym_dbt pm, dwlpm_dbt wl, dpmrmprop_dbt rm, dpmprop_dbt pr "+
   "WHERE pm.t_paymentid = wl.t_paymentid "+
   "AND pm.t_paymentid = pr.t_paymentid "  +
   "and pr.t_group=1 " +
   "and pr.t_issender=chr(0) "  +
     "AND pm.t_paymentid = rm.t_paymentid "+
     "AND pm.t_fiid = 0 "+
     "AND pm.t_valuedate =  ? "+
     "AND rm.t_shifroper NOT IN ('01') "+
     "AND wl.t_propstatus >3000 "+
     "AND rm.t_shifroper = ? "+
     "AND pm.t_numberpack = ? "+
     "AND rm.t_priority = ? ");
 cmd.addparam("date",RSDBP_IN, reportdate);
 cmd.addparam("shifr",RSDBP_IN,dataset.value("t_shifroper"));
 cmd.addparam("pack",RSDBP_IN,dataset.value("t_numberpack"));
 cmd.addparam("pr",RSDBP_IN,dataset.value("t_priority"));
 cmd.execute();
 rsd = RSDRECORDSET(cmd);
 if (rsd.movenext())
 end;


  strings[asize(strings)] = "(3R(s0p13.50h8.5v0s0b20T&l1X&l8D&l0O&a7L&l2E                                             &l8D";
  strings[asize(strings)] = "";
  strings[asize(strings)] = "                                                                                  ÚÄÄÄÄÄÄÄ¿";
  strings[asize(strings)] = "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ    ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ                                          ³0401060³";
  strings[asize(strings)] = "®áâã¯.¢ ¡ ­ª ¯« â.   ‘¯¨á ­® á® áç.¯« â.                                         ÀÄÄÄÄÄÄÄÙ";
  strings[asize(strings)] = "";
  strings[asize(strings)] = "";
  strings[asize(strings)] = "‘‚„…                                                                            ÚÄÄÄÄ¿       &l8D";
  strings[asize(strings)] = "‹€’…†… “—…ˆ… ü                       " + Date({curdate}) + "                             ³    ³       &l3.45C";
  strings[asize(strings)] = "                                       ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ   ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ   ÀÄÄÄÄÙ       &l3.45C";
  strings[asize(strings)] = "                                              „ â                ‚¨¤ ¯« â¥¦                     &l3.45C";
  strings[asize(strings)] = "          ³                                                                                     &l3.45C";
  strings[asize(strings)] = "‘ã¬¬      ³  " + RubToStr( rsd.value("amount") )+" &l3.45C";
  strings[asize(strings)] = "          ³                                                                                     &l8D";
  strings[asize(strings)] = "¯à®¯¨áìî  ³                                                                                     &l3.45C";
  strings[asize(strings)] = "          ³                                                                                     &l8D";
  strings[asize(strings)] = "          ³                                                                                     &l3.45C";
  strings[asize(strings)] = "ÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ&l8D";
  if (SplitFullInn(GetPartyINN({SelfId}, 1), StrInn, StrKPP)==0)
   strings[asize(strings)] = "ˆ "+string(StrINN:15)+"       ³ Š "+string(StrKPP:15)+"      ³ ‘ã¬¬  ³ "+money((rsd.value("amount")):f)+" &l3.45C";
  else
   strings[asize(strings)] = "ˆ                       ³ Š                      ³ ‘ã¬¬  ³ "+money((rsd.value("amount")):f)+" &l3.45C";
  end;
  strings[asize(strings)] = "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´       ³                                  &l8D";
  strings[asize(strings)] = " € €Š \"ˆ‡…‘€Š\"                             ³       ³                                  &l3.45C";
  strings[asize(strings)] = "                                                     ³       ³                                  &l8D";
  strings[asize(strings)] = "                                                     ³       ³                                  &l3.45C";
  strings[asize(strings)] = "                                                     ÃÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ&l8D";
  strings[asize(strings)] = "                                                     ³ ‘ç. ü ³ "+{CORAC_Bank}+"             &l3.45C";
  strings[asize(strings)] = "                                                     ³       ³                                  &l8D";
  strings[asize(strings)] = "                                                     ³       ³                                  &l3.45C";
  strings[asize(strings)] = "                                                     ³       ³                                  &l8D";
  strings[asize(strings)] = "« â¥«ìé¨ª                                           ³       ³                                  &l3.45C";
  strings[asize(strings)] = "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄ´                                  &l8D";
  strings[asize(strings)] = " …“ Œ‘Š‚‘Šƒ ƒ’“ €Š€ ‘‘ˆˆ, ƒ. Œ‘Š‚€ 35    ³ ˆŠ   ³ "+044525000+"                     &l3.45C";
  strings[asize(strings)] = "                                                     ÃÄÄÄÄÄÄÄ´                                  &l8D";
  strings[asize(strings)] = "                                                     ³ ‘ç. ü ³                                  &l3.45C";
  strings[asize(strings)] = "                                                     ³       ³                                  &l8D";
  strings[asize(strings)] = " ­ª ¯« â¥«ìé¨ª                                      ³       ³                                  &l3.45C";
  strings[asize(strings)] = "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ&l8D";
  strings[asize(strings)] = "  §­ë¥                                              ³ ˆŠ   ³                                  &l3.45C";
  strings[asize(strings)] = "                                                     ÃÄÄÄÄÄÄÄ´                                  &l8D";
  strings[asize(strings)] = "                                                     ³ ‘ç. ü ³                                  &l3.45C";
  strings[asize(strings)] = "                                                     ³       ³                                  &l8D";
  strings[asize(strings)] = " ­ª ¯®«ãç â¥«ï                                      ³       ³                                  &l3.45C";
  strings[asize(strings)] = "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄ´                                  &l8D";
  strings[asize(strings)] = "ˆ                       ³ Š                      ³ ‘ç. ü ³                                  &l3.45C";
  strings[asize(strings)] = "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´       ³                                  &l8D";
  strings[asize(strings)] = "  §­ë¥                                              ³       ³                                  &l3.45C";
  strings[asize(strings)] = "                                                     ³       ³                                  &l8D";
  strings[asize(strings)] = "                                                     ³       ³                                  &l3.45C";
  strings[asize(strings)] = "                                                     ÃÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄ&l8D";
  strings[asize(strings)] = "                                                     ³‚¨¤.®¯.³          ³‘à®ª.¯« â.³            &l3.45C";
  strings[asize(strings)] = "                                                     ÃÄÄÄÄÄÄÄ´          ÃÄÄÄÄÄÄÄÄÄÄ´            &l8D";
  strings[asize(strings)] = "                                                     ³ §.¯«.³          ³ç¥à.¯« â.³             &l3.45C";
  strings[asize(strings)] = "                                                     ÃÄÄÄÄÄÄÄ´          ÃÄÄÄÄÄÄÄÄÄÄ´            &l8D";
  strings[asize(strings)] = "®«ãç â¥«ì                                           ³Š®¤    ³          ³¥§. ¯®«¥ ³            &l3.45C";
  strings[asize(strings)] = "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÂÄÄÄÄÄÄÄÄÁÄÄÄÂÄÄÄÁÄÄÄÄÄÄÄÄÄÄÁÄÄÄÂÄÄÄÄÄÄÁÄÄÄÄÄÂÄÄÄÄÄÄ&l8D";
  strings[asize(strings)] = "                       ³               ³    ³            ³                  ³            ³      &l3.45C";
  strings[asize(strings)] = "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄ&l8D";
  strings[asize(strings)] = "                                                                                                &l3.45C";
  strings[asize(strings)] = " Š®«-¢® ¤®ª-â®¢ - "+int(rsd.value("cnt"))+" &l3.45C";
  strings[asize(strings)] = "                                                                                                &l8D";
  strings[asize(strings)] = "                                                                                                &l3.45C";
  strings[asize(strings)] = "                                                                                                &l8D";
  strings[asize(strings)] = "                                                                                                &l3.45C";
  strings[asize(strings)] = "                                                                                                &l8D";
  strings[asize(strings)] = "                                                                                                &l8D";
  strings[asize(strings)] = "                                                                                                &l3.45C";
  strings[asize(strings)] = "                                                                                                &l8D";
  strings[asize(strings)] = " §­ ç¥­¨¥ ¯« â¥¦                                                                               &l3.45C";
  strings[asize(strings)] = "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ&l8D";
  strings[asize(strings)] = "                           ®¤¯¨á¨                                â¬¥âª¨ ¡ ­ª                  &l3.45C";
  strings[asize(strings)] = "                                                                                                &l8D";
  strings[asize(strings)] = "                                                                                                &l3.45C";
  strings[asize(strings)] = "                                                                                                &l8D";
  strings[asize(strings)] = "                                                                                                &l3.45C";
  strings[asize(strings)] = "                    ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ                                            &l8D";
  strings[asize(strings)] = "      Œ..                                                                                      &l3.45C";
  strings[asize(strings)] = "                                                                                                &l8D";
  strings[asize(strings)] = "                                                                                                &l3.45C";
  strings[asize(strings)] = "                                                                                                &l8D";
  strings[asize(strings)] = "                                                                                                &l3.45C";
  strings[asize(strings)] = "                    ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ                                            &l8D";
  strings[asize(strings)] = "                                                                                                &l8D";
  strings[asize(strings)] = "                                                                                                &l3.45C";
  strings[asize(strings)] = "                                                                                                &l8D";
  strings[asize(strings)] = "                                                                                                &l3.45C";
  strings[asize(strings)] = "                                                                                                &l8D";
  strings[asize(strings)] = "";



  strings[asize(strings)] = "(3R(s0p13.50h8.5v0s0b20T&l1X&l8D&l0O&a7L&l2E                                             &l8D";
  strings[asize(strings)] = "";
  strings[asize(strings)] = "                                                                                  ÚÄÄÄÄÄÄÄ¿";
  strings[asize(strings)] = "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ    ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ                                          ³0401060³";
  strings[asize(strings)] = "®áâã¯.¢ ¡ ­ª ¯« â.   ‘¯¨á ­® á® áç.¯« â.                                         ÀÄÄÄÄÄÄÄÙ";
  strings[asize(strings)] = "";
  strings[asize(strings)] = "";
  strings[asize(strings)] = "‘‚„…                                                                            ÚÄÄÄÄ¿       &l8D";
  strings[asize(strings)] = "‹€’…†… “—…ˆ… ü " + substr(strsubst(string({curdate}),".",""),1,4) + "                  " + Date({curdate}) + "                             ³    ³       &l3.45C";
  strings[asize(strings)] = "                                       ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ   ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ   ÀÄÄÄÄÙ       &l3.45C";
  strings[asize(strings)] = "                                              „ â                ‚¨¤ ¯« â¥¦                     &l3.45C";
  strings[asize(strings)] = "          ³                                                                                     &l3.45C";
  strings[asize(strings)] = "‘ã¬¬      ³  " + RubToStr(string(rsd.value("amount")))+" &l3.45C";
  strings[asize(strings)] = "          ³                                                                                     &l8D";
  strings[asize(strings)] = "¯à®¯¨áìî  ³                                                                                     &l3.45C";
  strings[asize(strings)] = "          ³                                                                                     &l8D";
  strings[asize(strings)] = "          ³                                                                                     &l3.45C";
  strings[asize(strings)] = "ÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ&l8D";
  if (SplitFullInn(GetPartyINN({SelfId}, 1), StrInn, StrKPP)==0)
   strings[asize(strings)] = "ˆ "+string(StrINN:15)+"       ³ Š "+string(StrKPP:15)+"      ³ ‘ã¬¬  ³ "+money((rsd.value("amount")):f)+" &l3.45C";
  else
   strings[asize(strings)] = "ˆ                       ³ Š                      ³ ‘ã¬¬  ³ "+money((rsd.value("amount")):f)+" &l3.45C";
/*  end;*/
  strings[asize(strings)] = "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´       ³                                  &l8D";
  strings[asize(strings)] = " € €Š \"ˆ‡…‘€Š\"                             ³       ³                                  &l3.45C";
  strings[asize(strings)] = "                                                     ³       ³                                  &l8D";
  strings[asize(strings)] = "                                                     ³       ³                                  &l3.45C";
  strings[asize(strings)] = "                                                     ÃÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ&l8D";
  strings[asize(strings)] = "                                                     ³ ‘ç. ü ³ "+{CORAC_Bank}+"             &l3.45C";
  strings[asize(strings)] = "                                                     ³       ³                                  &l8D";
  strings[asize(strings)] = "                                                     ³       ³                                  &l3.45C";
  strings[asize(strings)] = "                                                     ³       ³                                  &l8D";
  strings[asize(strings)] = "« â¥«ìé¨ª                                           ³       ³                                  &l3.45C";
  strings[asize(strings)] = "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄ´                                  &l8D";
  strings[asize(strings)] = " …“ Œ‘Š‚‘Šƒ ƒ’“ €Š€ ‘‘ˆˆ, ƒ. Œ‘Š‚€ 35    ³ ˆŠ   ³ "+044525000+" &l3.45C";
  strings[asize(strings)] = "                                                     ÃÄÄÄÄÄÄÄ´                                  &l8D";
  strings[asize(strings)] = "                                                     ³ ‘ç. ü ³                                  &l3.45C";
  strings[asize(strings)] = "                                                     ³       ³                                  &l8D";
  strings[asize(strings)] = " ­ª ¯« â¥«ìé¨ª                                      ³       ³                                  &l3.45C";
  strings[asize(strings)] = "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ&l8D";
  strings[asize(strings)] = "  §­ë¥                                              ³ ˆŠ   ³                                  &l3.45C";
  strings[asize(strings)] = "                                                     ÃÄÄÄÄÄÄÄ´                                  &l8D";
  strings[asize(strings)] = "                                                     ³ ‘ç. ü ³                                  &l3.45C";
  strings[asize(strings)] = "                                                     ³       ³                                  &l8D";
  strings[asize(strings)] = " ­ª ¯®«ãç â¥«ï                                      ³       ³                                  &l3.45C";
  strings[asize(strings)] = "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄ´                                  &l8D";
  strings[asize(strings)] = "ˆ                       ³ Š                      ³ ‘ç. ü ³                                  &l3.45C";
  strings[asize(strings)] = "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´       ³                                  &l8D";
  strings[asize(strings)] = "  §­ë¥                                              ³       ³                                  &l3.45C";
  strings[asize(strings)] = "                                                     ³       ³                                  &l8D";
  strings[asize(strings)] = "                                                     ³       ³                                  &l3.45C";
  strings[asize(strings)] = "                                                     ÃÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄ&l8D";
  strings[asize(strings)] = "                                                     ³‚¨¤.®¯.³          ³‘à®ª.¯« â.³            &l3.45C";
  strings[asize(strings)] = "                                                     ÃÄÄÄÄÄÄÄ´          ÃÄÄÄÄÄÄÄÄÄÄ´            &l8D";
  strings[asize(strings)] = "                                                     ³ §.¯«.³          ³ç¥à.¯« â.³  &l3.45C";
  strings[asize(strings)] = "                                                     ÃÄÄÄÄÄÄÄ´          ÃÄÄÄÄÄÄÄÄÄÄ´            &l8D";
  strings[asize(strings)] = "®«ãç â¥«ì                                           ³Š®¤    ³          ³¥§. ¯®«¥ ³            &l3.45C";
  strings[asize(strings)] = "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÂÄÄÄÄÄÄÄÄÁÄÄÄÂÄÄÄÁÄÄÄÄÄÄÄÄÄÄÁÄÄÄÂÄÄÄÄÄÄÁÄÄÄÄÄÂÄÄÄÄÄÄ&l8D";
  strings[asize(strings)] = "                       ³               ³    ³            ³                  ³            ³      &l3.45C";
  strings[asize(strings)] = "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄ&l8D";
  strings[asize(strings)] = "                                                                                                &l3.45C";
//  strings[asize(strings)] = " Š®«-¢® ¤®ª-â®¢ - "+int(rsd.value("cnt"))+" &l3.45C";
  strings[asize(strings)] = " « â¥¦¨ ¢ á®®â¢¥âáâ¢¨¨ á à¥¥áâà ¬¨ ¯à®¢¥¤¥­­ëå ¯« â¥¦¥©, ¯¥à¥¤ ­­ëå ¯® ª ­ « ¬ á¢ï§¨           &l3.45C";
  strings[asize(strings)] = " " + Date({curdate}) + ". “­¨ª «ì­ë¥ ­®¬¥à  à¥¥áâà®¢ ü"+sess+"                                                &l8D";
  strings[asize(strings)] = "                                                                                                &l3.45C";
  strings[asize(strings)] = "                                                                                                &l8D";
  strings[asize(strings)] = "                                                                                                &l3.45C";
  strings[asize(strings)] = "                                                                                                &l8D";
  strings[asize(strings)] = "                                                                                                &l8D";
  strings[asize(strings)] = "                                                                                                &l3.45C";
  strings[asize(strings)] = "                                                                                                &l8D";
  strings[asize(strings)] = " §­ ç¥­¨¥ ¯« â¥¦                                                                               &l3.45C";
  strings[asize(strings)] = "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ&l8D";
  strings[asize(strings)] = "                           ®¤¯¨á¨                                â¬¥âª¨ ¡ ­ª                  &l3.45C";
  strings[asize(strings)] = "                                                                                                &l8D";
  strings[asize(strings)] = "                                                                                                &l3.45C";
  strings[asize(strings)] = "                                                                                                &l8D";
  strings[asize(strings)] = "                                                                                                &l3.45C";
  strings[asize(strings)] = "                    ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ                                            &l8D";
  strings[asize(strings)] = "      Œ..                                                                                      &l3.45C";
  strings[asize(strings)] = "                                                                                                &l8D";
  strings[asize(strings)] = "                                                                                                &l3.45C";
  strings[asize(strings)] = "                                                                                                &l8D";
  strings[asize(strings)] = "                                                                                                &l3.45C";
  strings[asize(strings)] = "                    ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ                                            &l8D";
  strings[asize(strings)] = "                                                                                                &l8D";
  strings[asize(strings)] = "                                                                                                &l3.45C";
  strings[asize(strings)] = "                                                                                                &l8D";
  strings[asize(strings)] = "                                                                                                &l3.45C";
  strings[asize(strings)] = "                                                                                                &l8D";
  strings[asize(strings)] = "";


  strings[asize(strings)] = "(3R(s0p13.5h8.5v0s0b0T&l1X&l8D&l0O&a5L";
  strings[asize(strings)] = string( {Name_Bank}:43:l )+" &l16D";
  strings[asize(strings)] = "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ &l8D";
  strings[asize(strings)] = "ˆŠ " + string({MFO_Bank}:9:l)+" &l16D";
  strings[asize(strings)] = "    ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ &l8D";
  strings[asize(strings)] = "Š/c " + {CORAC_Bank}+" &l16D";
  strings[asize(strings)] = "    ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ &l8D";
  strings[asize(strings)] = "ƒŠ–/Š– " + string( rcc({operdprt}):50:l)+" &l16D";
  strings[asize(strings)] = "         ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ &l8D";
  strings[asize(strings)] = "ˆŠ " + string(bicrcc({operdprt}):9)+" &l16D";
  strings[asize(strings)] = "    ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ &l8D";
  strings[asize(strings)] = Date( reportdate )+" &l16D";
  strings[asize(strings)] = " ÄÄ  ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ                      &l8D";
  strings[asize(strings)] = "";
  strings[asize(strings)] = "";
  strings[asize(strings)] = "                                      ˆ‘œ €‘—…’›• „Š“Œ…’‚";
  strings[asize(strings)] = "";
  strings[asize(strings)] = "                                    ü       ®â " + Date( {curdate} )+" &l16D";
  strings[asize(strings)] = "                                      ÄÄÄÄ     ÄÄ  ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ  &l8D";
  strings[asize(strings)] = "(3R(s0p16.67h8.5v0s0b0T&l1X&l8D&l0O&a5L";
  strings[asize(strings)] = "ÚÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄ¿";
  strings[asize(strings)] = "³ ü   ³‚¨¤   ³ü    ³„ â       ³ ‘ã¬¬        ³ ®¬¥à              ³ ˆŠ     ³ ®¬¥à              ³ ®¬¥à              ³â- ³";
  strings[asize(strings)] = "³¯/¯  ³®¯¥-  ³¤®ªã-³¤®ªã¬¥­â  ³ ¤®ªã¬¥­â    ³ «¨æ¥¢®£®           ³ ¡ ­ª    ³ ª®àà¥á¯®­¤¥­âáª®£® ³ «¨æ¥¢®£®           ³¬¥â-³";
  strings[asize(strings)] = "³     ³à æ¨¨ ³¬¥­â ³          ³             ³ áç¥â               ³ ¯®«ãç - ³ áç¥â               ³ áç¥â               ³ª¨  ³";
  strings[asize(strings)] = "³     ³(è¨äà ³     ³          ³             ³ ¯« â¥«ìé¨ª         ³ â¥«ï    ³ ¡ ­ª               ³ ¯®«ãç â¥«ï         ³¡ ­-³";
  strings[asize(strings)] = "³     ³¤®ª.) ³     ³          ³             ³                    ³         ³ ¯®«ãç â¥«ï         ³                    ³ª   ³";
  strings[asize(strings)] = "ÃÄÄÄÄÄÅÄÄÄÄÄÄÅÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄ´";
  strings[asize(strings)] = "³  1  ³   2  ³  3  ³    4     ³      5      ³          6         ³    7    ³          8         ³          9         ³ 10 ³";
  strings[asize(strings)] = "ÃÄÄÄÄÄÅÄÄÄÄÄÄÅÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄ´";

//end;
//end;
  
     strings[asize(strings)] = string( "³", (i):5, "³", dataset.value("t_shifroper"):6:r, "³",
                               dataset.value("t_number"):5:r, "³", date(dataset.value("t_valuedate")), "³",  dataset.value("t_amount"):13:f, "³", dataset.value("t_payeraccount"):20, "³",
                               bicb(dataset.value("t_receiverbankid")):9, "³", dataset.value("t_receivercorraccnostro"):20, "³", dataset.value("t_receiveraccount"):20, "³    ³" );
sum=sum+dataset.value("t_amount");
shifroper=dataset.value("t_shifroper");
numberpack=dataset.value("t_numberpack");
priority=dataset.value("t_priority");
end;
 

  strings[asize(strings)] = "ÃÄÄÄÄÄÅÄÄÄÄÄÄÅÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄ   ÄÄ ÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄ´";
  strings[asize(strings)] = "³     ³      ³     ³          ³             ³                    ³         ³                    ³                    ³    ³";
  strings[asize(strings)] = "³ˆ’ƒ³      ³     ³          ³" + string(sum:13:f) + "³                    ³         ³                    ³                    ³    ³";
  strings[asize(strings)] = "ÀÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÙ";
  strings[asize(strings)] = "";
  strings[asize(strings)] = "";
  strings[asize(strings)] = "";
  strings[asize(strings)] = "";
  strings[asize(strings)] = "";
  strings[asize(strings)] = "                                                                            ®¤¯¨á¨";
  strings[asize(strings)] = "";
  strings[asize(strings)] = "";
  strings[asize(strings)] = "      Œ..                                                             _________________________";
  strings[asize(strings)] = "";
  strings[asize(strings)] = "";
  strings[asize(strings)] = "                                                                       _________________________";
i = 0;
while (i<asize(strings))
println (strings(i));
i=i+1;
end;

*/

setoutput(null,true);
viewfile(fulloutput);
END;

 /*¡à ¡®âç¨ª ¤¨ «®£®¢®© ¯ ­¥«¨ ¢¢®¤  ¨áå®¤­ëå ¤ ­­ëå ¤«ï ¯¥ç â¨*/
MACRO Event (dlg, cmd, id, key) 

   var const_mess = "~F2~ à®¤®«¦¨âì ~ESC~ ‚ëå®¤ ";

   /*¥à¢®­ ç «ì­ ï ¨­¨æ¨ «¨§ æ¨ï ¯®«¥©*/
   if(cmd == DLG_INIT)
      dlg.rec.ReportDate  = {curdate};
      UpdateFields(dlg); 
   end;
   
   /*“áâ ­®¢ª  ¯®¤áª §®ª ¢ áâà®ª¥ á®áâ®ï­¨ï*/
   if (cmd==DLG_SETFOCUS)
     if (FldName(dlg,id)=="ReportDate")
       message(" ~F3~ ‚ë¡®à ¤ âë ¨§ ª «¥­¤ àï "+const_mess);
      else 
       message(const_mess);
     end;
   end;
   
   if (cmd == DLG_REMFOCUS)
     /*à®¢¥àª  ª®àà¥ªâ­®áâ¨ ¤ â ®âç¥â */
     if (FldName(dlg,id) == "ReportDate")
       if ( dlg.rec.reportdate > {curdate} )
         MsgBox("„ â   ­¥ ¬®¦¥â ¡ëâì ¡®«ìè¥ ¤ âë â¥ªãé¥£® ®¯¥à æ¨®­­®£® ¤­ï");
        return CM_CANCEL;
       end;
     end;
      UpdateFields(dlg); 
   end;

   if (cmd == DLG_KEY)
     /*‚ëå®¤ ¨§ ¤¨ «®£®¢®£® ®ª­  ä®à¬¨à®¢ ­¨ï ®âç¥â */
     if (KEY == KEY_ESC)
       return exit(1);//CM_CANCEL;
     /*‚ë¡®à ¤ ­­ëå ¨§ á¯¨áª */
     elif ( KEY == KEY_F3)
        /*‚ë¡®à ¤ âë ¨§ ª «¥­¤ àï*/
        if (FldName(dlg,id) == "ReportDate")
          dlg.rec.reportdate = GetDateByCalendar ({curDate});
        end;

        
     elif (( KEY == KEY_F2 )   or ( KEY == KEY_ENTER ))        //à®¢¥àª¨ ¯à¨ ¢¢®¤¥
         if ( dlg.rec.reportdate > {curdate} )
                MsgBox("„ â   ­¥ ¬®¦¥â ¡ëâì ¡®«ìè¥ ¤ âë â¥ªãé¥£® ®¯¥à æ¨®­­®£® ¤­ï");
                return CM_IGNORE;
         end;
        reportdate  = dlg.rec.reportdate;
        return cm_save;
      else
           Return CM_IGNORE;
     end;
   end;
        
END;

/*’®çª  ¢å®¤  ¢ ¬ ªà®á*/
if (RunDialog(dlg, "Event"))                  
outall();
end;
END;


