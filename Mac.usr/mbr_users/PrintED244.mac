// ------------------------------------------------------------------------------------------------
// @filename: PrintED244.mac
// @author  : Gurin S. УФЭБС Альбом v2.6.0
// @desc    : Печать сообщений ED244
// @request : none
// -------------------------------------------------------------------------------------------------
Import MesInter, rsd, likepy, oralib;

private macro NameField(_name)
    var sql, parm, NameField = _name;
    sql  = "select t_description descr from dwltpfld_dbt where t_tpid = 9 and t_name = :name";
    parm = makeArray (SQLParam ("name", _name));
    sql  = execSQLSelect (sql, parm);
    if (sql.moveNext)
        NameField = sql.value ("descr");
    end;
    return NameField;
end;

macro PrintForm( addrMes, MassCopy )

    record wlmes( wlmes );
    SetBuff( wlmes, addrMes );

    var field_name, field_value;
    [ 
       ОТВЕТ НА ЗАПРОС ПО ЭПС УЧАСТНИКА

    ];

    while( СчитатьПоле( field_name, field_value ) )
        if  ((NameField(field_name) == "Начало блока") or (NameField(field_name) == "Конец блока"))
            println ("");
        else
            println("  ", NameField(field_name), "  :  ", field_value );
        end;
    end;
 
    return true;

end;

                                                  