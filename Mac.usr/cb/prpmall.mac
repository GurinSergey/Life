/************************************************************************/
/*         Автоматизированная банковская система RS-Bank                */
/*                 Copyright (c) R-Style Software Lab 2002              */
/*                                                                      */
/*  Имя файла      : prpmall.mac                                        */
/*                                                                      */
/*  Описание       : Вызов печати платежа в той или иной форме.         */
/*                                                                      */
/*  Программист    : Смирнов С.В. SMR PRN                               */
/*                                                                      */
/*  Создан         : 11.10.02                                           */
/*                                                                      */
/************************************************************************/

import prpm;

MACRO PrintDocument(ncopy:integer):bool
  var DocKind:integer = pr_pmpaym.rec.DocKind,
      stat:bool;
  if( DocKind == 261 )
      DocKind = PS_PAYORDER;
  end;

  /* Банковский ордер */
  if( pr_pmrmprop.rec.ShifrOper == "17" )

    stat = ExecMacroFile( "prpmboi.mac", "PrintBankOrder", ncopy );
    
  /* Платежный ордер (частичная оплата картотеки 2 печатается так всегда) */
  elif( (DocKind == PS_PAYORDER) and (pr_pmrmprop.rec.ShifrOper == "16" ) )
    stat = FillBuffersForPayOrderPrint();
    if(stat)
      stat = ExecMacroFile("prpmori.mac", "PrintPayOrder", ncopy);
    end;

  /* Клиентское платежное поручение с шифром 06 является инкассовым поручением */
/*
  elif( ((DocKind == PS_PAYORDER) and (pr_pspayord.rec.DocKind == PSPOKIND_REQUEST) and (pr_pmrmprop.rec.ShifrOper == "06" )) or
        (DocKind == PS_INRQ)
      )
*/
//SDA 11.03.2012 

  elif( ((DocKind == PS_PAYORDER) and (pr_pmrmprop.rec.ShifrOper == "06" )) or
        (DocKind == PS_INRQ)
      )

    stat = ExecMacroFile("prpmini.mac", "PrintIncashRequest", ncopy);

  /*Платежное поручение*/
  elif( (DocKind == DLDOC_BANKPAYMENT) or 
        ((DocKind == PS_PAYORDER) and (pr_pspayord.rec.DocKind == PSPOKIND_ORDER)) )
    stat = ExecMacroFile("prpmrqi.mac", "PrintPayReq", ncopy);

  /*Платежное требование*/
  elif( (DocKind == DLDOC_BANKCLAIM) or 
        ((DocKind == PS_PAYORDER) and (pr_pspayord.rec.DocKind == PSPOKIND_DEMAND)) )
    stat = ExecMacroFile("prpmdmi.mac", "PrintPayDem", ncopy);

  /*Платежное требование-поручение*/
  elif( (DocKind == PS_PAYORDER) and (pr_pspayord.rec.DocKind == PSPOKIND_REQUEST) )
    stat = ExecMacroFile("prpmini.mac", "PrintIncashRequest", ncopy);

  /*Аккредитив*/
  elif( (DocKind == PS_PAYORDER) and (pr_pspayord.rec.DocKind == PSPOKIND_AKKREDITIV) )
    stat = ExecMacroFile("prpmaci.mac", "PrintAkkreditiv", ncopy);

  /*Платежное поручение*/
  elif( paymentIsRequest(pr_pmpaym, pr_debet, pr_credit) )
    stat = ExecMacroFile("prpmrqi.mac", "PrintPayReq", ncopy);

  /*Платежное требование*/
  elif( paymentIsDemand(pr_pmpaym, pr_debet, pr_credit) )
    stat = ExecMacroFile("prpmdmi.mac", "PrintPayDem", ncopy);

  else
    MsgBox("Данный вид документа не поддерживается макросом");
    stat = FALSE;
  end;
  
  return stat;

END;
