/*++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

   EVG  Функции формирования номера документа по референсу.

++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++*/
import BankInter;

/* ID Референса "ПРББ: формирование номеров внутрибанковских документов" */
const REFID_NumberDoc = 1000001;

macro GenNumberDocument()

  var ret, GenNumber = "";

  ret = GenerateReference(REFID_NumberDoc, GenNumber);

  if (ret > 0)
    msgbox ("При формировании номера документа по референсу возникла ошибка " + ret + "!|" + 
            "Формирование номера невозможно!");
    return "";
  end;

  return GenNumber;
end;
