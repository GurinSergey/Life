/*+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

   ████████   ████████
   ███   ███  ███   ███
   ███  ████  ███  ███
   ███████    ███████
   ███  ███   ███  ███
   ███   ███  ███   ███

   RR Рахмедов Р.С.

   Имя файла: ClubCard_Scroll.mac

   Создан:    18.02.2014

   Описание:  Пользовательский скролинг содержащий данные, выгруженные из вронта, о клубных картах.
              
   ChangeLog:
-----------------------------------------------------------------------------------------------------------------------------------------------------

+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++*/

import ZubRunScroll;
import lib_fc_corporate;

private macro main ()
    var sql = " SELECT RS_CODE_CLIENT, " +
              "        CLIENT_NAME, " +
              "        INN, " +
              "        SERVICE_STATUS, " +
              "        SERVICE_NAME, " +
              "        to_char(SERVICE_TYPE) SERVICE_TYPE, " +
              "        SERVICE_KIND, " +
              "        DATE_BEGIN_SERVICES, " +
              "        DATE_END_SERVICES, " +
              "        DATE_MINING, " +
              "        to_char(SERVICE_COUNT) SERVICE_COUNT " +
              "   FROM USR_FRONT_CLUBCARDINFO " +
              "  WHERE SERVICE_STATUS IN ('Подключена', 'Отключена') ";
             
    var scroll = ZubScroll ();

    scroll.Columns.Add ("RS_CODE_CLIENT",      "RS код",              12,   ZUB_SCR_COL_NONEDITABLE);
    scroll.Columns.Add ("CLIENT_NAME",         "Имя клиента",         30,   ZUB_SCR_COL_NONEDITABLE);
    scroll.Columns.Add ("INN",                 "ИНН",                 10,   ZUB_SCR_COL_NONEDITABLE);
    scroll.Columns.Add ("SERVICE_STATUS",      "Статус услуги",       10,   ZUB_SCR_COL_NONEDITABLE);
    scroll.Columns.Add ("SERVICE_NAME",        "Наименование услуги", 15,   ZUB_SCR_COL_NONEDITABLE);
    scroll.Columns.Add ("SERVICE_TYPE",        "Тип услуги",          5,    ZUB_SCR_COL_NONEDITABLE);
    scroll.Columns.Add ("SERVICE_KIND",        "Вид услуги",          20,   ZUB_SCR_COL_NONEDITABLE);
    scroll.Columns.Add ("DATE_BEGIN_SERVICES", "Дата подключения",    10,   ZUB_SCR_COL_NONEDITABLE);
    scroll.Columns.Add ("DATE_END_SERVICES",   "Дата отключения",     10,   ZUB_SCR_COL_NONEDITABLE);
    scroll.Columns.Add ("DATE_MINING",         "Дата загрузки",       10,   ZUB_SCR_COL_NONEDITABLE);
    scroll.Columns.Add ("SERVICE_COUNT",       "Кол-во",              10,   ZUB_SCR_COL_NONEDITABLE);
    scroll.ScrollReadOnly = true;
    scroll.SqlText = sql;
    scroll.ScrollHead = "Загруженная информация по Клубным картам (только для чтения)";

    scroll.Scroll ();
end;

main ();
exit (1);