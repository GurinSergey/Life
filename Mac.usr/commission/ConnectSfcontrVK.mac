/*+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

   ████████   ████████
   ███   ███  ███   ███
   ███  ████  ███  ████
   ███████    ███████
   ███  ███   ███  ███
   ███   ███  ███   ███

   RR Рахмедов Р.С.

   Имя файла: ConnectSfContrVK.mac

   Создан:    10.04.2012
   
   Описание:  Макрос вызова процедуры отключения комиссий  за валютный контроль от договоров обслуживания.
   
   ChangeLog:
-----------------------------------------------------------------------------------------------------------------------------------------------------
   //RR 20.04.2012 Допилено для ЭВ, наведена красота в выводе.
-----------------------------------------------------------------------------------------------------------------------------------------------------
   //RR 23.04.2012 Допилено для корректной работы 7-рок
-----------------------------------------------------------------------------------------------------------------------------------------------------
   //RR 22.05.2012 Добавлен ПРББ для тестирования на 30-м патче
-----------------------------------------------------------------------------------------------------------------------------------------------------
   //RR 22.06.2012 Добавлены новые комиссии по заявке C-12205
-----------------------------------------------------------------------------------------------------------------------------------------------------
   //RR 26.06.2012 Убраны комиссии указанные в C-12205
-----------------------------------------------------------------------------------------------------------------------------------------------------
   //RR 30.01.2013 Изменил проверку даты
-----------------------------------------------------------------------------------------------------------------------------------------------------
   //EVG 18.06.2014 Сделал подключение комиссий за ВК для банка Солидарность
-----------------------------------------------------------------------------------------------------------------------------------------------------
   //RR 29.01.2015 Адаптировано для банка ПОЙДЕМ
-----------------------------------------------------------------------------------------------------------------------------------------------------
   //RR 22.07.2015 Макрос переехал в ConnectSfContrVK_MainProc.mac
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++*/

import bankInter, Globals;

  private array a;
  private var TypeC,
              ComissV,
              OperDate;
   
   a[0] = "7.*.*v_in Седьмые пункты тарифов";
   a[1] = "9.*.*_in Девятые пункты тарифов";
  
   TypeC = Menu(a, "Выберите вид тарифа");
   if   (TypeC == 0)
     ComissV = 7;
   elif (TypeC == 1)
     ComissV = 9;
   end;

   /* Дата выполнения процедуры */
   OperDate = {CurDate};
   if ( not GetDate( OperDate, "Пожалуйста, введите дату окончания периода:" ) )
      exit(1);
   end;
  
   // 2012-09-10 zip_z. I-00249064-2 добавлена журнализация >
   if (not WriteFiscLog (OLSTRPROC, "ЗАПУСК ПРОЦЕДУРЫ ОТКЛЮЧЕНИЯ КОМИССИЙ ОТ ДОГОВОРОВ ОБСЛУЖИВАНИЯ\n" + 
                                    "Дата      : " + OperDate + "\n"
                                    "Вид тарифа: " + a[TypeC] + "\n"
                                    "Макрос    : connectsfcontrVK.mac"))
       msgbox ("Не удалось добавить запись о старте процедуры в фискальный журнал");
   end;
  
  ExecMacroFile("ConnectSfContrVK_MainProc.mac","ConnectSfContrVK",OperDate,ComissV,true);
  
     // 2012-09-10 zip_z. I-00249064-2 добавлена журнализация >
   if (not WriteFiscLog (OLFINPROC, "ОКОНЧАНИЕ ПРОЦЕДУРЫ ОТКЛЮЧЕНИЯ КОМИССИЙ ОТ ДОГОВОРОВ ОБСЛУЖИВАНИЯ\n" + 
                                    "Дата      : " + OperDate + "\n"
                                    "Вид тарифа: " + a[TypeC] + "\n"
                                    "Макрос    : connectsfcontrVK.mac"))
       msgbox ("Не удалось добавить запись об окончании процедуры в фискальный журнал");
   end;
   // < 2012-09-10 zip_z. 