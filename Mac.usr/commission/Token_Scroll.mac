/*+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

   ████████   ████████
   ███   ███  ███   ███
   ███  ████  ███  ███
   ███████    ███████
   ███  ███   ███  ███
   ███   ███  ███   ███

   RR Рахмедов Р.С.

   Имя файла: Token_Scroll.mac

   Создан:    06.11.2013

   Описание:  Пользовательский скролинг содержащий данные, выгруженные из вронта, о токенах.
              
   ChangeLog:
-----------------------------------------------------------------------------------------------------------------------------------------------------

+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++*/

import ZubRunScroll;
import lib_fc_corporate;

private macro main (OperDate)
    var sql = " SELECT   F_CLIENT, " +
              "          RS_CODE_CLIENT, " +
              "          CLIENT_NAME, " +
              "          SERVICE_TYPE, " +
              "          DATE_BEGIN, " +
              "          STATUS, " +
              "          TOKEN_COUNT " +
              "   FROM   USR_FRONT_TOKENINFO WHERE DATE_BEGIN = '"+OperDate+"'";
             
    var scroll = ZubScroll ();

    scroll.Columns.Add ("F_CLIENT"      ,"ID клиента во Фронте",null ,ZUB_SCR_COL_NONEDITABLE);
    scroll.Columns.Add ("CLIENT_NAME"   ,"Клиент"              ,30   ,ZUB_SCR_COL_NONEDITABLE);
    scroll.Columns.Add ("RS_CODE_CLIENT","RS-код"              ,10   ,ZUB_SCR_COL_NONEDITABLE);
    scroll.Columns.Add ("SERVICE_TYPE"  ,"Тип услуги"          ,10   ,ZUB_SCR_COL_NONEDITABLE);
    scroll.Columns.Add ("DATE_BEGIN"    ,"Дата начала действия",20   ,ZUB_SCR_COL_NONEDITABLE);
    scroll.Columns.Add ("STATUS"        ,"Статус"              ,10   ,ZUB_SCR_COL_NONEDITABLE);
    scroll.Columns.Add ("TOKEN_COUNT"   ,"Количество токенов"  ,20   ,ZUB_SCR_COL_NONEDITABLE);
    scroll.ScrollReadOnly = true;
    scroll.SqlText = sql;
    scroll.ScrollHead = "Загруженная информация по Токенам (только для чтения)";

    scroll.Scroll ();
end;

var OperDate = {CurDate};
if ( not GetDate( OperDate, "Введите дату действия токенов:" ) )
   exit(1);
end;

main (OperDate);
exit (1);