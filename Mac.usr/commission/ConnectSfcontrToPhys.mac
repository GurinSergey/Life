/*+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

   joy Макрос вызова процедуры отключения\подключения ежедневных периодических комиссий 
       за переводы на счета физических лиц C-31392

   Банк: ПРББ
   
   Создан: joy Жаворонкова Н.Ю. 28.07.2014
   
   ChangeLog:
   
-----------------------------------------------------------------------------------------------------------------------------------------------------
   //RR 29.01.2015 Адаптировано для банка ПОЙДЕМ
   //joy 28.05.2015 C-40210  Добавлено подключение 3.9.* для ВУЗа
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++*/

import "ConnectSfcontr_MainProc.mac";
import bankInter;

private var TypeC,
            ComissN,
            codes,
            UserTypeAccount, 
            OperDate,
            LifeBank = fg_life_subject( {OurBank} );
            
private array a;

     if ( LifeBank.is_VUZ() ) // 28.05.2015 joy C-40210
        a[0] = "3.9.* Комиссии за прочие платежи в пользу ФЛ на счета в других банках";
        TypeC = Menu(a, "Выберите вид тарифа");
         if     (TypeC == 0)
           ComissN = 390;
           codes = "3.9.1 - 3.9.7";
         end;
     else
        a[0] = "3.10.* Комиссии за прочие платежи в пользу ФЛ на счета в банках гр. Лайф";
        a[1] = "3.9.* Комиссии за прочие платежи в пользу ФЛ на счета в других банках";

         if (  LifeBank.is_EXV() )
            a[2] = "3.2.3 Комиссии за прочие платежи в пользу ФЛ в оплату з\п на счета в банках гр. Лайф";
            a[3] = "3.4.10 Комиссии за прочие платежи в пользу ФЛ в оплату з\п на счета в других банках";
         end;
      
        TypeC = Menu(a, "Выберите вид тарифа");
         if     (TypeC == 0)
           ComissN = 3100;
           codes = "3.10.1 - 3.10.7";
        elif   (TypeC == 1)
           ComissN = 390;
           codes = "3.9.1 - 3.9.7";
        elif   (TypeC == 2)
           ComissN = 323;
           codes = "3.2.3";
        elif   (TypeC == 3)
           ComissN = 3410;
           codes = "3.4.10";
        end;
     end;
        

     /* Дата выполнения процедуры */
  OperDate = {CurDate};
  if ( not GetDate( OperDate, "Пожалуйста, введите дату за которую хотите списать комиссию:" ) )
     exit(1);
  end;

  if (LifeBank.is_PRBB() or LifeBank.is_EXV() or LifeBank.is_GEB() or LifeBank.is_SLD() or LifeBank.is_GO() or LifeBank.is_VUZ() )
    ExecMacroFile("ConnectSfcontr_MainProc.mac", "Run_Connection_Com_To_Phys",  OperDate, ComissN, codes, true)
  else
     msgbox ("Извините, процедура для вашего банка не подключена");
  end;