/*+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

   ████████   ████████
   ███   ███  ███   ███
   ███  ████  ███  ████
   ███████    ███████
   ███  ███   ███  ███
   ███   ███  ███   ███

   RR Рахмедов Р.С.

   Имя файла: ConnectSfContrMonth.mac

   Создан:    23.07.2013(Предыдущая версия сохранена в ConnectSfcontr_MainProc.mac)
   
   Описание:  Механизм подключения перенес на сторону БД, для этих целей был разработан пакет usr_comiss_prbb_220, результаты
              выполнения сохраняются в таблицу usr_account_collection_220
   
   ChangeLog:
-----------------------------------------------------------------------------------------------------------------------------------------------------
   //RR 30.07.2013 Экспресс Волга и все ее филиалы переведы на пакетное подключение, для этих целей был разработан пакет 
                   usr_comiss_exv_220, результаты выполнения сохраняются в таблицу usr_account_collection_220
-----------------------------------------------------------------------------------------------------------------------------------------------------
   //RR 24.04.2014 ВУЗ переведен на пакетное подключение, для этих целей был разработан пакет 
                   usr_comiss_vuz_221_222, результаты выполнения сохраняются в таблицу usr_account_collection_221_222, сразу перенесена в 
                   RunConnection221_222VUZ, для обеспечения возможности вызова подключения роботом 20201
-----------------------------------------------------------------------------------------------------------------------------------------------------
   //RR 07.05.2014 Добавил в RunConnection220PRBB передачу текущей даты.
-----------------------------------------------------------------------------------------------------------------------------------------------------
   //RR 16.07.2014 В рамках создания робота для банка Солидарность, функция RunConnection220PRBB переехала в ConnectSfcontr_MainProc.mac
-----------------------------------------------------------------------------------------------------------------------------------------------------
   //RR 08.12.2014 Переезд RunConnection220EXV() из ConnectSfContrMonth.mac в ConnectSfContr_MainProc.mac
-----------------------------------------------------------------------------------------------------------------------------------------------------
   //RR 29.01.2015 Адаптировано для банка ПОЙДЕМ
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++*/
import RSD, Globals, TReport, fg_Life_parm, Календарь;

private const fgBank = fg_life_subject({OurBank});
var DateConnection;

/*****************************************************Точка Входа(Entry Point)*******************************************************/

  /* Дата выполнения процедуры */
  DateConnection = {CurDate};
  if ( not GetDate( DateConnection, "Введите любую дату месяца за который необходимо выполнить процедуру подключения:" ) )
     exit(1);
  end;
  DateConnection = date(   String(GetDaysInMonth (date(DateConnection))) 
                         + substr( string(DateConnection), 
                           index(string(DateConnection) ,"."), 
                           StrLen (string(DateConnection))));
  
  if (fgBank.is_PRBB() or fgBank.is_SLD() or fgBank.is_GO())
  
    ExecMacroFile ("ConnectSfcontr_MainProc.mac", "RunConnection220PRBB", true, DateConnection);
    
  elif (fgBank.is_EXV())
    
    ExecMacroFile("ConnectSfcontr_MainProc.mac", "RunConnection220EXV", True, DateConnection);
    
  elif (fgBank.is_VUZ())
  
    ExecMacroFile("ConnectSfcontr_MainProc.mac", "RunConnection221_222VUZ", True,DateConnection);
    ExecMacroFile("ConnectSfcontr_MainProc.mac", "RunConnection220_V_VUZ", True,DateConnection);
  
  else
  
    msgbox("Для вашего банка процедура подключения не предусмотрена \nОбращайтесь в Рахмедову Р.С. ");
    
  end;
 /***********************************************************************************************************************************/