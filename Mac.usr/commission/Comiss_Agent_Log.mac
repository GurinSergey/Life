/*+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

   RR Рахмедов Р.С.

   Имя файла Comiss_Agent_Log.mac

   Создан:    25.03.2013

   Описание:  Макрос для получения информации из лога агента комиссий (USR_COMISS_AGENT_LOG)
              
   P.S.       Редактирование, рефаторинг, добавление новых функций запрещено, все делать по согласованию со мной.
              Товарища Данилкива О.Я. это особо касается

+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++*/

Import RSD, Globals, SfInter, RSBError, Календарь, lib_rsbsession;
 var Rdate;
 
 Macro Get_Comiss_Agent_Log (Log_date);

  var cmd, rs;
  
   cmd = RSDCommand(" SELECT LOGG.T_DATE||' '||substr(LOGG.T_TIME, 1, 11)||' - '||LOGG.T_AGENT_INFO||' : '||LOGG.T_TEXT " +
                    "   FROM USR_COMISS_AGENT_LOG logg " +
                    "  WHERE LOGG.T_DATE = '"+Log_date+"' "+
                    "  order by LOGG.T_TIME asc ");
   rs  = RSDRecordSet(cmd);
   while (rs and rs.movenext())
     println (rs.value(0));
   end;
 END;

 RDate = {curdate}; 

 if (GetDate(RDate, "Введите дату отчета"))
   Get_Comiss_Agent_Log (Rdate);
 end; 


                                  